Commit Hash: 5dca69e26fe97f17d4a6cbd6872103c868577b14
Subject: software node: Handle software node injection to an existing device properly


Security Keywords:
- injection

Full commit message:
software node: Handle software node injection to an existing device properly

The function software_node_notify() - the function that creates
and removes the symlinks between the node and the device - was
called unconditionally in device_add_software_node() and
device_remove_software_node(), but it needs to be called in
those functions only in the special case where the node is
added to a device that has already been registered.

This fixes NULL pointer dereference that happens if
device_remove_software_node() is used with device that was
never registered.

Fixes: b622b24519f5 ("software node: Allow node addition to already existing device")
Reported-and-tested-by: Dominik Brodowski <linux@dominikbrodowski.net>
Reviewed-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Signed-off-by: Heikki Krogerus <heikki.krogerus@linux.intel.com>
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

Metadata:
Author: Heikki Krogerus <heikki.krogerus@linux.intel.com>
Author Date: Wed Jun 23 16:14:21 2021 +0300
Committer: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Commit Date: Wed Jun 23 19:34:58 2021 +0200

Files Changed: 1
Lines Added: 12
Lines Removed: 4
Total Changes: 16
