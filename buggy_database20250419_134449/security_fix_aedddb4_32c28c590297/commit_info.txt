Commit Hash: aedddb4e45b34426cfbfa84454b6f203712733c5
Subject: NFC: add necessary privilege flags in netlink layer


Security Keywords:
- exploit

Full commit message:
NFC: add necessary privilege flags in netlink layer

The CAP_NET_ADMIN checks are needed to prevent attackers faking a
device under NCIUARTSETDRIVER and exploit privileged commands.

This patch add GENL_ADMIN_PERM flags in genl_ops to fulfill the check.
Except for commands like NFC_CMD_GET_DEVICE, NFC_CMD_GET_TARGET,
NFC_CMD_LLC_GET_PARAMS, and NFC_CMD_GET_SE, which are mainly information-
read operations.

Signed-off-by: Lin Ma <linma@zju.edu.cn>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Lin Ma <linma@zju.edu.cn>
Author Date: Tue Nov 2 16:10:21 2021 +0800
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Wed Nov 3 11:15:18 2021 +0000

Files Changed: 1
Lines Added: 15
Lines Removed: 0
Total Changes: 15
