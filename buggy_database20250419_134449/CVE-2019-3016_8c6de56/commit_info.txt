Commit Hash: 8c6de56a42e0c657955e12b882a81ef07d1d073e
Subject: x86/kvm: Be careful not to clear KVM_VCPU_FLUSH_TLB bit

CVE Identifiers:
- CVE-2019-3016

Full commit message:
x86/kvm: Be careful not to clear KVM_VCPU_FLUSH_TLB bit

kvm_steal_time_set_preempted() may accidentally clear KVM_VCPU_FLUSH_TLB
bit if it is called more than once while VCPU is preempted.

This is part of CVE-2019-3016.

(This bug was also independently discovered by Jim Mattson
<jmattson@google.com>)

Signed-off-by: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Reviewed-by: Joao Martins <joao.m.martins@oracle.com>
Cc: stable@vger.kernel.org
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Boris Ostrovsky <boris.ostrovsky@oracle.com>
Author Date: Wed Oct 30 19:01:31 2019 +0000
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Thu Jan 30 18:45:54 2020 +0100

Files Changed: 1
Lines Added: 3
Lines Removed: 0
Total Changes: 3
