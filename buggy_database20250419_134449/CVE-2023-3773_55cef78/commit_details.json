{
  "hash": "55cef78c244d0d076f5a75a35530ca63c92f4426",
  "hash_short": "55cef78c",
  "subject": "macvlan: add forgotten nla_policy for IFLA_MACVLAN_BC_CUTOFF",
  "body": "The previous commit 954d1fa1ac93 (\"macvlan: Add netlink attribute for\nbroadcast cutoff\") added one additional attribute named\nIFLA_MACVLAN_BC_CUTOFF to allow broadcast cutfoff.\n\nHowever, it forgot to describe the nla_policy at macvlan_policy\n(drivers/net/macvlan.c). Hence, this suppose NLA_S32 (4 bytes) integer\ncan be faked as empty (0 bytes) by a malicious user, which could leads\nto OOB in heap just like CVE-2023-3773.\n\nTo fix it, this commit just completes the nla_policy description for\nIFLA_MACVLAN_BC_CUTOFF. This enforces the length check and avoids the\npotential OOB read.\n\nFixes: 954d1fa1ac93 (\"macvlan: Add netlink attribute for broadcast cutoff\")\nSigned-off-by: Lin Ma <linma@zju.edu.cn>\nReviewed-by: Simon Horman <simon.horman@corigine.com>\nLink: https://lore.kernel.org/r/20230723080205.3715164-1-linma@zju.edu.cn\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "macvlan: add forgotten nla_policy for IFLA_MACVLAN_BC_CUTOFF\n\nThe previous commit 954d1fa1ac93 (\"macvlan: Add netlink attribute for\nbroadcast cutoff\") added one additional attribute named\nIFLA_MACVLAN_BC_CUTOFF to allow broadcast cutfoff.\n\nHowever, it forgot to describe the nla_policy at macvlan_policy\n(drivers/net/macvlan.c). Hence, this suppose NLA_S32 (4 bytes) integer\ncan be faked as empty (0 bytes) by a malicious user, which could leads\nto OOB in heap just like CVE-2023-3773.\n\nTo fix it, this commit just completes the nla_policy description for\nIFLA_MACVLAN_BC_CUTOFF. This enforces the length check and avoids the\npotential OOB read.\n\nFixes: 954d1fa1ac93 (\"macvlan: Add netlink attribute for broadcast cutoff\")\nSigned-off-by: Lin Ma <linma@zju.edu.cn>\nReviewed-by: Simon Horman <simon.horman@corigine.com>\nLink: https://lore.kernel.org/r/20230723080205.3715164-1-linma@zju.edu.cn\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Lin Ma",
  "author_email": "linma@zju.edu.cn",
  "author_date": "Sun Jul 23 16:02:05 2023 +0800",
  "author_date_iso": "2023-07-23T16:02:05+08:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Tue Jul 25 19:48:50 2023 -0700",
  "committer_date_iso": "2023-07-25T19:48:50-07:00",
  "files_changed": [
    "drivers/net/macvlan.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/macvlan.c",
      "insertions": 1,
      "deletions": 0
    }
  ],
  "total_insertions": 1,
  "total_deletions": 0,
  "total_changes": 1,
  "parents": [
    "284779dbf4e98753458708783af8c35630674a21"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2023-3773"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/macvlan.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}