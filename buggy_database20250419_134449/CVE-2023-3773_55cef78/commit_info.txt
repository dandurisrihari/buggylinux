Commit Hash: 55cef78c244d0d076f5a75a35530ca63c92f4426
Subject: macvlan: add forgotten nla_policy for IFLA_MACVLAN_BC_CUTOFF

CVE Identifiers:
- CVE-2023-3773

Full commit message:
macvlan: add forgotten nla_policy for IFLA_MACVLAN_BC_CUTOFF

The previous commit 954d1fa1ac93 ("macvlan: Add netlink attribute for
broadcast cutoff") added one additional attribute named
IFLA_MACVLAN_BC_CUTOFF to allow broadcast cutfoff.

However, it forgot to describe the nla_policy at macvlan_policy
(drivers/net/macvlan.c). Hence, this suppose NLA_S32 (4 bytes) integer
can be faked as empty (0 bytes) by a malicious user, which could leads
to OOB in heap just like CVE-2023-3773.

To fix it, this commit just completes the nla_policy description for
IFLA_MACVLAN_BC_CUTOFF. This enforces the length check and avoids the
potential OOB read.

Fixes: 954d1fa1ac93 ("macvlan: Add netlink attribute for broadcast cutoff")
Signed-off-by: Lin Ma <linma@zju.edu.cn>
Reviewed-by: Simon Horman <simon.horman@corigine.com>
Link: https://lore.kernel.org/r/20230723080205.3715164-1-linma@zju.edu.cn
Signed-off-by: Jakub Kicinski <kuba@kernel.org>

Metadata:
Author: Lin Ma <linma@zju.edu.cn>
Author Date: Sun Jul 23 16:02:05 2023 +0800
Committer: Jakub Kicinski <kuba@kernel.org>
Commit Date: Tue Jul 25 19:48:50 2023 -0700

Files Changed: 1
Lines Added: 1
Lines Removed: 0
Total Changes: 1
