{
  "hash": "09da1f3463eb81d59685df723b1c5950b7570340",
  "hash_short": "09da1f34",
  "subject": "Bluetooth: Fix redundant encryption request for reauthentication",
  "body": "When we're performing reauthentication (in order to elevate the\nsecurity level from an unauthenticated key to an authenticated one) we\ndo not need to issue any encryption command once authentication\ncompletes. Since the trigger for the encryption HCI command is the\nENCRYPT_PEND flag this flag should not be set in this scenario.\nInstead, the REAUTH_PEND flag takes care of all necessary steps for\nreauthentication.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nCc: stable@vger.kernel.org",
  "full_message": "Bluetooth: Fix redundant encryption request for reauthentication\n\nWhen we're performing reauthentication (in order to elevate the\nsecurity level from an unauthenticated key to an authenticated one) we\ndo not need to issue any encryption command once authentication\ncompletes. Since the trigger for the encryption HCI command is the\nENCRYPT_PEND flag this flag should not be set in this scenario.\nInstead, the REAUTH_PEND flag takes care of all necessary steps for\nreauthentication.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nCc: stable@vger.kernel.org",
  "author_name": "Johan Hedberg",
  "author_email": "johan.hedberg@intel.com",
  "author_date": "Fri Apr 11 12:02:32 2014 -0700",
  "author_date_iso": "2014-04-11T12:02:32-07:00",
  "committer_name": "Johan Hedberg",
  "committer_email": "johan.hedberg@intel.com",
  "committer_date": "Fri Apr 25 09:47:15 2014 +0300",
  "committer_date_iso": "2014-04-25T09:47:15+03:00",
  "files_changed": [
    "net/bluetooth/hci_conn.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 6,
      "deletions": 3
    }
  ],
  "total_insertions": 6,
  "total_deletions": 3,
  "total_changes": 9,
  "parents": [
    "9eb1fbfa0a737fd4d3a6d12d71c5ea9af622b887"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.15",
    "v3.15-rc5",
    "v3.15-rc6",
    "v3.15-rc7",
    "v3.15-rc8",
    "v3.16",
    "v3.16-rc1",
    "v3.16-rc2",
    "v3.16-rc3",
    "v3.16-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}