Commit Hash: 09da1f3463eb81d59685df723b1c5950b7570340
Subject: Bluetooth: Fix redundant encryption request for reauthentication


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix redundant encryption request for reauthentication

When we're performing reauthentication (in order to elevate the
security level from an unauthenticated key to an authenticated one) we
do not need to issue any encryption command once authentication
completes. Since the trigger for the encryption HCI command is the
ENCRYPT_PEND flag this flag should not be set in this scenario.
Instead, the REAUTH_PEND flag takes care of all necessary steps for
reauthentication.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
Cc: stable@vger.kernel.org

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Fri Apr 11 12:02:32 2014 -0700
Committer: Johan Hedberg <johan.hedberg@intel.com>
Commit Date: Fri Apr 25 09:47:15 2014 +0300

Files Changed: 1
Lines Added: 6
Lines Removed: 3
Total Changes: 9
