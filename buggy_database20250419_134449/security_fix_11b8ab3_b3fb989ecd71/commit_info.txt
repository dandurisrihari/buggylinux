Commit Hash: 11b8ab3836454a2600e396f34731e491b661f9d5
Subject: ubifs: Fix memleak in ubifs_init_authentication


Security Keywords:
- authentication

Full commit message:
ubifs: Fix memleak in ubifs_init_authentication

When crypto_shash_digestsize() fails, c->hmac_tfm
has not been freed before returning, which leads
to memleak.

Fixes: 49525e5eecca5 ("ubifs: Add helper functions for authentication support")
Signed-off-by: Dinghao Liu <dinghao.liu@zju.edu.cn>
Reviewed-by: Zhihao Cheng <chengzhihao1@huawei.com>
Signed-off-by: Richard Weinberger <richard@nod.at>

Metadata:
Author: Dinghao Liu <dinghao.liu@zju.edu.cn>
Author Date: Tue Jan 5 14:03:40 2021 +0800
Committer: Richard Weinberger <richard@nod.at>
Commit Date: Fri Feb 12 21:53:22 2021 +0100

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
