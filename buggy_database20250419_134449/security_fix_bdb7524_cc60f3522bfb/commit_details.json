{
  "hash": "bdb7524a75e4716535a29abb314a82619301e068",
  "hash_short": "bdb7524a",
  "subject": "Bluetooth: Fix non-SSP auth request for HIGH security level sockets",
  "body": "When initiating dedicated bonding a L2CAP raw socket with HIGH security\nlevel is used. The kernel is supposed to trigger the authentication\nrequest in this case but this doesn't happen currently for non-SSP\n(pre-2.1) devices. The reason is that the authentication request happens\nin the remote extended features callback which never gets called for\nnon-SSP devices. This patch fixes the issue by requesting also\nauthentiation in the (normal) remote features callback in the case of\nnon-SSP devices.\n\nThis rule is applied only for HIGH security level which might at first\nseem unintuitive since on the server socket side MEDIUM is already\nenough for authentication. However, for the clients we really want to\nprefer the server side to decide the authentication requrement in most\ncases, and since most client sockets use MEDIUM it's better to be\navoided on the kernel side for these sockets. The important socket to\nrequest it for is the dedicated bonding one and that socket uses HIGH\nsecurity level.\n\nThe patch is based on the initial investigation and patch proposal from\nAndrei Emeltchenko <endrei.emeltchenko@nokia.com>.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@nokia.com>\nAcked-by: Marcel Holtmann <marcel@holtmann.org>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>",
  "full_message": "Bluetooth: Fix non-SSP auth request for HIGH security level sockets\n\nWhen initiating dedicated bonding a L2CAP raw socket with HIGH security\nlevel is used. The kernel is supposed to trigger the authentication\nrequest in this case but this doesn't happen currently for non-SSP\n(pre-2.1) devices. The reason is that the authentication request happens\nin the remote extended features callback which never gets called for\nnon-SSP devices. This patch fixes the issue by requesting also\nauthentiation in the (normal) remote features callback in the case of\nnon-SSP devices.\n\nThis rule is applied only for HIGH security level which might at first\nseem unintuitive since on the server socket side MEDIUM is already\nenough for authentication. However, for the clients we really want to\nprefer the server side to decide the authentication requrement in most\ncases, and since most client sockets use MEDIUM it's better to be\navoided on the kernel side for these sockets. The important socket to\nrequest it for is the dedicated bonding one and that socket uses HIGH\nsecurity level.\n\nThe patch is based on the initial investigation and patch proposal from\nAndrei Emeltchenko <endrei.emeltchenko@nokia.com>.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@nokia.com>\nAcked-by: Marcel Holtmann <marcel@holtmann.org>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>",
  "author_name": "Johan Hedberg",
  "author_email": "johan.hedberg@nokia.com",
  "author_date": "Fri Oct 15 10:46:09 2010 +0300",
  "author_date_iso": "2010-10-15T10:46:09+03:00",
  "committer_name": "Gustavo F. Padovan",
  "committer_email": "padovan@profusion.mobi",
  "committer_date": "Tue Nov 9 00:55:27 2010 -0200",
  "committer_date_iso": "2010-11-09T00:55:27-02:00",
  "files_changed": [
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 6,
      "deletions": 0
    }
  ],
  "total_insertions": 6,
  "total_deletions": 0,
  "total_changes": 6,
  "parents": [
    "96c99b473a8531188e2f6106c6ef0e33bb4500f2"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.37",
    "v2.6.37-rc2",
    "v2.6.37-rc3",
    "v2.6.37-rc4",
    "v2.6.37-rc5",
    "v2.6.37-rc6",
    "v2.6.37-rc7",
    "v2.6.37-rc8",
    "v2.6.38",
    "v2.6.38-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "auth"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}