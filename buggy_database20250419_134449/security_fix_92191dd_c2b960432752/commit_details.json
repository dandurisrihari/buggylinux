{
  "hash": "92191dd1073088753821b862b791dcc83e558e07",
  "hash_short": "92191dd1",
  "subject": "net: ipv6: fix dst ref loops in rpl, seg6 and ioam6 lwtunnels",
  "body": "Some lwtunnels have a dst cache for post-transformation dst.\nIf the packet destination did not change we may end up recording\na reference to the lwtunnel in its own cache, and the lwtunnel\nstate will never be freed.\n\nDiscovered by the ioam6.sh test, kmemleak was recently fixed\nto catch per-cpu memory leaks. I'm not sure if rpl and seg6\ncan actually hit this, but in principle I don't see why not.\n\nFixes: 8cb3bf8bff3c (\"ipv6: ioam: Add support for the ip6ip6 encapsulation\")\nFixes: 6c8702c60b88 (\"ipv6: sr: add support for SRH encapsulation and injection with lwtunnels\")\nFixes: a7a29f9c361f (\"net: ipv6: add rpl sr tunnel\")\nReviewed-by: Simon Horman <horms@kernel.org>\nLink: https://patch.msgid.link/20250130031519.2716843-2-kuba@kernel.org\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "net: ipv6: fix dst ref loops in rpl, seg6 and ioam6 lwtunnels\n\nSome lwtunnels have a dst cache for post-transformation dst.\nIf the packet destination did not change we may end up recording\na reference to the lwtunnel in its own cache, and the lwtunnel\nstate will never be freed.\n\nDiscovered by the ioam6.sh test, kmemleak was recently fixed\nto catch per-cpu memory leaks. I'm not sure if rpl and seg6\ncan actually hit this, but in principle I don't see why not.\n\nFixes: 8cb3bf8bff3c (\"ipv6: ioam: Add support for the ip6ip6 encapsulation\")\nFixes: 6c8702c60b88 (\"ipv6: sr: add support for SRH encapsulation and injection with lwtunnels\")\nFixes: a7a29f9c361f (\"net: ipv6: add rpl sr tunnel\")\nReviewed-by: Simon Horman <horms@kernel.org>\nLink: https://patch.msgid.link/20250130031519.2716843-2-kuba@kernel.org\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Jakub Kicinski",
  "author_email": "kuba@kernel.org",
  "author_date": "Wed Jan 29 19:15:19 2025 -0800",
  "author_date_iso": "2025-01-29T19:15:19-08:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Sat Feb 1 16:55:44 2025 -0800",
  "committer_date_iso": "2025-02-01T16:55:44-08:00",
  "files_changed": [
    "net/ipv6/ioam6_iptunnel.c",
    "net/ipv6/rpl_iptunnel.c",
    "net/ipv6/seg6_iptunnel.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "net/ipv6/ioam6_iptunnel.c",
      "insertions": 6,
      "deletions": 3
    },
    {
      "file": "net/ipv6/rpl_iptunnel.c",
      "insertions": 6,
      "deletions": 3
    },
    {
      "file": "net/ipv6/seg6_iptunnel.c",
      "insertions": 6,
      "deletions": 3
    }
  ],
  "total_insertions": 18,
  "total_deletions": 9,
  "total_changes": 27,
  "parents": [
    "c71a192976ded2f2f416d03c4f595cdd4478b825"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/ipv6/ioam6_iptunnel.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv6/rpl_iptunnel.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv6/seg6_iptunnel.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}