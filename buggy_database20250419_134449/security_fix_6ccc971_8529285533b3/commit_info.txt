Commit Hash: 6ccc971ee2c61a1ffb487e46bf6184f7df6aacfb
Subject: KVM: arm64: nv: Add emulation for ERETAx instructions


Security Keywords:
- Authentication

Full commit message:
KVM: arm64: nv: Add emulation for ERETAx instructions

FEAT_NV has the interesting property of relying on ERET being
trapped. An added complexity is that it also traps ERETAA and
ERETAB, meaning that the Pointer Authentication aspect of these
instruction must be emulated.

Add an emulation of Pointer Authentication, limited to ERETAx
(always using SP_EL2 as the modifier and ELR_EL2 as the pointer),
using the Generic Authentication instructions.

The emulation, however small, is placed in its own compilation
unit so that it can be avoided if the configuration doesn't
include it (or the toolchan in not up to the task).

Reviewed-by: Joey Gouly <joey.gouly@arm.com>
Reviewed-by: Oliver Upton <oliver.upton@linux.dev>
Link: https://lore.kernel.org/r/20240419102935.1935571-13-maz@kernel.org
Signed-off-by: Marc Zyngier <maz@kernel.org>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Fri Apr 19 11:29:32 2024 +0100
Committer: Marc Zyngier <maz@kernel.org>
Commit Date: Sat Apr 20 12:42:51 2024 +0100

Files Changed: 4
Lines Added: 210
Lines Removed: 0
Total Changes: 210
