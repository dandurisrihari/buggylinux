Commit Hash: ed5d44d42c95e8a13bb54e614d2269c8740667f9
Subject: selinux: Implement userns_create hook


Security Keywords:
- privilege escalation
- vulnerability

Full commit message:
selinux: Implement userns_create hook

Unprivileged user namespace creation is an intended feature to enable
sandboxing, however this feature is often used to as an initial step to
perform a privilege escalation attack.

This patch implements a new user_namespace { create } access control
permission to restrict which domains allow or deny user namespace
creation. This is necessary for system administrators to quickly protect
their systems while waiting for vulnerability patches to be applied.

This permission can be used in the following way:

        allow domA_t domA_t : user_namespace { create };

Signed-off-by: Frederick Lawler <fred@cloudflare.com>
Signed-off-by: Paul Moore <paul@paul-moore.com>

Metadata:
Author: Frederick Lawler <fred@cloudflare.com>
Author Date: Mon Aug 15 11:20:28 2022 -0500
Committer: Paul Moore <paul@paul-moore.com>
Commit Date: Tue Aug 16 17:44:44 2022 -0400

Files Changed: 2
Lines Added: 11
Lines Removed: 0
Total Changes: 11
