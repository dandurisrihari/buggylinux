{
  "hash": "ed5d44d42c95e8a13bb54e614d2269c8740667f9",
  "hash_short": "ed5d44d4",
  "subject": "selinux: Implement userns_create hook",
  "body": "Unprivileged user namespace creation is an intended feature to enable\nsandboxing, however this feature is often used to as an initial step to\nperform a privilege escalation attack.\n\nThis patch implements a new user_namespace { create } access control\npermission to restrict which domains allow or deny user namespace\ncreation. This is necessary for system administrators to quickly protect\ntheir systems while waiting for vulnerability patches to be applied.\n\nThis permission can be used in the following way:\n\n        allow domA_t domA_t : user_namespace { create };\n\nSigned-off-by: Frederick Lawler <fred@cloudflare.com>\nSigned-off-by: Paul Moore <paul@paul-moore.com>",
  "full_message": "selinux: Implement userns_create hook\n\nUnprivileged user namespace creation is an intended feature to enable\nsandboxing, however this feature is often used to as an initial step to\nperform a privilege escalation attack.\n\nThis patch implements a new user_namespace { create } access control\npermission to restrict which domains allow or deny user namespace\ncreation. This is necessary for system administrators to quickly protect\ntheir systems while waiting for vulnerability patches to be applied.\n\nThis permission can be used in the following way:\n\n        allow domA_t domA_t : user_namespace { create };\n\nSigned-off-by: Frederick Lawler <fred@cloudflare.com>\nSigned-off-by: Paul Moore <paul@paul-moore.com>",
  "author_name": "Frederick Lawler",
  "author_email": "fred@cloudflare.com",
  "author_date": "Mon Aug 15 11:20:28 2022 -0500",
  "author_date_iso": "2022-08-15T11:20:28-05:00",
  "committer_name": "Paul Moore",
  "committer_email": "paul@paul-moore.com",
  "committer_date": "Tue Aug 16 17:44:44 2022 -0400",
  "committer_date_iso": "2022-08-16T17:44:44-04:00",
  "files_changed": [
    "security/selinux/hooks.c",
    "security/selinux/include/classmap.h"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "security/selinux/hooks.c",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "security/selinux/include/classmap.h",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 11,
  "total_deletions": 0,
  "total_changes": 11,
  "parents": [
    "d5810139cca39cf2854728b465f8bada4a445302"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "privilege escalation",
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "security/selinux/hooks.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/selinux/include/classmap.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}