{
  "hash": "4fc19708b165c1c152fa1f12f6600e66184b7786",
  "hash_short": "4fc19708",
  "subject": "x86/alternatives: Initialize temporary mm for patching",
  "body": "To prevent improper use of the PTEs that are used for text patching, the\nnext patches will use a temporary mm struct. Initailize it by copying\nthe init mm.\n\nThe address that will be used for patching is taken from the lower area\nthat is usually used for the task memory. Doing so prevents the need to\nfrequently synchronize the temporary-mm (e.g., when BPF programs are\ninstalled), since different PGDs are used for the task memory.\n\nFinally, randomize the address of the PTEs to harden against exploits\nthat use these PTEs.\n\nSuggested-by: Andy Lutomirski <luto@kernel.org>\nTested-by: Masami Hiramatsu <mhiramat@kernel.org>\nSigned-off-by: Nadav Amit <namit@vmware.com>\nSigned-off-by: Rick Edgecombe <rick.p.edgecombe@intel.com>\nSigned-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>\nReviewed-by: Masami Hiramatsu <mhiramat@kernel.org>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Dave Hansen <dave.hansen@intel.com>\nCc: H. Peter Anvin <hpa@zytor.com>\nCc: Kees Cook <keescook@chromium.org>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Rik van Riel <riel@surriel.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: akpm@linux-foundation.org\nCc: ard.biesheuvel@linaro.org\nCc: deneen.t.dock@intel.com\nCc: kernel-hardening@lists.openwall.com\nCc: kristen@linux.intel.com\nCc: linux_dti@icloud.com\nCc: will.deacon@arm.com\nLink: https://lkml.kernel.org/r/20190426232303.28381-8-nadav.amit@gmail.com\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
  "full_message": "x86/alternatives: Initialize temporary mm for patching\n\nTo prevent improper use of the PTEs that are used for text patching, the\nnext patches will use a temporary mm struct. Initailize it by copying\nthe init mm.\n\nThe address that will be used for patching is taken from the lower area\nthat is usually used for the task memory. Doing so prevents the need to\nfrequently synchronize the temporary-mm (e.g., when BPF programs are\ninstalled), since different PGDs are used for the task memory.\n\nFinally, randomize the address of the PTEs to harden against exploits\nthat use these PTEs.\n\nSuggested-by: Andy Lutomirski <luto@kernel.org>\nTested-by: Masami Hiramatsu <mhiramat@kernel.org>\nSigned-off-by: Nadav Amit <namit@vmware.com>\nSigned-off-by: Rick Edgecombe <rick.p.edgecombe@intel.com>\nSigned-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>\nReviewed-by: Masami Hiramatsu <mhiramat@kernel.org>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Dave Hansen <dave.hansen@intel.com>\nCc: H. Peter Anvin <hpa@zytor.com>\nCc: Kees Cook <keescook@chromium.org>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Rik van Riel <riel@surriel.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: akpm@linux-foundation.org\nCc: ard.biesheuvel@linaro.org\nCc: deneen.t.dock@intel.com\nCc: kernel-hardening@lists.openwall.com\nCc: kristen@linux.intel.com\nCc: linux_dti@icloud.com\nCc: will.deacon@arm.com\nLink: https://lkml.kernel.org/r/20190426232303.28381-8-nadav.amit@gmail.com\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
  "author_name": "Nadav Amit",
  "author_email": "namit@vmware.com",
  "author_date": "Fri Apr 26 16:22:46 2019 -0700",
  "author_date_iso": "2019-04-26T16:22:46-07:00",
  "committer_name": "Ingo Molnar",
  "committer_email": "mingo@kernel.org",
  "committer_date": "Tue Apr 30 12:37:52 2019 +0200",
  "committer_date_iso": "2019-04-30T12:37:52+02:00",
  "files_changed": [
    "arch/x86/include/asm/pgtable.h",
    "arch/x86/include/asm/text-patching.h",
    "arch/x86/kernel/alternative.c",
    "arch/x86/mm/init.c",
    "init/main.c"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "arch/x86/include/asm/pgtable.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "arch/x86/include/asm/text-patching.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/x86/kernel/alternative.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "arch/x86/mm/init.c",
      "insertions": 37,
      "deletions": 0
    },
    {
      "file": "init/main.c",
      "insertions": 3,
      "deletions": 0
    }
  ],
  "total_insertions": 48,
  "total_deletions": 0,
  "total_changes": 48,
  "parents": [
    "13585fa0668c724efab9635aaeef6ec390217415"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.2",
    "v5.2-rc1",
    "v5.2-rc2",
    "v5.2-rc3",
    "v5.2-rc4",
    "v5.2-rc5",
    "v5.2-rc6",
    "v5.2-rc7",
    "v5.3",
    "v5.3-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/include/asm/pgtable.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/include/asm/text-patching.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kernel/alternative.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/mm/init.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "init/main.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}