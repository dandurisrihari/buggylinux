Commit Hash: cd08d3216fc4e684f05fe4cf696a275a975f6499
Subject: KVM: arm64: Unify UNDEF injection helpers


Security Keywords:
- injection

Full commit message:
KVM: arm64: Unify UNDEF injection helpers

We currently have two helpers (undef_access() and trap_undef()) that
do exactly the same thing: inject an UNDEF and return 'false' (as an
indication that PC should not be incremented).

We definitely could do with one less. Given that undef_access() is
used 80ish times, while trap_undef() is only used 30 times, the
latter loses the battle and is immediately sacrificed.

We also have a large number of instances where undef_access() is
open-coded. Let's also convert those.

Reviewed-by: Oliver Upton <oliver.upton@linux.dev>
Link: https://lore.kernel.org/r/20240827152517.3909653-11-maz@kernel.org
Signed-off-by: Marc Zyngier <maz@kernel.org>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Tue Aug 27 16:25:16 2024 +0100
Committer: Marc Zyngier <maz@kernel.org>
Commit Date: Tue Aug 27 18:32:56 2024 +0100

Files Changed: 1
Lines Added: 51
Lines Removed: 81
Total Changes: 132
