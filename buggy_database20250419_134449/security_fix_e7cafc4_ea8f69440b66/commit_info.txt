Commit Hash: e7cafc45258c852c5176cd421615846e79a3d307
Subject: Bluetooth: Pass initiator/acceptor information to hci_conn_security()


Security Keywords:
- authentication

Full commit message:
Bluetooth: Pass initiator/acceptor information to hci_conn_security()

We're interested in whether an authentication request is because of a
remote or local action. So far hci_conn_security() has been used both
for incoming and outgoing actions (e.g. RFCOMM or L2CAP connect
requests) so without some modifications it cannot know which peer is
responsible for requesting authentication.

This patch adds a new "bool initiator" parameter to hci_conn_security()
to indicate which side is responsible for the request and updates the
current users to pass this information correspondingly.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Thu Jul 17 15:35:38 2014 +0300
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Thu Jul 17 14:39:39 2014 +0200

Files Changed: 7
Lines Added: 17
Lines Removed: 13
Total Changes: 30
