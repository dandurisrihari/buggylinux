Commit Hash: 684ec215706d449f78da232aae125c0bc14f22a9
Subject: platform/x86/intel/ifs: Authenticate and copy to secured memory


Security Keywords:
- authentication

Full commit message:
platform/x86/intel/ifs: Authenticate and copy to secured memory

The IFS image contains hashes that will be used to authenticate the ifs
test chunks. First, use WRMSR to copy the hashes and enumerate the number
of test chunks, chunk size and the maximum number of cores that can run
scan test simultaneously.

Next, use WRMSR to authenticate each and every scan test chunk which is
stored in the IFS image. The CPU will check if the test chunks match
the hashes, otherwise failure is indicated to system software. If the test
chunk is authenticated, it is automatically copied to secured memory.

Use schedule_work_on() to perform the hash copy and authentication. Note
this needs only be done on the first logical cpu of each socket.

Reviewed-by: Dan Williams <dan.j.williams@intel.com>
Signed-off-by: Jithu Joseph <jithu.joseph@intel.com>
Co-developed-by: Tony Luck <tony.luck@intel.com>
Signed-off-by: Tony Luck <tony.luck@intel.com>
Acked-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
Link: https://lore.kernel.org/r/20220506225410.1652287-8-tony.luck@intel.com
Signed-off-by: Hans de Goede <hdegoede@redhat.com>

Metadata:
Author: Jithu Joseph <jithu.joseph@intel.com>
Author Date: Fri May 6 15:54:05 2022 -0700
Committer: Hans de Goede <hdegoede@redhat.com>
Commit Date: Thu May 12 15:35:29 2022 +0200

Files Changed: 2
Lines Added: 226
Lines Removed: 2
Total Changes: 228
