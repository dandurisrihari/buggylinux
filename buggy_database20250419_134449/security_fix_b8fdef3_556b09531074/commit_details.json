{
  "hash": "b8fdef311a0bd9223f10754f94fdcf1a594a3457",
  "hash_short": "b8fdef31",
  "subject": "arm64: Always force a branch protection mode when the compiler has one",
  "body": "Compilers with branch protection support can be configured to enable it by\ndefault, it is likely that distributions will do this as part of deploying\nbranch protection system wide. As well as the slight overhead from having\nsome extra NOPs for unused branch protection features this can cause more\nserious problems when the kernel is providing pointer authentication to\nuserspace but not built for pointer authentication itself. In that case our\nswitching of keys for userspace can affect the kernel unexpectedly, causing\npointer authentication instructions in the kernel to corrupt addresses.\n\nTo ensure that we get consistent and reliable behaviour always explicitly\ninitialise the branch protection mode, ensuring that the kernel is built\nthe same way regardless of the compiler defaults.\n\nFixes: 7503197562567 (arm64: add basic pointer authentication support)\nReported-by: Szabolcs Nagy <szabolcs.nagy@arm.com>\nSigned-off-by: Mark Brown <broonie@kernel.org>\nCc: stable@vger.kernel.org\n[catalin.marinas@arm.com: remove Kconfig option in favour of Makefile check]\nSigned-off-by: Catalin Marinas <catalin.marinas@arm.com>",
  "full_message": "arm64: Always force a branch protection mode when the compiler has one\n\nCompilers with branch protection support can be configured to enable it by\ndefault, it is likely that distributions will do this as part of deploying\nbranch protection system wide. As well as the slight overhead from having\nsome extra NOPs for unused branch protection features this can cause more\nserious problems when the kernel is providing pointer authentication to\nuserspace but not built for pointer authentication itself. In that case our\nswitching of keys for userspace can affect the kernel unexpectedly, causing\npointer authentication instructions in the kernel to corrupt addresses.\n\nTo ensure that we get consistent and reliable behaviour always explicitly\ninitialise the branch protection mode, ensuring that the kernel is built\nthe same way regardless of the compiler defaults.\n\nFixes: 7503197562567 (arm64: add basic pointer authentication support)\nReported-by: Szabolcs Nagy <szabolcs.nagy@arm.com>\nSigned-off-by: Mark Brown <broonie@kernel.org>\nCc: stable@vger.kernel.org\n[catalin.marinas@arm.com: remove Kconfig option in favour of Makefile check]\nSigned-off-by: Catalin Marinas <catalin.marinas@arm.com>",
  "author_name": "Mark Brown",
  "author_email": "broonie@kernel.org",
  "author_date": "Tue Mar 31 20:44:59 2020 +0100",
  "author_date_iso": "2020-03-31T20:44:59+01:00",
  "committer_name": "Catalin Marinas",
  "committer_email": "catalin.marinas@arm.com",
  "committer_date": "Wed Apr 1 21:23:40 2020 +0100",
  "committer_date_iso": "2020-04-01T21:23:40+01:00",
  "files_changed": [
    "arch/arm64/Makefile"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/arm64/Makefile",
      "insertions": 6,
      "deletions": 1
    }
  ],
  "total_insertions": 6,
  "total_deletions": 1,
  "total_changes": 7,
  "parents": [
    "15cd0e675f3f76b4d21c313795fe0c23df0ee20f"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.7-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/arm64/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}