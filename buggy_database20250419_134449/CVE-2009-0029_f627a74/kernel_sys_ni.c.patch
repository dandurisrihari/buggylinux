commit f627a741d24f12955fa2d9f8831c3b12860635bd
Author: Heiko Carstens <hca@linux.ibm.com>
Date:   Wed Jan 14 14:13:58 2009 +0100

    [CVE-2009-0029] Make sys_syslog a conditional system call
    
    Remove the -ENOSYS implementation for !CONFIG_PRINTK and use
    the cond_syscall infrastructure instead.
    
    Acked-by: Kyle McMartin <kyle@redhat.com>
    Signed-off-by: Heiko Carstens <heiko.carstens@de.ibm.com>

diff --git a/kernel/sys_ni.c b/kernel/sys_ni.c
index e14a23281707..27dad2967387 100644
--- a/kernel/sys_ni.c
+++ b/kernel/sys_ni.c
@@ -131,6 +131,7 @@ cond_syscall(sys_io_destroy);
 cond_syscall(sys_io_submit);
 cond_syscall(sys_io_cancel);
 cond_syscall(sys_io_getevents);
+cond_syscall(sys_syslog);
 
 /* arch-specific weak syscall entries */
 cond_syscall(sys_pciconfig_read);