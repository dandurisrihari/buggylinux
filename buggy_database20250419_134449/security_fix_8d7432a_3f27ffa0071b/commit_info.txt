Commit Hash: 8d7432a2f53bc283148062955cbe7ffbf713e646
Subject: mac80211: Move ieee80211_mgd_auth() EBUSY check to be before allocation


Security Keywords:
- authentication

Full commit message:
mac80211: Move ieee80211_mgd_auth() EBUSY check to be before allocation

This makes it easier to conditionally replace full allocation of
auth_data to use reallocation for the case of continuing SAE
authentication. Furthermore, there was not really any point in having
this check done so late in the function after having already completed
number of steps that cannot be used anyway in the error case.

Signed-off-by: Jouni Malinen <jouni@codeaurora.org>
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Jouni Malinen <jouni@codeaurora.org>
Author Date: Thu Oct 11 00:21:20 2018 +0300
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Thu Oct 11 16:01:07 2018 +0200

Files Changed: 1
Lines Added: 4
Lines Removed: 7
Total Changes: 11
