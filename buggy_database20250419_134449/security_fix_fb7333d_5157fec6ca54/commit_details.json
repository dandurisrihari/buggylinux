{
  "hash": "fb7333dfd812062d3d51f377e70c1d3a3788472b",
  "hash_short": "fb7333df",
  "subject": "KVM: SVM: fix calls to is_intercept",
  "body": "is_intercept takes an INTERCEPT_* constant, not SVM_EXIT_*; because\nof this, the compiler was removing the body of the conditionals,\nas if is_intercept returned 0.\n\nThis unveils a latent bug: when clearing the VINTR intercept,\nint_ctl must also be changed in the L1 VMCB (svm->nested.hsave),\njust like the intercept itself is also changed in the L1 VMCB.\nOtherwise V_IRQ remains set and, due to the VINTR intercept being clear,\nwe get a spurious injection of a vector 0 interrupt on the next\nL2->L1 vmexit.\n\nReported-by: Qian Cai <cai@lca.pw>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "KVM: SVM: fix calls to is_intercept\n\nis_intercept takes an INTERCEPT_* constant, not SVM_EXIT_*; because\nof this, the compiler was removing the body of the conditionals,\nas if is_intercept returned 0.\n\nThis unveils a latent bug: when clearing the VINTR intercept,\nint_ctl must also be changed in the L1 VMCB (svm->nested.hsave),\njust like the intercept itself is also changed in the L1 VMCB.\nOtherwise V_IRQ remains set and, due to the VINTR intercept being clear,\nwe get a spurious injection of a vector 0 interrupt on the next\nL2->L1 vmexit.\n\nReported-by: Qian Cai <cai@lca.pw>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Paolo Bonzini",
  "author_email": "pbonzini@redhat.com",
  "author_date": "Mon Jun 8 07:11:47 2020 -0400",
  "author_date_iso": "2020-06-08T07:11:47-04:00",
  "committer_name": "Paolo Bonzini",
  "committer_email": "pbonzini@redhat.com",
  "committer_date": "Mon Jun 8 08:00:57 2020 -0400",
  "committer_date_iso": "2020-06-08T08:00:57-04:00",
  "files_changed": [
    "arch/x86/kvm/svm/nested.c",
    "arch/x86/kvm/svm/svm.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "arch/x86/kvm/svm/nested.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/x86/kvm/svm/svm.c",
      "insertions": 3,
      "deletions": 1
    }
  ],
  "total_insertions": 4,
  "total_deletions": 2,
  "total_changes": 6,
  "parents": [
    "75ad6e800217220b8ee63904fb472fd5c3819259"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/kvm/svm/nested.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/svm/svm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}