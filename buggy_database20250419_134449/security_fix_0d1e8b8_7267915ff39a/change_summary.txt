Files changed: 22
Insertions: 12456
Deletions: 3259
Total changes: 15715

File-specific changes:
Documentation/s390/vfio-ap.txt: +837 -0
Documentation/virtual/kvm/api.txt: +129 -6
MAINTAINERS: +12 -0
arch/arm/include/asm/kvm_arm.h: +1 -2
arch/arm/include/asm/kvm_host.h: +12 -1
arch/arm/include/asm/kvm_mmu.h: +10 -5
arch/arm/include/asm/stage2_pgtable.h: +32 -22
arch/arm64/include/asm/cpufeature.h: +21 -0
arch/arm64/include/asm/kvm_arm.h: +125 -30
arch/arm64/include/asm/kvm_asm.h: +1 -2
arch/arm64/include/asm/kvm_host.h: +9 -9
arch/arm64/include/asm/kvm_hyp.h: +10 -0
arch/arm64/include/asm/kvm_mmu.h: +34 -8
arch/arm64/include/asm/ptrace.h: +3 -0
arch/arm64/include/asm/stage2_pgtable-nopmd.h: +0 -42
arch/arm64/include/asm/stage2_pgtable-nopud.h: +0 -39
arch/arm64/include/asm/stage2_pgtable.h: +170 -66
arch/arm64/kvm/guest.c: +3 -3
arch/arm64/kvm/handle_exit.c: +7 -0
arch/arm64/kvm/hyp/Makefile: +0 -1
arch/arm64/kvm/hyp/hyp-entry.S: +15 -1
arch/arm64/kvm/hyp/s2-setup.c: +0 -90
arch/arm64/kvm/hyp/switch.c: +2 -2
arch/arm64/kvm/hyp/sysreg-sr.c: +18 -1
arch/arm64/kvm/hyp/tlb.c: +2 -2
arch/arm64/kvm/reset.c: +105 -3
arch/powerpc/include/asm/asm-prototypes.h: +21 -0
arch/powerpc/include/asm/book3s/64/mmu-hash.h: +12 -0
arch/powerpc/include/asm/book3s/64/tlbflush-radix.h: +1 -0
arch/powerpc/include/asm/hvcall.h: +41 -0
arch/powerpc/include/asm/iommu.h: +1 -1
arch/powerpc/include/asm/kvm_asm.h: +1 -3
arch/powerpc/include/asm/kvm_book3s.h: +40 -5
arch/powerpc/include/asm/kvm_book3s_64.h: +116 -2
arch/powerpc/include/asm/kvm_book3s_asm.h: +3 -0
arch/powerpc/include/asm/kvm_booke.h: +2 -2
arch/powerpc/include/asm/kvm_host.h: +14 -2
arch/powerpc/include/asm/kvm_ppc.h: +5 -3
arch/powerpc/include/asm/ppc-opcode.h: +1 -0
arch/powerpc/include/asm/reg.h: +2 -0
arch/powerpc/include/uapi/asm/kvm.h: +1 -0
arch/powerpc/kernel/asm-offsets.c: +3 -2
arch/powerpc/kernel/cpu_setup_power.S: +2 -2
arch/powerpc/kvm/Makefile: +2 -1
arch/powerpc/kvm/book3s.c: +36 -10
arch/powerpc/kvm/book3s_64_mmu_hv.c: +3 -4
arch/powerpc/kvm/book3s_64_mmu_radix.c: +536 -182
arch/powerpc/kvm/book3s_64_vio.c: +67 -27
arch/powerpc/kvm/book3s_64_vio_hv.c: +49 -38
arch/powerpc/kvm/book3s_emulate.c: +6 -7
arch/powerpc/kvm/book3s_hv.c: +818 -55
arch/powerpc/kvm/book3s_hv_builtin.c: +84 -8
arch/powerpc/kvm/book3s_hv_interrupts.S: +49 -46
arch/powerpc/kvm/book3s_hv_nested.c: +1291 -0
arch/powerpc/kvm/book3s_hv_ras.c: +10 -0
arch/powerpc/kvm/book3s_hv_rm_xics.c: +10 -3
arch/powerpc/kvm/book3s_hv_rmhandlers.S: +460 -363
arch/powerpc/kvm/book3s_hv_tm.c: +3 -3
arch/powerpc/kvm/book3s_hv_tm_builtin.c: +3 -2
arch/powerpc/kvm/book3s_pr.c: +2 -3
arch/powerpc/kvm/book3s_xics.c: +6 -8
arch/powerpc/kvm/book3s_xive.c: +63 -0
arch/powerpc/kvm/book3s_xive_template.c: +0 -8
arch/powerpc/kvm/bookehv_interrupts.S: +4 -4
arch/powerpc/kvm/emulate_loadstore.c: +0 -1
arch/powerpc/kvm/powerpc.c: +14 -1
arch/powerpc/kvm/tm.S: +136 -114
arch/powerpc/kvm/trace_book3s.h: +0 -1
arch/powerpc/mm/tlb-radix.c: +9 -0
arch/s390/Kconfig: +11 -0
arch/s390/include/asm/kvm_host.h: +14 -1
arch/s390/include/uapi/asm/kvm.h: +2 -0
arch/s390/kvm/kvm-s390.c: +142 -42
arch/s390/kvm/kvm-s390.h: +1 -0
arch/s390/kvm/vsie.c: +192 -18
arch/s390/mm/gmap.c: +8 -2
arch/s390/tools/gen_facilities.c: +2 -0
arch/x86/include/asm/kvm_host.h: +61 -9
arch/x86/include/asm/virtext.h: +1 -1
arch/x86/include/asm/vmx.h: +0 -13
arch/x86/include/uapi/asm/kvm.h: +6 -2
arch/x86/kvm/hyperv.c: +212 -68
arch/x86/kvm/hyperv.h: +4 -0
arch/x86/kvm/lapic.c: +38 -7
arch/x86/kvm/lapic.h: +1 -1
arch/x86/kvm/mmu.c: +235 -158
arch/x86/kvm/mmu.h: +4 -9
arch/x86/kvm/mmu_audit.c: +6 -6
arch/x86/kvm/paging_tmpl.h: +8 -7
arch/x86/kvm/svm.c: +35 -29
arch/x86/kvm/trace.h: +42 -0
arch/x86/kvm/vmx.c: +1614 -749
arch/x86/kvm/vmx_shadow_fields.h: +1 -4
arch/x86/kvm/x86.c: +194 -50
arch/x86/kvm/x86.h: +2 -0
drivers/iommu/Kconfig: +8 -0
drivers/s390/crypto/Makefile: +4 -0
drivers/s390/crypto/vfio_ap_drv.c: +157 -0
drivers/s390/crypto/vfio_ap_ops.c: +939 -0
drivers/s390/crypto/vfio_ap_private.h: +88 -0
drivers/vfio/vfio_iommu_spapr_tce.c: +21 -2
include/linux/irqchip/arm-gic-v3.h: +5 -0
include/uapi/linux/kvm.h: +24 -2
include/uapi/linux/vfio.h: +2 -0
tools/arch/x86/include/uapi/asm/kvm.h: +8 -2
tools/include/uapi/linux/kvm.h: +5 -0
tools/perf/arch/powerpc/util/book3s_hv_exits.h: +0 -1
tools/testing/selftests/kvm/.gitignore: +8 -6
tools/testing/selftests/kvm/Makefile: +26 -13
tools/testing/selftests/kvm/dirty_log_test.c: +257 -117
tools/testing/selftests/kvm/include/aarch64/processor.h: +55 -0
tools/testing/selftests/kvm/include/evmcs.h: +1098 -0
tools/testing/selftests/kvm/include/kvm_util.h: +78 -91
tools/testing/selftests/kvm/include/sparsebit.h: +3 -3
tools/testing/selftests/kvm/include/test_util.h: +3 -3
tools/testing/selftests/kvm/include/{x86.h => x86_64/processor.h}: +23 -5
tools/testing/selftests/kvm/include/{ => x86_64}/vmx.h: +32 -3
tools/testing/selftests/kvm/lib/aarch64/processor.c: +311 -0
tools/testing/selftests/kvm/lib/assert.c: +1 -1
tools/testing/selftests/kvm/lib/kvm_util.c: +184 -380
tools/testing/selftests/kvm/lib/kvm_util_internal.h: +17 -16
tools/testing/selftests/kvm/lib/ucall.c: +144 -0
tools/testing/selftests/kvm/lib/{x86.c => x86_64/processor.c}: +254 -9
tools/testing/selftests/kvm/lib/{ => x86_64}/vmx.c: +42 -13
tools/testing/selftests/kvm/{ => x86_64}/cr4_cpuid_sync_test.c: +7 -7
tools/testing/selftests/kvm/x86_64/evmcs_test.c: +160 -0
tools/testing/selftests/kvm/{ => x86_64}/platform_info_test.c: +7 -7
tools/testing/selftests/kvm/{ => x86_64}/set_sregs_test.c: +1 -1
tools/testing/selftests/kvm/{ => x86_64}/state_test.c: +25 -22
tools/testing/selftests/kvm/{ => x86_64}/sync_regs_test.c: +1 -1
tools/testing/selftests/kvm/{ => x86_64}/vmx_tsc_adjust_test.c: +12 -12
virt/kvm/arm/arm.c: +12 -14
virt/kvm/arm/mmu.c: +69 -59
virt/kvm/arm/vgic/vgic-its.c: +10 -26
virt/kvm/arm/vgic/vgic-kvm-device.c: +1 -1
virt/kvm/arm/vgic/vgic-mmio-v3.c: +0 -2
virt/kvm/coalesced_mmio.c: +9 -3
virt/kvm/kvm_main.c: +24 -15
