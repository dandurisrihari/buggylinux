{
  "hash": "9c674e1e2f9e24fa4392167efe343749008338e0",
  "hash_short": "9c674e1e",
  "subject": "crypto: aesni - handle zero length dst buffer",
  "body": "GCM can be invoked with a zero destination buffer. This is possible if\nthe AAD and the ciphertext have zero lengths and only the tag exists in\nthe source buffer (i.e. a source buffer cannot be zero). In this case,\nthe GCM cipher only performs the authentication and no decryption\noperation.\n\nWhen the destination buffer has zero length, it is possible that no page\nis mapped to the SG pointing to the destination. In this case,\nsg_page(req->dst) is an invalid access. Therefore, page accesses should\nonly be allowed if the req->dst->length is non-zero which is the\nindicator that a page must exist.\n\nThis fixes a crash that can be triggered by user space via AF_ALG.\n\nCC: <stable@vger.kernel.org>\nSigned-off-by: Stephan Mueller <smueller@chronox.de>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "crypto: aesni - handle zero length dst buffer\n\nGCM can be invoked with a zero destination buffer. This is possible if\nthe AAD and the ciphertext have zero lengths and only the tag exists in\nthe source buffer (i.e. a source buffer cannot be zero). In this case,\nthe GCM cipher only performs the authentication and no decryption\noperation.\n\nWhen the destination buffer has zero length, it is possible that no page\nis mapped to the SG pointing to the destination. In this case,\nsg_page(req->dst) is an invalid access. Therefore, page accesses should\nonly be allowed if the req->dst->length is non-zero which is the\nindicator that a page must exist.\n\nThis fixes a crash that can be triggered by user space via AF_ALG.\n\nCC: <stable@vger.kernel.org>\nSigned-off-by: Stephan Mueller <smueller@chronox.de>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Stephan Mueller",
  "author_email": "smueller@chronox.de",
  "author_date": "Thu Jan 18 20:41:09 2018 +0100",
  "author_date_iso": "2018-01-18T20:41:09+01:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Fri Jan 26 01:10:32 2018 +1100",
  "committer_date_iso": "2018-01-26T01:10:32+11:00",
  "files_changed": [
    "arch/x86/crypto/aesni-intel_glue.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/x86/crypto/aesni-intel_glue.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "980b4c95e78e4113cb7b9f430f121dab1c814b6c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.16-rc1",
    "v4.16-rc2",
    "v4.16-rc3",
    "v4.16-rc4",
    "v4.16-rc5",
    "v4.16-rc6",
    "v4.16-rc7",
    "v4.17",
    "v4.17-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/crypto/aesni-intel_glue.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}