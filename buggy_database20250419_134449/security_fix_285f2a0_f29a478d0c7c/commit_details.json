{
  "hash": "285f2a08841432fc3e498b1cd00cce5216cdf189",
  "hash_short": "285f2a08",
  "subject": "cxl/region: Avoid null pointer dereference in region lookup",
  "body": "cxl_dpa_to_region() looks up a region based on a memdev and DPA.\nIt wrongly assumes an endpoint found mapping the DPA is also of\na fully assembled region. When not true it leads to a null pointer\ndereference looking up the region name.\n\nThis appears during testing of region lookup after a failure to\nassemble a BIOS defined region or if the lookup raced with the\nassembly of the BIOS defined region.\n\nFailure to clean up BIOS defined regions that fail assembly is an\nissue in itself and a fix to that problem will alleviate some of\nthe impact. It will not alleviate the race condition so let's harden\nthis path.\n\nThe behavior change is that the kernel oops due to a null pointer\ndereference is replaced with a dev_dbg() message noting that an\nendpoint was mapped.\n\nAdditional comments are added so that future users of this function\ncan more clearly understand what it provides.\n\nFixes: 0a105ab28a4d (\"cxl/memdev: Warn of poison inject or clear to a mapped region\")\nSigned-off-by: Alison Schofield <alison.schofield@intel.com>\nReviewed-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>\nLink: https://patch.msgid.link/20240604003609.202682-1-alison.schofield@intel.com\nSigned-off-by: Dave Jiang <dave.jiang@intel.com>",
  "full_message": "cxl/region: Avoid null pointer dereference in region lookup\n\ncxl_dpa_to_region() looks up a region based on a memdev and DPA.\nIt wrongly assumes an endpoint found mapping the DPA is also of\na fully assembled region. When not true it leads to a null pointer\ndereference looking up the region name.\n\nThis appears during testing of region lookup after a failure to\nassemble a BIOS defined region or if the lookup raced with the\nassembly of the BIOS defined region.\n\nFailure to clean up BIOS defined regions that fail assembly is an\nissue in itself and a fix to that problem will alleviate some of\nthe impact. It will not alleviate the race condition so let's harden\nthis path.\n\nThe behavior change is that the kernel oops due to a null pointer\ndereference is replaced with a dev_dbg() message noting that an\nendpoint was mapped.\n\nAdditional comments are added so that future users of this function\ncan more clearly understand what it provides.\n\nFixes: 0a105ab28a4d (\"cxl/memdev: Warn of poison inject or clear to a mapped region\")\nSigned-off-by: Alison Schofield <alison.schofield@intel.com>\nReviewed-by: Jonathan Cameron <Jonathan.Cameron@huawei.com>\nLink: https://patch.msgid.link/20240604003609.202682-1-alison.schofield@intel.com\nSigned-off-by: Dave Jiang <dave.jiang@intel.com>",
  "author_name": "Alison Schofield",
  "author_email": "alison.schofield@intel.com",
  "author_date": "Mon Jun 3 17:36:09 2024 -0700",
  "author_date_iso": "2024-06-03T17:36:09-07:00",
  "committer_name": "Dave Jiang",
  "committer_email": "dave.jiang@intel.com",
  "committer_date": "Tue Jun 25 14:39:52 2024 -0700",
  "committer_date_iso": "2024-06-25T14:39:52-07:00",
  "files_changed": [
    "drivers/cxl/core/region.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/cxl/core/region.c",
      "insertions": 15,
      "deletions": 4
    }
  ],
  "total_insertions": 15,
  "total_deletions": 4,
  "total_changes": 19,
  "parents": [
    "84ec985944ef34a34a1605b93ce401aa8737af96"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/cxl/core/region.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}