Commit Hash: 78541c1dc60b65ecfce5a6a096fc260219d6784e
Subject: net: Fix ns_capable check in sock_diag_put_filterinfo


Security Keywords:
- security bug

Full commit message:
net: Fix ns_capable check in sock_diag_put_filterinfo

The caller needs capabilities on the namespace being queried, not on
their own namespace.  This is a security bug, although it likely has
only a minor impact.

Cc: stable@vger.kernel.org
Signed-off-by: Andy Lutomirski <luto@amacapital.net>
Acked-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Andrew Lutomirski <luto@amacapital.net>
Author Date: Wed Apr 16 21:41:34 2014 -0700
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Tue Apr 22 12:49:39 2014 -0400

Files Changed: 3
Lines Added: 4
Lines Removed: 4
Total Changes: 8
