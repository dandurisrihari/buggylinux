{
  "hash": "944c74f472f926785b1948efa0e73e2f1b3b539b",
  "hash_short": "944c74f4",
  "subject": "afs: Distinguish mountpoints from symlinks by file mode alone",
  "body": "In AFS, mountpoints appear as symlinks with mode 0644 and normal symlinks\nhave mode 0777, so use this to distinguish them rather than reading the\ncontent and parsing it.  In the case of a mountpoint, the symlink body is a\nformatted string indicating the location of the target volume.\n\nNote that with this, kAFS no longer 'pre-fetches' the contents of symlinks,\nso afs_readpage() may fail with an access-denial because when the VFS calls\nd_automount(), it wraps the call in an credentials override that sets the\ninitial creds - thereby preventing access to the caller's keyrings and the\nauthentication keys held therein.\n\nTo this end, a patch reverting that change to the VFS is required also.\n\nReported-by: Jeffrey Altman <jaltman@auristor.com>\nSigned-off-by: David Howells <dhowells@redhat.com>",
  "full_message": "afs: Distinguish mountpoints from symlinks by file mode alone\n\nIn AFS, mountpoints appear as symlinks with mode 0644 and normal symlinks\nhave mode 0777, so use this to distinguish them rather than reading the\ncontent and parsing it.  In the case of a mountpoint, the symlink body is a\nformatted string indicating the location of the target volume.\n\nNote that with this, kAFS no longer 'pre-fetches' the contents of symlinks,\nso afs_readpage() may fail with an access-denial because when the VFS calls\nd_automount(), it wraps the call in an credentials override that sets the\ninitial creds - thereby preventing access to the caller's keyrings and the\nauthentication keys held therein.\n\nTo this end, a patch reverting that change to the VFS is required also.\n\nReported-by: Jeffrey Altman <jaltman@auristor.com>\nSigned-off-by: David Howells <dhowells@redhat.com>",
  "author_name": "David Howells",
  "author_email": "dhowells@redhat.com",
  "author_date": "Thu Mar 16 16:27:45 2017 +0000",
  "author_date_iso": "2017-03-16T16:27:45+00:00",
  "committer_name": "David Howells",
  "committer_email": "dhowells@redhat.com",
  "committer_date": "Thu Mar 16 16:27:45 2017 +0000",
  "committer_date_iso": "2017-03-16T16:27:45+00:00",
  "files_changed": [
    "fs/afs/inode.c",
    "fs/afs/internal.h",
    "fs/afs/mntpt.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "fs/afs/inode.c",
      "insertions": 15,
      "deletions": 14
    },
    {
      "file": "fs/afs/internal.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "fs/afs/mntpt.c",
      "insertions": 0,
      "deletions": 53
    }
  ],
  "total_insertions": 15,
  "total_deletions": 68,
  "total_changes": 83,
  "parents": [
    "58fed94dfb17e89556b5705f20f90e5b2971b6a1"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.11",
    "v4.11-rc3",
    "v4.11-rc4",
    "v4.11-rc5",
    "v4.11-rc6",
    "v4.11-rc7",
    "v4.11-rc8",
    "v4.12",
    "v4.12-rc1",
    "v4.12-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/afs/inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/internal.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/mntpt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}