{
  "hash": "b2ac7541e3777f325c49d900550c9e3dd10c0eda",
  "hash_short": "b2ac7541",
  "subject": "net/mlx5e: IPsec: Add Connect-X IPsec Rx data path offload",
  "body": "On receive flow inspect received packets for IPsec offload indication\nusing the cqe, for IPsec offloaded packets propagate offload status\nand stack handle to stack for further processing.\n\nSupported statuses:\n- Offload ok.\n- Authentication failure.\n- Bad trailer indication.\n\nConnect-X IPsec does not use mlx5e_ipsec_handle_rx_cqe.\n\nFor RX only offload, we see the BW gain. Below is the iperf3\nperformance report on two server of 24 cores Intel(R) Xeon(R)\nCPU E5-2620 v3 @ 2.40GHz with ConnectX6-DX.\nWe use one thread per IPsec tunnel.\n\n---------------------------------------------------------------------\nMode          |  Num tunnel | BW     | Send CPU util | Recv CPU util\n              |             | (Gbps) | (Average %)   | (Average %)\n---------------------------------------------------------------------\nCryto offload | 1           | 4.6    | 4.2           | 14.5\n---------------------------------------------------------------------\nCryto offload | 24          | 38     | 73            | 63\n---------------------------------------------------------------------\nNon-offload   | 1           | 4      | 4             | 13\n---------------------------------------------------------------------\nNon-offload   | 24          | 23     | 52            | 67\n\nSigned-off-by: Raed Salem <raeds@mellanox.com>\nReviewed-by: Boris Pismenny <borisp@mellanox.com>\nReviewed-by: Tariq Toukan <tariqt@mellanox.com>\nSigned-off-by: Saeed Mahameed <saeedm@mellanox.com>",
  "full_message": "net/mlx5e: IPsec: Add Connect-X IPsec Rx data path offload\n\nOn receive flow inspect received packets for IPsec offload indication\nusing the cqe, for IPsec offloaded packets propagate offload status\nand stack handle to stack for further processing.\n\nSupported statuses:\n- Offload ok.\n- Authentication failure.\n- Bad trailer indication.\n\nConnect-X IPsec does not use mlx5e_ipsec_handle_rx_cqe.\n\nFor RX only offload, we see the BW gain. Below is the iperf3\nperformance report on two server of 24 cores Intel(R) Xeon(R)\nCPU E5-2620 v3 @ 2.40GHz with ConnectX6-DX.\nWe use one thread per IPsec tunnel.\n\n---------------------------------------------------------------------\nMode          |  Num tunnel | BW     | Send CPU util | Recv CPU util\n              |             | (Gbps) | (Average %)   | (Average %)\n---------------------------------------------------------------------\nCryto offload | 1           | 4.6    | 4.2           | 14.5\n---------------------------------------------------------------------\nCryto offload | 24          | 38     | 73            | 63\n---------------------------------------------------------------------\nNon-offload   | 1           | 4      | 4             | 13\n---------------------------------------------------------------------\nNon-offload   | 24          | 23     | 52            | 67\n\nSigned-off-by: Raed Salem <raeds@mellanox.com>\nReviewed-by: Boris Pismenny <borisp@mellanox.com>\nReviewed-by: Tariq Toukan <tariqt@mellanox.com>\nSigned-off-by: Saeed Mahameed <saeedm@mellanox.com>",
  "author_name": "Raed Salem",
  "author_email": "raeds@mellanox.com",
  "author_date": "Thu Oct 24 16:11:28 2019 +0300",
  "author_date_iso": "2019-10-24T16:11:28+03:00",
  "committer_name": "Saeed Mahameed",
  "committer_email": "saeedm@mellanox.com",
  "committer_date": "Thu Jul 16 16:36:49 2020 -0700",
  "committer_date_iso": "2020-07-16T16:36:49-07:00",
  "files_changed": [
    "drivers/net/ethernet/mellanox/mlx5/core/en_accel/ipsec_rxtx.c",
    "drivers/net/ethernet/mellanox/mlx5/core/en_accel/ipsec_rxtx.h",
    "drivers/net/ethernet/mellanox/mlx5/core/en_main.c",
    "drivers/net/ethernet/mellanox/mlx5/core/en_rx.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_accel/ipsec_rxtx.c",
      "insertions": 56,
      "deletions": 0
    },
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_accel/ipsec_rxtx.h",
      "insertions": 20,
      "deletions": 2
    },
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_main.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_rx.c",
      "insertions": 9,
      "deletions": 1
    }
  ],
  "total_insertions": 88,
  "total_deletions": 4,
  "total_changes": 92,
  "parents": [
    "5e466345291a91d1722e7198497198becda29e22"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_accel/ipsec_rxtx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_accel/ipsec_rxtx.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_main.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mellanox/mlx5/core/en_rx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}