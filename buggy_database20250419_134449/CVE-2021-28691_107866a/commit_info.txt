Commit Hash: 107866a8eb0b664675a260f1ba0655010fac1e08
Subject: xen-netback: take a reference to the RX task thread

CVE Identifiers:
- CVE-2021-28691

Full commit message:
xen-netback: take a reference to the RX task thread

Do this in order to prevent the task from being freed if the thread
returns (which can be triggered by the frontend) before the call to
kthread_stop done as part of the backend tear down. Not taking the
reference will lead to a use-after-free in that scenario. Such
reference was taken before but dropped as part of the rework done in
2ac061ce97f4.

Reintroduce the reference taking and add a comment this time
explaining why it's needed.

This is XSA-374 / CVE-2021-28691.

Fixes: 2ac061ce97f4 ('xen/netback: cleanup init and deinit code')
Signed-off-by: Roger Pau Monn√© <roger.pau@citrix.com>
Cc: stable@vger.kernel.org
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Reviewed-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Juergen Gross <jgross@suse.com>

Metadata:
Author: Roger Pau Monne <roger.pau@citrix.com>
Author Date: Mon Jun 7 15:13:15 2021 +0200
Committer: Juergen Gross <jgross@suse.com>
Commit Date: Mon Jun 7 15:13:15 2021 +0200

Files Changed: 1
Lines Added: 6
Lines Removed: 0
Total Changes: 6
