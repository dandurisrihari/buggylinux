{
  "hash": "1cbe06c3cf542d48eb22180163e00f91760ef8cd",
  "hash_short": "1cbe06c3",
  "subject": "Merge tag 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dledford/rdma",
  "body": "Pull more rdma updates from Doug Ledford:\n \"This is the second group of code for the 4.7 merge window.  It looks\n  large, but only in one sense.  I'll get to that in a minute.  The list\n  of changes here breaks down as follows:\n\n   - Dynamic counter infrastructure in the IB drivers\n\n     This is a sysfs based code to allow free form access to the\n     hardware counters RDMA devices might support so drivers don't need\n     to code this up repeatedly themselves\n\n   - SendOnlyFullMember multicast support\n\n   - IB router support\n\n   - A couple misc fixes\n\n   - The big item on the list: hfi1 driver updates, plus moving the hfi1\n     driver out of staging\n\n  There was a group of 15 patches in the hfi1 list that I thought I had\n  in the first pull request but they weren't.  So that added to the\n  length of the hfi1 section here.\n\n  As far as these go, everything but the hfi1 is pretty straight\n  forward.\n\n  The hfi1 is, if you recall, the driver that Al had complaints about\n  how it used the write/writev interfaces in an overloaded fashion.  The\n  write portion of their interface behaved like the write handler in the\n  IB stack proper and did bi-directional communications.  The writev\n  interface, on the other hand, only accepts SDMA request structures.\n  The completions for those structures are sent back via an entirely\n  different event mechanism.\n\n  With the security patch, we put security checks on the write\n  interface, however, we also knew they would be going away soon.  Now,\n  we've converted the write handler in the hfi1 driver to use ioctls\n  from the IB reserved magic area for its bidirectional communications.\n  With that change, Intel has addressed all of the items originally on\n  their TODO when they went into staging (as well as many items added to\n  the list later).\n\n  As such, I moved them out, and since they were the last item in the\n  staging/rdma directory, and I don't have immediate plans to use the\n  staging area again, I removed the staging/rdma area.\n\n  Because of the move out of staging, as well as a series of 5 patches\n  in the hfi1 driver that removed code people thought should be done in\n  a different way and was optional to begin with (a snoop debug\n  interface, an eeprom driver for an eeprom connected directory to their\n  hfi1 chip and not via an i2c bus, and a few other things like that),\n  the line count, especially the removal count, is high\"\n\n* tag 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dledford/rdma: (56 commits)\n  staging/rdma: Remove the entire rdma subdirectory of staging\n  IB/core: Make device counter infrastructure dynamic\n  IB/hfi1: Fix pio map initialization\n  IB/hfi1: Correct 8051 link parameter settings\n  IB/hfi1: Update pkey table properly after link down or FM start\n  IB/rdamvt: Fix rdmavt s_ack_queue sizing\n  IB/rdmavt: Max atomic value should be a u8\n  IB/hfi1: Fix hard lockup due to not using save/restore spin lock\n  IB/hfi1: Add tracing support for send with invalidate opcode\n  IB/hfi1, qib: Add ieth to the packet header definitions\n  IB/hfi1: Move driver out of staging\n  IB/hfi1: Do not free hfi1 cdev parent structure early\n  IB/hfi1: Add trace message in user IOCTL handling\n  IB/hfi1: Remove write(), use ioctl() for user cmds\n  IB/hfi1: Add ioctl() interface for user commands\n  IB/hfi1: Remove unused user command\n  IB/hfi1: Remove snoop/diag interface\n  IB/hfi1: Remove EPROM functionality from data device\n  IB/hfi1: Remove UI char device\n  IB/hfi1: Remove multiple device cdev\n  ...",
  "full_message": "Merge tag 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dledford/rdma\n\nPull more rdma updates from Doug Ledford:\n \"This is the second group of code for the 4.7 merge window.  It looks\n  large, but only in one sense.  I'll get to that in a minute.  The list\n  of changes here breaks down as follows:\n\n   - Dynamic counter infrastructure in the IB drivers\n\n     This is a sysfs based code to allow free form access to the\n     hardware counters RDMA devices might support so drivers don't need\n     to code this up repeatedly themselves\n\n   - SendOnlyFullMember multicast support\n\n   - IB router support\n\n   - A couple misc fixes\n\n   - The big item on the list: hfi1 driver updates, plus moving the hfi1\n     driver out of staging\n\n  There was a group of 15 patches in the hfi1 list that I thought I had\n  in the first pull request but they weren't.  So that added to the\n  length of the hfi1 section here.\n\n  As far as these go, everything but the hfi1 is pretty straight\n  forward.\n\n  The hfi1 is, if you recall, the driver that Al had complaints about\n  how it used the write/writev interfaces in an overloaded fashion.  The\n  write portion of their interface behaved like the write handler in the\n  IB stack proper and did bi-directional communications.  The writev\n  interface, on the other hand, only accepts SDMA request structures.\n  The completions for those structures are sent back via an entirely\n  different event mechanism.\n\n  With the security patch, we put security checks on the write\n  interface, however, we also knew they would be going away soon.  Now,\n  we've converted the write handler in the hfi1 driver to use ioctls\n  from the IB reserved magic area for its bidirectional communications.\n  With that change, Intel has addressed all of the items originally on\n  their TODO when they went into staging (as well as many items added to\n  the list later).\n\n  As such, I moved them out, and since they were the last item in the\n  staging/rdma directory, and I don't have immediate plans to use the\n  staging area again, I removed the staging/rdma area.\n\n  Because of the move out of staging, as well as a series of 5 patches\n  in the hfi1 driver that removed code people thought should be done in\n  a different way and was optional to begin with (a snoop debug\n  interface, an eeprom driver for an eeprom connected directory to their\n  hfi1 chip and not via an i2c bus, and a few other things like that),\n  the line count, especially the removal count, is high\"\n\n* tag 'for-linus' of git://git.kernel.org/pub/scm/linux/kernel/git/dledford/rdma: (56 commits)\n  staging/rdma: Remove the entire rdma subdirectory of staging\n  IB/core: Make device counter infrastructure dynamic\n  IB/hfi1: Fix pio map initialization\n  IB/hfi1: Correct 8051 link parameter settings\n  IB/hfi1: Update pkey table properly after link down or FM start\n  IB/rdamvt: Fix rdmavt s_ack_queue sizing\n  IB/rdmavt: Max atomic value should be a u8\n  IB/hfi1: Fix hard lockup due to not using save/restore spin lock\n  IB/hfi1: Add tracing support for send with invalidate opcode\n  IB/hfi1, qib: Add ieth to the packet header definitions\n  IB/hfi1: Move driver out of staging\n  IB/hfi1: Do not free hfi1 cdev parent structure early\n  IB/hfi1: Add trace message in user IOCTL handling\n  IB/hfi1: Remove write(), use ioctl() for user cmds\n  IB/hfi1: Add ioctl() interface for user commands\n  IB/hfi1: Remove unused user command\n  IB/hfi1: Remove snoop/diag interface\n  IB/hfi1: Remove EPROM functionality from data device\n  IB/hfi1: Remove UI char device\n  IB/hfi1: Remove multiple device cdev\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Sat May 28 11:04:16 2016 -0700",
  "author_date_iso": "2016-05-28T11:04:16-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Sat May 28 11:04:16 2016 -0700",
  "committer_date_iso": "2016-05-28T11:04:16-07:00",
  "files_changed": [
    "MAINTAINERS",
    "drivers/infiniband/ulp/ipoib/ipoib_ib.c",
    "drivers/infiniband/ulp/ipoib/ipoib_main.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "Documentation/infiniband/sysfs.txt",
      "insertions": 12,
      "deletions": 0
    },
    {
      "file": "MAINTAINERS",
      "insertions": 7,
      "deletions": 7
    },
    {
      "file": "drivers/infiniband/Kconfig",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/core/Makefile",
      "insertions": 3,
      "deletions": 9
    },
    {
      "file": "drivers/infiniband/core/addr.c",
      "insertions": 194,
      "deletions": 32
    },
    {
      "file": "drivers/infiniband/core/core_priv.h",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/core/device.c",
      "insertions": 58,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/core/mad.c",
      "insertions": 3,
      "deletions": 10
    },
    {
      "file": "drivers/infiniband/core/multicast.c",
      "insertions": 18,
      "deletions": 5
    },
    {
      "file": "drivers/infiniband/core/sa_query.c",
      "insertions": 180,
      "deletions": 31
    },
    {
      "file": "drivers/infiniband/core/sysfs.c",
      "insertions": 242,
      "deletions": 124
    },
    {
      "file": "drivers/infiniband/hw/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/cxgb3/cxio_hal.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/infiniband/hw/cxgb3/iwch_provider.c",
      "insertions": 104,
      "deletions": 43
    },
    {
      "file": "drivers/infiniband/hw/cxgb4/provider.c",
      "insertions": 49,
      "deletions": 9
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/Kconfig",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/affinity.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/affinity.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/aspm.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/chip.c",
      "insertions": 30,
      "deletions": 11
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/chip.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/chip_registers.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/common.h",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/debugfs.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/debugfs.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/device.c",
      "insertions": 10,
      "deletions": 8
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/device.h",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/dma.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/driver.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/efivar.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/efivar.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/hfi1/eprom.c",
      "insertions": 102,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/eprom.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/file_ops.c",
      "insertions": 137,
      "deletions": 412
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/firmware.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/hfi.h",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/init.c",
      "insertions": 17,
      "deletions": 5
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/intr.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/iowait.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/mad.c",
      "insertions": 66,
      "deletions": 33
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/mad.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/mmu_rb.c",
      "insertions": 11,
      "deletions": 11
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/mmu_rb.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/opa_compat.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/pcie.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/pio.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/pio.h",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/pio_copy.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/platform.c",
      "insertions": 17,
      "deletions": 10
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/platform.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/qp.c",
      "insertions": 3,
      "deletions": 6
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/qp.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/qsfp.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/qsfp.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/rc.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/ruc.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/sdma.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/sdma.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/sdma_txreq.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/sysfs.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/trace.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/trace.h",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/twsi.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/twsi.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/uc.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/ud.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/user_exp_rcv.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/user_exp_rcv.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/user_pages.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/user_sdma.c",
      "insertions": 10,
      "deletions": 8
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/user_sdma.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/verbs.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/verbs.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/verbs_txreq.c",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/{staging/rdma => infiniband/hw}/hfi1/verbs_txreq.h",
      "insertions": 0,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/i40iw/i40iw_verbs.c",
      "insertions": 109,
      "deletions": 36
    },
    {
      "file": "drivers/infiniband/hw/qib/qib_iba7322.c",
      "insertions": 0,
      "deletions": 15
    },
    {
      "file": "drivers/infiniband/hw/qib/qib_mad.c",
      "insertions": 4,
      "deletions": 2
    },
    {
      "file": "drivers/infiniband/hw/qib/qib_verbs.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/sw/rdmavt/cq.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/sw/rdmavt/mr.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/infiniband/sw/rdmavt/qp.c",
      "insertions": 24,
      "deletions": 6
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib.h",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_ib.c",
      "insertions": 107,
      "deletions": 2
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_main.c",
      "insertions": 140,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_multicast.c",
      "insertions": 31,
      "deletions": 17
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_verbs.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_vlan.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/ulp/srpt/ib_srpt.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/staging/Kconfig",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "drivers/staging/Makefile",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/staging/rdma/Kconfig",
      "insertions": 0,
      "deletions": 27
    },
    {
      "file": "drivers/staging/rdma/Makefile",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "drivers/staging/rdma/hfi1/TODO",
      "insertions": 0,
      "deletions": 6
    },
    {
      "file": "drivers/staging/rdma/hfi1/diag.c",
      "insertions": 0,
      "deletions": 1925
    },
    {
      "file": "drivers/staging/rdma/hfi1/eprom.c",
      "insertions": 0,
      "deletions": 471
    },
    {
      "file": "include/rdma/ib_mad.h",
      "insertions": 58,
      "deletions": 2
    },
    {
      "file": "include/rdma/ib_pack.h",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "include/rdma/ib_sa.h",
      "insertions": 12,
      "deletions": 0
    },
    {
      "file": "include/rdma/ib_verbs.h",
      "insertions": 74,
      "deletions": 52
    },
    {
      "file": "include/rdma/rdma_vt.h",
      "insertions": 11,
      "deletions": 2
    },
    {
      "file": "include/rdma/rdmavt_qp.h",
      "insertions": 1,
      "deletions": 4
    },
    {
      "file": "include/uapi/rdma/hfi/hfi1_user.h",
      "insertions": 48,
      "deletions": 32
    },
    {
      "file": "include/uapi/rdma/rdma_netlink.h",
      "insertions": 10,
      "deletions": 0
    }
  ],
  "total_insertions": 1986,
  "total_deletions": 3400,
  "total_changes": 5386,
  "parents": [
    "ed2608faa0f701b1dbc65277a9e5c7ff7118bfd4",
    "7a226f9c32b0481b0744e2726cd7f8349b866af5"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security patch"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "MAINTAINERS",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_ib.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/ulp/ipoib/ipoib_main.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}