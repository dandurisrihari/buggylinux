Commit Hash: 218a2680624cba1611e3dfc7d9b646d240e5f855
Subject: certs: Reference revocation list for all keyrings


Security Keywords:
- vulnerability

Full commit message:
certs: Reference revocation list for all keyrings

Systems booted with shim have a Forbidden Signature Database called mokx.
During boot, hashes and certs contained within the mokx are loaded into the
blacklist keyring.  When calling verify_pkcs7_message_sig the contents of
the blacklist keyring (or revocation list) are referenced when validating
keys on the platform keyring. Currently, when validating against the
secondary or builtin keyrings, the revocation list is not referenced.  Move
up the check to allow the revocation list to be used with all keyrings,
including the secondary and builtin, allowing the system owner to take
corrective action should a vulnerability be found within keys contained
within either keyring.

Signed-off-by: Eric Snowberg <eric.snowberg@oracle.com>
Reviewed-by: Mimi Zohar <zohar@linux.ibm.com>
Reviewed-by: Jarkko Sakkinen <jarkko@kernel.org>
Signed-off-by: Jarkko Sakkinen <jarkko@kernel.org>

Metadata:
Author: Eric Snowberg <eric.snowberg@oracle.com>
Author Date: Thu Aug 17 10:04:07 2023 -0400
Committer: Jarkko Sakkinen <jarkko@kernel.org>
Commit Date: Thu Aug 17 20:12:41 2023 +0000

Files Changed: 1
Lines Added: 6
Lines Removed: 6
Total Changes: 12
