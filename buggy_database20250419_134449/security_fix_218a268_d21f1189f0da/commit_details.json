{
  "hash": "218a2680624cba1611e3dfc7d9b646d240e5f855",
  "hash_short": "218a2680",
  "subject": "certs: Reference revocation list for all keyrings",
  "body": "Systems booted with shim have a Forbidden Signature Database called mokx.\nDuring boot, hashes and certs contained within the mokx are loaded into the\nblacklist keyring.  When calling verify_pkcs7_message_sig the contents of\nthe blacklist keyring (or revocation list) are referenced when validating\nkeys on the platform keyring. Currently, when validating against the\nsecondary or builtin keyrings, the revocation list is not referenced.  Move\nup the check to allow the revocation list to be used with all keyrings,\nincluding the secondary and builtin, allowing the system owner to take\ncorrective action should a vulnerability be found within keys contained\nwithin either keyring.\n\nSigned-off-by: Eric Snowberg <eric.snowberg@oracle.com>\nReviewed-by: Mimi Zohar <zohar@linux.ibm.com>\nReviewed-by: Jarkko Sakkinen <jarkko@kernel.org>\nSigned-off-by: Jarkko Sakkinen <jarkko@kernel.org>",
  "full_message": "certs: Reference revocation list for all keyrings\n\nSystems booted with shim have a Forbidden Signature Database called mokx.\nDuring boot, hashes and certs contained within the mokx are loaded into the\nblacklist keyring.  When calling verify_pkcs7_message_sig the contents of\nthe blacklist keyring (or revocation list) are referenced when validating\nkeys on the platform keyring. Currently, when validating against the\nsecondary or builtin keyrings, the revocation list is not referenced.  Move\nup the check to allow the revocation list to be used with all keyrings,\nincluding the secondary and builtin, allowing the system owner to take\ncorrective action should a vulnerability be found within keys contained\nwithin either keyring.\n\nSigned-off-by: Eric Snowberg <eric.snowberg@oracle.com>\nReviewed-by: Mimi Zohar <zohar@linux.ibm.com>\nReviewed-by: Jarkko Sakkinen <jarkko@kernel.org>\nSigned-off-by: Jarkko Sakkinen <jarkko@kernel.org>",
  "author_name": "Eric Snowberg",
  "author_email": "eric.snowberg@oracle.com",
  "author_date": "Thu Aug 17 10:04:07 2023 -0400",
  "author_date_iso": "2023-08-17T10:04:07-04:00",
  "committer_name": "Jarkko Sakkinen",
  "committer_email": "jarkko@kernel.org",
  "committer_date": "Thu Aug 17 20:12:41 2023 +0000",
  "committer_date_iso": "2023-08-17T20:12:41+00:00",
  "files_changed": [
    "certs/system_keyring.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "certs/system_keyring.c",
      "insertions": 6,
      "deletions": 6
    }
  ],
  "total_insertions": 6,
  "total_deletions": 6,
  "total_changes": 12,
  "parents": [
    "2ccf8c76b4fb38deb25af3830aa9489b6a374621"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "certs/system_keyring.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}