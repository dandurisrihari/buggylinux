Commit Hash: 7d2cc63eca0c993c99d18893214abf8f85d566d8
Subject: bpf: Take return from set_memory_ro() into account with bpf_prog_lock_ro()


Security Keywords:
- hardening

Full commit message:
bpf: Take return from set_memory_ro() into account with bpf_prog_lock_ro()

set_memory_ro() can fail, leaving memory unprotected.

Check its return and take it into account as an error.

Link: https://github.com/KSPP/linux/issues/7
Signed-off-by: Christophe Leroy <christophe.leroy@csgroup.eu>
Cc: linux-hardening@vger.kernel.org <linux-hardening@vger.kernel.org>
Reviewed-by: Kees Cook <keescook@chromium.org>
Message-ID: <286def78955e04382b227cb3e4b6ba272a7442e3.1709850515.git.christophe.leroy@csgroup.eu>
Signed-off-by: Alexei Starovoitov <ast@kernel.org>

Metadata:
Author: Christophe Leroy <christophe.leroy@csgroup.eu>
Author Date: Fri Mar 8 06:38:07 2024 +0100
Committer: Alexei Starovoitov <ast@kernel.org>
Commit Date: Thu Mar 14 19:28:52 2024 -0700

Files Changed: 3
Lines Added: 12
Lines Removed: 5
Total Changes: 17
