{
  "hash": "f86286569e92a260fbf8a1975f9421b4a66581d8",
  "hash_short": "f8628656",
  "subject": "Merge tag 'drm-intel-gt-next-2023-04-06' of git://anongit.freedesktop.org/drm/drm-intel into drm-next",
  "body": "UAPI Changes:\n\n- (Build-time only, should not have any impact)\n  drm/i915/uapi: Replace fake flex-array with flexible-array member\n\n  \"Zero-length arrays as fake flexible arrays are deprecated and we are\n  moving towards adopting C99 flexible-array members instead.\"\n\n  This is on core kernel request moving towards GCC 13.\n\nDriver Changes:\n\n- Fix context runtime accounting on sysfs fdinfo for heavy workloads (Tvrtko)\n- Add support for OA media units on MTL (Umesh)\n- Add new workarounds for Meteorlake (Daniele, Radhakrishna, Haridhar)\n- Fix sysfs to read actual frequency for MTL and Gen6 and earlier\n  (Ashutosh)\n- Synchronize i915/BIOS on C6 enabling on MTL (Vinay)\n- Fix DMAR error noise due to GPU error capture (Andrej)\n- Fix forcewake during BAR resize on discrete (Andrzej)\n- Flush lmem contents after construction on discrete (Chris)\n- Fix GuC loading timeout on systems where IFWI programs low boot\n  frequency (John)\n- Fix race condition UAF in i915_perf_add_config_ioctl (Min)\n\n- Sanitycheck MMIO access early in driver load and during forcewake\n  (Matt)\n- Wakeref fixes for GuC RC error scenario and active VM tracking (Chris)\n- Cancel HuC delayed load timer on reset (Daniele)\n- Limit double GT reset to pre-MTL (Daniele)\n- Use i915 instead of dev_priv insied the file_priv structure (Andi)\n- Improve GuC load error reporting (John)\n- Simplify VCS/BSD engine selection logic (Tvrtko)\n- Perform uc late init after probe error injection (Andrzej)\n- Fix format for perf_limit_reasons in debugfs (Vinay)\n- Create per-gt debugfs files (Andi)\n\n- Documentation and kerneldoc fixes (Nirmoy, Lee)\n- Selftest improvements (Fei, Jonathan)\n\nSigned-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>\nFrom: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/ZC6APj/feB+jBf2d@jlahtine-mobl.ger.corp.intel.com",
  "full_message": "Merge tag 'drm-intel-gt-next-2023-04-06' of git://anongit.freedesktop.org/drm/drm-intel into drm-next\n\nUAPI Changes:\n\n- (Build-time only, should not have any impact)\n  drm/i915/uapi: Replace fake flex-array with flexible-array member\n\n  \"Zero-length arrays as fake flexible arrays are deprecated and we are\n  moving towards adopting C99 flexible-array members instead.\"\n\n  This is on core kernel request moving towards GCC 13.\n\nDriver Changes:\n\n- Fix context runtime accounting on sysfs fdinfo for heavy workloads (Tvrtko)\n- Add support for OA media units on MTL (Umesh)\n- Add new workarounds for Meteorlake (Daniele, Radhakrishna, Haridhar)\n- Fix sysfs to read actual frequency for MTL and Gen6 and earlier\n  (Ashutosh)\n- Synchronize i915/BIOS on C6 enabling on MTL (Vinay)\n- Fix DMAR error noise due to GPU error capture (Andrej)\n- Fix forcewake during BAR resize on discrete (Andrzej)\n- Flush lmem contents after construction on discrete (Chris)\n- Fix GuC loading timeout on systems where IFWI programs low boot\n  frequency (John)\n- Fix race condition UAF in i915_perf_add_config_ioctl (Min)\n\n- Sanitycheck MMIO access early in driver load and during forcewake\n  (Matt)\n- Wakeref fixes for GuC RC error scenario and active VM tracking (Chris)\n- Cancel HuC delayed load timer on reset (Daniele)\n- Limit double GT reset to pre-MTL (Daniele)\n- Use i915 instead of dev_priv insied the file_priv structure (Andi)\n- Improve GuC load error reporting (John)\n- Simplify VCS/BSD engine selection logic (Tvrtko)\n- Perform uc late init after probe error injection (Andrzej)\n- Fix format for perf_limit_reasons in debugfs (Vinay)\n- Create per-gt debugfs files (Andi)\n\n- Documentation and kerneldoc fixes (Nirmoy, Lee)\n- Selftest improvements (Fei, Jonathan)\n\nSigned-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>\nFrom: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/ZC6APj/feB+jBf2d@jlahtine-mobl.ger.corp.intel.com",
  "author_name": "Daniel Vetter",
  "author_email": "daniel.vetter@ffwll.ch",
  "author_date": "Thu Apr 6 14:21:00 2023 +0200",
  "author_date_iso": "2023-04-06T14:21:00+02:00",
  "committer_name": "Daniel Vetter",
  "committer_email": "daniel.vetter@ffwll.ch",
  "committer_date": "Thu Apr 6 14:21:00 2023 +0200",
  "committer_date_iso": "2023-04-06T14:21:00+02:00",
  "files_changed": [
    "drivers/gpu/drm/i915/gem/i915_gem_create.c",
    "drivers/gpu/drm/i915/gem/i915_gem_domain.c",
    "drivers/gpu/drm/i915/gem/i915_gem_ttm.c",
    "drivers/gpu/drm/i915/gem/i915_gem_ttm_move.c",
    "drivers/gpu/drm/i915/gem/i915_gem_ttm_pm.c",
    "drivers/gpu/drm/i915/gt/intel_execlists_submission.c",
    "drivers/gpu/drm/i915/gt/intel_ggtt.c",
    "drivers/gpu/drm/i915/gt/intel_ggtt_gmch.c",
    "drivers/gpu/drm/i915/gt/intel_gt_regs.h",
    "drivers/gpu/drm/i915/gt/intel_rc6.c",
    "drivers/gpu/drm/i915/gt/intel_region_lmem.c",
    "drivers/gpu/drm/i915/gt/intel_rps.c",
    "drivers/gpu/drm/i915/gt/intel_rps.h",
    "drivers/gpu/drm/i915/gt/intel_workarounds.c",
    "drivers/gpu/drm/i915/i915_debugfs.c",
    "drivers/gpu/drm/i915/i915_driver.c",
    "drivers/gpu/drm/i915/i915_drv.h",
    "drivers/gpu/drm/i915/i915_pci.c",
    "drivers/gpu/drm/i915/i915_pmu.c",
    "drivers/gpu/drm/i915/i915_reg.h",
    "drivers/gpu/drm/i915/i915_scatterlist.c",
    "drivers/gpu/drm/i915/i915_vma.c",
    "drivers/gpu/drm/i915/intel_device_info.h",
    "drivers/gpu/drm/i915/intel_uncore.c"
  ],
  "files_changed_count": 24,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_context.c",
      "insertions": 11,
      "deletions": 11
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_create.c",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_domain.c",
      "insertions": 9,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_execbuffer.c",
      "insertions": 3,
      "deletions": 7
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_lmem.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_object.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_ttm.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_ttm_move.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_ttm_pm.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_wait.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_context.h",
      "insertions": 11,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_engine_cs.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_engine_pm.c",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_engine_types.h",
      "insertions": 10,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_execlists_submission.c",
      "insertions": 10,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_ggtt.c",
      "insertions": 39,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_ggtt_gmch.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_gt_debugfs.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_gt_regs.h",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_gtt.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rc6.c",
      "insertions": 27,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rc6.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rc6_types.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_region_lmem.c",
      "insertions": 18,
      "deletions": 7
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_reset.c",
      "insertions": 99,
      "deletions": 20
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rps.c",
      "insertions": 22,
      "deletions": 18
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rps.h",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_sseu.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_workarounds.c",
      "insertions": 19,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/selftest_timeline.c",
      "insertions": 11,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/abi/guc_errors_abi.h",
      "insertions": 17,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_gsc_fw.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.c",
      "insertions": 121,
      "deletions": 20
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_hwconfig.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_log.c",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_reg.h",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc.c",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc.h",
      "insertions": 1,
      "deletions": 6
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_uc_debugfs.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/i915_debugfs.c",
      "insertions": 32,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/i915/i915_driver.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_drm_client.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_drv.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/i915_file_private.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem.c",
      "insertions": 5,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/i915/i915_getparam.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_pci.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/i915_perf.c",
      "insertions": 455,
      "deletions": 115
    },
    {
      "file": "drivers/gpu/drm/i915/i915_perf.h",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/i915_perf_oa_regs.h",
      "insertions": 78,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/i915_perf_types.h",
      "insertions": 71,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/i915/i915_pmu.c",
      "insertions": 4,
      "deletions": 6
    },
    {
      "file": "drivers/gpu/drm/i915/i915_reg.h",
      "insertions": 12,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/i915_scatterlist.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_vma.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/intel_device_info.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/intel_region_ttm.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/intel_uncore.c",
      "insertions": 44,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/selftests/i915_gem_gtt.c",
      "insertions": 0,
      "deletions": 356
    },
    {
      "file": "include/uapi/drm/i915_drm.h",
      "insertions": 24,
      "deletions": 1
    }
  ],
  "total_insertions": 1238,
  "total_deletions": 634,
  "total_changes": 1872,
  "parents": [
    "1138398d71e8e583669fcec96784471332e488d4",
    "4b51210f98c2b89ce37aede5b8dc5105be0572c6"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_domain.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_ttm_move.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_create.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_ttm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gem/i915_gem_ttm_pm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_ggtt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_ggtt_gmch.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rc6.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_execlists_submission.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_region_lmem.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_gt_regs.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rps.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_workarounds.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/intel_rps.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_pci.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_drv.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_debugfs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_driver.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_scatterlist.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_pmu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_reg.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_uncore.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_vma.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_device_info.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}