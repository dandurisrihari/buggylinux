Commit Hash: fff3490f47810e2d34b91fb9e31103e923b11c2f
Subject: Bluetooth: Fix setting correct authentication information for SMP STK


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix setting correct authentication information for SMP STK

When we store the STK in slave role we should set the correct
authentication information for it. If the pairing is producing a HIGH
security level the STK is considered authenticated, and otherwise it's
considered unauthenticated. This patch fixes the value passed to the
hci_add_ltk() function when adding the STK on the slave side.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Tested-by: Marcin Kraglak <marcin.kraglak@tieto.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
Cc: stable@vger.kernel.org

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Tue Jun 10 15:19:50 2014 +0300
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Fri Jun 13 13:30:48 2014 +0200

Files Changed: 1
Lines Added: 7
Lines Removed: 2
Total Changes: 9
