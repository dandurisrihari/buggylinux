Commit Hash: 392bef709659abea614abfe53cf228e7a59876a4
Subject: x86/build: Move _etext to actual end of .text


Security Keywords:
- injection

Full commit message:
x86/build: Move _etext to actual end of .text

When building x86 with Clang LTO and CFI, CFI jump regions are
automatically added to the end of the .text section late in linking. As a
result, the _etext position was being labelled before the appended jump
regions, causing confusion about where the boundaries of the executable
region actually are in the running kernel, and broke at least the fault
injection code. This moves the _etext mark to outside (and immediately
after) the .text area, as it already the case on other architectures
(e.g. arm64, arm).

Reported-and-tested-by: Sami Tolvanen <samitolvanen@google.com>
Signed-off-by: Kees Cook <keescook@chromium.org>
Cc: Borislav Petkov <bp@suse.de>
Cc: Linus Torvalds <torvalds@linux-foundation.org>
Cc: Peter Zijlstra <peterz@infradead.org>
Cc: Thomas Gleixner <tglx@linutronix.de>
Link: http://lkml.kernel.org/r/20190423183827.GA4012@beast
Signed-off-by: Ingo Molnar <mingo@kernel.org>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Tue Apr 23 11:38:27 2019 -0700
Committer: Ingo Molnar <mingo@kernel.org>
Commit Date: Wed Apr 24 12:27:47 2019 +0200

Files Changed: 1
Lines Added: 3
Lines Removed: 3
Total Changes: 6
