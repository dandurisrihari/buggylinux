Commit Hash: 68c4a4f8abc60c9440ede9cd123d48b78325f7a3
Subject: pstore: Honor dmesg_restrict sysctl on dmesg dumps


Security Keywords:
- exploit

Full commit message:
pstore: Honor dmesg_restrict sysctl on dmesg dumps

When the kernel.dmesg_restrict restriction is in place, only users with
CAP_SYSLOG should be able to access crash dumps (like: attacker is
trying to exploit a bug, watchdog reboots, attacker can happily read
crash dumps and logs).

This puts the restriction on console-* types as well as sensitive
information could have been leaked there.

Other log types are unaffected.

Signed-off-by: Sebastian Schmidt <yath@yath.de>
Acked-by: Kees Cook <keescook@chromium.org>
Signed-off-by: Tony Luck <tony.luck@intel.com>

Metadata:
Author: Sebastian Schmidt <yath@yath.de>
Author Date: Sun Oct 19 20:05:15 2014 +0200
Committer: Tony Luck <tony.luck@intel.com>
Commit Date: Wed Nov 5 09:59:48 2014 -0800

Files Changed: 3
Lines Added: 24
Lines Removed: 1
Total Changes: 25
