{
  "hash": "6cb6982f42cbfaf5e50af1069451a8828231ffb9",
  "hash_short": "6cb6982f",
  "subject": "lkdtm: arm64: test kernel pointer authentication",
  "body": "This test is specific for arm64. When in-kernel Pointer Authentication\nconfig is enabled, the return address stored in the stack is signed.\nThis feature helps in ROP kind of attack. If any parameters used to\ngenerate the pac (<key, sp, lr>) is modified then this will fail in\nthe authentication stage and will lead to abort.\n\nThis test changes the input parameter APIA kernel keys to cause abort.\nThe pac computed from the new key can be same as last due to hash\ncollision so this is retried for few times as there is no reliable way\nto compare the pacs. Even though this test may fail even after retries\nbut this may cause authentication failure at a later stage in earlier\nfunction returns.\n\nThis test can be invoked as,\necho CORRUPT_PAC > /sys/kernel/debug/provoke-crash/DIRECT\n\nor as below if inserted as a module,\ninsmod lkdtm.ko cpoint_name=DIRECT cpoint_type=CORRUPT_PAC cpoint_count=1\n\n[   13.118166] lkdtm: Performing direct entry CORRUPT_PAC\n[   13.118298] lkdtm: Clearing PAC from the return address\n[   13.118466] Unable to handle kernel paging request at virtual address bfff8000108648ec\n[   13.118626] Mem abort info:\n[   13.118666]   ESR = 0x86000004\n[   13.118866]   EC = 0x21: IABT (current EL), IL = 32 bits\n[   13.118966]   SET = 0, FnV = 0\n[   13.119117]   EA = 0, S1PTW = 0\n\nSigned-off-by: Amit Daniel Kachhap <amit.kachhap@arm.com>\nAcked-by: Catalin Marinas <catalin.marinas@arm.com>\nCc: Kees Cook <keescook@chromium.org>\nSigned-off-by: Catalin Marinas <catalin.marinas@arm.com>",
  "full_message": "lkdtm: arm64: test kernel pointer authentication\n\nThis test is specific for arm64. When in-kernel Pointer Authentication\nconfig is enabled, the return address stored in the stack is signed.\nThis feature helps in ROP kind of attack. If any parameters used to\ngenerate the pac (<key, sp, lr>) is modified then this will fail in\nthe authentication stage and will lead to abort.\n\nThis test changes the input parameter APIA kernel keys to cause abort.\nThe pac computed from the new key can be same as last due to hash\ncollision so this is retried for few times as there is no reliable way\nto compare the pacs. Even though this test may fail even after retries\nbut this may cause authentication failure at a later stage in earlier\nfunction returns.\n\nThis test can be invoked as,\necho CORRUPT_PAC > /sys/kernel/debug/provoke-crash/DIRECT\n\nor as below if inserted as a module,\ninsmod lkdtm.ko cpoint_name=DIRECT cpoint_type=CORRUPT_PAC cpoint_count=1\n\n[   13.118166] lkdtm: Performing direct entry CORRUPT_PAC\n[   13.118298] lkdtm: Clearing PAC from the return address\n[   13.118466] Unable to handle kernel paging request at virtual address bfff8000108648ec\n[   13.118626] Mem abort info:\n[   13.118666]   ESR = 0x86000004\n[   13.118866]   EC = 0x21: IABT (current EL), IL = 32 bits\n[   13.118966]   SET = 0, FnV = 0\n[   13.119117]   EA = 0, S1PTW = 0\n\nSigned-off-by: Amit Daniel Kachhap <amit.kachhap@arm.com>\nAcked-by: Catalin Marinas <catalin.marinas@arm.com>\nCc: Kees Cook <keescook@chromium.org>\nSigned-off-by: Catalin Marinas <catalin.marinas@arm.com>",
  "author_name": "Amit Daniel Kachhap",
  "author_email": "amit.kachhap@arm.com",
  "author_date": "Fri Mar 13 14:35:04 2020 +0530",
  "author_date_iso": "2020-03-13T14:35:04+05:30",
  "committer_name": "Catalin Marinas",
  "committer_email": "catalin.marinas@arm.com",
  "committer_date": "Wed Mar 18 09:50:21 2020 +0000",
  "committer_date_iso": "2020-03-18T09:50:21+00:00",
  "files_changed": [
    "drivers/misc/lkdtm/bugs.c",
    "drivers/misc/lkdtm/core.c",
    "drivers/misc/lkdtm/lkdtm.h"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "drivers/misc/lkdtm/bugs.c",
      "insertions": 36,
      "deletions": 0
    },
    {
      "file": "drivers/misc/lkdtm/core.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/misc/lkdtm/lkdtm.h",
      "insertions": 1,
      "deletions": 0
    }
  ],
  "total_insertions": 38,
  "total_deletions": 0,
  "total_changes": 38,
  "parents": [
    "74afda4016a7437e6e425c3370e4b93b47be8ddf"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.7-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/misc/lkdtm/bugs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/misc/lkdtm/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/misc/lkdtm/lkdtm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}