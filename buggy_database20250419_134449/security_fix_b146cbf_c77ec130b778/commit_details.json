{
  "hash": "b146cbf2e32f01f56244d670aef2f43d44fcf120",
  "hash_short": "b146cbf2",
  "subject": "af_unix: Silence randstruct GCC plugin warning",
  "body": "While preparing for Clang randstruct support (which duplicated many of\nthe warnings the randstruct GCC plugin warned about), one strange one\nremained only for the randstruct GCC plugin. Eliminating this rids\nthe plugin of the last exception.\n\nIt seems the plugin is happy to dereference individual members of\na cross-struct cast, but it is upset about casting to a whole object\npointer. This only manifests in one place in the kernel, so just replace\nthe variable with individual member accesses. There is no change in\nexecutable instruction output.\n\nDrop the last exception from the randstruct GCC plugin.\n\nCc: \"David S. Miller\" <davem@davemloft.net>\nCc: Christoph Hellwig <hch@infradead.org>\nCc: Paolo Abeni <pabeni@redhat.com>\nCc: Alexei Starovoitov <ast@kernel.org>\nCc: Cong Wang <cong.wang@bytedance.com>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: netdev@vger.kernel.org\nCc: linux-hardening@vger.kernel.org\nAcked-by: Kuniyuki Iwashima <kuniyu@amazon.co.jp>\nLink: https://lore.kernel.org/lkml/20220511022217.58586-1-kuniyu@amazon.co.jp\nAcked-by: Jakub Kicinski <kuba@kernel.org>\nLink: https://lore.kernel.org/lkml/20220511151542.4cb3ff17@kernel.org\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "full_message": "af_unix: Silence randstruct GCC plugin warning\n\nWhile preparing for Clang randstruct support (which duplicated many of\nthe warnings the randstruct GCC plugin warned about), one strange one\nremained only for the randstruct GCC plugin. Eliminating this rids\nthe plugin of the last exception.\n\nIt seems the plugin is happy to dereference individual members of\na cross-struct cast, but it is upset about casting to a whole object\npointer. This only manifests in one place in the kernel, so just replace\nthe variable with individual member accesses. There is no change in\nexecutable instruction output.\n\nDrop the last exception from the randstruct GCC plugin.\n\nCc: \"David S. Miller\" <davem@davemloft.net>\nCc: Christoph Hellwig <hch@infradead.org>\nCc: Paolo Abeni <pabeni@redhat.com>\nCc: Alexei Starovoitov <ast@kernel.org>\nCc: Cong Wang <cong.wang@bytedance.com>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: netdev@vger.kernel.org\nCc: linux-hardening@vger.kernel.org\nAcked-by: Kuniyuki Iwashima <kuniyu@amazon.co.jp>\nLink: https://lore.kernel.org/lkml/20220511022217.58586-1-kuniyu@amazon.co.jp\nAcked-by: Jakub Kicinski <kuba@kernel.org>\nLink: https://lore.kernel.org/lkml/20220511151542.4cb3ff17@kernel.org\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "author_name": "Kees Cook",
  "author_email": "keescook@chromium.org",
  "author_date": "Tue May 10 15:46:26 2022 -0700",
  "author_date_iso": "2022-05-10T15:46:26-07:00",
  "committer_name": "Kees Cook",
  "committer_email": "keescook@chromium.org",
  "committer_date": "Mon May 16 16:02:21 2022 -0700",
  "committer_date_iso": "2022-05-16T16:02:21-07:00",
  "files_changed": [
    "net/unix/af_unix.c",
    "scripts/gcc-plugins/randomize_layout_plugin.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/unix/af_unix.c",
      "insertions": 3,
      "deletions": 5
    },
    {
      "file": "scripts/gcc-plugins/randomize_layout_plugin.c",
      "insertions": 0,
      "deletions": 2
    }
  ],
  "total_insertions": 3,
  "total_deletions": 7,
  "total_changes": 10,
  "parents": [
    "2dcfe9e2d370f6643486e327c6ae17af8887756c"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/unix/af_unix.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "scripts/gcc-plugins/randomize_layout_plugin.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}