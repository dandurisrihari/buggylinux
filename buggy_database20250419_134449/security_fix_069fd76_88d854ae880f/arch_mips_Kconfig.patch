commit 069fd766271de65ec4dc2eb8d15f7f44727b1ea1
Author: Matt Redfearn <matt.redfearn@mips.com>
Date:   Thu Mar 31 10:05:34 2016 +0100

    MIPS: Reserve space for relocation table
    
    When CONFIG_RELOCATABLE is enabled, add a new section in the memory map
    to be filled with relocation data.
    
    CONFIG_RELOCATION_TABLE_SIZE allows the amount of space reserved to be
    adjusted if necessary.
    
    The relocs tool will populate this reserved space with relocation
    information. The space is reserved within the elf by filling it with
    0's, and an invalid entry is left at the start of the space such that
    kernel relocation will be aborted if the table is empty.
    
    Signed-off-by: Matt Redfearn <matt.redfearn@imgtec.com>
    Cc: Aaro Koskinen <aaro.koskinen@nokia.com>
    Cc: David Daney <ddaney@caviumnetworks.com>
    Cc: Jonas Gorski <jogo@openwrt.org>
    Cc: linux-mips@linux-mips.org
    Cc: kernel-hardening@lists.openwall.com
    Cc: linux-kernel@vger.kernel.org
    Patchwork: https://patchwork.linux-mips.org/patch/12982/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

diff --git a/arch/mips/Kconfig b/arch/mips/Kconfig
index b5609111a3bd..99ec21f35433 100644
--- a/arch/mips/Kconfig
+++ b/arch/mips/Kconfig
@@ -2473,6 +2473,22 @@ config NUMA
 config SYS_SUPPORTS_NUMA
 	bool
 
+config RELOCATION_TABLE_SIZE
+	hex "Relocation table size"
+	depends on RELOCATABLE
+	range 0x0 0x01000000
+	default "0x00100000"
+	---help---
+	  A table of relocation data will be appended to the kernel binary
+	  and parsed at boot to fix up the relocated kernel.
+
+	  This option allows the amount of space reserved for the table to be
+	  adjusted, although the default of 1Mb should be ok in most cases.
+
+	  The build will fail and a valid size suggested if this is too small.
+
+	  If unsure, leave at the default value.
+
 config NODES_SHIFT
 	int
 	default "6"