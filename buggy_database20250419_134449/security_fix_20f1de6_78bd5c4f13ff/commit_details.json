{
  "hash": "20f1de659b77364d55d4e7fad2ef657e7730323f",
  "hash_short": "20f1de65",
  "subject": "gen_init_cpio: avoid stack overflow when expanding",
  "body": "Fix possible overflow of the buffer used for expanding environment\nvariables when building file list.\n\nIn the extremely unlikely case of an attacker having control over the\nenvironment variables visible to gen_init_cpio, control over the\ncontents of the file gen_init_cpio parses, and gen_init_cpio was built\nwithout compiler hardening, the attacker can gain arbitrary execution\ncontrol via a stack buffer overflow.\n\n  $ cat usr/crash.list\n  file foo ${BIG}${BIG}${BIG}${BIG}${BIG}${BIG} 0755 0 0\n  $ BIG=$(perl -e 'print \"A\" x 4096;') ./usr/gen_init_cpio usr/crash.list\n  *** buffer overflow detected ***: ./usr/gen_init_cpio terminated\n\nThis also replaces the space-indenting with tabs.\n\nPatch based on existing fix extracted from grsecurity.\n\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: Michal Marek <mmarek@suse.cz>\nCc: Brad Spengler <spender@grsecurity.net>\nCc: PaX Team <pageexec@freemail.hu>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "gen_init_cpio: avoid stack overflow when expanding\n\nFix possible overflow of the buffer used for expanding environment\nvariables when building file list.\n\nIn the extremely unlikely case of an attacker having control over the\nenvironment variables visible to gen_init_cpio, control over the\ncontents of the file gen_init_cpio parses, and gen_init_cpio was built\nwithout compiler hardening, the attacker can gain arbitrary execution\ncontrol via a stack buffer overflow.\n\n  $ cat usr/crash.list\n  file foo ${BIG}${BIG}${BIG}${BIG}${BIG}${BIG} 0755 0 0\n  $ BIG=$(perl -e 'print \"A\" x 4096;') ./usr/gen_init_cpio usr/crash.list\n  *** buffer overflow detected ***: ./usr/gen_init_cpio terminated\n\nThis also replaces the space-indenting with tabs.\n\nPatch based on existing fix extracted from grsecurity.\n\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: Michal Marek <mmarek@suse.cz>\nCc: Brad Spengler <spender@grsecurity.net>\nCc: PaX Team <pageexec@freemail.hu>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Kees Cook",
  "author_email": "keescook@chromium.org",
  "author_date": "Thu Oct 25 13:38:14 2012 -0700",
  "author_date_iso": "2012-10-25T13:38:14-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Thu Oct 25 14:37:53 2012 -0700",
  "committer_date_iso": "2012-10-25T14:37:53-07:00",
  "files_changed": [
    "usr/gen_init_cpio.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "usr/gen_init_cpio.c",
      "insertions": 23,
      "deletions": 20
    }
  ],
  "total_insertions": 23,
  "total_deletions": 20,
  "total_changes": 43,
  "parents": [
    "fee0de7791f967c2c5f0d43eb7b7261761b45e64"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "usr/gen_init_cpio.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}