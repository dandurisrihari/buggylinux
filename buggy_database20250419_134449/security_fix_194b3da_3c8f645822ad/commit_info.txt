Commit Hash: 194b3da873fd334ef183806db751473512af29ce
Subject: agp: fix arbitrary kernel memory writes


Security Keywords:
- privilege escalation

Full commit message:
agp: fix arbitrary kernel memory writes

pg_start is copied from userspace on AGPIOC_BIND and AGPIOC_UNBIND ioctl
cmds of agp_ioctl() and passed to agpioc_bind_wrap().  As said in the
comment, (pg_start + mem->page_count) may wrap in case of AGPIOC_BIND,
and it is not checked at all in case of AGPIOC_UNBIND.  As a result, user
with sufficient privileges (usually "video" group) may generate either
local DoS or privilege escalation.

Signed-off-by: Vasiliy Kulikov <segoon@openwall.com>
Signed-off-by: Dave Airlie <airlied@redhat.com>

Metadata:
Author: Vasiliy Kulikov <segoon@openwall.com>
Author Date: Thu Apr 14 20:55:16 2011 +0400
Committer: Dave Airlie <airlied@redhat.com>
Commit Date: Thu Apr 21 12:16:55 2011 +1000

Files Changed: 1
Lines Added: 8
Lines Removed: 3
Total Changes: 11
