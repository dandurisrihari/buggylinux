{
  "hash": "4c190e2f913f038c9c91ee63b59cd037260ba353",
  "hash_short": "4c190e2f",
  "subject": "sunrpc: trim off trailing checksum before returning decrypted or integrity authenticated buffer",
  "body": "When GSSAPI integrity signatures are in use, or when we're using GSSAPI\nprivacy with the v2 token format, there is a trailing checksum on the\nxdr_buf that is returned.\n\nIt's checked during the authentication stage, and afterward nothing\ncares about it. Ordinarily, it's not a problem since the XDR code\ngenerally ignores it, but it will be when we try to compute a checksum\nover the buffer to help prevent XID collisions in the duplicate reply\ncache.\n\nFix the code to trim off the checksums after verifying them. Note that\nin unwrap_integ_data, we must avoid trying to reverify the checksum if\nthe request was deferred since it will no longer be present when it's\nrevisited.\n\nSigned-off-by: Jeff Layton <jlayton@redhat.com>",
  "full_message": "sunrpc: trim off trailing checksum before returning decrypted or integrity authenticated buffer\n\nWhen GSSAPI integrity signatures are in use, or when we're using GSSAPI\nprivacy with the v2 token format, there is a trailing checksum on the\nxdr_buf that is returned.\n\nIt's checked during the authentication stage, and afterward nothing\ncares about it. Ordinarily, it's not a problem since the XDR code\ngenerally ignores it, but it will be when we try to compute a checksum\nover the buffer to help prevent XID collisions in the duplicate reply\ncache.\n\nFix the code to trim off the checksums after verifying them. Note that\nin unwrap_integ_data, we must avoid trying to reverify the checksum if\nthe request was deferred since it will no longer be present when it's\nrevisited.\n\nSigned-off-by: Jeff Layton <jlayton@redhat.com>",
  "author_name": "Jeff Layton",
  "author_email": "jlayton@redhat.com",
  "author_date": "Wed Feb 6 08:28:55 2013 -0500",
  "author_date_iso": "2013-02-06T08:28:55-05:00",
  "committer_name": "J. Bruce Fields",
  "committer_email": "bfields@redhat.com",
  "committer_date": "Fri Feb 8 15:19:10 2013 -0500",
  "committer_date_iso": "2013-02-08T15:19:10-05:00",
  "files_changed": [
    "include/linux/sunrpc/xdr.h",
    "net/sunrpc/auth_gss/gss_krb5_wrap.c",
    "net/sunrpc/auth_gss/svcauth_gss.c",
    "net/sunrpc/xdr.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "include/linux/sunrpc/xdr.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_wrap.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "net/sunrpc/auth_gss/svcauth_gss.c",
      "insertions": 8,
      "deletions": 2
    },
    {
      "file": "net/sunrpc/xdr.c",
      "insertions": 41,
      "deletions": 0
    }
  ],
  "total_insertions": 52,
  "total_deletions": 2,
  "total_changes": 54,
  "parents": [
    "de0b65ca55dc62b6b477f6e02088df2281da7b51"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/linux/sunrpc/xdr.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_wrap.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/sunrpc/auth_gss/svcauth_gss.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/sunrpc/xdr.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}