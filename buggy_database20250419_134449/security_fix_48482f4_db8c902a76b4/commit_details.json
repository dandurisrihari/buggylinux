{
  "hash": "48482f4dd3432e5e62873bf0f2e254cfb8ce2ac2",
  "hash_short": "48482f4d",
  "subject": "selftests/powerpc: Better reporting in spectre_v2",
  "body": "In commit f3054ffd71b5 (\"selftests/powerpc: Return skip code for\nspectre_v2\"), the spectre_v2 selftest is updated to be aware of cases\nwhere the vulnerability status reported in sysfs is incorrect, skipping\nthe test instead.\n\nThis happens because qemu can misrepresent the mitigation status of the\nhost to the guest. If the count cache is disabled in the host, and this\nis correctly reported to the guest, then the guest won't apply\nmitigations. If the guest is then migrated to a new host where\nmitigations are necessary, it is now vulnerable because it has not\napplied mitigations.\n\nUpdate the selftest to report when we see excessive misses, indicative of\nthe count cache being disabled. If software flushing is enabled, also\nwarn that these flushes are just wasting performance.\n\nSigned-off-by: Russell Currey <ruscur@russell.cc>\n[mpe: Rebase and update change log appropriately]\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>\nLink: https://lore.kernel.org/r/20210608064809.199116-1-ruscur@russell.cc",
  "full_message": "selftests/powerpc: Better reporting in spectre_v2\n\nIn commit f3054ffd71b5 (\"selftests/powerpc: Return skip code for\nspectre_v2\"), the spectre_v2 selftest is updated to be aware of cases\nwhere the vulnerability status reported in sysfs is incorrect, skipping\nthe test instead.\n\nThis happens because qemu can misrepresent the mitigation status of the\nhost to the guest. If the count cache is disabled in the host, and this\nis correctly reported to the guest, then the guest won't apply\nmitigations. If the guest is then migrated to a new host where\nmitigations are necessary, it is now vulnerable because it has not\napplied mitigations.\n\nUpdate the selftest to report when we see excessive misses, indicative of\nthe count cache being disabled. If software flushing is enabled, also\nwarn that these flushes are just wasting performance.\n\nSigned-off-by: Russell Currey <ruscur@russell.cc>\n[mpe: Rebase and update change log appropriately]\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>\nLink: https://lore.kernel.org/r/20210608064809.199116-1-ruscur@russell.cc",
  "author_name": "Russell Currey",
  "author_email": "ruscur@russell.cc",
  "author_date": "Tue Jun 8 16:48:09 2021 +1000",
  "author_date_iso": "2021-06-08T16:48:09+10:00",
  "committer_name": "Michael Ellerman",
  "committer_email": "mpe@ellerman.id.au",
  "committer_date": "Sun May 22 15:58:28 2022 +1000",
  "committer_date_iso": "2022-05-22T15:58:28+10:00",
  "files_changed": [
    "tools/testing/selftests/powerpc/security/spectre_v2.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "tools/testing/selftests/powerpc/security/spectre_v2.c",
      "insertions": 15,
      "deletions": 9
    }
  ],
  "total_insertions": 15,
  "total_deletions": 9,
  "total_changes": 24,
  "parents": [
    "d2a3c131981d4498571908df95c3c9393a00adf5"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "tools/testing/selftests/powerpc/security/spectre_v2.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}