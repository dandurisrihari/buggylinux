commit 8d20dcda404d48784f2359976811bfc189992aa0
Author: John Daley <johndale@cisco.com>
Date:   Wed Jan 15 10:13:12 2025 -0800

    selftests: drv-net-hw: inject pp_alloc_fail errors in the right place
    
    The tool pp_alloc_fail.py tested error recovery by injecting errors
    into the function page_pool_alloc_pages(). The page pool allocation
    function page_pool_dev_alloc() does not end up calling
    page_pool_alloc_pages(). page_pool_alloc_netmems() seems to be the
    function that is called by all of the page pool alloc functions in
    the API, so move error injection to that function instead.
    
    Signed-off-by: John Daley <johndale@cisco.com>
    Link: https://patch.msgid.link/20250115181312.3544-2-johndale@cisco.com
    Signed-off-by: Jakub Kicinski <kuba@kernel.org>

diff --git a/net/core/page_pool.c b/net/core/page_pool.c
index 9733206d6406..a3de752c5178 100644
--- a/net/core/page_pool.c
+++ b/net/core/page_pool.c
@@ -595,13 +595,13 @@ netmem_ref page_pool_alloc_netmems(struct page_pool *pool, gfp_t gfp)
 	return netmem;
 }
 EXPORT_SYMBOL(page_pool_alloc_netmems);
+ALLOW_ERROR_INJECTION(page_pool_alloc_netmems, NULL);
 
 struct page *page_pool_alloc_pages(struct page_pool *pool, gfp_t gfp)
 {
 	return netmem_to_page(page_pool_alloc_netmems(pool, gfp));
 }
 EXPORT_SYMBOL(page_pool_alloc_pages);
-ALLOW_ERROR_INJECTION(page_pool_alloc_pages, NULL);
 
 /* Calculate distance between two u32 values, valid if distance is below 2^(31)
  *  https://en.wikipedia.org/wiki/Serial_number_arithmetic#General_Solution