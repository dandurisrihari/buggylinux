Commit Hash: 429fa68b58cefb9aa9de27e4089637298b46b757
Subject: usbnet: ipheth: check that DPE points past NCM header


Security Keywords:
- security issue

Full commit message:
usbnet: ipheth: check that DPE points past NCM header

By definition, a DPE points at the start of a network frame/datagram.
Thus it makes no sense for it to point at anything that's part of the
NCM header. It is not a security issue, but merely an indication of
a malformed DPE.

Enforce that all DPEs point at the data portion of the URB, past the
NCM header.

Fixes: a2d274c62e44 ("usbnet: ipheth: add CDC NCM support")
Cc: stable@vger.kernel.org
Signed-off-by: Foster Snowhill <forst@pen.gy>
Reviewed-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Paolo Abeni <pabeni@redhat.com>

Metadata:
Author: Foster Snowhill <forst@pen.gy>
Author Date: Sun Jan 26 00:54:04 2025 +0100
Committer: Paolo Abeni <pabeni@redhat.com>
Commit Date: Tue Jan 28 12:16:32 2025 +0100

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
