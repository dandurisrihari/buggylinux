{
  "hash": "b9815eb1d13f0dc088ee8afb6e6d0683ea551098",
  "hash_short": "b9815eb1",
  "subject": "tun: implement header_ops->parse_protocol for AF_PACKET",
  "body": "The tun driver passes up skb->protocol to userspace in the form of PI headers.\nFor AF_PACKET injection, we need to support its call chain of:\n\n    packet_sendmsg -> packet_snd -> packet_parse_headers ->\n      dev_parse_header_protocol -> parse_protocol\n\nWithout a valid parse_protocol, this returns zero, and the tun driver\nthen gives userspace bogus values that it can't deal with.\n\nNote that this isn't the case with tap, because tap already benefits\nfrom the shared infrastructure for ethernet headers. But with tun,\nthere's nothing.\n\nSigned-off-by: Jason A. Donenfeld <Jason@zx2c4.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "tun: implement header_ops->parse_protocol for AF_PACKET\n\nThe tun driver passes up skb->protocol to userspace in the form of PI headers.\nFor AF_PACKET injection, we need to support its call chain of:\n\n    packet_sendmsg -> packet_snd -> packet_parse_headers ->\n      dev_parse_header_protocol -> parse_protocol\n\nWithout a valid parse_protocol, this returns zero, and the tun driver\nthen gives userspace bogus values that it can't deal with.\n\nNote that this isn't the case with tap, because tap already benefits\nfrom the shared infrastructure for ethernet headers. But with tun,\nthere's nothing.\n\nSigned-off-by: Jason A. Donenfeld <Jason@zx2c4.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Jason A. Donenfeld",
  "author_email": "Jason@zx2c4.com",
  "author_date": "Mon Jun 29 19:06:22 2020 -0600",
  "author_date_iso": "2020-06-29T19:06:22-06:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Jun 30 12:29:39 2020 -0700",
  "committer_date_iso": "2020-06-30T12:29:39-07:00",
  "files_changed": [
    "drivers/net/tun.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/tun.c",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 2,
  "total_deletions": 0,
  "total_changes": 2,
  "parents": [
    "1a574074ae7d1d745c16f7710655f38a53174c27"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/tun.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}