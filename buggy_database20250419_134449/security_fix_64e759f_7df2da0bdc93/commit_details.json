{
  "hash": "64e759f58f128730b97a3c3a26d283c075ad7c86",
  "hash_short": "64e759f5",
  "subject": "Bluetooth: Fix missing encryption refresh on Security Request",
  "body": "If Security Request is received on connection that is already encrypted\nwith sufficient security master should perform encryption key refresh\nprocedure instead of just ignoring Slave Security Request\n(Core Spec 5.0 Vol 3 Part H 2.4.6).\n\n> ACL Data RX: Handle 3585 flags 0x02 dlen 6\n      SMP: Security Request (0x0b) len 1\n        Authentication requirement: Bonding, No MITM, SC, No Keypresses (0x09)\n< HCI Command: LE Start Encryption (0x08|0x0019) plen 28\n        Handle: 3585\n        Random number: 0x0000000000000000\n        Encrypted diversifier: 0x0000\n        Long term key: 44264272a5c426a9e868f034cf0e69f3\n> HCI Event: Command Status (0x0f) plen 4\n      LE Start Encryption (0x08|0x0019) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Encryption Key Refresh Complete (0x30) plen 3\n        Status: Success (0x00)\n        Handle: 3585\n\nSigned-off-by: Szymon Janc <szymon.janc@codecoup.pl>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "Bluetooth: Fix missing encryption refresh on Security Request\n\nIf Security Request is received on connection that is already encrypted\nwith sufficient security master should perform encryption key refresh\nprocedure instead of just ignoring Slave Security Request\n(Core Spec 5.0 Vol 3 Part H 2.4.6).\n\n> ACL Data RX: Handle 3585 flags 0x02 dlen 6\n      SMP: Security Request (0x0b) len 1\n        Authentication requirement: Bonding, No MITM, SC, No Keypresses (0x09)\n< HCI Command: LE Start Encryption (0x08|0x0019) plen 28\n        Handle: 3585\n        Random number: 0x0000000000000000\n        Encrypted diversifier: 0x0000\n        Long term key: 44264272a5c426a9e868f034cf0e69f3\n> HCI Event: Command Status (0x0f) plen 4\n      LE Start Encryption (0x08|0x0019) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Encryption Key Refresh Complete (0x30) plen 3\n        Status: Success (0x00)\n        Handle: 3585\n\nSigned-off-by: Szymon Janc <szymon.janc@codecoup.pl>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Szymon Janc",
  "author_email": "szymon.janc@codecoup.pl",
  "author_date": "Mon Feb 26 15:41:53 2018 +0100",
  "author_date_iso": "2018-02-26T15:41:53+01:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Thu Mar 1 19:55:56 2018 +0100",
  "committer_date_iso": "2018-03-01T19:55:56+01:00",
  "files_changed": [
    "net/bluetooth/smp.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/smp.c",
      "insertions": 7,
      "deletions": 1
    }
  ],
  "total_insertions": 7,
  "total_deletions": 1,
  "total_changes": 8,
  "parents": [
    "0c6e526646c04ce31d4aaa280ed2237dd1cd774c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.16-rc7",
    "v4.17",
    "v4.17-rc1",
    "v4.17-rc2",
    "v4.17-rc3",
    "v4.17-rc4",
    "v4.17-rc5",
    "v4.17-rc6",
    "v4.17-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/smp.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}