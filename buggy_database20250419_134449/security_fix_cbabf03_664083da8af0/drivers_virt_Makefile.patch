commit cbabf03c3ef3cce74a97f140cf57611a9e8a21bc
Author: Dov Murik <dovmurik@linux.ibm.com>
Date:   Tue Apr 12 21:21:25 2022 +0000

    virt: Add efi_secret module to expose confidential computing secrets
    
    The new efi_secret module exposes the confidential computing (coco)
    EFI secret area via securityfs interface.
    
    When the module is loaded (and securityfs is mounted, typically under
    /sys/kernel/security), a "secrets/coco" directory is created in
    securityfs.  In it, a file is created for each secret entry.  The name
    of each such file is the GUID of the secret entry, and its content is
    the secret data.
    
    This allows applications running in a confidential computing setting to
    read secrets provided by the guest owner via a secure secret injection
    mechanism (such as AMD SEV's LAUNCH_SECRET command).
    
    Removing (unlinking) files in the "secrets/coco" directory will zero out
    the secret in memory, and remove the filesystem entry.  If the module is
    removed and loaded again, that secret will not appear in the filesystem.
    
    Signed-off-by: Dov Murik <dovmurik@linux.ibm.com>
    Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
    Link: https://lore.kernel.org/r/20220412212127.154182-3-dovmurik@linux.ibm.com
    Signed-off-by: Ard Biesheuvel <ardb@kernel.org>

diff --git a/drivers/virt/Makefile b/drivers/virt/Makefile
index 108d0ffcc9aa..067b5427f40f 100644
--- a/drivers/virt/Makefile
+++ b/drivers/virt/Makefile
@@ -9,3 +9,4 @@ obj-y				+= vboxguest/
 
 obj-$(CONFIG_NITRO_ENCLAVES)	+= nitro_enclaves/
 obj-$(CONFIG_ACRN_HSM)		+= acrn/
+obj-$(CONFIG_EFI_SECRET)	+= coco/efi_secret/