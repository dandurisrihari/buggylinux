Commit Hash: cbabf03c3ef3cce74a97f140cf57611a9e8a21bc
Subject: virt: Add efi_secret module to expose confidential computing secrets


Security Keywords:
- injection

Full commit message:
virt: Add efi_secret module to expose confidential computing secrets

The new efi_secret module exposes the confidential computing (coco)
EFI secret area via securityfs interface.

When the module is loaded (and securityfs is mounted, typically under
/sys/kernel/security), a "secrets/coco" directory is created in
securityfs.  In it, a file is created for each secret entry.  The name
of each such file is the GUID of the secret entry, and its content is
the secret data.

This allows applications running in a confidential computing setting to
read secrets provided by the guest owner via a secure secret injection
mechanism (such as AMD SEV's LAUNCH_SECRET command).

Removing (unlinking) files in the "secrets/coco" directory will zero out
the secret in memory, and remove the filesystem entry.  If the module is
removed and loaded again, that secret will not appear in the filesystem.

Signed-off-by: Dov Murik <dovmurik@linux.ibm.com>
Reviewed-by: Gerd Hoffmann <kraxel@redhat.com>
Link: https://lore.kernel.org/r/20220412212127.154182-3-dovmurik@linux.ibm.com
Signed-off-by: Ard Biesheuvel <ardb@kernel.org>

Metadata:
Author: Dov Murik <dovmurik@linux.ibm.com>
Author Date: Tue Apr 12 21:21:25 2022 +0000
Committer: Ard Biesheuvel <ardb@kernel.org>
Commit Date: Wed Apr 13 19:11:20 2022 +0200

Files Changed: 6
Lines Added: 422
Lines Removed: 0
Total Changes: 422
