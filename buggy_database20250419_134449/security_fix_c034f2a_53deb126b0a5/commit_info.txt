Commit Hash: c034f2aa8622e1e436563eb34c0f78ba8aa32329
Subject: KVM: VMX: Fix conditions for guest IA32_XSS support


Security Keywords:
- XSS

Full commit message:
KVM: VMX: Fix conditions for guest IA32_XSS support

Volume 4 of the SDM says that IA32_XSS is supported
if CPUID(EAX=0DH,ECX=1):EAX.XSS[bit 3] is set, so only the
X86_FEATURE_XSAVES check is necessary (X86_FEATURE_XSAVES is the Linux
name for CPUID(EAX=0DH,ECX=1):EAX.XSS[bit 3]).

Fixes: 4d763b168e9c5 ("KVM: VMX: check CPUID before allowing read/write of IA32_XSS")
Reviewed-by: Jim Mattson <jmattson@google.com>
Signed-off-by: Aaron Lewis <aaronlewis@google.com>
Change-Id: I9059b9f2e3595e4b09a4cdcf14b933b22ebad419
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Aaron Lewis <aaronlewis@google.com>
Author Date: Mon Oct 21 16:30:21 2019 -0700
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Tue Oct 22 15:43:21 2019 +0200

Files Changed: 1
Lines Added: 11
Lines Removed: 13
Total Changes: 24
