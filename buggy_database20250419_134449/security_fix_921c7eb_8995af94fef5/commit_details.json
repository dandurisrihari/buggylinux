{
  "hash": "921c7ebd1337d1a46783d7e15a850e12aed2eaa0",
  "hash_short": "921c7ebd",
  "subject": "futex: Fix incorrect should_fail_futex() handling",
  "body": "If should_futex_fail() returns true in futex_wake_pi(), then the 'ret'\nvariable is set to -EFAULT and then immediately overwritten. So the failure\ninjection is non-functional.\n\nFix it by actually leaving the function and returning -EFAULT.\n\nThe Fixes tag is kinda blury because the initial commit which introduced\nfailure injection was already sloppy, but the below mentioned commit broke\nit completely.\n\n[ tglx: Massaged changelog ]\n\nFixes: 6b4f4bc9cb22 (\"locking/futex: Allow low-level atomic operations to return -EAGAIN\")\nSigned-off-by: Mateusz Nosek <mateusznosek0@gmail.com>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nLink: https://lore.kernel.org/r/20200927000858.24219-1-mateusznosek0@gmail.com",
  "full_message": "futex: Fix incorrect should_fail_futex() handling\n\nIf should_futex_fail() returns true in futex_wake_pi(), then the 'ret'\nvariable is set to -EFAULT and then immediately overwritten. So the failure\ninjection is non-functional.\n\nFix it by actually leaving the function and returning -EFAULT.\n\nThe Fixes tag is kinda blury because the initial commit which introduced\nfailure injection was already sloppy, but the below mentioned commit broke\nit completely.\n\n[ tglx: Massaged changelog ]\n\nFixes: 6b4f4bc9cb22 (\"locking/futex: Allow low-level atomic operations to return -EAGAIN\")\nSigned-off-by: Mateusz Nosek <mateusznosek0@gmail.com>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nLink: https://lore.kernel.org/r/20200927000858.24219-1-mateusznosek0@gmail.com",
  "author_name": "Mateusz Nosek",
  "author_email": "mateusznosek0@gmail.com",
  "author_date": "Sun Sep 27 02:08:58 2020 +0200",
  "author_date_iso": "2020-09-27T02:08:58+02:00",
  "committer_name": "Thomas Gleixner",
  "committer_email": "tglx@linutronix.de",
  "committer_date": "Wed Oct 28 15:48:51 2020 +0100",
  "committer_date_iso": "2020-10-28T15:48:51+01:00",
  "files_changed": [
    "kernel/futex.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "kernel/futex.c",
      "insertions": 3,
      "deletions": 1
    }
  ],
  "total_insertions": 3,
  "total_deletions": 1,
  "total_changes": 4,
  "parents": [
    "f8e48a3dca060e80f672d398d181db1298fbc86c"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "kernel/futex.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}