{
  "hash": "fa00c437eef8dc2e7b25f8cd868cfa405fcc2bb3",
  "hash_short": "fa00c437",
  "subject": "aacraid: Check size values after double-fetch from user",
  "body": "In aacraid's ioctl_send_fib() we do two fetches from userspace, one the\nget the fib header's size and one for the fib itself. Later we use the\nsize field from the second fetch to further process the fib. If for some\nreason the size from the second fetch is different than from the first\nfix, we may encounter an out-of- bounds access in aac_fib_send(). We\nalso check the sender size to insure it is not out of bounds. This was\nreported in https://bugzilla.kernel.org/show_bug.cgi?id=116751 and was\nassigned CVE-2016-6480.\n\nReported-by: Pengfei Wang <wpengfeinudt@gmail.com>\nFixes: 7c00ffa31 '[SCSI] 2.6 aacraid: Variable FIB size (updated patch)'\nCc: stable@vger.kernel.org\nSigned-off-by: Dave Carroll <david.carroll@microsemi.com>\nReviewed-by: Johannes Thumshirn <jthumshirn@suse.de>\nSigned-off-by: Martin K. Petersen <martin.petersen@oracle.com>",
  "full_message": "aacraid: Check size values after double-fetch from user\n\nIn aacraid's ioctl_send_fib() we do two fetches from userspace, one the\nget the fib header's size and one for the fib itself. Later we use the\nsize field from the second fetch to further process the fib. If for some\nreason the size from the second fetch is different than from the first\nfix, we may encounter an out-of- bounds access in aac_fib_send(). We\nalso check the sender size to insure it is not out of bounds. This was\nreported in https://bugzilla.kernel.org/show_bug.cgi?id=116751 and was\nassigned CVE-2016-6480.\n\nReported-by: Pengfei Wang <wpengfeinudt@gmail.com>\nFixes: 7c00ffa31 '[SCSI] 2.6 aacraid: Variable FIB size (updated patch)'\nCc: stable@vger.kernel.org\nSigned-off-by: Dave Carroll <david.carroll@microsemi.com>\nReviewed-by: Johannes Thumshirn <jthumshirn@suse.de>\nSigned-off-by: Martin K. Petersen <martin.petersen@oracle.com>",
  "author_name": "Dave Carroll",
  "author_email": "david.carroll@microsemi.com",
  "author_date": "Fri Aug 5 13:44:10 2016 -0600",
  "author_date_iso": "2016-08-05T13:44:10-06:00",
  "committer_name": "Martin K. Petersen",
  "committer_email": "martin.petersen@oracle.com",
  "committer_date": "Mon Aug 8 21:34:02 2016 -0400",
  "committer_date_iso": "2016-08-08T21:34:02-04:00",
  "files_changed": [
    "drivers/scsi/aacraid/commctrl.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/scsi/aacraid/commctrl.c",
      "insertions": 11,
      "deletions": 2
    }
  ],
  "total_insertions": 11,
  "total_deletions": 2,
  "total_changes": 13,
  "parents": [
    "ea0a95d7f162bfa1c9df74471f0064f71cdf80ea"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2016-6480"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/scsi/aacraid/commctrl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}