Commit Hash: fa00c437eef8dc2e7b25f8cd868cfa405fcc2bb3
Subject: aacraid: Check size values after double-fetch from user

CVE Identifiers:
- CVE-2016-6480

Full commit message:
aacraid: Check size values after double-fetch from user

In aacraid's ioctl_send_fib() we do two fetches from userspace, one the
get the fib header's size and one for the fib itself. Later we use the
size field from the second fetch to further process the fib. If for some
reason the size from the second fetch is different than from the first
fix, we may encounter an out-of- bounds access in aac_fib_send(). We
also check the sender size to insure it is not out of bounds. This was
reported in https://bugzilla.kernel.org/show_bug.cgi?id=116751 and was
assigned CVE-2016-6480.

Reported-by: Pengfei Wang <wpengfeinudt@gmail.com>
Fixes: 7c00ffa31 '[SCSI] 2.6 aacraid: Variable FIB size (updated patch)'
Cc: stable@vger.kernel.org
Signed-off-by: Dave Carroll <david.carroll@microsemi.com>
Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

Metadata:
Author: Dave Carroll <david.carroll@microsemi.com>
Author Date: Fri Aug 5 13:44:10 2016 -0600
Committer: Martin K. Petersen <martin.petersen@oracle.com>
Commit Date: Mon Aug 8 21:34:02 2016 -0400

Files Changed: 1
Lines Added: 11
Lines Removed: 2
Total Changes: 13
