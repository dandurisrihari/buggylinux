{
  "hash": "b4845bb6383821a9516ce30af3a27dc873e37fd4",
  "hash_short": "b4845bb6",
  "subject": "x86/xen: add central hypercall functions",
  "body": "Add generic hypercall functions usable for all normal (i.e. not iret)\nhypercalls. Depending on the guest type and the processor vendor\ndifferent functions need to be used due to the to be used instruction\nfor entering the hypervisor:\n\n- PV guests need to use syscall\n- HVM/PVH guests on Intel need to use vmcall\n- HVM/PVH guests on AMD and Hygon need to use vmmcall\n\nAs PVH guests need to issue hypercalls very early during boot, there\nis a 4th hypercall function needed for HVM/PVH which can be used on\nIntel and AMD processors. It will check the vendor type and then set\nthe Intel or AMD specific function to use via static_call().\n\nThis is part of XSA-466 / CVE-2024-53241.\n\nReported-by: Andrew Cooper <andrew.cooper3@citrix.com>\nSigned-off-by: Juergen Gross <jgross@suse.com>\nCo-developed-by: Peter Zijlstra <peterz@infradead.org>",
  "full_message": "x86/xen: add central hypercall functions\n\nAdd generic hypercall functions usable for all normal (i.e. not iret)\nhypercalls. Depending on the guest type and the processor vendor\ndifferent functions need to be used due to the to be used instruction\nfor entering the hypervisor:\n\n- PV guests need to use syscall\n- HVM/PVH guests on Intel need to use vmcall\n- HVM/PVH guests on AMD and Hygon need to use vmmcall\n\nAs PVH guests need to issue hypercalls very early during boot, there\nis a 4th hypercall function needed for HVM/PVH which can be used on\nIntel and AMD processors. It will check the vendor type and then set\nthe Intel or AMD specific function to use via static_call().\n\nThis is part of XSA-466 / CVE-2024-53241.\n\nReported-by: Andrew Cooper <andrew.cooper3@citrix.com>\nSigned-off-by: Juergen Gross <jgross@suse.com>\nCo-developed-by: Peter Zijlstra <peterz@infradead.org>",
  "author_name": "Juergen Gross",
  "author_email": "jgross@suse.com",
  "author_date": "Thu Oct 17 11:00:52 2024 +0200",
  "author_date_iso": "2024-10-17T11:00:52+02:00",
  "committer_name": "Juergen Gross",
  "committer_email": "jgross@suse.com",
  "committer_date": "Tue Dec 17 08:23:29 2024 +0100",
  "committer_date_iso": "2024-12-17T08:23:29+01:00",
  "files_changed": [
    "arch/x86/include/asm/xen/hypercall.h",
    "arch/x86/xen/enlighten.c",
    "arch/x86/xen/enlighten_hvm.c",
    "arch/x86/xen/enlighten_pv.c",
    "arch/x86/xen/xen-asm.S",
    "arch/x86/xen/xen-head.S",
    "arch/x86/xen/xen-ops.h"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "arch/x86/include/asm/xen/hypercall.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "arch/x86/xen/enlighten.c",
      "insertions": 65,
      "deletions": 0
    },
    {
      "file": "arch/x86/xen/enlighten_hvm.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/x86/xen/enlighten_pv.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "arch/x86/xen/xen-asm.S",
      "insertions": 23,
      "deletions": 0
    },
    {
      "file": "arch/x86/xen/xen-head.S",
      "insertions": 83,
      "deletions": 0
    },
    {
      "file": "arch/x86/xen/xen-ops.h",
      "insertions": 9,
      "deletions": 0
    }
  ],
  "total_insertions": 190,
  "total_deletions": 1,
  "total_changes": 191,
  "parents": [
    "a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2024-53241"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "arch/x86/include/asm/xen/hypercall.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/xen/xen-ops.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/xen/xen-head.S",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/xen/xen-asm.S",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/xen/enlighten.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/xen/enlighten_pv.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/xen/enlighten_hvm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}