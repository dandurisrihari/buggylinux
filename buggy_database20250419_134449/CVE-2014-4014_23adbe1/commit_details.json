{
  "hash": "23adbe12ef7d3d4195e80800ab36b37bee28cd03",
  "hash_short": "23adbe12",
  "subject": "fs,userns: Change inode_capable to capable_wrt_inode_uidgid",
  "body": "The kernel has no concept of capabilities with respect to inodes; inodes\nexist independently of namespaces.  For example, inode_capable(inode,\nCAP_LINUX_IMMUTABLE) would be nonsense.\n\nThis patch changes inode_capable to check for uid and gid mappings and\nrenames it to capable_wrt_inode_uidgid, which should make it more\nobvious what it does.\n\nFixes CVE-2014-4014.\n\nCc: Theodore Ts'o <tytso@mit.edu>\nCc: Serge Hallyn <serge.hallyn@ubuntu.com>\nCc: \"Eric W. Biederman\" <ebiederm@xmission.com>\nCc: Dave Chinner <david@fromorbit.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "fs,userns: Change inode_capable to capable_wrt_inode_uidgid\n\nThe kernel has no concept of capabilities with respect to inodes; inodes\nexist independently of namespaces.  For example, inode_capable(inode,\nCAP_LINUX_IMMUTABLE) would be nonsense.\n\nThis patch changes inode_capable to check for uid and gid mappings and\nrenames it to capable_wrt_inode_uidgid, which should make it more\nobvious what it does.\n\nFixes CVE-2014-4014.\n\nCc: Theodore Ts'o <tytso@mit.edu>\nCc: Serge Hallyn <serge.hallyn@ubuntu.com>\nCc: \"Eric W. Biederman\" <ebiederm@xmission.com>\nCc: Dave Chinner <david@fromorbit.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Andy Lutomirski",
  "author_email": "luto@amacapital.net",
  "author_date": "Tue Jun 10 12:45:42 2014 -0700",
  "author_date_iso": "2014-06-10T12:45:42-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Tue Jun 10 13:57:22 2014 -0700",
  "committer_date_iso": "2014-06-10T13:57:22-07:00",
  "files_changed": [
    "fs/attr.c",
    "fs/inode.c",
    "fs/namei.c",
    "fs/xfs/xfs_ioctl.c",
    "include/linux/capability.h",
    "kernel/capability.c"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "fs/attr.c",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "fs/inode.c",
      "insertions": 7,
      "deletions": 3
    },
    {
      "file": "fs/namei.c",
      "insertions": 6,
      "deletions": 5
    },
    {
      "file": "fs/xfs/xfs_ioctl.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/capability.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "kernel/capability.c",
      "insertions": 8,
      "deletions": 12
    }
  ],
  "total_insertions": 27,
  "total_deletions": 26,
  "total_changes": 53,
  "parents": [
    "5b174fd6472b1d6b6402b30210a212f3fd770d96"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.16",
    "v3.16-rc1",
    "v3.16-rc2",
    "v3.16-rc3",
    "v3.16-rc4",
    "v3.16-rc5",
    "v3.16-rc6",
    "v3.16-rc7",
    "v3.17",
    "v3.17-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2014-4014"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "fs/attr.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/xfs/xfs_ioctl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/namei.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/capability.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/capability.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}