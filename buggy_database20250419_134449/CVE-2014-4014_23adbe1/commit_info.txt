Commit Hash: 23adbe12ef7d3d4195e80800ab36b37bee28cd03
Subject: fs,userns: Change inode_capable to capable_wrt_inode_uidgid

CVE Identifiers:
- CVE-2014-4014

Full commit message:
fs,userns: Change inode_capable to capable_wrt_inode_uidgid

The kernel has no concept of capabilities with respect to inodes; inodes
exist independently of namespaces.  For example, inode_capable(inode,
CAP_LINUX_IMMUTABLE) would be nonsense.

This patch changes inode_capable to check for uid and gid mappings and
renames it to capable_wrt_inode_uidgid, which should make it more
obvious what it does.

Fixes CVE-2014-4014.

Cc: Theodore Ts'o <tytso@mit.edu>
Cc: Serge Hallyn <serge.hallyn@ubuntu.com>
Cc: "Eric W. Biederman" <ebiederm@xmission.com>
Cc: Dave Chinner <david@fromorbit.com>
Cc: stable@vger.kernel.org
Signed-off-by: Andy Lutomirski <luto@amacapital.net>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Andy Lutomirski <luto@amacapital.net>
Author Date: Tue Jun 10 12:45:42 2014 -0700
Committer: Linus Torvalds <torvalds@linux-foundation.org>
Commit Date: Tue Jun 10 13:57:22 2014 -0700

Files Changed: 6
Lines Added: 27
Lines Removed: 26
Total Changes: 53
