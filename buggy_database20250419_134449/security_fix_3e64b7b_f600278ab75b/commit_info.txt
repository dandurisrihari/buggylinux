Commit Hash: 3e64b7bd8234b459134b3059919828122e2fd79f
Subject: Bluetooth: Trigger SMP for the appropriate LE CoC errors


Security Keywords:
- authentication

Full commit message:
Bluetooth: Trigger SMP for the appropriate LE CoC errors

The insufficient authentication/encryption errors indicate to the L2CAP
client that it should try to elevate the security level. Since there
really isn't any exception to this rule it makes sense to fully handle
it on the kernel side instead of pushing the responsibility to user
space.

This patch adds special handling of these two error codes and calls
smp_conn_security() with the elevated security level if necessary.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Thu Nov 13 10:55:19 2014 +0200
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Sat Nov 15 01:46:50 2014 +0100

Files Changed: 1
Lines Added: 22
Lines Removed: 1
Total Changes: 23
