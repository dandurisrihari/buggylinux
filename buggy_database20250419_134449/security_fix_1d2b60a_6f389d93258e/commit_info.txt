Commit Hash: 1d2b60a5545942b1376cb48c1d55843d71e3a08f
Subject: iscsi-target: Reject mutual authentication with reflected CHAP_C


Security Keywords:
- authentication

Full commit message:
iscsi-target: Reject mutual authentication with reflected CHAP_C

This patch adds an explicit check in chap_server_compute_md5() to ensure
the CHAP_C value received from the initiator during mutual authentication
does not match the original CHAP_C provided by the target.

This is in line with RFC-3720, section 8.2.1:

   Originators MUST NOT reuse the CHAP challenge sent by the Responder
   for the other direction of a bidirectional authentication.
   Responders MUST check for this condition and close the iSCSI TCP
   connection if it occurs.

Reported-by: Tejas Vaykole <tejas.vaykole@calsoftinc.com>
Cc: stable@vger.kernel.org # 3.1+
Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>

Metadata:
Author: Nicholas Bellinger <nab@linux-iscsi.org>
Author Date: Thu Jun 5 18:08:57 2014 -0700
Committer: Nicholas Bellinger <nab@linux-iscsi.org>
Commit Date: Thu Jun 5 19:45:01 2014 -0700

Files Changed: 1
Lines Added: 10
Lines Removed: 0
Total Changes: 10
