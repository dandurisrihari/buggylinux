{
  "hash": "3b59df46a449ec9975146d71318c4777ad086744",
  "hash_short": "3b59df46",
  "subject": "xfrm: Workaround incompatibility of ESN and async crypto",
  "body": "ESN for esp is defined in RFC 4303. This RFC assumes that the\nsequence number counters are always up to date. However,\nthis is not true if an async crypto algorithm is employed.\n\nIf the sequence number counters are not up to date on sequence\nnumber check, we may incorrectly update the upper 32 bit of\nthe sequence number. This leads to a DOS.\n\nWe workaround this by comparing the upper sequence number,\n(used for authentication) with the upper sequence number\ncomputed after the async processing. We drop the packet\nif these numbers are different.\n\nTo do this, we introduce a recheck function that does this\ncheck in the ESN case.\n\nSigned-off-by: Steffen Klassert <steffen.klassert@secunet.com>\nAcked-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "xfrm: Workaround incompatibility of ESN and async crypto\n\nESN for esp is defined in RFC 4303. This RFC assumes that the\nsequence number counters are always up to date. However,\nthis is not true if an async crypto algorithm is employed.\n\nIf the sequence number counters are not up to date on sequence\nnumber check, we may incorrectly update the upper 32 bit of\nthe sequence number. This leads to a DOS.\n\nWe workaround this by comparing the upper sequence number,\n(used for authentication) with the upper sequence number\ncomputed after the async processing. We drop the packet\nif these numbers are different.\n\nTo do this, we introduce a recheck function that does this\ncheck in the ESN case.\n\nSigned-off-by: Steffen Klassert <steffen.klassert@secunet.com>\nAcked-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Steffen Klassert",
  "author_email": "steffen.klassert@secunet.com",
  "author_date": "Tue Sep 4 00:03:29 2012 +0000",
  "author_date_iso": "2012-09-04T00:03:29+00:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Sep 4 14:09:45 2012 -0400",
  "committer_date_iso": "2012-09-04T14:09:45-04:00",
  "files_changed": [
    "include/net/xfrm.h",
    "net/xfrm/xfrm_input.c",
    "net/xfrm/xfrm_replay.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "include/net/xfrm.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "net/xfrm/xfrm_input.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/xfrm/xfrm_replay.c",
      "insertions": 15,
      "deletions": 0
    }
  ],
  "total_insertions": 19,
  "total_deletions": 1,
  "total_changes": 20,
  "parents": [
    "37159ef2c1ae1e696b24b260b241209a19f92c60"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/xfrm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/xfrm/xfrm_input.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/xfrm/xfrm_replay.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}