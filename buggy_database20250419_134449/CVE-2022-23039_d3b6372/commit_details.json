{
  "hash": "d3b6372c5881cb54925212abb62c521df8ba4809",
  "hash_short": "d3b6372c",
  "subject": "xen/gntalloc: don't use gnttab_query_foreign_access()",
  "body": "Using gnttab_query_foreign_access() is unsafe, as it is racy by design.\n\nThe use case in the gntalloc driver is not needed at all. While at it\nreplace the call of gnttab_end_foreign_access_ref() with a call of\ngnttab_end_foreign_access(), which is what is really wanted there. In\ncase the grant wasn't used due to an allocation failure, just free the\ngrant via gnttab_free_grant_reference().\n\nThis is CVE-2022-23039 / part of XSA-396.\n\nReported-by: Demi Marie Obenour <demi@invisiblethingslab.com>\nSigned-off-by: Juergen Gross <jgross@suse.com>\nReviewed-by: Jan Beulich <jbeulich@suse.com>\n---\nV3:\n- fix __del_gref() (Jan Beulich)",
  "full_message": "xen/gntalloc: don't use gnttab_query_foreign_access()\n\nUsing gnttab_query_foreign_access() is unsafe, as it is racy by design.\n\nThe use case in the gntalloc driver is not needed at all. While at it\nreplace the call of gnttab_end_foreign_access_ref() with a call of\ngnttab_end_foreign_access(), which is what is really wanted there. In\ncase the grant wasn't used due to an allocation failure, just free the\ngrant via gnttab_free_grant_reference().\n\nThis is CVE-2022-23039 / part of XSA-396.\n\nReported-by: Demi Marie Obenour <demi@invisiblethingslab.com>\nSigned-off-by: Juergen Gross <jgross@suse.com>\nReviewed-by: Jan Beulich <jbeulich@suse.com>\n---\nV3:\n- fix __del_gref() (Jan Beulich)",
  "author_name": "Juergen Gross",
  "author_email": "jgross@suse.com",
  "author_date": "Mon Mar 7 09:48:54 2022 +0100",
  "author_date_iso": "2022-03-07T09:48:54+01:00",
  "committer_name": "Juergen Gross",
  "committer_email": "jgross@suse.com",
  "committer_date": "Mon Mar 7 09:48:54 2022 +0100",
  "committer_date_iso": "2022-03-07T09:48:54+01:00",
  "files_changed": [
    "drivers/xen/gntalloc.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/xen/gntalloc.c",
      "insertions": 7,
      "deletions": 18
    }
  ],
  "total_insertions": 7,
  "total_deletions": 18,
  "total_changes": 25,
  "parents": [
    "33172ab50a53578a95691310f49567c9266968b0"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-23039"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/xen/gntalloc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}