{
  "hash": "befaa609f4c784f505c02ea3ff036adf4f4aa814",
  "hash_short": "befaa609",
  "subject": "Merge tag 'hardening-v6.7-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux",
  "body": "Pull hardening updates from Kees Cook:\n \"One of the more voluminous set of changes is for adding the new\n  __counted_by annotation[1] to gain run-time bounds checking of\n  dynamically sized arrays with UBSan.\n\n   - Add LKDTM test for stuck CPUs (Mark Rutland)\n\n   - Improve LKDTM selftest behavior under UBSan (Ricardo Ca\u00f1uelo)\n\n   - Refactor more 1-element arrays into flexible arrays (Gustavo A. R.\n     Silva)\n\n   - Analyze and replace strlcpy and strncpy uses (Justin Stitt, Azeem\n     Shaikh)\n\n   - Convert group_info.usage to refcount_t (Elena Reshetova)\n\n   - Add __counted_by annotations (Kees Cook, Gustavo A. R. Silva)\n\n   - Add Kconfig fragment for basic hardening options (Kees Cook, Lukas\n     Bulwahn)\n\n   - Fix randstruct GCC plugin performance mode to stay in groups (Kees\n     Cook)\n\n   - Fix strtomem() compile-time check for small sources (Kees Cook)\"\n\n* tag 'hardening-v6.7-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux: (56 commits)\n  hwmon: (acpi_power_meter) replace open-coded kmemdup_nul\n  reset: Annotate struct reset_control_array with __counted_by\n  kexec: Annotate struct crash_mem with __counted_by\n  virtio_console: Annotate struct port_buffer with __counted_by\n  ima: Add __counted_by for struct modsig and use struct_size()\n  MAINTAINERS: Include stackleak paths in hardening entry\n  string: Adjust strtomem() logic to allow for smaller sources\n  hardening: x86: drop reference to removed config AMD_IOMMU_V2\n  randstruct: Fix gcc-plugin performance mode to stay in group\n  mailbox: zynqmp: Annotate struct zynqmp_ipi_pdata with __counted_by\n  drivers: thermal: tsens: Annotate struct tsens_priv with __counted_by\n  irqchip/imx-intmux: Annotate struct intmux_data with __counted_by\n  KVM: Annotate struct kvm_irq_routing_table with __counted_by\n  virt: acrn: Annotate struct vm_memory_region_batch with __counted_by\n  hwmon: Annotate struct gsc_hwmon_platform_data with __counted_by\n  sparc: Annotate struct cpuinfo_tree with __counted_by\n  isdn: kcapi: replace deprecated strncpy with strscpy_pad\n  isdn: replace deprecated strncpy with strscpy\n  NFS/flexfiles: Annotate struct nfs4_ff_layout_segment with __counted_by\n  nfs41: Annotate struct nfs4_file_layout_dsaddr with __counted_by\n  ...",
  "full_message": "Merge tag 'hardening-v6.7-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux\n\nPull hardening updates from Kees Cook:\n \"One of the more voluminous set of changes is for adding the new\n  __counted_by annotation[1] to gain run-time bounds checking of\n  dynamically sized arrays with UBSan.\n\n   - Add LKDTM test for stuck CPUs (Mark Rutland)\n\n   - Improve LKDTM selftest behavior under UBSan (Ricardo Ca\u00f1uelo)\n\n   - Refactor more 1-element arrays into flexible arrays (Gustavo A. R.\n     Silva)\n\n   - Analyze and replace strlcpy and strncpy uses (Justin Stitt, Azeem\n     Shaikh)\n\n   - Convert group_info.usage to refcount_t (Elena Reshetova)\n\n   - Add __counted_by annotations (Kees Cook, Gustavo A. R. Silva)\n\n   - Add Kconfig fragment for basic hardening options (Kees Cook, Lukas\n     Bulwahn)\n\n   - Fix randstruct GCC plugin performance mode to stay in groups (Kees\n     Cook)\n\n   - Fix strtomem() compile-time check for small sources (Kees Cook)\"\n\n* tag 'hardening-v6.7-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux: (56 commits)\n  hwmon: (acpi_power_meter) replace open-coded kmemdup_nul\n  reset: Annotate struct reset_control_array with __counted_by\n  kexec: Annotate struct crash_mem with __counted_by\n  virtio_console: Annotate struct port_buffer with __counted_by\n  ima: Add __counted_by for struct modsig and use struct_size()\n  MAINTAINERS: Include stackleak paths in hardening entry\n  string: Adjust strtomem() logic to allow for smaller sources\n  hardening: x86: drop reference to removed config AMD_IOMMU_V2\n  randstruct: Fix gcc-plugin performance mode to stay in group\n  mailbox: zynqmp: Annotate struct zynqmp_ipi_pdata with __counted_by\n  drivers: thermal: tsens: Annotate struct tsens_priv with __counted_by\n  irqchip/imx-intmux: Annotate struct intmux_data with __counted_by\n  KVM: Annotate struct kvm_irq_routing_table with __counted_by\n  virt: acrn: Annotate struct vm_memory_region_batch with __counted_by\n  hwmon: Annotate struct gsc_hwmon_platform_data with __counted_by\n  sparc: Annotate struct cpuinfo_tree with __counted_by\n  isdn: kcapi: replace deprecated strncpy with strscpy_pad\n  isdn: replace deprecated strncpy with strscpy\n  NFS/flexfiles: Annotate struct nfs4_ff_layout_segment with __counted_by\n  nfs41: Annotate struct nfs4_file_layout_dsaddr with __counted_by\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Mon Oct 30 19:09:55 2023 -1000",
  "author_date_iso": "2023-10-30T19:09:55-10:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Mon Oct 30 19:09:55 2023 -1000",
  "committer_date_iso": "2023-10-30T19:09:55-10:00",
  "files_changed": [
    "MAINTAINERS",
    "drivers/block/drbd/drbd_int.h",
    "drivers/md/dm-crypt.c",
    "drivers/usb/gadget/function/f_fs.c",
    "drivers/usb/host/xhci.h",
    "fs/afs/internal.h"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "MAINTAINERS",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "arch/arm/configs/hardening.config",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "arch/arm64/configs/hardening.config",
      "insertions": 22,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/configs/hardening.config",
      "insertions": 10,
      "deletions": 0
    },
    {
      "file": "arch/sparc/kernel/cpumap.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/um/os-Linux/drivers/ethertap_user.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/x86/configs/hardening.config",
      "insertions": 14,
      "deletions": 0
    },
    {
      "file": "drivers/accel/ivpu/ivpu_job.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/auxdisplay/panel.c",
      "insertions": 3,
      "deletions": 4
    },
    {
      "file": "drivers/block/drbd/drbd_int.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/bus/fsl-mc/dprc.c",
      "insertions": 4,
      "deletions": 8
    },
    {
      "file": "drivers/char/virtio_console.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/cpufreq/cpufreq.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/cpuidle/dt_idle_states.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/edac/edac_mc_sysfs.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/firmware/tegra/bpmp-debugfs.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/gud/gud_pipe.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/nouveau/nouveau_svm.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/hid/hid-prodikeys.c",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "drivers/hwmon/acpi_power_meter.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "drivers/hwmon/asus_wmi_sensors.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/hwmon/ibmpowernv.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/irqchip/irq-imx-intmux.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/isdn/capi/kcapi.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/isdn/mISDN/clock.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/mailbox/zynqmp-ipi-mailbox.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/md/dm-bio-prison-v1.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/md/dm-crypt.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/md/dm-raid.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/md/dm-stats.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/md/dm-stripe.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/misc/lkdtm/bugs.c",
      "insertions": 29,
      "deletions": 1
    },
    {
      "file": "drivers/reset/core.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/thermal/qcom/tsens.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/usb/atm/usbatm.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/usb/gadget/function/f_fs.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/usb/gadget/function/f_midi.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/usb/host/ohci.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/usb/host/xhci.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/virt/acrn/acrn_drv.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/virt/acrn/mm.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/afs/internal.h",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "fs/nfs/filelayout/filelayout.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/nfs/flexfilelayout/flexfilelayout.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/ocfs2/slot_map.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/ceph/osd_client.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/crash_core.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/cred.h",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "include/linux/kvm_host.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/platform_data/gsc_hwmon.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/string.h",
      "insertions": 5,
      "deletions": 2
    },
    {
      "file": "init/version.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "kernel/configs/hardening.config",
      "insertions": 98,
      "deletions": 0
    },
    {
      "file": "kernel/cred.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "kernel/groups.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "lib/kobject_uevent.c",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "scripts/gcc-plugins/randomize_layout_plugin.c",
      "insertions": 8,
      "deletions": 3
    },
    {
      "file": "security/integrity/ima/ima_modsig.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "tools/testing/selftests/lkdtm/config",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "tools/testing/selftests/lkdtm/tests.txt",
      "insertions": 2,
      "deletions": 1
    }
  ],
  "total_insertions": 280,
  "total_deletions": 90,
  "total_changes": 370,
  "parents": [
    "fdce8bd38037a4a2b2961ca4abffaab195690b30",
    "9cca73d7b4bfec75b2fcef751015f31691afa792"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/block/drbd/drbd_int.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/md/dm-crypt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/usb/gadget/function/f_fs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/internal.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/usb/host/xhci.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "MAINTAINERS",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}