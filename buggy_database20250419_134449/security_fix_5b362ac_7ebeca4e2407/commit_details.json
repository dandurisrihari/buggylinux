{
  "hash": "5b362ac3799ff4225c40935500f520cad4d7ed66",
  "hash_short": "5b362ac3",
  "subject": "NFS: Fix panic after nfs_umount()",
  "body": "After a few unsuccessful NFS mount attempts in which the client and\nserver cannot agree on an authentication flavor both support, the\nclient panics.  nfs_umount() is invoked in the kernel in this case.\n\nTurns out nfs_umount()'s UMNT RPC invocation causes the RPC client to\nwrite off the end of the rpc_clnt's iostat array.  This is because the\nmount client's nrprocs field is initialized with the count of defined\nprocedures (two: MNT and UMNT), rather than the size of the client's\nproc array (four).\n\nThe fix is to use the same initialization technique used by most other\nupper layer clients in the kernel.\n\nIntroduced by commit 0b524123, which failed to update nrprocs when\nsupport was added for UMNT in the kernel.\n\nBugLink: https://bugzilla.kernel.org/show_bug.cgi?id=24302\nBugLink: http://bugs.launchpad.net/bugs/683938\n\nReported-by: Stefan Bader <stefan.bader@canonical.com>\nTested-by: Stefan Bader <stefan.bader@canonical.com>\nCc: stable@kernel.org # >= 2.6.32\nSigned-off-by: Chuck Lever <chuck.lever@oracle.com>\nSigned-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>",
  "full_message": "NFS: Fix panic after nfs_umount()\n\nAfter a few unsuccessful NFS mount attempts in which the client and\nserver cannot agree on an authentication flavor both support, the\nclient panics.  nfs_umount() is invoked in the kernel in this case.\n\nTurns out nfs_umount()'s UMNT RPC invocation causes the RPC client to\nwrite off the end of the rpc_clnt's iostat array.  This is because the\nmount client's nrprocs field is initialized with the count of defined\nprocedures (two: MNT and UMNT), rather than the size of the client's\nproc array (four).\n\nThe fix is to use the same initialization technique used by most other\nupper layer clients in the kernel.\n\nIntroduced by commit 0b524123, which failed to update nrprocs when\nsupport was added for UMNT in the kernel.\n\nBugLink: https://bugzilla.kernel.org/show_bug.cgi?id=24302\nBugLink: http://bugs.launchpad.net/bugs/683938\n\nReported-by: Stefan Bader <stefan.bader@canonical.com>\nTested-by: Stefan Bader <stefan.bader@canonical.com>\nCc: stable@kernel.org # >= 2.6.32\nSigned-off-by: Chuck Lever <chuck.lever@oracle.com>\nSigned-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>",
  "author_name": "Chuck Lever",
  "author_email": "chuck.lever@oracle.com",
  "author_date": "Fri Dec 10 12:31:14 2010 -0500",
  "author_date_iso": "2010-12-10T12:31:14-05:00",
  "committer_name": "Trond Myklebust",
  "committer_email": "Trond.Myklebust@netapp.com",
  "committer_date": "Fri Dec 10 13:01:50 2010 -0500",
  "committer_date_iso": "2010-12-10T13:01:50-05:00",
  "files_changed": [
    "fs/nfs/mount_clnt.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/nfs/mount_clnt.c",
      "insertions": 2,
      "deletions": 2
    }
  ],
  "total_insertions": 2,
  "total_deletions": 2,
  "total_changes": 4,
  "parents": [
    "2df485a774ba59c3f43bfe84107672c1d9b731a0"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.37",
    "v2.6.37-rc6",
    "v2.6.37-rc7",
    "v2.6.37-rc8",
    "v2.6.38",
    "v2.6.38-rc1",
    "v2.6.38-rc2",
    "v2.6.38-rc3",
    "v2.6.38-rc4",
    "v2.6.38-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/nfs/mount_clnt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}