{
  "hash": "250c6c49e3b68756b14983c076183568636e2bde",
  "hash_short": "250c6c49",
  "subject": "fbdev: Fixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in sbusfb_ioctl_helper().",
  "body": "Fixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in\nsbusfb_ioctl_helper().\n\n'index' is defined as an int in sbusfb_ioctl_helper().\nWe retrieve this from the user:\nif (get_user(index, &c->index) ||\n    __get_user(count, &c->count) ||\n    __get_user(ured, &c->red) ||\n    __get_user(ugreen, &c->green) ||\n    __get_user(ublue, &c->blue))\n       return -EFAULT;\n\nand then we use 'index' in the following way:\nred = cmap->red[index + i] >> 8;\ngreen = cmap->green[index + i] >> 8;\nblue = cmap->blue[index + i] >> 8;\n\nThis is a classic information leak vulnerability. 'index' should be\nan unsigned int, given its usage above.\n\nThis patch is straight-forward; it changes 'index' to unsigned int\nin two switch-cases: FBIOGETCMAP_SPARC && FBIOPUTCMAP_SPARC.\n\nThis patch fixes CVE-2018-6412.\n\nSigned-off-by: Peter Malone <peter.malone@gmail.com>\nAcked-by: Mathieu Malaterre <malat@debian.org>\nSigned-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>",
  "full_message": "fbdev: Fixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in sbusfb_ioctl_helper().\n\nFixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in\nsbusfb_ioctl_helper().\n\n'index' is defined as an int in sbusfb_ioctl_helper().\nWe retrieve this from the user:\nif (get_user(index, &c->index) ||\n    __get_user(count, &c->count) ||\n    __get_user(ured, &c->red) ||\n    __get_user(ugreen, &c->green) ||\n    __get_user(ublue, &c->blue))\n       return -EFAULT;\n\nand then we use 'index' in the following way:\nred = cmap->red[index + i] >> 8;\ngreen = cmap->green[index + i] >> 8;\nblue = cmap->blue[index + i] >> 8;\n\nThis is a classic information leak vulnerability. 'index' should be\nan unsigned int, given its usage above.\n\nThis patch is straight-forward; it changes 'index' to unsigned int\nin two switch-cases: FBIOGETCMAP_SPARC && FBIOPUTCMAP_SPARC.\n\nThis patch fixes CVE-2018-6412.\n\nSigned-off-by: Peter Malone <peter.malone@gmail.com>\nAcked-by: Mathieu Malaterre <malat@debian.org>\nSigned-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>",
  "author_name": "Peter Malone",
  "author_email": "peter.malone@gmail.com",
  "author_date": "Wed Mar 7 14:00:34 2018 +0100",
  "author_date_iso": "2018-03-07T14:00:34+01:00",
  "committer_name": "Bartlomiej Zolnierkiewicz",
  "committer_email": "b.zolnierkie@samsung.com",
  "committer_date": "Wed Mar 7 14:00:34 2018 +0100",
  "committer_date_iso": "2018-03-07T14:00:34+01:00",
  "files_changed": [
    "drivers/video/fbdev/sbuslib.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/video/fbdev/sbuslib.c",
      "insertions": 2,
      "deletions": 2
    }
  ],
  "total_insertions": 2,
  "total_deletions": 2,
  "total_changes": 4,
  "parents": [
    "5fe9cfbe44b6892e17f803125c4761221b0175c6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.16-rc5",
    "v4.16-rc6",
    "v4.16-rc7",
    "v4.17",
    "v4.17-rc1",
    "v4.17-rc2",
    "v4.17-rc3",
    "v4.17-rc4",
    "v4.17-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2018-6412"
    ],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/video/fbdev/sbuslib.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}