commit 7f6240858cf3abb75237c9ba63ec70d232573ae8
Author: Srinivas Ramana <quic_sramana@quicinc.com>
Date:   Mon Feb 8 09:57:30 2021 +0000

    arm64: Defer enabling pointer authentication on boot core
    
    Defer enabling pointer authentication on boot core until
    after its required to be enabled by cpufeature framework.
    This will help in controlling the feature dynamically
    with a boot parameter.
    
    Signed-off-by: Ajay Patil <pajay@qti.qualcomm.com>
    Signed-off-by: Prasad Sodagudi <psodagud@codeaurora.org>
    Signed-off-by: Srinivas Ramana <sramana@codeaurora.org>
    Signed-off-by: Marc Zyngier <maz@kernel.org>
    Link: https://lore.kernel.org/r/1610152163-16554-2-git-send-email-sramana@codeaurora.org
    Reviewed-by: Catalin Marinas <catalin.marinas@arm.com>
    Acked-by: David Brazdil <dbrazdil@google.com>
    Link: https://lore.kernel.org/r/20210208095732.3267263-22-maz@kernel.org
    Signed-off-by: Will Deacon <will@kernel.org>

diff --git a/arch/arm64/include/asm/stackprotector.h b/arch/arm64/include/asm/stackprotector.h
index 7263e0bac680..33f1bb453150 100644
--- a/arch/arm64/include/asm/stackprotector.h
+++ b/arch/arm64/include/asm/stackprotector.h
@@ -41,6 +41,7 @@ static __always_inline void boot_init_stack_canary(void)
 #endif
 	ptrauth_thread_init_kernel(current);
 	ptrauth_thread_switch_kernel(current);
+	ptrauth_enable();
 }
 
 #endif	/* _ASM_STACKPROTECTOR_H */