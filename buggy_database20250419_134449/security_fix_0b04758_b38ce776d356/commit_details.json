{
  "hash": "0b04758b002bde9434053be2fff8064ac3d9d8bb",
  "hash_short": "0b04758b",
  "subject": "irqchip/gic-v3: Use SGIs without active state if offered",
  "body": "To allow the direct injection of SGIs into a guest, the GICv4.1\narchitecture has to sacrifice the Active state so that SGIs look\na lot like LPIs (they are injected by the same mechanism).\n\nIn order not to break existing software, the architecture gives\noffers guests OSs the choice: SGIs with or without an active\nstate. It is the hypervisors duty to honor the guest's choice.\n\nFor this, the architecture offers a discovery bit indicating whether\nthe GIC supports GICv4.1 SGIs (GICD_TYPER2.nASSGIcap), and another\nbit indicating whether the guest wants Active-less SGIs or not\n(controlled by GICD_CTLR.nASSGIreq).\n\nA hypervisor not supporting GICv4.1 SGIs would leave nASSGIcap\nclear, and a guest not knowing about GICv4.1 SGIs (or definitely\nwanting an Active state) would leave nASSGIreq clear (both being\nthankfully backward compatible with older revisions of the GIC).\n\nSince Linux is perfectly happy without an active state on SGIs,\ninform the hypervisor that we'll use that if offered.\n\nSigned-off-by: Marc Zyngier <maz@kernel.org>\nReviewed-by: Zenghui Yu <yuzenghui@huawei.com>\nLink: https://lore.kernel.org/r/20200304203330.4967-2-maz@kernel.org",
  "full_message": "irqchip/gic-v3: Use SGIs without active state if offered\n\nTo allow the direct injection of SGIs into a guest, the GICv4.1\narchitecture has to sacrifice the Active state so that SGIs look\na lot like LPIs (they are injected by the same mechanism).\n\nIn order not to break existing software, the architecture gives\noffers guests OSs the choice: SGIs with or without an active\nstate. It is the hypervisors duty to honor the guest's choice.\n\nFor this, the architecture offers a discovery bit indicating whether\nthe GIC supports GICv4.1 SGIs (GICD_TYPER2.nASSGIcap), and another\nbit indicating whether the guest wants Active-less SGIs or not\n(controlled by GICD_CTLR.nASSGIreq).\n\nA hypervisor not supporting GICv4.1 SGIs would leave nASSGIcap\nclear, and a guest not knowing about GICv4.1 SGIs (or definitely\nwanting an Active state) would leave nASSGIreq clear (both being\nthankfully backward compatible with older revisions of the GIC).\n\nSince Linux is perfectly happy without an active state on SGIs,\ninform the hypervisor that we'll use that if offered.\n\nSigned-off-by: Marc Zyngier <maz@kernel.org>\nReviewed-by: Zenghui Yu <yuzenghui@huawei.com>\nLink: https://lore.kernel.org/r/20200304203330.4967-2-maz@kernel.org",
  "author_name": "Marc Zyngier",
  "author_email": "maz@kernel.org",
  "author_date": "Wed Mar 4 20:33:08 2020 +0000",
  "author_date_iso": "2020-03-04T20:33:08+00:00",
  "committer_name": "Marc Zyngier",
  "committer_email": "maz@kernel.org",
  "committer_date": "Thu Mar 19 11:11:21 2020 +0000",
  "committer_date_iso": "2020-03-19T11:11:21+00:00",
  "files_changed": [
    "drivers/irqchip/irq-gic-v3.c",
    "include/linux/irqchip/arm-gic-v3.h"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "drivers/irqchip/irq-gic-v3.c",
      "insertions": 8,
      "deletions": 2
    },
    {
      "file": "include/linux/irqchip/arm-gic-v3.h",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 10,
  "total_deletions": 2,
  "total_changes": 12,
  "parents": [
    "98d54f81e36ba3bf92172791eba5ca5bd813989b"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.7-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/irqchip/irq-gic-v3.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/irqchip/arm-gic-v3.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}