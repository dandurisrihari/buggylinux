{
  "hash": "b7d05bad1c10a363b6b99f66ac1fa76b6892e618",
  "hash_short": "b7d05bad",
  "subject": "Bluetooth: Fix l2cap conn failures for ssp devices",
  "body": "Commit 330605423c fixed l2cap conn establishment for non-ssp remote\ndevices by not setting HCI_CONN_ENCRYPT_PEND every time conn security\nis tested (which was always returning failure on any subsequent\nsecurity checks).\n\nHowever, this broke l2cap conn establishment for ssp remote devices\nwhen an ACL link was already established at SDP-level security. This\nfix ensures that encryption must be pending whenever authentication\nis also pending.\n\nSigned-off-by: Peter Hurley <peter@hurleysoftware.com>\nTested-by: Daniel Wagner <daniel.wagner@bmw-carit.de>\nAcked-by: Marcel Holtmann <marcel@holtmann.org>\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>",
  "full_message": "Bluetooth: Fix l2cap conn failures for ssp devices\n\nCommit 330605423c fixed l2cap conn establishment for non-ssp remote\ndevices by not setting HCI_CONN_ENCRYPT_PEND every time conn security\nis tested (which was always returning failure on any subsequent\nsecurity checks).\n\nHowever, this broke l2cap conn establishment for ssp remote devices\nwhen an ACL link was already established at SDP-level security. This\nfix ensures that encryption must be pending whenever authentication\nis also pending.\n\nSigned-off-by: Peter Hurley <peter@hurleysoftware.com>\nTested-by: Daniel Wagner <daniel.wagner@bmw-carit.de>\nAcked-by: Marcel Holtmann <marcel@holtmann.org>\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>",
  "author_name": "Peter Hurley",
  "author_email": "peter@hurleysoftware.com",
  "author_date": "Fri Jan 13 15:11:30 2012 +0100",
  "author_date_iso": "2012-01-13T15:11:30+01:00",
  "committer_name": "Johan Hedberg",
  "committer_email": "johan.hedberg@intel.com",
  "committer_date": "Mon Feb 13 17:01:31 2012 +0200",
  "committer_date_iso": "2012-02-13T17:01:31+02:00",
  "files_changed": [
    "net/bluetooth/hci_conn.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 4,
      "deletions": 0
    }
  ],
  "total_insertions": 4,
  "total_deletions": 0,
  "total_changes": 4,
  "parents": [
    "9ef866adf9602238c2e83e951a72a1037d4179de"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}