{
  "hash": "a45d5cf09d49ed46c1cf1150ed5a891878a161f3",
  "hash_short": "a45d5cf0",
  "subject": "accel/habanalabs: refactor deprecated strncpy to strscpy_pad",
  "body": "`strncpy` is deprecated for use on NUL-terminated destination strings [1].\n\nWe see that `prop->cpucp_info.card_name` is supposed to be\nNUL-terminated based on its usage within `__hwmon_device_register()`\n(wherein it's called \"name\"):\n|\tif (name && (!strlen(name) || strpbrk(name, \"-* \\t\\n\")))\n|\t\tdev_warn(dev,\n|\t\t\t \"hwmon: '%s' is not a valid name attribute, please fix\\n\",\n|\t\t\t name);\n\nA suitable replacement is `strscpy_pad` [2] due to the fact that it\nguarantees both NUL-termination and NUL-padding on its destination\nbuffer.\n\nNUL-padding on `prop->cpucp_info.card_name` is not strictly necessary as\n`hdev->prop` is explicitly zero-initialized but should be used\nregardless as it gets copied out to userspace directly -- as per Kees'\nsuggestion.\n\nLink: https://www.kernel.org/doc/html/latest/process/deprecated.html#strncpy-on-nul-terminated-strings [1]\nLink: https://manpages.debian.org/testing/linux-manual-4.8/strscpy.9.en.html [2]\nLink: https://github.com/KSPP/linux/issues/90\nCc: linux-hardening@vger.kernel.org\nSigned-off-by: Justin Stitt <justinstitt@google.com>\nSuggested-by: Kees Cook <keescook@chromium.org>\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Oded Gabbay <ogabbay@kernel.org>",
  "full_message": "accel/habanalabs: refactor deprecated strncpy to strscpy_pad\n\n`strncpy` is deprecated for use on NUL-terminated destination strings [1].\n\nWe see that `prop->cpucp_info.card_name` is supposed to be\nNUL-terminated based on its usage within `__hwmon_device_register()`\n(wherein it's called \"name\"):\n|\tif (name && (!strlen(name) || strpbrk(name, \"-* \\t\\n\")))\n|\t\tdev_warn(dev,\n|\t\t\t \"hwmon: '%s' is not a valid name attribute, please fix\\n\",\n|\t\t\t name);\n\nA suitable replacement is `strscpy_pad` [2] due to the fact that it\nguarantees both NUL-termination and NUL-padding on its destination\nbuffer.\n\nNUL-padding on `prop->cpucp_info.card_name` is not strictly necessary as\n`hdev->prop` is explicitly zero-initialized but should be used\nregardless as it gets copied out to userspace directly -- as per Kees'\nsuggestion.\n\nLink: https://www.kernel.org/doc/html/latest/process/deprecated.html#strncpy-on-nul-terminated-strings [1]\nLink: https://manpages.debian.org/testing/linux-manual-4.8/strscpy.9.en.html [2]\nLink: https://github.com/KSPP/linux/issues/90\nCc: linux-hardening@vger.kernel.org\nSigned-off-by: Justin Stitt <justinstitt@google.com>\nSuggested-by: Kees Cook <keescook@chromium.org>\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Oded Gabbay <ogabbay@kernel.org>",
  "author_name": "Justin Stitt",
  "author_email": "justinstitt@google.com",
  "author_date": "Fri Aug 25 22:09:51 2023 +0000",
  "author_date_iso": "2023-08-25T22:09:51+00:00",
  "committer_name": "Oded Gabbay",
  "committer_email": "ogabbay@kernel.org",
  "committer_date": "Mon Oct 9 12:37:20 2023 +0300",
  "committer_date_iso": "2023-10-09T12:37:20+03:00",
  "files_changed": [
    "drivers/accel/habanalabs/gaudi/gaudi.c",
    "drivers/accel/habanalabs/gaudi2/gaudi2.c",
    "drivers/accel/habanalabs/goya/goya.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "drivers/accel/habanalabs/gaudi/gaudi.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/accel/habanalabs/gaudi2/gaudi2.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/accel/habanalabs/goya/goya.c",
      "insertions": 2,
      "deletions": 2
    }
  ],
  "total_insertions": 7,
  "total_deletions": 6,
  "total_changes": 13,
  "parents": [
    "428f6882a6f9fc0521eb2dca5293436d5a041ff3"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/accel/habanalabs/gaudi/gaudi.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/accel/habanalabs/gaudi2/gaudi2.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/accel/habanalabs/goya/goya.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}