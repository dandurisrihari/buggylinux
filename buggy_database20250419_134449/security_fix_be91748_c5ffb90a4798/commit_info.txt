Commit Hash: be91748fa6ca6909853c3dc630d65e45084962d7
Subject: mm/hwpoison: fix refcount of THP head page in no-injection case


Security Keywords:
- injection

Full commit message:
mm/hwpoison: fix refcount of THP head page in no-injection case

Hwpoison injection takes a refcount of target page and another refcount
of head page of THP if the target page is the tail page of a THP.
However, current code doesn't release the refcount of head page if the
THP is not supported to be injected wrt hwpoison filter.

Fix it by reducing the refcount of head page if the target page is the
tail page of a THP and it is not supported to be injected.

Signed-off-by: Wanpeng Li <wanpeng.li@hotmail.com>
Acked-by: Naoya Horiguchi <n-horiguchi@ah.jp.nec.com>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Wanpeng Li <wanpeng.li@hotmail.com>
Author Date: Tue Sep 8 15:03:18 2015 -0700
Committer: Linus Torvalds <torvalds@linux-foundation.org>
Commit Date: Tue Sep 8 15:35:28 2015 -0700

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
