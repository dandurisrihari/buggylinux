{
  "hash": "01a1a3cc1e3fbe718bd06a2a5d4d1a2d0fb4d7d9",
  "hash_short": "01a1a3cc",
  "subject": "V4L/DVB (9624): CVE-2008-5033: fix OOPS on tvaudio when controlling bass/treble",
  "body": "This bug were supposed to be fixed by 5ba2f67afb02c5302b2898949ed6fc3b3d37dcf1,\nwhere a call to NULL happens.\n\nNot all tvaudio chips allow controlling bass/treble. So, the driver\nhas a table with a flag to indicate if the chip does support it.\n\nUnfortunately, the handling of this logic were broken for a very long\ntime (probably since the first module version). Due to that, an OOPS\nwere generated for devices that don't support bass/treble.\n\nThis were the resulting OOPS message before the patch, with debug messages\nenabled:\n\ntvaudio' 1-005b: VIDIOC_S_CTRL\nBUG: unable to handle kernel NULL pointer dereference at 00000000\nIP: [<00000000>]\n*pde = 22fda067 *pte = 00000000\nOops: 0000 [#1] SMP\nModules linked in: snd_hda_intel snd_seq_dummy snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device\nsnd_pcm_oss snd_mixer_oss snd_pcm snd_timer snd_hwdep snd soundcore tuner_simple tuner_types tea5767 tuner\ntvaudio bttv bridgebnep rfcomm l2cap bluetooth it87 hwmon_vid hwmon fuse sunrpc ipt_REJECT\nnf_conntrack_ipv4 iptable_filter ip_tables ip6t_REJECT xt_tcpudp nf_conntrack_ipv6 xt_state nf_conntrack\nip6table_filter ip6_tables x_tables ipv6 dm_mirrordm_multipath dm_mod configfs videodev v4l1_compat\nir_common 8139cp compat_ioctl32 v4l2_common 8139too videobuf_dma_sg videobuf_core mii btcx_risc tveeprom\ni915 button snd_page_alloc serio_raw drm pcspkr i2c_algo_bit i2c_i801 i2c_core iTCO_wdt\niTCO_vendor_support sr_mod cdrom sg ata_generic pata_acpi ata_piix libata sd_mod scsi_mod ext3 jbdmbcache\nuhci_hcd ohci_hcd ehci_hcd [last unloaded: soundcore]\n\nPid: 15413, comm: qv4l2 Not tainted (2.6.25.14-108.fc9.i686 #1)\nEIP: 0060:[<00000000>] EFLAGS: 00210246 CPU: 0\nEIP is at 0x0\nEAX: 00008000 EBX: ebd21600 ECX: e2fd9ec4 EDX: 00200046\nESI: f8c0f0c4 EDI: f8c0f0c4 EBP: e2fd9d50 ESP: e2fd9d2c\n DS: 007b ES: 007b FS: 00d8 GS: 0033 SS: 0068\nProcess qv4l2 (pid: 15413, ti=e2fd9000 task=ebe44000 task.ti=e2fd9000)\nStack: f8c0c6ae e2ff2a00 00000d00 e2fd9ec4 ebc4e000 e2fd9d5c f8c0c448 00000000\n       f899c12a e2fd9d5c f899c154 e2fd9d68 e2fd9d80 c0560185 e2fd9d88 f8f3e1d8\n       f8f3e1dc ebc4e034 f8f3e18c e2fd9ec4 00000000 e2fd9d90 f899c286 c008561c\nCall Trace:\n [<f8c0c6ae>] ? chip_command+0x266/0x4b6 [tvaudio]\n [<f8c0c448>] ? chip_command+0x0/0x4b6 [tvaudio]\n [<f899c12a>] ? i2c_cmd+0x0/0x2f [i2c_core]\n [<f899c154>] ? i2c_cmd+0x2a/0x2f [i2c_core]\n [<c0560185>] ? device_for_each_child+0x21/0x49\n [<f899c286>] ? i2c_clients_command+0x1c/0x1e [i2c_core]\n [<f8f283d8>] ? bttv_call_i2c_clients+0x14/0x16 [bttv]\n [<f8f23601>] ? bttv_s_ctrl+0x1bc/0x313 [bttv]\n [<f8f23445>] ? bttv_s_ctrl+0x0/0x313 [bttv]\n [<f8b6096d>] ? __video_do_ioctl+0x1f84/0x3726 [videodev]\n [<c05abb4e>] ? sock_aio_write+0x100/0x10d\n [<c041b23e>] ? kmap_atomic_prot+0x1dd/0x1df\n [<c043a0c9>] ? enqueue_hrtimer+0xc2/0xcd\n [<c04f4fa4>] ? copy_from_user+0x39/0x121\n [<f8b622b9>] ? __video_ioctl2+0x1aa/0x24a [videodev]\n [<c04054fd>] ? do_notify_resume+0x768/0x795\n [<c043c0f7>] ? getnstimeofday+0x34/0xd1\n [<c0437b77>] ? autoremove_wake_function+0x0/0x33\n [<f8b62368>] ? video_ioctl2+0xf/0x13 [videodev]\n [<c048c6f0>] ? vfs_ioctl+0x50/0x69\n [<c048c942>] ? do_vfs_ioctl+0x239/0x24c\n [<c048c995>] ? sys_ioctl+0x40/0x5b\n [<c0405bf2>] ? syscall_call+0x7/0xb\n [<c0620000>] ? cpuid4_cache_sysfs_exit+0x3d/0x69\n =======================\nCode:  Bad EIP value.\nEIP: [<00000000>] 0x0 SS:ESP 0068:e2fd9d2c\n\nSigned-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>",
  "full_message": "V4L/DVB (9624): CVE-2008-5033: fix OOPS on tvaudio when controlling bass/treble\n\nThis bug were supposed to be fixed by 5ba2f67afb02c5302b2898949ed6fc3b3d37dcf1,\nwhere a call to NULL happens.\n\nNot all tvaudio chips allow controlling bass/treble. So, the driver\nhas a table with a flag to indicate if the chip does support it.\n\nUnfortunately, the handling of this logic were broken for a very long\ntime (probably since the first module version). Due to that, an OOPS\nwere generated for devices that don't support bass/treble.\n\nThis were the resulting OOPS message before the patch, with debug messages\nenabled:\n\ntvaudio' 1-005b: VIDIOC_S_CTRL\nBUG: unable to handle kernel NULL pointer dereference at 00000000\nIP: [<00000000>]\n*pde = 22fda067 *pte = 00000000\nOops: 0000 [#1] SMP\nModules linked in: snd_hda_intel snd_seq_dummy snd_seq_oss snd_seq_midi_event snd_seq snd_seq_device\nsnd_pcm_oss snd_mixer_oss snd_pcm snd_timer snd_hwdep snd soundcore tuner_simple tuner_types tea5767 tuner\ntvaudio bttv bridgebnep rfcomm l2cap bluetooth it87 hwmon_vid hwmon fuse sunrpc ipt_REJECT\nnf_conntrack_ipv4 iptable_filter ip_tables ip6t_REJECT xt_tcpudp nf_conntrack_ipv6 xt_state nf_conntrack\nip6table_filter ip6_tables x_tables ipv6 dm_mirrordm_multipath dm_mod configfs videodev v4l1_compat\nir_common 8139cp compat_ioctl32 v4l2_common 8139too videobuf_dma_sg videobuf_core mii btcx_risc tveeprom\ni915 button snd_page_alloc serio_raw drm pcspkr i2c_algo_bit i2c_i801 i2c_core iTCO_wdt\niTCO_vendor_support sr_mod cdrom sg ata_generic pata_acpi ata_piix libata sd_mod scsi_mod ext3 jbdmbcache\nuhci_hcd ohci_hcd ehci_hcd [last unloaded: soundcore]\n\nPid: 15413, comm: qv4l2 Not tainted (2.6.25.14-108.fc9.i686 #1)\nEIP: 0060:[<00000000>] EFLAGS: 00210246 CPU: 0\nEIP is at 0x0\nEAX: 00008000 EBX: ebd21600 ECX: e2fd9ec4 EDX: 00200046\nESI: f8c0f0c4 EDI: f8c0f0c4 EBP: e2fd9d50 ESP: e2fd9d2c\n DS: 007b ES: 007b FS: 00d8 GS: 0033 SS: 0068\nProcess qv4l2 (pid: 15413, ti=e2fd9000 task=ebe44000 task.ti=e2fd9000)\nStack: f8c0c6ae e2ff2a00 00000d00 e2fd9ec4 ebc4e000 e2fd9d5c f8c0c448 00000000\n       f899c12a e2fd9d5c f899c154 e2fd9d68 e2fd9d80 c0560185 e2fd9d88 f8f3e1d8\n       f8f3e1dc ebc4e034 f8f3e18c e2fd9ec4 00000000 e2fd9d90 f899c286 c008561c\nCall Trace:\n [<f8c0c6ae>] ? chip_command+0x266/0x4b6 [tvaudio]\n [<f8c0c448>] ? chip_command+0x0/0x4b6 [tvaudio]\n [<f899c12a>] ? i2c_cmd+0x0/0x2f [i2c_core]\n [<f899c154>] ? i2c_cmd+0x2a/0x2f [i2c_core]\n [<c0560185>] ? device_for_each_child+0x21/0x49\n [<f899c286>] ? i2c_clients_command+0x1c/0x1e [i2c_core]\n [<f8f283d8>] ? bttv_call_i2c_clients+0x14/0x16 [bttv]\n [<f8f23601>] ? bttv_s_ctrl+0x1bc/0x313 [bttv]\n [<f8f23445>] ? bttv_s_ctrl+0x0/0x313 [bttv]\n [<f8b6096d>] ? __video_do_ioctl+0x1f84/0x3726 [videodev]\n [<c05abb4e>] ? sock_aio_write+0x100/0x10d\n [<c041b23e>] ? kmap_atomic_prot+0x1dd/0x1df\n [<c043a0c9>] ? enqueue_hrtimer+0xc2/0xcd\n [<c04f4fa4>] ? copy_from_user+0x39/0x121\n [<f8b622b9>] ? __video_ioctl2+0x1aa/0x24a [videodev]\n [<c04054fd>] ? do_notify_resume+0x768/0x795\n [<c043c0f7>] ? getnstimeofday+0x34/0xd1\n [<c0437b77>] ? autoremove_wake_function+0x0/0x33\n [<f8b62368>] ? video_ioctl2+0xf/0x13 [videodev]\n [<c048c6f0>] ? vfs_ioctl+0x50/0x69\n [<c048c942>] ? do_vfs_ioctl+0x239/0x24c\n [<c048c995>] ? sys_ioctl+0x40/0x5b\n [<c0405bf2>] ? syscall_call+0x7/0xb\n [<c0620000>] ? cpuid4_cache_sysfs_exit+0x3d/0x69\n =======================\nCode:  Bad EIP value.\nEIP: [<00000000>] 0x0 SS:ESP 0068:e2fd9d2c\n\nSigned-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>",
  "author_name": "Mauro Carvalho Chehab",
  "author_email": "mchehab@redhat.com",
  "author_date": "Fri Nov 14 10:46:59 2008 -0300",
  "author_date_iso": "2008-11-14T10:46:59-03:00",
  "committer_name": "Mauro Carvalho Chehab",
  "committer_email": "mchehab@redhat.com",
  "committer_date": "Fri Nov 14 14:39:47 2008 -0200",
  "committer_date_iso": "2008-11-14T14:39:47-02:00",
  "files_changed": [
    "drivers/media/video/tvaudio.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/media/video/tvaudio.c",
      "insertions": 7,
      "deletions": 8
    }
  ],
  "total_insertions": 7,
  "total_deletions": 8,
  "total_changes": 15,
  "parents": [
    "c6241b6c64dbe759e0eccaee913bdcf4d7960367"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.28",
    "v2.6.28-rc5",
    "v2.6.28-rc6",
    "v2.6.28-rc7",
    "v2.6.28-rc8",
    "v2.6.28-rc9",
    "v2.6.29",
    "v2.6.29-rc1",
    "v2.6.29-rc2",
    "v2.6.29-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2008-5033",
      "CVE-2008-5033"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/media/video/tvaudio.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}