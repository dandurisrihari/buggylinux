{
  "hash": "ee70bc1e7b63ac8023c9ff9475d8741e397316e7",
  "hash_short": "ee70bc1e",
  "subject": "tpm-dev-common: Reject too short writes",
  "body": "tpm_transmit() does not offer an explicit interface to indicate the number\nof valid bytes in the communication buffer. Instead, it relies on the\ncommandSize field in the TPM header that is encoded within the buffer.\nTherefore, ensure that a) enough data has been written to the buffer, so\nthat the commandSize field is present and b) the commandSize field does not\nannounce more data than has been written to the buffer.\n\nThis should have been fixed with CVE-2011-1161 long ago, but apparently\na correct version of that patch never made it into the kernel.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Alexander Steffen <Alexander.Steffen@infineon.com>\nReviewed-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>\nTested-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>\nSigned-off-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>",
  "full_message": "tpm-dev-common: Reject too short writes\n\ntpm_transmit() does not offer an explicit interface to indicate the number\nof valid bytes in the communication buffer. Instead, it relies on the\ncommandSize field in the TPM header that is encoded within the buffer.\nTherefore, ensure that a) enough data has been written to the buffer, so\nthat the commandSize field is present and b) the commandSize field does not\nannounce more data than has been written to the buffer.\n\nThis should have been fixed with CVE-2011-1161 long ago, but apparently\na correct version of that patch never made it into the kernel.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Alexander Steffen <Alexander.Steffen@infineon.com>\nReviewed-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>\nTested-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>\nSigned-off-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>",
  "author_name": "Alexander Steffen",
  "author_email": "Alexander.Steffen@infineon.com",
  "author_date": "Fri Sep 8 17:21:32 2017 +0200",
  "author_date_iso": "2017-09-08T17:21:32+02:00",
  "committer_name": "Jarkko Sakkinen",
  "committer_email": "jarkko.sakkinen@linux.intel.com",
  "committer_date": "Wed Oct 18 18:28:47 2017 +0300",
  "committer_date_iso": "2017-10-18T18:28:47+03:00",
  "files_changed": [
    "drivers/char/tpm/tpm-dev-common.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/char/tpm/tpm-dev-common.c",
      "insertions": 6,
      "deletions": 0
    }
  ],
  "total_insertions": 6,
  "total_deletions": 0,
  "total_changes": 6,
  "parents": [
    "125a2210541079e8e7c69e629ad06cabed788f8c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.15",
    "v4.15-rc1",
    "v4.15-rc2",
    "v4.15-rc3",
    "v4.15-rc4",
    "v4.15-rc5",
    "v4.15-rc6",
    "v4.15-rc7",
    "v4.15-rc8",
    "v4.15-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2011-1161"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/char/tpm/tpm-dev-common.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}