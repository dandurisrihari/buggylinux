Commit Hash: 4ab42d78e37a294ac7bc56901d563c642e03c4ae
Subject: ppp, slip: Validate VJ compression slot parameters completely

CVE Identifiers:
- CVE-2015-7799

Full commit message:
ppp, slip: Validate VJ compression slot parameters completely

Currently slhc_init() treats out-of-range values of rslots and tslots
as equivalent to 0, except that if tslots is too large it will
dereference a null pointer (CVE-2015-7799).

Add a range-check at the top of the function and make it return an
ERR_PTR() on error instead of NULL.  Change the callers accordingly.

Compile-tested only.

Reported-by: 郭永刚 <guoyonggang@360.cn>
References: http://article.gmane.org/gmane.comp.security.oss.general/17908
Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Ben Hutchings <ben@decadent.org.uk>
Author Date: Sun Nov 1 16:22:53 2015 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Nov 2 16:25:00 2015 -0500

Files Changed: 4
Lines Added: 15
Lines Removed: 15
Total Changes: 30
