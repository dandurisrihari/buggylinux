{
  "hash": "25d834e16294c8dfd923dae6bdb8a055391a99a5",
  "hash_short": "25d834e1",
  "subject": "mac80211: fix virtual interfaces vs. injection",
  "body": "Currently, virtual interface pointers passed to drivers might be\nfrom monitor interfaces and as such completely uninitialised\nbecause we do not tell the driver about monitor interfaces when\nthose are created. Instead of passing them, we should therefore\nindicate to the driver that there is no information; do that by\npassing a NULL value and adjust drivers to cope with it.\n\nAs a result, some mac80211 API functions also need to cope with\na NULL vif pointer so drivers can still call them unconditionally.\n\nAlso, when injecting frames we really don't want to pass NULL all\nthe time, if we know we are the source address of a frame and have\na local interface for that address, we can to use that interface.\nThis also helps with processing the frame correctly for that\ninterface which will help the 802.11w implementation. It's not\nentirely correct for VLANs or WDS interfaces because there the MAC\naddress isn't unique, but it's already a lot better than what we\ndo now.\n\nFinally, when injecting without a matching local interface, don't\nassign sequence numbers at all.\n\nSigned-off-by: Johannes Berg <johannes@sipsolutions.net>\nSigned-off-by: John W. Linville <linville@tuxdriver.com>",
  "full_message": "mac80211: fix virtual interfaces vs. injection\n\nCurrently, virtual interface pointers passed to drivers might be\nfrom monitor interfaces and as such completely uninitialised\nbecause we do not tell the driver about monitor interfaces when\nthose are created. Instead of passing them, we should therefore\nindicate to the driver that there is no information; do that by\npassing a NULL value and adjust drivers to cope with it.\n\nAs a result, some mac80211 API functions also need to cope with\na NULL vif pointer so drivers can still call them unconditionally.\n\nAlso, when injecting frames we really don't want to pass NULL all\nthe time, if we know we are the source address of a frame and have\na local interface for that address, we can to use that interface.\nThis also helps with processing the frame correctly for that\ninterface which will help the 802.11w implementation. It's not\nentirely correct for VLANs or WDS interfaces because there the MAC\naddress isn't unique, but it's already a lot better than what we\ndo now.\n\nFinally, when injecting without a matching local interface, don't\nassign sequence numbers at all.\n\nSigned-off-by: Johannes Berg <johannes@sipsolutions.net>\nSigned-off-by: John W. Linville <linville@tuxdriver.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes@sipsolutions.net",
  "author_date": "Fri Sep 12 22:52:47 2008 +0200",
  "author_date_iso": "2008-09-12T22:52:47+02:00",
  "committer_name": "John W. Linville",
  "committer_email": "linville@tuxdriver.com",
  "committer_date": "Mon Sep 15 16:48:25 2008 -0400",
  "committer_date_iso": "2008-09-15T16:48:25-04:00",
  "files_changed": [
    "drivers/net/wireless/mac80211_hwsim.c",
    "drivers/net/wireless/rt2x00/rt2x00queue.c",
    "include/net/mac80211.h",
    "net/mac80211/tx.c",
    "net/mac80211/util.c"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "drivers/net/wireless/mac80211_hwsim.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/net/wireless/rt2x00/rt2x00queue.c",
      "insertions": 13,
      "deletions": 8
    },
    {
      "file": "include/net/mac80211.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/mac80211/tx.c",
      "insertions": 60,
      "deletions": 4
    },
    {
      "file": "net/mac80211/util.c",
      "insertions": 25,
      "deletions": 12
    }
  ],
  "total_insertions": 101,
  "total_deletions": 25,
  "total_changes": 126,
  "parents": [
    "9c31fd635ddfae6eb61712491770befa2ce1fdde"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.28",
    "v2.6.28-rc1",
    "v2.6.28-rc2",
    "v2.6.28-rc3",
    "v2.6.28-rc4",
    "v2.6.28-rc5",
    "v2.6.28-rc6",
    "v2.6.28-rc7",
    "v2.6.28-rc8",
    "v2.6.28-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/mac80211_hwsim.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/rt2x00/rt2x00queue.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/net/mac80211.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/tx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/util.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}