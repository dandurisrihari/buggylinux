Commit Hash: dac211ec10d268b9d09000093a9fa2ac1773894f
Subject: mac80211: fail authentication when AP denied authentication


Security Keywords:
- authentication

Full commit message:
mac80211: fail authentication when AP denied authentication

ieee80211_rx_mgmt_auth() doesn't handle denied authentication
properly - it authenticates the station and waits for association
(for 5 seconds) instead of failing the authentication.

Fix it by destroying auth_data and bailing out instead.

Signed-off-by: Eliad Peller <eliad@wizery.com>
Acked-by: Johannes Berg <johannes@sipsolutions.net>
Cc: stable@vger.kernel.org #3.4
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Eliad Peller <eliad@wizery.com>
Author Date: Sun May 13 18:07:04 2012 +0300
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Tue Jun 5 15:21:47 2012 -0400

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
