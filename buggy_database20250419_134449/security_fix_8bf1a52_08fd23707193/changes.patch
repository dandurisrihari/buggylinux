diff --cc arch/arm64/Kconfig
index c5ccca26a408,619ab046744a..27b2592698b0
--- a/arch/arm64/Kconfig
+++ b/arch/arm64/Kconfig
@@@ -184,6 -186,10 +186,8 @@@ config ARM6
  	select HAVE_DEBUG_KMEMLEAK
  	select HAVE_DMA_CONTIGUOUS
  	select HAVE_DYNAMIC_FTRACE
 -	select HAVE_DYNAMIC_FTRACE_WITH_ARGS \
 -		if $(cc-option,-fpatchable-function-entry=2)
+ 	select HAVE_DYNAMIC_FTRACE_WITH_CALL_OPS \
+ 		if (DYNAMIC_FTRACE_WITH_ARGS && !CFI_CLANG)
  	select FTRACE_MCOUNT_USE_PATCHABLE_FUNCTION_ENTRY \
  		if DYNAMIC_FTRACE_WITH_ARGS
  	select HAVE_EFFICIENT_UNALIGNED_ACCESS
diff --cc arch/arm64/kernel/ptrace.c
index 0c321ad23cd3,143a971d7511..d7f4f0d1ae12
--- a/arch/arm64/kernel/ptrace.c
+++ b/arch/arm64/kernel/ptrace.c
@@@ -1357,9 -1402,10 +1402,10 @@@ enum aarch64_regset 
  #ifdef CONFIG_ARM64_SVE
  	REGSET_SVE,
  #endif
 -#ifdef CONFIG_ARM64_SVE
 +#ifdef CONFIG_ARM64_SME
  	REGSET_SSVE,
  	REGSET_ZA,
+ 	REGSET_ZT,
  #endif
  #ifdef CONFIG_ARM64_PTR_AUTH
  	REGSET_PAC_MASK,