{
  "hash": "696e1a48b1a1b01edad542a1ef293665864a4dd0",
  "hash_short": "696e1a48",
  "subject": "netfilter: nft_payload: incorrect arithmetics when fetching VLAN header bits",
  "body": "If the offset + length goes over the ethernet + vlan header, then the\nlength is adjusted to copy the bytes that are within the boundaries of\nthe vlan_ethhdr scratchpad area. The remaining bytes beyond ethernet +\nvlan header are copied directly from the skbuff data area.\n\nFix incorrect arithmetic operator: subtract, not add, the size of the\nvlan header in case of double-tagged packets to adjust the length\naccordingly to address CVE-2023-0179.\n\nReported-by: Davide Ornaghi <d.ornaghi97@gmail.com>\nFixes: f6ae9f120dad (\"netfilter: nft_payload: add C-VLAN support\")\nSigned-off-by: Pablo Neira Ayuso <pablo@netfilter.org>",
  "full_message": "netfilter: nft_payload: incorrect arithmetics when fetching VLAN header bits\n\nIf the offset + length goes over the ethernet + vlan header, then the\nlength is adjusted to copy the bytes that are within the boundaries of\nthe vlan_ethhdr scratchpad area. The remaining bytes beyond ethernet +\nvlan header are copied directly from the skbuff data area.\n\nFix incorrect arithmetic operator: subtract, not add, the size of the\nvlan header in case of double-tagged packets to adjust the length\naccordingly to address CVE-2023-0179.\n\nReported-by: Davide Ornaghi <d.ornaghi97@gmail.com>\nFixes: f6ae9f120dad (\"netfilter: nft_payload: add C-VLAN support\")\nSigned-off-by: Pablo Neira Ayuso <pablo@netfilter.org>",
  "author_name": "Pablo Neira Ayuso",
  "author_email": "pablo@netfilter.org",
  "author_date": "Wed Jan 11 17:07:33 2023 +0100",
  "author_date_iso": "2023-01-11T17:07:33+01:00",
  "committer_name": "Pablo Neira Ayuso",
  "committer_email": "pablo@netfilter.org",
  "committer_date": "Wed Jan 11 19:18:04 2023 +0100",
  "committer_date_iso": "2023-01-11T19:18:04+01:00",
  "files_changed": [
    "net/netfilter/nft_payload.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/netfilter/nft_payload.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "9ea4b476cea1b7d461d16dda25ca3c7e616e2d15"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2023-0179"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/netfilter/nft_payload.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}