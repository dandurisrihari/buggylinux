Commit Hash: 819fcf4adfbd55e81c4325e11eccae16ccad4106
Subject: Merge branch 'cls_drop-fix'


Security Keywords:
- exploit

Full commit message:
Merge branch 'cls_drop-fix'

Jamal Hadi Salim says:

====================
net: dont intepret cls results when asked to drop

It is possible that an error in processing may occur in tcf_classify() which
will result in res.classid being some garbage value. Example of such a code path
is when the classifier goes into a loop due to bad policy. See patch 1/2
for a sample splat.
While the core code reacts correctly and asks the caller to drop the packet
(by returning TC_ACT_SHOT) some callers first intepret the res.class as
a pointer to memory and end up dropping the packet only after some activity with
the pointer. There is likelihood of this resulting in an exploit. So lets fix
all the known qdiscs that behave this way.
====================

Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: David S. Miller <davem@davemloft.net>
Author Date: Mon Jan 2 13:32:43 2023 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Jan 2 13:32:43 2023 +0000

Files Changed: 0
Lines Added: 6
Lines Removed: 3
Total Changes: 9
