Commit Hash: 8ccba14233000f48639aad4cab55ed7b61260db5
Subject: rtc: ds1511: clean up ds1511_nvram_read()/ds1511_nvram_write()


Security Keywords:
- exploit

Full commit message:
rtc: ds1511: clean up ds1511_nvram_read()/ds1511_nvram_write()

The change removes redundant sysfs binary file boundary checks, since
this task is already done on caller side in fs/sysfs/file.c

The change enables burst mode of access to SRAM for any read()/write()
operations, it is worth to mention that this may influence on
userspace, for instance prior to the change

  read(fd, buf, 1);
  read(fd, buf + 1, 1);

and

  read(fd, buf, 2);

sequences of syscalls over DS1511's sysfs "nvram" fd led to different
DS1511 state changes and/or buf content, if some userspace applications
are written specifically for DS1511 and exploit this strange
"feature", they may be impacted.

Also the change corrects NVRAM size accessible to userspace from 255
bytes to 256 bytes.

Signed-off-by: Vladimir Zapolskiy <vz@mleia.com>
Signed-off-by: Alexandre Belloni <alexandre.belloni@free-electrons.com>

Metadata:
Author: Vladimir Zapolskiy <vz@mleia.com>
Author Date: Wed Aug 5 21:12:58 2015 +0300
Committer: Alexandre Belloni <alexandre.belloni@free-electrons.com>
Commit Date: Sat Sep 5 13:19:10 2015 +0200

Files Changed: 1
Lines Added: 5
Lines Removed: 37
Total Changes: 42
