Commit Hash: c707193a17128fae2802d10cbad7239cc57f0c95
Subject: Revert "smb: client: Fix netns refcount imbalance causing leaks and use-after-free"

CVE Identifiers:
- CVE-2024-54680

Full commit message:
Revert "smb: client: Fix netns refcount imbalance causing leaks and use-after-free"

This reverts commit 4e7f1644f2ac6d01dc584f6301c3b1d5aac4eaef.

The commit e9f2517a3e18 ("smb: client: fix TCP timers deadlock after
rmmod") is not only a bogus fix for LOCKDEP null-ptr-deref but also
introduces a real issue, TCP sockets leak, which will be explained in
detail in the next revert.

Also, CNA assigned CVE-2024-54680 to it but is rejecting it. [0]

Thus, we are reverting the commit and its follow-up commit 4e7f1644f2ac
("smb: client: Fix netns refcount imbalance causing leaks and
use-after-free").

Link: https://lore.kernel.org/all/2025040248-tummy-smilingly-4240@gregkh/ #[0]
Fixes: 4e7f1644f2ac ("smb: client: Fix netns refcount imbalance causing leaks and use-after-free")
Signed-off-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Cc: stable@vger.kernel.org
Signed-off-by: Steve French <stfrench@microsoft.com>

Metadata:
Author: Kuniyuki Iwashima <kuniyu@amazon.com>
Author Date: Wed Apr 2 13:26:47 2025 -0700
Committer: Steve French <stfrench@microsoft.com>
Commit Date: Sun Apr 13 17:24:55 2025 -0500

Files Changed: 1
Lines Added: 8
Lines Removed: 8
Total Changes: 16
