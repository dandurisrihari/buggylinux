{
  "hash": "3e493173b7841259a08c5c8e5cbe90adb349da7e",
  "hash_short": "3e493173",
  "subject": "mac80211: Do not send Layer 2 Update frame before authorization",
  "body": "The Layer 2 Update frame is used to update bridges when a station roams\nto another AP even if that STA does not transmit any frames after the\nreassociation. This behavior was described in IEEE Std 802.11F-2003 as\nsomething that would happen based on MLME-ASSOCIATE.indication, i.e.,\nbefore completing 4-way handshake. However, this IEEE trial-use\nrecommended practice document was published before RSN (IEEE Std\n802.11i-2004) and as such, did not consider RSN use cases. Furthermore,\nIEEE Std 802.11F-2003 was withdrawn in 2006 and as such, has not been\nmaintained amd should not be used anymore.\n\nSending out the Layer 2 Update frame immediately after association is\nfine for open networks (and also when using SAE, FT protocol, or FILS\nauthentication when the station is actually authenticated by the time\nassociation completes). However, it is not appropriate for cases where\nRSN is used with PSK or EAP authentication since the station is actually\nfully authenticated only once the 4-way handshake completes after\nauthentication and attackers might be able to use the unauthenticated\ntriggering of Layer 2 Update frame transmission to disrupt bridge\nbehavior.\n\nFix this by postponing transmission of the Layer 2 Update frame from\nstation entry addition to the point when the station entry is marked\nauthorized. Similarly, send out the VLAN binding update only if the STA\nentry has already been authorized.\n\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nReviewed-by: Johannes Berg <johannes@sipsolutions.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "mac80211: Do not send Layer 2 Update frame before authorization\n\nThe Layer 2 Update frame is used to update bridges when a station roams\nto another AP even if that STA does not transmit any frames after the\nreassociation. This behavior was described in IEEE Std 802.11F-2003 as\nsomething that would happen based on MLME-ASSOCIATE.indication, i.e.,\nbefore completing 4-way handshake. However, this IEEE trial-use\nrecommended practice document was published before RSN (IEEE Std\n802.11i-2004) and as such, did not consider RSN use cases. Furthermore,\nIEEE Std 802.11F-2003 was withdrawn in 2006 and as such, has not been\nmaintained amd should not be used anymore.\n\nSending out the Layer 2 Update frame immediately after association is\nfine for open networks (and also when using SAE, FT protocol, or FILS\nauthentication when the station is actually authenticated by the time\nassociation completes). However, it is not appropriate for cases where\nRSN is used with PSK or EAP authentication since the station is actually\nfully authenticated only once the 4-way handshake completes after\nauthentication and attackers might be able to use the unauthenticated\ntriggering of Layer 2 Update frame transmission to disrupt bridge\nbehavior.\n\nFix this by postponing transmission of the Layer 2 Update frame from\nstation entry addition to the point when the station entry is marked\nauthorized. Similarly, send out the VLAN binding update only if the STA\nentry has already been authorized.\n\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nReviewed-by: Johannes Berg <johannes@sipsolutions.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Jouni Malinen",
  "author_email": "jouni@codeaurora.org",
  "author_date": "Wed Sep 11 16:03:05 2019 +0300",
  "author_date_iso": "2019-09-11T16:03:05+03:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Wed Sep 11 14:59:26 2019 +0100",
  "committer_date_iso": "2019-09-11T14:59:26+01:00",
  "files_changed": [
    "net/mac80211/cfg.c",
    "net/mac80211/sta_info.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/mac80211/cfg.c",
      "insertions": 4,
      "deletions": 10
    },
    {
      "file": "net/mac80211/sta_info.c",
      "insertions": 4,
      "deletions": 0
    }
  ],
  "total_insertions": 8,
  "total_deletions": 10,
  "total_changes": 18,
  "parents": [
    "3dfdecc6d1256835ac0612b2a8f7595466d66327"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.3",
    "v5.4",
    "v5.4-rc1",
    "v5.4-rc2",
    "v5.4-rc3",
    "v5.4-rc4",
    "v5.4-rc5",
    "v5.4-rc6",
    "v5.4-rc7",
    "v5.4-rc8"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/cfg.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/sta_info.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}