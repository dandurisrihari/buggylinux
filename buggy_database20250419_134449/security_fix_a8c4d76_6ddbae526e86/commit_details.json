{
  "hash": "a8c4d76a8dd4fb9666fc8919a703d85fb8f44ed8",
  "hash_short": "a8c4d76a",
  "subject": "mac80211: do not accept/forward invalid EAPOL frames",
  "body": "EAPOL frames are used for authentication and key management between the\nAP and each individual STA associated in the BSS. Those frames are not\nsupposed to be sent by one associated STA to another associated STA\n(either unicast for broadcast/multicast).\n\nSimilarly, in 802.11 they're supposed to be sent to the authenticator\n(AP) address.\n\nSince it is possible for unexpected EAPOL frames to result in misbehavior\nin supplicant implementations, it is better for the AP to not allow such\ncases to be forwarded to other clients either directly, or indirectly if\nthe AP interface is part of a bridge.\n\nAccept EAPOL (control port) frames only if they're transmitted to the\nown address, or, due to interoperability concerns, to the PAE group\naddress.\n\nDisable forwarding of EAPOL (or well, the configured control port\nprotocol) frames back to wireless medium in all cases. Previously, these\nframes were accepted from fully authenticated and authorized stations\nand also from unauthenticated stations for one of the cases.\n\nAdditionally, to avoid forwarding by the bridge, rewrite the PAE group\naddress case to the local MAC address.\n\nCc: stable@vger.kernel.org\nCo-developed-by: Jouni Malinen <jouni@codeaurora.org>\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nLink: https://lore.kernel.org/r/20210511200110.cb327ed0cabe.Ib7dcffa2a31f0913d660de65ba3c8aca75b1d10f@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: do not accept/forward invalid EAPOL frames\n\nEAPOL frames are used for authentication and key management between the\nAP and each individual STA associated in the BSS. Those frames are not\nsupposed to be sent by one associated STA to another associated STA\n(either unicast for broadcast/multicast).\n\nSimilarly, in 802.11 they're supposed to be sent to the authenticator\n(AP) address.\n\nSince it is possible for unexpected EAPOL frames to result in misbehavior\nin supplicant implementations, it is better for the AP to not allow such\ncases to be forwarded to other clients either directly, or indirectly if\nthe AP interface is part of a bridge.\n\nAccept EAPOL (control port) frames only if they're transmitted to the\nown address, or, due to interoperability concerns, to the PAE group\naddress.\n\nDisable forwarding of EAPOL (or well, the configured control port\nprotocol) frames back to wireless medium in all cases. Previously, these\nframes were accepted from fully authenticated and authorized stations\nand also from unauthenticated stations for one of the cases.\n\nAdditionally, to avoid forwarding by the bridge, rewrite the PAE group\naddress case to the local MAC address.\n\nCc: stable@vger.kernel.org\nCo-developed-by: Jouni Malinen <jouni@codeaurora.org>\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nLink: https://lore.kernel.org/r/20210511200110.cb327ed0cabe.Ib7dcffa2a31f0913d660de65ba3c8aca75b1d10f@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Tue May 11 20:02:50 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:50+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:14:20 2021 +0200",
  "committer_date_iso": "2021-05-11T20:14:20+02:00",
  "files_changed": [
    "net/mac80211/rx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/rx.c",
      "insertions": 27,
      "deletions": 6
    }
  ],
  "total_insertions": 27,
  "total_deletions": 6,
  "total_changes": 33,
  "parents": [
    "7e44a0b597f04e67eee8cdcbe7ee706c6f5de38b"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/rx.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}