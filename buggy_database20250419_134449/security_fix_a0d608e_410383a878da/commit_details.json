{
  "hash": "a0d608ee5ebfa9a9da0e69784e7aa0f86644a02e",
  "hash_short": "a0d608ee",
  "subject": "crypto: testmgr - unify the AEAD encryption and decryption test vectors",
  "body": "Currently testmgr has separate encryption and decryption test vectors\nfor AEADs.  That's massively redundant, since usually the decryption\ntests are identical to the encryption tests, just with the input/result\nswapped.  And for some algorithms it was forgotten to add decryption\ntest vectors, so for them currently only encryption is being tested.\n\nTherefore, eliminate the redundancy by removing the AEAD decryption test\nvectors and updating testmgr to test both AEAD encryption and decryption\nusing what used to be the encryption test vectors.  Naming is adjusted\naccordingly: each aead_testvec now has a 'ptext' (plaintext), 'plen'\n(plaintext length), 'ctext' (ciphertext), and 'clen' (ciphertext length)\ninstead of an 'input', 'ilen', 'result', and 'rlen'.  \"Ciphertext\" here\nrefers to the full ciphertext, including the authentication tag.\n\nFor now the scatterlist divisions are just given for the plaintext\nlength, not also the ciphertext length.  For decryption, the last\nscatterlist element is just extended by the authentication tag length.\n\nIn total, this removes over 5000 lines from testmgr.h, with no reduction\nin test coverage since prior patches already copied the few unique\ndecryption test vectors into the encryption test vectors.\n\nThe testmgr.h portion of this patch was automatically generated using\nthe following awk script, except that I also manually updated the\ndefinition of 'struct aead_testvec' and fixed the location of the\ncomment describing the AEGIS-128 test vectors.\n\n    BEGIN { OTHER = 0; ENCVEC = 1; DECVEC = 2; DECVEC_TAIL = 3; mode = OTHER }\n\n    /^static const struct aead_testvec.*_enc_/ { sub(\"_enc\", \"\"); mode = ENCVEC }\n    /^static const struct aead_testvec.*_dec_/ { mode = DECVEC }\n    mode == ENCVEC {\n        sub(/\\.input[[:space:]]*=/,     \".ptext\\t=\")\n        sub(/\\.result[[:space:]]*=/,    \".ctext\\t=\")\n        sub(/\\.ilen[[:space:]]*=/,      \".plen\\t=\")\n        sub(/\\.rlen[[:space:]]*=/,      \".clen\\t=\")\n        print\n    }\n    mode == DECVEC_TAIL && /[^[:space:]]/ { mode = OTHER }\n    mode == OTHER                         { print }\n    mode == ENCVEC && /^};/               { mode = OTHER }\n    mode == DECVEC && /^};/               { mode = DECVEC_TAIL }\n\nNote that git's default diff algorithm gets confused by the testmgr.h\nportion of this patch, and reports too many lines added and removed.\nIt's better viewed with 'git diff --minimal' (or 'git show --minimal'),\nwhich reports \"2 files changed, 1235 insertions(+), 6491 deletions(-)\".\n\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "crypto: testmgr - unify the AEAD encryption and decryption test vectors\n\nCurrently testmgr has separate encryption and decryption test vectors\nfor AEADs.  That's massively redundant, since usually the decryption\ntests are identical to the encryption tests, just with the input/result\nswapped.  And for some algorithms it was forgotten to add decryption\ntest vectors, so for them currently only encryption is being tested.\n\nTherefore, eliminate the redundancy by removing the AEAD decryption test\nvectors and updating testmgr to test both AEAD encryption and decryption\nusing what used to be the encryption test vectors.  Naming is adjusted\naccordingly: each aead_testvec now has a 'ptext' (plaintext), 'plen'\n(plaintext length), 'ctext' (ciphertext), and 'clen' (ciphertext length)\ninstead of an 'input', 'ilen', 'result', and 'rlen'.  \"Ciphertext\" here\nrefers to the full ciphertext, including the authentication tag.\n\nFor now the scatterlist divisions are just given for the plaintext\nlength, not also the ciphertext length.  For decryption, the last\nscatterlist element is just extended by the authentication tag length.\n\nIn total, this removes over 5000 lines from testmgr.h, with no reduction\nin test coverage since prior patches already copied the few unique\ndecryption test vectors into the encryption test vectors.\n\nThe testmgr.h portion of this patch was automatically generated using\nthe following awk script, except that I also manually updated the\ndefinition of 'struct aead_testvec' and fixed the location of the\ncomment describing the AEGIS-128 test vectors.\n\n    BEGIN { OTHER = 0; ENCVEC = 1; DECVEC = 2; DECVEC_TAIL = 3; mode = OTHER }\n\n    /^static const struct aead_testvec.*_enc_/ { sub(\"_enc\", \"\"); mode = ENCVEC }\n    /^static const struct aead_testvec.*_dec_/ { mode = DECVEC }\n    mode == ENCVEC {\n        sub(/\\.input[[:space:]]*=/,     \".ptext\\t=\")\n        sub(/\\.result[[:space:]]*=/,    \".ctext\\t=\")\n        sub(/\\.ilen[[:space:]]*=/,      \".plen\\t=\")\n        sub(/\\.rlen[[:space:]]*=/,      \".clen\\t=\")\n        print\n    }\n    mode == DECVEC_TAIL && /[^[:space:]]/ { mode = OTHER }\n    mode == OTHER                         { print }\n    mode == ENCVEC && /^};/               { mode = OTHER }\n    mode == DECVEC && /^};/               { mode = DECVEC_TAIL }\n\nNote that git's default diff algorithm gets confused by the testmgr.h\nportion of this patch, and reports too many lines added and removed.\nIt's better viewed with 'git diff --minimal' (or 'git show --minimal'),\nwhich reports \"2 files changed, 1235 insertions(+), 6491 deletions(-)\".\n\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Eric Biggers",
  "author_email": "ebiggers@google.com",
  "author_date": "Sun Jan 13 15:32:28 2019 -0800",
  "author_date_iso": "2019-01-13T15:32:28-08:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Fri Jan 18 18:54:36 2019 +0800",
  "committer_date_iso": "2019-01-18T18:54:36+08:00",
  "files_changed": [
    "crypto/testmgr.c",
    "crypto/testmgr.h"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "crypto/testmgr.c",
      "insertions": 101,
      "deletions": 159
    },
    {
      "file": "crypto/testmgr.h",
      "insertions": 3617,
      "deletions": 8815
    }
  ],
  "total_insertions": 3718,
  "total_deletions": 8974,
  "total_changes": 12692,
  "parents": [
    "d7250b41531842cf7eaadf463053275a5d5a01f0"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.1",
    "v5.1-rc1",
    "v5.1-rc2",
    "v5.1-rc3",
    "v5.1-rc4",
    "v5.1-rc5",
    "v5.1-rc6",
    "v5.1-rc7",
    "v5.2",
    "v5.2-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "crypto/testmgr.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "crypto/testmgr.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}