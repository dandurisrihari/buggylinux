{
  "hash": "ee1e3c46ed19c096be22472c728fa7f68b1352c4",
  "hash_short": "ee1e3c46",
  "subject": "EINJ, CXL: Fix CXL device SBDF calculation",
  "body": "The SBDF of the target CXL 2.0 compliant root port is required to inject a CXL\nprotocol error as per ACPI 6.5. The SBDF given has to be in the\nfollowing format:\n\n31     24 23    16 15    11 10      8  7        0\n+-------------------------------------------------+\n| segment |   bus  | device | function | reserved |\n+-------------------------------------------------+\n\nThe SBDF calculated in cxl_dport_get_sbdf() doesn't account for\nthe reserved bits currently, causing the wrong SBDF to be used.\nFix said calculation to properly shift the SBDF.\n\nWithout this fix, error injection into CXL 2.0 root ports through the\nCXL debugfs interface (<debugfs>/cxl) is broken. Injection\nthrough the legacy interface (<debugfs>/apei/einj/) will still work\nbecause the SBDF is manually provided by the user.\n\nFixes: 12fb28ea6b1cf (\"EINJ: Add CXL error type support\")\nSigned-off-by: Ben Cheatham <Benjamin.Cheatham@amd.com>\nReviewed-by: Dan Williams <dan.j.williams@intel.com>\nTested-by: Srinivasulu Thanneeru <sthanneeru.opensrc@micron.com>\nReviewed-by: Srinivasulu Thanneeru <sthanneeru.opensrc@micron.com>\nLink: https://patch.msgid.link/20240927163428.366557-1-Benjamin.Cheatham@amd.com\nSigned-off-by: Ira Weiny <ira.weiny@intel.com>",
  "full_message": "EINJ, CXL: Fix CXL device SBDF calculation\n\nThe SBDF of the target CXL 2.0 compliant root port is required to inject a CXL\nprotocol error as per ACPI 6.5. The SBDF given has to be in the\nfollowing format:\n\n31     24 23    16 15    11 10      8  7        0\n+-------------------------------------------------+\n| segment |   bus  | device | function | reserved |\n+-------------------------------------------------+\n\nThe SBDF calculated in cxl_dport_get_sbdf() doesn't account for\nthe reserved bits currently, causing the wrong SBDF to be used.\nFix said calculation to properly shift the SBDF.\n\nWithout this fix, error injection into CXL 2.0 root ports through the\nCXL debugfs interface (<debugfs>/cxl) is broken. Injection\nthrough the legacy interface (<debugfs>/apei/einj/) will still work\nbecause the SBDF is manually provided by the user.\n\nFixes: 12fb28ea6b1cf (\"EINJ: Add CXL error type support\")\nSigned-off-by: Ben Cheatham <Benjamin.Cheatham@amd.com>\nReviewed-by: Dan Williams <dan.j.williams@intel.com>\nTested-by: Srinivasulu Thanneeru <sthanneeru.opensrc@micron.com>\nReviewed-by: Srinivasulu Thanneeru <sthanneeru.opensrc@micron.com>\nLink: https://patch.msgid.link/20240927163428.366557-1-Benjamin.Cheatham@amd.com\nSigned-off-by: Ira Weiny <ira.weiny@intel.com>",
  "author_name": "Ben Cheatham",
  "author_email": "Benjamin.Cheatham@amd.com",
  "author_date": "Fri Sep 27 11:34:28 2024 -0500",
  "author_date_iso": "2024-09-27T11:34:28-05:00",
  "committer_name": "Ira Weiny",
  "committer_email": "ira.weiny@intel.com",
  "committer_date": "Mon Sep 30 08:10:39 2024 -0500",
  "committer_date_iso": "2024-09-30T08:10:39-05:00",
  "files_changed": [
    "drivers/acpi/apei/einj-cxl.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/acpi/apei/einj-cxl.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "9852d85ec9d492ebef56dc5f229416c925758edc"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/acpi/apei/einj-cxl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}