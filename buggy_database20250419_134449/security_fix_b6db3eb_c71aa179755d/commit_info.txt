Commit Hash: b6db3eb6c373b97d9e433530d748590421bbeea7
Subject: arm64: esr: Define ESR_ELx_EC_* constants as UL


Security Keywords:
- injection

Full commit message:
arm64: esr: Define ESR_ELx_EC_* constants as UL

Add explicit casting to prevent expantion of 32th bit of
u32 into highest half of u64 in several places.

For example, in inject_abt64:
ESR_ELx_EC_DABT_LOW << ESR_ELx_EC_SHIFT = 0x24 << 26.
This operation's result is int with 1 in 32th bit.
While casting this value into u64 (esr is u64) 1
fills 32 highest bits.

Found by Linux Verification Center (linuxtesting.org) with SVACE.

Cc: <stable@vger.kernel.org>
Fixes: aa8eff9bfbd5 ("arm64: KVM: fault injection into a guest")
Signed-off-by: Anastasia Belova <abelova@astralinux.ru>
Acked-by: Marc Zyngier <maz@kernel.org>
Link: https://lore.kernel.org/stable/20240910085016.32120-1-abelova%40astralinux.ru
Link: https://lore.kernel.org/r/20240910085016.32120-1-abelova@astralinux.ru
Signed-off-by: Will Deacon <will@kernel.org>

Metadata:
Author: Anastasia Belova <abelova@astralinux.ru>
Author Date: Tue Sep 10 11:50:16 2024 +0300
Committer: Will Deacon <will@kernel.org>
Commit Date: Tue Sep 10 18:22:58 2024 +0100

Files Changed: 1
Lines Added: 44
Lines Removed: 44
Total Changes: 88
