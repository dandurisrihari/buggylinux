Commit Hash: 567320c46a60a3c39b69aa1df802d753817a3f86
Subject: smb: client: fix potential OOB in smb2_dump_detail()

CVE Identifiers:
- CVE-2023-6610

Full commit message:
smb: client: fix potential OOB in smb2_dump_detail()

Validate SMB message with ->check_message() before calling
->calc_smb_size().

This fixes CVE-2023-6610.

Reported-by: j51569436@gmail.com
Closes: https://bugzilla.kernel.org/show_bug.cgi?id=218219
Cc; stable@vger.kernel.org
Signed-off-by: Paulo Alcantara <pc@manguebit.com>
Signed-off-by: Steve French <stfrench@microsoft.com>

Metadata:
Author: Paulo Alcantara <pc@manguebit.com>
Author Date: Tue Dec 19 13:10:31 2023 -0300
Committer: Steve French <stfrench@microsoft.com>
Commit Date: Tue Dec 19 10:33:39 2023 -0600

Files Changed: 2
Lines Added: 19
Lines Removed: 17
Total Changes: 36
