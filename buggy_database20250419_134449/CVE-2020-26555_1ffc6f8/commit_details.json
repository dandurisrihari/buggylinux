{
  "hash": "1ffc6f8cc33268731fcf9629fc4438f6db1191fc",
  "hash_short": "1ffc6f8c",
  "subject": "Bluetooth: Reject connection with the device which has same BD_ADDR",
  "body": "This change is used to relieve CVE-2020-26555. The description of\nthe CVE:\n\nBluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification\n1.0B through 5.2 may permit an unauthenticated nearby device to spoof\nthe BD_ADDR of the peer device to complete pairing without knowledge\nof the PIN. [1]\n\nThe detail of this attack is in IEEE paper:\nBlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols\n[2]\n\nIt's a reflection attack. The paper mentioned that attacker can induce\nthe attacked target to generate null link key (zero key) without PIN\ncode. In BR/EDR, the key generation is actually handled in the controller\nwhich is below HCI.\n\nA condition of this attack is that attacker should change the\nBR_ADDR of his hacking device (Host B) to equal to the BR_ADDR with\nthe target device being attacked (Host A).\n\nThus, we reject the connection with device which has same BD_ADDR\nboth on HCI_Create_Connection and HCI_Connection_Request to prevent\nthe attack. A similar implementation also shows in btstack project.\n[3][4]\n\nCc: stable@vger.kernel.org\nLink: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]\nLink: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]\nLink: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3523 [3]\nLink: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L7297 [4]\nSigned-off-by: Lee, Chun-Yi <jlee@suse.com>\nSigned-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>",
  "full_message": "Bluetooth: Reject connection with the device which has same BD_ADDR\n\nThis change is used to relieve CVE-2020-26555. The description of\nthe CVE:\n\nBluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification\n1.0B through 5.2 may permit an unauthenticated nearby device to spoof\nthe BD_ADDR of the peer device to complete pairing without knowledge\nof the PIN. [1]\n\nThe detail of this attack is in IEEE paper:\nBlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols\n[2]\n\nIt's a reflection attack. The paper mentioned that attacker can induce\nthe attacked target to generate null link key (zero key) without PIN\ncode. In BR/EDR, the key generation is actually handled in the controller\nwhich is below HCI.\n\nA condition of this attack is that attacker should change the\nBR_ADDR of his hacking device (Host B) to equal to the BR_ADDR with\nthe target device being attacked (Host A).\n\nThus, we reject the connection with device which has same BD_ADDR\nboth on HCI_Create_Connection and HCI_Connection_Request to prevent\nthe attack. A similar implementation also shows in btstack project.\n[3][4]\n\nCc: stable@vger.kernel.org\nLink: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]\nLink: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]\nLink: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3523 [3]\nLink: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L7297 [4]\nSigned-off-by: Lee, Chun-Yi <jlee@suse.com>\nSigned-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>",
  "author_name": "Lee, Chun-Yi",
  "author_email": "jlee@suse.com",
  "author_date": "Sun Oct 1 16:59:58 2023 +0800",
  "author_date_iso": "2023-10-01T16:59:58+08:00",
  "committer_name": "Luiz Augusto von Dentz",
  "committer_email": "luiz.von.dentz@intel.com",
  "committer_date": "Wed Oct 11 11:16:24 2023 -0700",
  "committer_date_iso": "2023-10-11T11:16:24-07:00",
  "files_changed": [
    "net/bluetooth/hci_conn.c",
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 11,
      "deletions": 0
    }
  ],
  "total_insertions": 20,
  "total_deletions": 0,
  "total_changes": 20,
  "parents": [
    "33155c4aae5260475def6f7438e4e35564f4f3ba"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-26555",
      "CVE-2020-26555"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}