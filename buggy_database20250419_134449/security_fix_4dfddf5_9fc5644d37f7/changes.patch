diff --cc drivers/scsi/megaraid/megaraid_sas_base.c
index c1ed25adb17e,c3efcc725540..9ff57dee72d7
--- a/drivers/scsi/megaraid/megaraid_sas_base.c
+++ b/drivers/scsi/megaraid/megaraid_sas_base.c
@@@ -5036,8 -5023,8 +5023,8 @@@ static int megasas_init_fw(struct megas
  
  	/* Find first memory bar */
  	bar_list = pci_select_bars(instance->pdev, IORESOURCE_MEM);
- 	instance->bar = find_first_bit(&bar_list, sizeof(unsigned long));
+ 	instance->bar = find_first_bit(&bar_list, BITS_PER_LONG);
 -	if (pci_request_selected_regions(instance->pdev, instance->bar,
 +	if (pci_request_selected_regions(instance->pdev, 1<<instance->bar,
  					 "megasas: LSI")) {
  		dev_printk(KERN_DEBUG, &instance->pdev->dev, "IO memory region busy!\n");
  		return -EBUSY;
diff --cc drivers/scsi/mpt3sas/mpt3sas_base.c
index 750f82c339d4,df95d1aa1eaa..a1a5ceb42ce6
--- a/drivers/scsi/mpt3sas/mpt3sas_base.c
+++ b/drivers/scsi/mpt3sas/mpt3sas_base.c
@@@ -5291,8 -5246,19 +5257,8 @@@ mpt3sas_base_attach(struct MPT3SAS_ADAP
  	if (r)
  		goto out_free_resources;
  
 -	if (ioc->is_warpdrive) {
 -		ioc->reply_post_host_index[0] = (resource_size_t __iomem *)
 -		    &ioc->chip->ReplyPostHostIndex;
 -
 -		for (i = 1; i < ioc->cpu_msix_table_sz; i++)
 -			ioc->reply_post_host_index[i] =
 -			(resource_size_t __iomem *)
 -			((u8 __iomem *)&ioc->chip->Doorbell + (0x4000 + ((i - 1)
 -			* 4)));
 -	}
 -
  	pci_set_drvdata(ioc->pdev, ioc->shost);
- 	r = _base_get_ioc_facts(ioc, CAN_SLEEP);
+ 	r = _base_get_ioc_facts(ioc);
  	if (r)
  		goto out_free_resources;