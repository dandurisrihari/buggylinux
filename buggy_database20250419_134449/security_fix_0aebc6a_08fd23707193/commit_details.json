{
  "hash": "0aebc6a440b942df6221a7765f077f02217e0114",
  "hash_short": "0aebc6a4",
  "subject": "Merge tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux",
  "body": "Pull arm64 updates from Catalin Marinas:\n \"The main theme of this pull request is security covering variants 2\n  and 3 for arm64. I expect to send additional patches next week\n  covering an improved firmware interface (requires firmware changes)\n  for variant 2 and way for KPTI to be disabled on unaffected CPUs\n  (Cavium's ThunderX doesn't work properly with KPTI enabled because of\n  a hardware erratum).\n\n  Summary:\n\n   - Security mitigations:\n      - variant 2: invalidate the branch predictor with a call to\n        secure firmware\n      - variant 3: implement KPTI for arm64\n\n   - 52-bit physical address support for arm64 (ARMv8.2)\n\n   - arm64 support for RAS (firmware first only) and SDEI (software\n     delegated exception interface; allows firmware to inject a RAS\n     error into the OS)\n\n   - perf support for the ARM DynamIQ Shared Unit PMU\n\n   - CPUID and HWCAP bits updated for new floating point multiplication\n     instructions in ARMv8.4\n\n   - remove some virtual memory layout printks during boot\n\n   - fix initial page table creation to cope with larger than 32M kernel\n     images when 16K pages are enabled\"\n\n* tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux: (104 commits)\n  arm64: Fix TTBR + PAN + 52-bit PA logic in cpu_do_switch_mm\n  arm64: Turn on KPTI only on CPUs that need it\n  arm64: Branch predictor hardening for Cavium ThunderX2\n  arm64: Run enable method for errata work arounds on late CPUs\n  arm64: Move BP hardening to check_and_switch_context\n  arm64: mm: ignore memory above supported physical address size\n  arm64: kpti: Fix the interaction between ASID switching and software PAN\n  KVM: arm64: Emulate RAS error registers and set HCR_EL2's TERR & TEA\n  KVM: arm64: Handle RAS SErrors from EL2 on guest exit\n  KVM: arm64: Handle RAS SErrors from EL1 on guest exit\n  KVM: arm64: Save ESR_EL2 on guest SError\n  KVM: arm64: Save/Restore guest DISR_EL1\n  KVM: arm64: Set an impdef ESR for Virtual-SError using VSESR_EL2.\n  KVM: arm/arm64: mask/unmask daif around VHE guests\n  arm64: kernel: Prepare for a DISR user\n  arm64: Unconditionally enable IESB on exception entry/return for firmware-first\n  arm64: kernel: Survive corrected RAS errors notified by SError\n  arm64: cpufeature: Detect CPU RAS Extentions\n  arm64: sysreg: Move to use definitions for all the SCTLR bits\n  arm64: cpufeature: __this_cpu_has_cap() shouldn't stop early\n  ...",
  "full_message": "Merge tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux\n\nPull arm64 updates from Catalin Marinas:\n \"The main theme of this pull request is security covering variants 2\n  and 3 for arm64. I expect to send additional patches next week\n  covering an improved firmware interface (requires firmware changes)\n  for variant 2 and way for KPTI to be disabled on unaffected CPUs\n  (Cavium's ThunderX doesn't work properly with KPTI enabled because of\n  a hardware erratum).\n\n  Summary:\n\n   - Security mitigations:\n      - variant 2: invalidate the branch predictor with a call to\n        secure firmware\n      - variant 3: implement KPTI for arm64\n\n   - 52-bit physical address support for arm64 (ARMv8.2)\n\n   - arm64 support for RAS (firmware first only) and SDEI (software\n     delegated exception interface; allows firmware to inject a RAS\n     error into the OS)\n\n   - perf support for the ARM DynamIQ Shared Unit PMU\n\n   - CPUID and HWCAP bits updated for new floating point multiplication\n     instructions in ARMv8.4\n\n   - remove some virtual memory layout printks during boot\n\n   - fix initial page table creation to cope with larger than 32M kernel\n     images when 16K pages are enabled\"\n\n* tag 'arm64-upstream' of git://git.kernel.org/pub/scm/linux/kernel/git/arm64/linux: (104 commits)\n  arm64: Fix TTBR + PAN + 52-bit PA logic in cpu_do_switch_mm\n  arm64: Turn on KPTI only on CPUs that need it\n  arm64: Branch predictor hardening for Cavium ThunderX2\n  arm64: Run enable method for errata work arounds on late CPUs\n  arm64: Move BP hardening to check_and_switch_context\n  arm64: mm: ignore memory above supported physical address size\n  arm64: kpti: Fix the interaction between ASID switching and software PAN\n  KVM: arm64: Emulate RAS error registers and set HCR_EL2's TERR & TEA\n  KVM: arm64: Handle RAS SErrors from EL2 on guest exit\n  KVM: arm64: Handle RAS SErrors from EL1 on guest exit\n  KVM: arm64: Save ESR_EL2 on guest SError\n  KVM: arm64: Save/Restore guest DISR_EL1\n  KVM: arm64: Set an impdef ESR for Virtual-SError using VSESR_EL2.\n  KVM: arm/arm64: mask/unmask daif around VHE guests\n  arm64: kernel: Prepare for a DISR user\n  arm64: Unconditionally enable IESB on exception entry/return for firmware-first\n  arm64: kernel: Survive corrected RAS errors notified by SError\n  arm64: cpufeature: Detect CPU RAS Extentions\n  arm64: sysreg: Move to use definitions for all the SCTLR bits\n  arm64: cpufeature: __this_cpu_has_cap() shouldn't stop early\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Tue Jan 30 13:57:43 2018 -0800",
  "author_date_iso": "2018-01-30T13:57:43-08:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Tue Jan 30 13:57:43 2018 -0800",
  "committer_date_iso": "2018-01-30T13:57:43-08:00",
  "files_changed": [
    "Documentation/arm64/silicon-errata.txt",
    "MAINTAINERS",
    "arch/arm64/Kconfig",
    "arch/arm64/include/asm/assembler.h",
    "arch/arm64/include/asm/cputype.h",
    "arch/arm64/include/asm/pgtable.h",
    "arch/arm64/kernel/cpufeature.c",
    "arch/arm64/kernel/head.S",
    "arch/arm64/kvm/handle_exit.c",
    "arch/arm64/kvm/hyp-init.S",
    "arch/arm64/mm/fault.c",
    "arch/arm64/mm/init.c",
    "drivers/irqchip/irq-gic-v3.c",
    "include/linux/cpuhotplug.h",
    "kernel/events/core.c",
    "virt/kvm/arm/arm.c",
    "virt/kvm/arm/mmu.c"
  ],
  "files_changed_count": 17,
  "stats": [
    {
      "file": "Documentation/arm64/cpu-feature-registers.txt",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "Documentation/arm64/elf_hwcaps.txt",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "Documentation/arm64/silicon-errata.txt",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "Documentation/devicetree/bindings/arm/arm-dsu-pmu.txt",
      "insertions": 27,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/arm/firmware/sdei.txt",
      "insertions": 42,
      "deletions": 0
    },
    {
      "file": "Documentation/perf/arm_dsu_pmu.txt",
      "insertions": 28,
      "deletions": 0
    },
    {
      "file": "MAINTAINERS",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "arch/arm/include/asm/kvm_host.h",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "arch/arm/include/asm/kvm_mmu.h",
      "insertions": 17,
      "deletions": 0
    },
    {
      "file": "arch/arm64/Kconfig",
      "insertions": 79,
      "deletions": 12
    },
    {
      "file": "arch/arm64/include/asm/alternative.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/arm_dsu_pmu.h",
      "insertions": 129,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/asm-uaccess.h",
      "insertions": 27,
      "deletions": 15
    },
    {
      "file": "arch/arm64/include/asm/assembler.h",
      "insertions": 43,
      "deletions": 32
    },
    {
      "file": "arch/arm64/include/asm/cpucaps.h",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "arch/arm64/include/asm/cputype.h",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/efi.h",
      "insertions": 7,
      "deletions": 5
    },
    {
      "file": "arch/arm64/include/asm/esr.h",
      "insertions": 20,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/exception.h",
      "insertions": 14,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/fixmap.h",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/fpsimd.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/arm64/include/asm/kernel-pgtable.h",
      "insertions": 56,
      "deletions": 3
    },
    {
      "file": "arch/arm64/include/asm/kvm_arm.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/kvm_asm.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/kvm_emulate.h",
      "insertions": 17,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/kvm_host.h",
      "insertions": 19,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/kvm_mmu.h",
      "insertions": 56,
      "deletions": 3
    },
    {
      "file": "arch/arm64/include/asm/mmu.h",
      "insertions": 49,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/mmu_context.h",
      "insertions": 21,
      "deletions": 6
    },
    {
      "file": "arch/arm64/include/asm/percpu.h",
      "insertions": 9,
      "deletions": 2
    },
    {
      "file": "arch/arm64/include/asm/pgalloc.h",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "arch/arm64/include/asm/pgtable-hwdef.h",
      "insertions": 28,
      "deletions": 4
    },
    {
      "file": "arch/arm64/include/asm/pgtable-prot.h",
      "insertions": 15,
      "deletions": 6
    },
    {
      "file": "arch/arm64/include/asm/pgtable.h",
      "insertions": 46,
      "deletions": 11
    },
    {
      "file": "arch/arm64/include/asm/proc-fns.h",
      "insertions": 0,
      "deletions": 6
    },
    {
      "file": "arch/arm64/include/asm/processor.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/sdei.h",
      "insertions": 57,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/sections.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/sparsemem.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/arm64/include/asm/stacktrace.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/sysreg.h",
      "insertions": 90,
      "deletions": 2
    },
    {
      "file": "arch/arm64/include/asm/tlbflush.h",
      "insertions": 14,
      "deletions": 2
    },
    {
      "file": "arch/arm64/include/asm/traps.h",
      "insertions": 54,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/asm/uaccess.h",
      "insertions": 34,
      "deletions": 6
    },
    {
      "file": "arch/arm64/include/asm/vmap_stack.h",
      "insertions": 28,
      "deletions": 0
    },
    {
      "file": "arch/arm64/include/uapi/asm/hwcap.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/arm64/kernel/Makefile",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "arch/arm64/kernel/acpi.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kernel/alternative.c",
      "insertions": 5,
      "deletions": 4
    },
    {
      "file": "arch/arm64/kernel/asm-offsets.c",
      "insertions": 11,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kernel/bpi.S",
      "insertions": 87,
      "deletions": 0
    },
    {
      "file": "arch/arm64/kernel/cpu_errata.c",
      "insertions": 189,
      "deletions": 3
    },
    {
      "file": "arch/arm64/kernel/cpufeature.c",
      "insertions": 123,
      "deletions": 23
    },
    {
      "file": "arch/arm64/kernel/cpuidle.c",
      "insertions": 7,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kernel/cpuinfo.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/arm64/kernel/entry.S",
      "insertions": 365,
      "deletions": 31
    },
    {
      "file": "arch/arm64/kernel/fpsimd.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/kernel/head.S",
      "insertions": 172,
      "deletions": 73
    },
    {
      "file": "arch/arm64/kernel/hibernate-asm.S",
      "insertions": 7,
      "deletions": 5
    },
    {
      "file": "arch/arm64/kernel/hibernate.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "arch/arm64/kernel/irq.c",
      "insertions": 2,
      "deletions": 11
    },
    {
      "file": "arch/arm64/kernel/process.c",
      "insertions": 5,
      "deletions": 7
    },
    {
      "file": "arch/arm64/kernel/sdei.c",
      "insertions": 235,
      "deletions": 0
    },
    {
      "file": "arch/arm64/kernel/signal.c",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "arch/arm64/kernel/signal32.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "arch/arm64/kernel/smp.c",
      "insertions": 10,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kernel/suspend.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/kernel/topology.c",
      "insertions": 6,
      "deletions": 10
    },
    {
      "file": "arch/arm64/kernel/traps.c",
      "insertions": 46,
      "deletions": 5
    },
    {
      "file": "arch/arm64/kernel/vmlinux.lds.S",
      "insertions": 24,
      "deletions": 3
    },
    {
      "file": "arch/arm64/kvm/handle_exit.c",
      "insertions": 30,
      "deletions": 2
    },
    {
      "file": "arch/arm64/kvm/hyp-init.S",
      "insertions": 16,
      "deletions": 14
    },
    {
      "file": "arch/arm64/kvm/hyp/entry.S",
      "insertions": 32,
      "deletions": 3
    },
    {
      "file": "arch/arm64/kvm/hyp/hyp-entry.S",
      "insertions": 15,
      "deletions": 3
    },
    {
      "file": "arch/arm64/kvm/hyp/s2-setup.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/arm64/kvm/hyp/switch.c",
      "insertions": 44,
      "deletions": 16
    },
    {
      "file": "arch/arm64/kvm/hyp/sysreg-sr.c",
      "insertions": 14,
      "deletions": 8
    },
    {
      "file": "arch/arm64/kvm/inject_fault.c",
      "insertions": 12,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kvm/sys_regs.c",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "arch/arm64/lib/clear_user.S",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/lib/copy_from_user.S",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/lib/copy_in_user.S",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/lib/copy_to_user.S",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/lib/tishift.S",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "arch/arm64/mm/cache.S",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "arch/arm64/mm/context.c",
      "insertions": 40,
      "deletions": 27
    },
    {
      "file": "arch/arm64/mm/fault.c",
      "insertions": 17,
      "deletions": 0
    },
    {
      "file": "arch/arm64/mm/init.c",
      "insertions": 3,
      "deletions": 43
    },
    {
      "file": "arch/arm64/mm/mmu.c",
      "insertions": 41,
      "deletions": 6
    },
    {
      "file": "arch/arm64/mm/pgd.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "arch/arm64/mm/proc.S",
      "insertions": 31,
      "deletions": 35
    },
    {
      "file": "arch/arm64/xen/hypercall.S",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/firmware/Kconfig",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/firmware/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/firmware/arm_sdei.c",
      "insertions": 1092,
      "deletions": 0
    },
    {
      "file": "drivers/firmware/psci.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/hwtracing/coresight/of_coresight.c",
      "insertions": 3,
      "deletions": 12
    },
    {
      "file": "drivers/irqchip/irq-gic-v3.c",
      "insertions": 2,
      "deletions": 27
    },
    {
      "file": "drivers/of/base.c",
      "insertions": 26,
      "deletions": 0
    },
    {
      "file": "drivers/perf/Kconfig",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "drivers/perf/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/perf/arm_dsu_pmu.c",
      "insertions": 843,
      "deletions": 0
    },
    {
      "file": "drivers/perf/arm_pmu_platform.c",
      "insertions": 3,
      "deletions": 12
    },
    {
      "file": "drivers/perf/arm_spe_pmu.c",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "include/linux/arm_sdei.h",
      "insertions": 79,
      "deletions": 0
    },
    {
      "file": "include/linux/cpuhotplug.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/linux/cpuidle.h",
      "insertions": 24,
      "deletions": 16
    },
    {
      "file": "include/linux/of.h",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "include/linux/psci.h",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "include/uapi/linux/arm_sdei.h",
      "insertions": 73,
      "deletions": 0
    },
    {
      "file": "kernel/events/core.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "virt/kvm/arm/arm.c",
      "insertions": 18,
      "deletions": 17
    },
    {
      "file": "virt/kvm/arm/mmu.c",
      "insertions": 6,
      "deletions": 6
    }
  ],
  "total_insertions": 4941,
  "total_deletions": 579,
  "total_changes": 5520,
  "parents": [
    "72906f38934a49faf4d2d38ea9ae32adcf7d5d0c",
    "ec89ab50a03a33a4a648869e868b1964354fb2d1"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.16-rc1",
    "v4.16-rc2",
    "v4.16-rc3",
    "v4.16-rc4",
    "v4.16-rc5",
    "v4.16-rc6",
    "v4.16-rc7",
    "v4.17",
    "v4.17-rc1"
  ],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening",
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/arm64/include/asm/assembler.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/include/asm/cputype.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "Documentation/arm64/silicon-errata.txt",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/kvm/hyp-init.S",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/include/asm/pgtable.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/kernel/cpufeature.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/kernel/head.S",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/kvm/handle_exit.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/mm/fault.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm64/mm/init.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/cpuhotplug.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/arm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/irqchip/irq-gic-v3.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/mmu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "MAINTAINERS",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/events/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}