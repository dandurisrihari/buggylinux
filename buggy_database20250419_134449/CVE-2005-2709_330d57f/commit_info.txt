Commit Hash: 330d57fb98a916fa8e1363846540dd420e99499a
Subject: [PATCH] Fix sysctl unregistration oops (CVE-2005-2709)

CVE Identifiers:
- CVE-2005-2709
- CVE-2005-2709

Full commit message:
[PATCH] Fix sysctl unregistration oops (CVE-2005-2709)

You could open the /proc/sys/net/ipv4/conf/<if>/<whatever> file, then
wait for interface to go away, try to grab as much memory as possible in
hope to hit the (kfreed) ctl_table.  Then fill it with pointers to your
function.  Then do read from file you've opened and if you are lucky,
you'll get it called as ->proc_handler() in kernel mode.

So this is at least an Oops and possibly more.  It does depend on an
interface going away though, so less of a security risk than it would
otherwise be.

Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
Signed-off-by: Linus Torvalds <torvalds@osdl.org>

Metadata:
Author: Al Viro <viro@zeniv.linux.org.uk>
Author Date: Fri Nov 4 10:18:40 2005 +0000
Committer: Linus Torvalds <torvalds@g5.osdl.org>
Commit Date: Tue Nov 8 17:57:30 2005 -0800

Files Changed: 4
Lines Added: 116
Lines Removed: 31
Total Changes: 147
