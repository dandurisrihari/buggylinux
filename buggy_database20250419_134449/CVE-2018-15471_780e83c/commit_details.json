{
  "hash": "780e83c259fc33e8959fed8dfdad17e378d72b62",
  "hash_short": "780e83c2",
  "subject": "xen-netback: fix input validation in xenvif_set_hash_mapping()",
  "body": "Both len and off are frontend specified values, so we need to make\nsure there's no overflow when adding the two for the bounds check. We\nalso want to avoid undefined behavior and hence use off to index into\n->hash.mapping[] only after bounds checking. This at the same time\nallows to take care of not applying off twice for the bounds checking\nagainst vif->num_queues.\n\nIt is also insufficient to bounds check copy_op.len, as this is len\ntruncated to 16 bits.\n\nThis is XSA-270 / CVE-2018-15471.\n\nReported-by: Felix Wilhelm <fwilhelm@google.com>\nSigned-off-by: Jan Beulich <jbeulich@suse.com>\nReviewed-by: Paul Durrant <paul.durrant@citrix.com>\nTested-by: Paul Durrant <paul.durrant@citrix.com>\nCc: stable@vger.kernel.org [4.7 onwards]\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "xen-netback: fix input validation in xenvif_set_hash_mapping()\n\nBoth len and off are frontend specified values, so we need to make\nsure there's no overflow when adding the two for the bounds check. We\nalso want to avoid undefined behavior and hence use off to index into\n->hash.mapping[] only after bounds checking. This at the same time\nallows to take care of not applying off twice for the bounds checking\nagainst vif->num_queues.\n\nIt is also insufficient to bounds check copy_op.len, as this is len\ntruncated to 16 bits.\n\nThis is XSA-270 / CVE-2018-15471.\n\nReported-by: Felix Wilhelm <fwilhelm@google.com>\nSigned-off-by: Jan Beulich <jbeulich@suse.com>\nReviewed-by: Paul Durrant <paul.durrant@citrix.com>\nTested-by: Paul Durrant <paul.durrant@citrix.com>\nCc: stable@vger.kernel.org [4.7 onwards]\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Jan Beulich",
  "author_email": "JBeulich@suse.com",
  "author_date": "Tue Sep 25 02:12:30 2018 -0600",
  "author_date_iso": "2018-09-25T02:12:30-06:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Sep 25 10:39:34 2018 -0700",
  "committer_date_iso": "2018-09-25T10:39:34-07:00",
  "files_changed": [
    "drivers/net/xen-netback/hash.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/xen-netback/hash.c",
      "insertions": 7,
      "deletions": 5
    }
  ],
  "total_insertions": 7,
  "total_deletions": 5,
  "total_changes": 12,
  "parents": [
    "e1e5d8a9fe737d94ccc0ccbaf0c97f69a8f3e000"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20",
    "v4.20-rc1",
    "v4.20-rc2",
    "v4.20-rc3",
    "v4.20-rc4",
    "v4.20-rc5",
    "v4.20-rc6"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2018-15471"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/xen-netback/hash.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}