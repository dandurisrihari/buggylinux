{
  "hash": "492855939bdb59c6f947b0b5b44af9ad82b7e38c",
  "hash_short": "49285593",
  "subject": "vfio/type1: Limit DMA mappings per container",
  "body": "Memory backed DMA mappings are accounted against a user's locked\nmemory limit, including multiple mappings of the same memory.  This\naccounting bounds the number of such mappings that a user can create.\nHowever, DMA mappings that are not backed by memory, such as DMA\nmappings of device MMIO via mmaps, do not make use of page pinning\nand therefore do not count against the user's locked memory limit.\nThese mappings still consume memory, but the memory is not well\nassociated to the process for the purpose of oom killing a task.\n\nTo add bounding on this use case, we introduce a limit to the total\nnumber of concurrent DMA mappings that a user is allowed to create.\nThis limit is exposed as a tunable module option where the default\nvalue of 64K is expected to be well in excess of any reasonable use\ncase (a large virtual machine configuration would typically only make\nuse of tens of concurrent mappings).\n\nThis fixes CVE-2019-3882.\n\nReviewed-by: Eric Auger <eric.auger@redhat.com>\nTested-by: Eric Auger <eric.auger@redhat.com>\nReviewed-by: Peter Xu <peterx@redhat.com>\nReviewed-by: Cornelia Huck <cohuck@redhat.com>\nSigned-off-by: Alex Williamson <alex.williamson@redhat.com>",
  "full_message": "vfio/type1: Limit DMA mappings per container\n\nMemory backed DMA mappings are accounted against a user's locked\nmemory limit, including multiple mappings of the same memory.  This\naccounting bounds the number of such mappings that a user can create.\nHowever, DMA mappings that are not backed by memory, such as DMA\nmappings of device MMIO via mmaps, do not make use of page pinning\nand therefore do not count against the user's locked memory limit.\nThese mappings still consume memory, but the memory is not well\nassociated to the process for the purpose of oom killing a task.\n\nTo add bounding on this use case, we introduce a limit to the total\nnumber of concurrent DMA mappings that a user is allowed to create.\nThis limit is exposed as a tunable module option where the default\nvalue of 64K is expected to be well in excess of any reasonable use\ncase (a large virtual machine configuration would typically only make\nuse of tens of concurrent mappings).\n\nThis fixes CVE-2019-3882.\n\nReviewed-by: Eric Auger <eric.auger@redhat.com>\nTested-by: Eric Auger <eric.auger@redhat.com>\nReviewed-by: Peter Xu <peterx@redhat.com>\nReviewed-by: Cornelia Huck <cohuck@redhat.com>\nSigned-off-by: Alex Williamson <alex.williamson@redhat.com>",
  "author_name": "Alex Williamson",
  "author_email": "alex.williamson@redhat.com",
  "author_date": "Wed Apr 3 12:36:21 2019 -0600",
  "author_date_iso": "2019-04-03T12:36:21-06:00",
  "committer_name": "Alex Williamson",
  "committer_email": "alex.williamson@redhat.com",
  "committer_date": "Wed Apr 3 12:43:05 2019 -0600",
  "committer_date_iso": "2019-04-03T12:43:05-06:00",
  "files_changed": [
    "drivers/vfio/vfio_iommu_type1.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/vfio/vfio_iommu_type1.c",
      "insertions": 14,
      "deletions": 0
    }
  ],
  "total_insertions": 14,
  "total_deletions": 0,
  "total_changes": 14,
  "parents": [
    "e39dd513d5f2ae2041c593d42fd0d8b24e7e950b"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.1",
    "v5.1-rc4",
    "v5.1-rc5",
    "v5.1-rc6",
    "v5.1-rc7",
    "v5.2",
    "v5.2-rc1",
    "v5.2-rc2",
    "v5.2-rc3",
    "v5.2-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2019-3882"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/vfio/vfio_iommu_type1.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}