{
  "hash": "5807b22c9164a21cd1077a9bc587f0bba361f72d",
  "hash_short": "5807b22c",
  "subject": "ipv6: sr: fix seg6 encap performances with TSO enabled",
  "body": "Enabling TSO can lead to abysmal performances when using seg6 in\nencap mode, such as with the ixgbe driver. This patch adds a call to\niptunnel_handle_offloads() to remove the encapsulation bit if needed.\n\nBefore:\nroot@comp4-seg6bpf:~# iperf3 -c fc00::55\nConnecting to host fc00::55, port 5201\n[  4] local fc45::4 port 36592 connected to fc00::55 port 5201\n[ ID] Interval           Transfer     Bandwidth       Retr  Cwnd\n[  4]   0.00-1.00   sec   196 KBytes  1.60 Mbits/sec   47   6.66 KBytes\n[  4]   1.00-2.00   sec   304 KBytes  2.49 Mbits/sec  100   5.33 KBytes\n[  4]   2.00-3.00   sec   284 KBytes  2.32 Mbits/sec   92   5.33 KBytes\n\nAfter:\nroot@comp4-seg6bpf:~# iperf3 -c fc00::55\nConnecting to host fc00::55, port 5201\n[  4] local fc45::4 port 43062 connected to fc00::55 port 5201\n[ ID] Interval           Transfer     Bandwidth       Retr  Cwnd\n[  4]   0.00-1.00   sec  1.03 GBytes  8.89 Gbits/sec    0    743 KBytes\n[  4]   1.00-2.00   sec  1.03 GBytes  8.87 Gbits/sec    0    743 KBytes\n[  4]   2.00-3.00   sec  1.03 GBytes  8.87 Gbits/sec    0    743 KBytes\n\nReported-by: Tom Herbert <tom@quantonium.net>\nFixes: 6c8702c60b88 (\"ipv6: sr: add support for SRH encapsulation and injection with lwtunnels\")\nSigned-off-by: David Lebrun <dlebrun@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "ipv6: sr: fix seg6 encap performances with TSO enabled\n\nEnabling TSO can lead to abysmal performances when using seg6 in\nencap mode, such as with the ixgbe driver. This patch adds a call to\niptunnel_handle_offloads() to remove the encapsulation bit if needed.\n\nBefore:\nroot@comp4-seg6bpf:~# iperf3 -c fc00::55\nConnecting to host fc00::55, port 5201\n[  4] local fc45::4 port 36592 connected to fc00::55 port 5201\n[ ID] Interval           Transfer     Bandwidth       Retr  Cwnd\n[  4]   0.00-1.00   sec   196 KBytes  1.60 Mbits/sec   47   6.66 KBytes\n[  4]   1.00-2.00   sec   304 KBytes  2.49 Mbits/sec  100   5.33 KBytes\n[  4]   2.00-3.00   sec   284 KBytes  2.32 Mbits/sec   92   5.33 KBytes\n\nAfter:\nroot@comp4-seg6bpf:~# iperf3 -c fc00::55\nConnecting to host fc00::55, port 5201\n[  4] local fc45::4 port 43062 connected to fc00::55 port 5201\n[ ID] Interval           Transfer     Bandwidth       Retr  Cwnd\n[  4]   0.00-1.00   sec  1.03 GBytes  8.89 Gbits/sec    0    743 KBytes\n[  4]   1.00-2.00   sec  1.03 GBytes  8.87 Gbits/sec    0    743 KBytes\n[  4]   2.00-3.00   sec  1.03 GBytes  8.87 Gbits/sec    0    743 KBytes\n\nReported-by: Tom Herbert <tom@quantonium.net>\nFixes: 6c8702c60b88 (\"ipv6: sr: add support for SRH encapsulation and injection with lwtunnels\")\nSigned-off-by: David Lebrun <dlebrun@google.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "David Lebrun",
  "author_email": "dlebrun@google.com",
  "author_date": "Thu Mar 29 17:59:36 2018 +0100",
  "author_date_iso": "2018-03-29T17:59:36+01:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Fri Mar 30 14:14:33 2018 -0400",
  "committer_date_iso": "2018-03-30T14:14:33-04:00",
  "files_changed": [
    "net/ipv6/seg6_iptunnel.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/ipv6/seg6_iptunnel.c",
      "insertions": 7,
      "deletions": 9
    }
  ],
  "total_insertions": 7,
  "total_deletions": 9,
  "total_changes": 16,
  "parents": [
    "f97c3dc3c0e8d23a5c4357d182afeef4c67f5c33"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.17",
    "v4.17-rc1",
    "v4.17-rc2",
    "v4.17-rc3",
    "v4.17-rc4",
    "v4.17-rc5",
    "v4.17-rc6",
    "v4.17-rc7",
    "v4.18"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/ipv6/seg6_iptunnel.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}