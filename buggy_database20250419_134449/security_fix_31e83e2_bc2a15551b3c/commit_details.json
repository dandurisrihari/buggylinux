{
  "hash": "31e83e21cf00fe5b669eb352ff3ed70e74b40fad",
  "hash_short": "31e83e21",
  "subject": "KVM: x86: compile out vendor-specific code if SMM is disabled",
  "body": "Vendor-specific code that deals with SMI injection and saving/restoring\nSMM state is not needed if CONFIG_KVM_SMM is disabled, so remove the\nfour callbacks smi_allowed, enter_smm, leave_smm and enable_smi_window.\nThe users in svm/nested.c and x86.c also have to be compiled out; the\namount of #ifdef'ed code is small and it's not worth moving it to\nsmm.c.\n\nenter_smm is now used only within #ifdef CONFIG_KVM_SMM, and the stub\ncan therefore be removed.\n\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\nReviewed-by: Maxim Levitsky <mlevitsk@redhat.com>\nMessage-Id: <20220929172016.319443-7-pbonzini@redhat.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "KVM: x86: compile out vendor-specific code if SMM is disabled\n\nVendor-specific code that deals with SMI injection and saving/restoring\nSMM state is not needed if CONFIG_KVM_SMM is disabled, so remove the\nfour callbacks smi_allowed, enter_smm, leave_smm and enable_smi_window.\nThe users in svm/nested.c and x86.c also have to be compiled out; the\namount of #ifdef'ed code is small and it's not worth moving it to\nsmm.c.\n\nenter_smm is now used only within #ifdef CONFIG_KVM_SMM, and the stub\ncan therefore be removed.\n\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>\nReviewed-by: Maxim Levitsky <mlevitsk@redhat.com>\nMessage-Id: <20220929172016.319443-7-pbonzini@redhat.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Paolo Bonzini",
  "author_email": "pbonzini@redhat.com",
  "author_date": "Thu Sep 29 13:20:14 2022 -0400",
  "author_date_iso": "2022-09-29T13:20:14-04:00",
  "committer_name": "Paolo Bonzini",
  "committer_email": "pbonzini@redhat.com",
  "committer_date": "Wed Nov 9 12:31:19 2022 -0500",
  "committer_date_iso": "2022-11-09T12:31:19-05:00",
  "files_changed": [
    "arch/x86/include/asm/kvm-x86-ops.h",
    "arch/x86/include/asm/kvm_host.h",
    "arch/x86/kvm/smm.h",
    "arch/x86/kvm/svm/nested.c",
    "arch/x86/kvm/svm/svm.c",
    "arch/x86/kvm/vmx/vmx.c",
    "arch/x86/kvm/x86.c"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "arch/x86/include/asm/kvm-x86-ops.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/x86/include/asm/kvm_host.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/smm.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "arch/x86/kvm/svm/nested.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/svm/svm.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/vmx/vmx.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/x86.c",
      "insertions": 4,
      "deletions": 0
    }
  ],
  "total_insertions": 18,
  "total_deletions": 1,
  "total_changes": 19,
  "parents": [
    "4b8e1b32013da2495244dbdee70f2456e6bc7aca"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/kvm/svm/nested.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/include/asm/kvm-x86-ops.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/include/asm/kvm_host.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/smm.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/svm/svm.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/vmx/vmx.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/x86.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}