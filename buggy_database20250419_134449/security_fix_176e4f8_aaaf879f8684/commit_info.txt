Commit Hash: 176e4f84423af3105894a7d71b23c1a16678a6be
Subject: mac80211: move tx crypto decision


Security Keywords:
- injection

Full commit message:
mac80211: move tx crypto decision

This patch moves the decision making about whether a frame is encrypted
with a certain algorithm up into the TX handlers rather than having it
in the crypto algorithm implementation.

This fixes a problem with the radiotap injection code where injecting
a non-data packet and requesting encryption could end up asking the
driver to encrypt a packet without giving it a key.

Signed-off-by: Johannes Berg <johannes@sipsolutions.net>
Signed-off-by: John W. Linville <linville@tuxdriver.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Johannes Berg <johannes@sipsolutions.net>
Author Date: Tue Dec 18 15:27:47 2007 +0100
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Jan 28 14:59:53 2008 -0800

Files Changed: 3
Lines Added: 22
Lines Removed: 41
Total Changes: 63
