Commit Hash: 0bc23d8b2237a104d7f8379d687aa4cb82e2968b
Subject: ACPI: tools: pfrut: Check if the input of level and type is in the right numeric range


Security Keywords:
- injection

Full commit message:
ACPI: tools: pfrut: Check if the input of level and type is in the right numeric range

The user provides arbitrary non-numeic value to level and type,
which could bring unexpected behavior. In this case the expected
behavior would be to throw an error.

 pfrut -h
usage: pfrut [OPTIONS]
code injection:
-l, --load
-s, --stage
-a, --activate
-u, --update [stage and activate]
-q, --query
-d, --revid
updateÂ telemetry:
-G, --getloginfo
-T, --type(0:execution, 1:history)
-L, --level(0, 1, 2, 4)
-R, --read
-D, --revid log

 pfrut -T A
 pfrut -G
log_level:0
log_type:0
log_revid:2
max_data_size:65536
chunk1_size:0
chunk2_size:1530
rollover_cnt:0
reset_cnt:17

Fix this by restricting the input to be in the expected range.

Reported-by: Hariganesh Govindarajulu <hariganesh.govindarajulu@intel.com>
Suggested-by: "Rafael J. Wysocki" <rafael.j.wysocki@intel.com>
Signed-off-by: Chen Yu <yu.c.chen@intel.com>
Signed-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>

Metadata:
Author: Chen Yu <yu.c.chen@intel.com>
Author Date: Wed Mar 8 21:23:09 2023 +0800
Committer: Rafael J. Wysocki <rafael.j.wysocki@intel.com>
Commit Date: Tue Mar 14 20:38:13 2023 +0100

Files Changed: 1
Lines Added: 15
Lines Removed: 3
Total Changes: 18
