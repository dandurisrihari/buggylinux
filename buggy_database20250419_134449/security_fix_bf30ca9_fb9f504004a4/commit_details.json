{
  "hash": "bf30ca922a0c0176007e074b0acc77ed345e9990",
  "hash_short": "bf30ca92",
  "subject": "mac80211: check defrag PN against current frame",
  "body": "As pointed out by Mathy Vanhoef, we implement the RX PN check\non fragmented frames incorrectly - we check against the last\nreceived PN prior to the new frame, rather than to the one in\nthis frame itself.\n\nPrior patches addressed the security issue here, but in order\nto be able to reason better about the code, fix it to really\ncompare against the current frame's PN, not the last stored\none.\n\nCc: stable@vger.kernel.org\nLink: https://lore.kernel.org/r/20210511200110.bfbc340ff071.Id0b690e581da7d03d76df90bb0e3fd55930bc8a0@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: check defrag PN against current frame\n\nAs pointed out by Mathy Vanhoef, we implement the RX PN check\non fragmented frames incorrectly - we check against the last\nreceived PN prior to the new frame, rather than to the one in\nthis frame itself.\n\nPrior patches addressed the security issue here, but in order\nto be able to reason better about the code, fix it to really\ncompare against the current frame's PN, not the last stored\none.\n\nCc: stable@vger.kernel.org\nLink: https://lore.kernel.org/r/20210511200110.bfbc340ff071.Id0b690e581da7d03d76df90bb0e3fd55930bc8a0@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Tue May 11 20:02:48 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:48+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:13:45 2021 +0200",
  "committer_date_iso": "2021-05-11T20:13:45+02:00",
  "files_changed": [
    "net/mac80211/ieee80211_i.h",
    "net/mac80211/rx.c",
    "net/mac80211/wpa.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "insertions": 9,
      "deletions": 2
    },
    {
      "file": "net/mac80211/rx.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "net/mac80211/wpa.c",
      "insertions": 9,
      "deletions": 4
    }
  ],
  "total_insertions": 20,
  "total_deletions": 9,
  "total_changes": 29,
  "parents": [
    "3a11ce08c45b50d69c891d71760b7c5b92074709"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security issue"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/rx.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/wpa.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}