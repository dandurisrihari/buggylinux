{
  "hash": "c3ae62af8e755ea68380fb5ce682e60079a4c388",
  "hash_short": "c3ae62af",
  "subject": "tcp: should drop incoming frames without ACK flag set",
  "body": "In commit 96e0bf4b5193d (tcp: Discard segments that ack data not yet\nsent) John Dykstra enforced a check against ack sequences.\n\nIn commit 354e4aa391ed5 (tcp: RFC 5961 5.2 Blind Data Injection Attack\nMitigation) I added more safety tests.\n\nBut we missed fact that these tests are not performed if ACK bit is\nnot set.\n\nRFC 793 3.9 mandates TCP should drop a frame without ACK flag set.\n\n\" fifth check the ACK field,\n      if the ACK bit is off drop the segment and return\"\n\nNot doing so permits an attacker to only guess an acceptable sequence\nnumber, evading stronger checks.\n\nMany thanks to Zhiyun Qian for bringing this issue to our attention.\n\nSee :\nhttp://web.eecs.umich.edu/~zhiyunq/pub/ccs12_TCP_sequence_number_inference.pdf\n\nReported-by: Zhiyun Qian <zhiyunq@umich.edu>\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nCc: Nandita Dukkipati <nanditad@google.com>\nCc: Neal Cardwell <ncardwell@google.com>\nCc: John Dykstra <john.dykstra1@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "tcp: should drop incoming frames without ACK flag set\n\nIn commit 96e0bf4b5193d (tcp: Discard segments that ack data not yet\nsent) John Dykstra enforced a check against ack sequences.\n\nIn commit 354e4aa391ed5 (tcp: RFC 5961 5.2 Blind Data Injection Attack\nMitigation) I added more safety tests.\n\nBut we missed fact that these tests are not performed if ACK bit is\nnot set.\n\nRFC 793 3.9 mandates TCP should drop a frame without ACK flag set.\n\n\" fifth check the ACK field,\n      if the ACK bit is off drop the segment and return\"\n\nNot doing so permits an attacker to only guess an acceptable sequence\nnumber, evading stronger checks.\n\nMany thanks to Zhiyun Qian for bringing this issue to our attention.\n\nSee :\nhttp://web.eecs.umich.edu/~zhiyunq/pub/ccs12_TCP_sequence_number_inference.pdf\n\nReported-by: Zhiyun Qian <zhiyunq@umich.edu>\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nCc: Nandita Dukkipati <nanditad@google.com>\nCc: Neal Cardwell <ncardwell@google.com>\nCc: John Dykstra <john.dykstra1@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Eric Dumazet",
  "author_email": "edumazet@google.com",
  "author_date": "Wed Dec 26 12:44:34 2012 +0000",
  "author_date_iso": "2012-12-26T12:44:34+00:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Wed Dec 26 15:08:55 2012 -0800",
  "committer_date_iso": "2012-12-26T15:08:55-08:00",
  "files_changed": [
    "net/ipv4/tcp_input.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/ipv4/tcp_input.c",
      "insertions": 10,
      "deletions": 4
    }
  ],
  "total_insertions": 10,
  "total_deletions": 4,
  "total_changes": 14,
  "parents": [
    "3d0dcfbd8fa2a1e63fabb5f8edac8b8a27860d98"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/ipv4/tcp_input.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}