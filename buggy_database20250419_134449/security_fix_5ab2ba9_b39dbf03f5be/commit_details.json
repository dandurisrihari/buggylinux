{
  "hash": "5ab2ba931255d8bf03009c06d58dce97de32797c",
  "hash_short": "5ab2ba93",
  "subject": "iwlwifi: mvm: fix security bug in PN checking",
  "body": "A previous patch allowed the same PN for packets originating from the\nsame AMSDU by copying PN only for the last packet in the series.\n\nThis however is bogus since we cannot assume the last frame will be\nreceived on the same queue, and if it is received on a different ueue\nwe will end up not incrementing the PN and possibly let the next\npacket to have the same PN and pass through.\n\nChange the logic instead to driver explicitly indicate for the second\nsub frame and on to be allowed to have the same PN as the first\nsubframe. Indicate it to mac80211 as well for the fallback queue.\n\nFixes: f1ae02b186d9 (\"iwlwifi: mvm: allow same PN for de-aggregated AMSDU\")\nSigned-off-by: Sara Sharon <sara.sharon@intel.com>\nSigned-off-by: Luca Coelho <luciano.coelho@intel.com>",
  "full_message": "iwlwifi: mvm: fix security bug in PN checking\n\nA previous patch allowed the same PN for packets originating from the\nsame AMSDU by copying PN only for the last packet in the series.\n\nThis however is bogus since we cannot assume the last frame will be\nreceived on the same queue, and if it is received on a different ueue\nwe will end up not incrementing the PN and possibly let the next\npacket to have the same PN and pass through.\n\nChange the logic instead to driver explicitly indicate for the second\nsub frame and on to be allowed to have the same PN as the first\nsubframe. Indicate it to mac80211 as well for the fallback queue.\n\nFixes: f1ae02b186d9 (\"iwlwifi: mvm: allow same PN for de-aggregated AMSDU\")\nSigned-off-by: Sara Sharon <sara.sharon@intel.com>\nSigned-off-by: Luca Coelho <luciano.coelho@intel.com>",
  "author_name": "Sara Sharon",
  "author_email": "sara.sharon@intel.com",
  "author_date": "Tue Mar 29 10:56:57 2016 +0300",
  "author_date_iso": "2016-03-29T10:56:57+03:00",
  "committer_name": "Luca Coelho",
  "committer_email": "luciano.coelho@intel.com",
  "committer_date": "Fri Feb 16 15:34:31 2018 +0200",
  "committer_date_iso": "2018-02-16T15:34:31+02:00",
  "files_changed": [
    "drivers/net/wireless/intel/iwlwifi/mvm/rxmq.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/wireless/intel/iwlwifi/mvm/rxmq.c",
      "insertions": 20,
      "deletions": 19
    }
  ],
  "total_insertions": 20,
  "total_deletions": 19,
  "total_changes": 39,
  "parents": [
    "7ac8ff95f48cbfa609a060fd6a1e361dd62feeb3"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.16-rc7",
    "v4.17",
    "v4.17-rc1",
    "v4.17-rc2",
    "v4.17-rc3",
    "v4.17-rc4",
    "v4.17-rc5",
    "v4.17-rc6",
    "v4.17-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security bug"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/intel/iwlwifi/mvm/rxmq.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}