Commit Hash: 49b3cf035edc5d7deb3ad1bf6805ce456ababc5b
Subject: kasan: arm64: set TCR_EL1.TBID1 when enabled


Security Keywords:
- authentication

Full commit message:
kasan: arm64: set TCR_EL1.TBID1 when enabled

On hardware supporting pointer authentication, we previously ended up
enabling TBI on instruction accesses when tag-based ASAN was enabled,
but this was costing us 8 bits of PAC entropy, which was unnecessary
since tag-based ASAN does not require TBI on instruction accesses. Get
them back by setting TCR_EL1.TBID1.

Signed-off-by: Peter Collingbourne <pcc@google.com>
Reviewed-by: Andrey Konovalov <andreyknvl@google.com>
Link: https://linux-review.googlesource.com/id/I3dded7824be2e70ea64df0aabab9598d5aebfcc4
Link: https://lore.kernel.org/r/20f64e26fc8a1309caa446fffcb1b4e2fe9e229f.1605952129.git.pcc@google.com
Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

Metadata:
Author: Peter Collingbourne <pcc@google.com>
Author Date: Sat Nov 21 01:59:02 2020 -0800
Committer: Catalin Marinas <catalin.marinas@arm.com>
Commit Date: Wed Nov 25 16:53:19 2020 +0000

Files Changed: 2
Lines Added: 2
Lines Removed: 1
Total Changes: 3
