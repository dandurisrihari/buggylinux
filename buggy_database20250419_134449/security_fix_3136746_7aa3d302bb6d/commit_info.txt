Commit Hash: 313674661925ee265f16570c893ea13cb9e00b82
Subject: Unify migrate_pages and move_pages access checks


Security Keywords:
- Sanitize
- security issue

Full commit message:
Unify migrate_pages and move_pages access checks

Commit 197e7e521384 ("Sanitize 'move_pages()' permission checks") fixed
a security issue I reported in the move_pages syscall, and made it so
that you can't act on set-uid processes unless you have the
CAP_SYS_PTRACE capability.

Unify the access check logic of migrate_pages to match the new behavior
of move_pages.  We discussed this a bit in the security@ list and
thought it'd be good for consistency even though there's no evident
security impact.  The NUMA node access checks are left intact and
require CAP_SYS_NICE as before.

Link: http://lkml.kernel.org/r/alpine.DEB.2.11.1710011830320.6333@lakka.kapsi.fi
Signed-off-by: Otto Ebeling <otto.ebeling@iki.fi>
Acked-by: Michal Hocko <mhocko@suse.com>
Cc: Eric W. Biederman <ebiederm@xmission.com>
Cc: Willy Tarreau <w@1wt.eu>
Cc: Kees Cook <keescook@chromium.org>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Otto Ebeling <otto.ebeling@iki.fi>
Author Date: Wed Nov 15 17:38:14 2017 -0800
Committer: Linus Torvalds <torvalds@linux-foundation.org>
Commit Date: Wed Nov 15 18:21:06 2017 -0800

Files Changed: 1
Lines Added: 4
Lines Removed: 9
Total Changes: 13
