{
  "hash": "3d6e48f43340343d97839eadb1ab7b6a3ea98797",
  "hash_short": "3d6e48f4",
  "subject": "[S390] CVE-2008-1514: prevent ptrace padding area read/write in 31-bit mode",
  "body": "When running a 31-bit ptrace, on either an s390 or s390x kernel,\nreads and writes into a padding area in struct user_regs_struct32\nwill result in a kernel panic.\n\nThis is also known as CVE-2008-1514.\n\nTest case available here:\nhttp://sources.redhat.com/cgi-bin/cvsweb.cgi/~checkout~/tests/ptrace-tests/tests/user-area-padding.c?cvsroot=systemtap\n\nSteps to reproduce:\n1) wget the above\n2) gcc -o user-area-padding-31bit user-area-padding.c -Wall -ggdb2 -D_GNU_SOURCE -m31\n3) ./user-area-padding-31bit\n<panic>\n\nTest status\n-----------\nWithout patch, both s390 and s390x kernels panic. With patch, the test case,\nas well as the gdb testsuite, pass without incident, padding area reads\nreturning zero, writes ignored.\n\nNb: original version returned -EINVAL on write attempts, which broke the\ngdb test and made the test case slightly unhappy, Jan Kratochvil suggested\nthe change to return 0 on write attempts.\n\nSigned-off-by: Jarod Wilson <jarod@redhat.com>\nTested-by: Jan Kratochvil <jan.kratochvil@redhat.com>\nSigned-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>",
  "full_message": "[S390] CVE-2008-1514: prevent ptrace padding area read/write in 31-bit mode\n\nWhen running a 31-bit ptrace, on either an s390 or s390x kernel,\nreads and writes into a padding area in struct user_regs_struct32\nwill result in a kernel panic.\n\nThis is also known as CVE-2008-1514.\n\nTest case available here:\nhttp://sources.redhat.com/cgi-bin/cvsweb.cgi/~checkout~/tests/ptrace-tests/tests/user-area-padding.c?cvsroot=systemtap\n\nSteps to reproduce:\n1) wget the above\n2) gcc -o user-area-padding-31bit user-area-padding.c -Wall -ggdb2 -D_GNU_SOURCE -m31\n3) ./user-area-padding-31bit\n<panic>\n\nTest status\n-----------\nWithout patch, both s390 and s390x kernels panic. With patch, the test case,\nas well as the gdb testsuite, pass without incident, padding area reads\nreturning zero, writes ignored.\n\nNb: original version returned -EINVAL on write attempts, which broke the\ngdb test and made the test case slightly unhappy, Jan Kratochvil suggested\nthe change to return 0 on write attempts.\n\nSigned-off-by: Jarod Wilson <jarod@redhat.com>\nTested-by: Jan Kratochvil <jan.kratochvil@redhat.com>\nSigned-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>",
  "author_name": "Jarod Wilson",
  "author_email": "jwilson@redhat.com",
  "author_date": "Tue Sep 9 12:38:56 2008 +0200",
  "author_date_iso": "2008-09-09T12:38:56+02:00",
  "committer_name": "Martin Schwidefsky",
  "committer_email": "schwidefsky@de.ibm.com",
  "committer_date": "Tue Sep 9 12:39:06 2008 +0200",
  "committer_date_iso": "2008-09-09T12:39:06+02:00",
  "files_changed": [
    "arch/s390/kernel/compat_ptrace.h",
    "arch/s390/kernel/ptrace.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "arch/s390/kernel/compat_ptrace.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/s390/kernel/ptrace.c",
      "insertions": 28,
      "deletions": 0
    }
  ],
  "total_insertions": 29,
  "total_deletions": 0,
  "total_changes": 29,
  "parents": [
    "82a28c794f27aac17d7a3ebd7f14d731a11a5532"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.27",
    "v2.6.27-rc6",
    "v2.6.27-rc7",
    "v2.6.27-rc8",
    "v2.6.27-rc9",
    "v2.6.28",
    "v2.6.28-rc1",
    "v2.6.28-rc2",
    "v2.6.28-rc3",
    "v2.6.28-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2008-1514",
      "CVE-2008-1514",
      "CVE-2008-1514"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "arch/s390/kernel/compat_ptrace.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/s390/kernel/ptrace.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}