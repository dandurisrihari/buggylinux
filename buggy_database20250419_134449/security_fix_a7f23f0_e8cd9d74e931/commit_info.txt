Commit Hash: a7f23f0a8f6be9d95d8110d34b21ccce03111447
Subject: mac80211: remove crypto special case for auth frames


Security Keywords:
- auth

Full commit message:
mac80211: remove crypto special case for auth frames

The shared key authentication frame that needs to be
encrypted (the third one in the shared key handshake)
is directly encrypted in ieee80211_send_auth and the
IEEE80211_TX_INTFL_DONT_ENCRYPT is set. All others
are not encrypted, so the only way to get to this is
erroneously on no-monitor AP side.

Remove the special case for authentication frames to
fix the AP shared key side when operating without
cooked monitor interfaces -- with cooked monitor the
IEEE80211_TX_INTFL_DONT_ENCRYPT also gets set, so we
never get here -- an AP never encrypts auth frames.

Without this patch, an AP operating in WEP mode with
my no-monitor patches would erroneously encrypt all
authentication frames, instead of none.

Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Mon Nov 14 15:02:44 2011 +0100
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Thu Nov 17 15:43:56 2011 -0500

Files Changed: 1
Lines Added: 0
Lines Removed: 2
Total Changes: 2
