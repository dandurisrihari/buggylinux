Commit Hash: 220c56729766444f3dd823f740a147ca6d82c4c6
Subject: KVM: nVMX: Do not inject NMI vmexits when L2 has a pending interrupt


Security Keywords:
- inject

Full commit message:
KVM: nVMX: Do not inject NMI vmexits when L2 has a pending interrupt

According to SDM 27.2.3, IDT vectoring information will not be valid on
vmexits caused by external NMIs. So we have to avoid creating such
scenarios by delaying EXIT_REASON_EXCEPTION_NMI injection as long as we
have a pending interrupt because that one would be migrated to L1's IDT
vectoring info on nested exit.

Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Jan Kiszka <jan.kiszka@siemens.com>
Author Date: Fri Mar 7 20:03:14 2014 +0100
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Tue Mar 11 08:41:46 2014 +0100

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
