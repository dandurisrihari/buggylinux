{
  "hash": "4fa0e81b83503900be277e6273a79651b375e288",
  "hash_short": "4fa0e81b",
  "subject": "ALSA: usb-audio: fix possible hang and overflow in parse_uac2_sample_rate_range()",
  "body": "A malicious USB device may feed in carefully crafted min/max/res values,\nso that the inner loop in parse_uac2_sample_rate_range() could run for\na long time or even never terminate, e.g., given max = INT_MAX.\n\nAlso nr_rates could be a large integer, which causes an integer overflow\nin the subsequent call to kmalloc() in parse_audio_format_rates_v2().\nThus, kmalloc() would allocate a smaller buffer than expected, leading\nto a memory corruption.\n\nTo exploit the two vulnerabilities, an attacker needs physical access\nto the machine to plug in a malicious USB device.\n\nThis patch makes two changes.\n\n1) The type of \"rate\" is changed to unsigned int, so that the loop could\n   stop once \"rate\" is larger than INT_MAX.\n\n2) Limit nr_rates to 1024.\n\nSuggested-by: Takashi Iwai <tiwai@suse.de>\nSigned-off-by: Xi Wang <xi.wang@gmail.com>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
  "full_message": "ALSA: usb-audio: fix possible hang and overflow in parse_uac2_sample_rate_range()\n\nA malicious USB device may feed in carefully crafted min/max/res values,\nso that the inner loop in parse_uac2_sample_rate_range() could run for\na long time or even never terminate, e.g., given max = INT_MAX.\n\nAlso nr_rates could be a large integer, which causes an integer overflow\nin the subsequent call to kmalloc() in parse_audio_format_rates_v2().\nThus, kmalloc() would allocate a smaller buffer than expected, leading\nto a memory corruption.\n\nTo exploit the two vulnerabilities, an attacker needs physical access\nto the machine to plug in a malicious USB device.\n\nThis patch makes two changes.\n\n1) The type of \"rate\" is changed to unsigned int, so that the loop could\n   stop once \"rate\" is larger than INT_MAX.\n\n2) Limit nr_rates to 1024.\n\nSuggested-by: Takashi Iwai <tiwai@suse.de>\nSigned-off-by: Xi Wang <xi.wang@gmail.com>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
  "author_name": "Xi Wang",
  "author_email": "xi.wang@gmail.com",
  "author_date": "Sun Jan 8 09:02:52 2012 -0500",
  "author_date_iso": "2012-01-08T09:02:52-05:00",
  "committer_name": "Takashi Iwai",
  "committer_email": "tiwai@suse.de",
  "committer_date": "Sun Jan 8 16:03:12 2012 +0100",
  "committer_date_iso": "2012-01-08T16:03:12+01:00",
  "files_changed": [
    "sound/usb/format.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "sound/usb/format.c",
      "insertions": 7,
      "deletions": 1
    }
  ],
  "total_insertions": 7,
  "total_deletions": 1,
  "total_changes": 8,
  "parents": [
    "fb65c2dfe60d38be6b9193d0b85e66e780cd4373"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "sound/usb/format.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}