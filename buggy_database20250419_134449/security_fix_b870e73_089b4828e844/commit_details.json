{
  "hash": "b870e73a56c4cccbec33224233eaf295839f228c",
  "hash_short": "b870e73a",
  "subject": "wifi: rndis_wlan: Prevent buffer overflow in rndis_query_oid",
  "body": "Since resplen and respoffs are signed integers sufficiently\nlarge values of unsigned int len and offset members of RNDIS\nresponse will result in negative values of prior variables.\nThis may be utilized to bypass implemented security checks\nto either extract memory contents by manipulating offset or\noverflow the data buffer via memcpy by manipulating both\noffset and len.\n\nAdditionally assure that sum of resplen and respoffs does not\noverflow so buffer boundaries are kept.\n\nFixes: 80f8c5b434f9 (\"rndis_wlan: copy only useful data from rndis_command respond\")\nSigned-off-by: Szymon Heidrich <szymon.heidrich@gmail.com>\nReviewed-by: Alexander Duyck <alexanderduyck@fb.com>\nSigned-off-by: Kalle Valo <kvalo@kernel.org>\nLink: https://lore.kernel.org/r/20230111175031.7049-1-szymon.heidrich@gmail.com",
  "full_message": "wifi: rndis_wlan: Prevent buffer overflow in rndis_query_oid\n\nSince resplen and respoffs are signed integers sufficiently\nlarge values of unsigned int len and offset members of RNDIS\nresponse will result in negative values of prior variables.\nThis may be utilized to bypass implemented security checks\nto either extract memory contents by manipulating offset or\noverflow the data buffer via memcpy by manipulating both\noffset and len.\n\nAdditionally assure that sum of resplen and respoffs does not\noverflow so buffer boundaries are kept.\n\nFixes: 80f8c5b434f9 (\"rndis_wlan: copy only useful data from rndis_command respond\")\nSigned-off-by: Szymon Heidrich <szymon.heidrich@gmail.com>\nReviewed-by: Alexander Duyck <alexanderduyck@fb.com>\nSigned-off-by: Kalle Valo <kvalo@kernel.org>\nLink: https://lore.kernel.org/r/20230111175031.7049-1-szymon.heidrich@gmail.com",
  "author_name": "Szymon Heidrich",
  "author_email": "szymon.heidrich@gmail.com",
  "author_date": "Wed Jan 11 18:50:31 2023 +0100",
  "author_date_iso": "2023-01-11T18:50:31+01:00",
  "committer_name": "Kalle Valo",
  "committer_email": "kvalo@kernel.org",
  "committer_date": "Mon Jan 16 13:27:54 2023 +0200",
  "committer_date_iso": "2023-01-16T13:27:54+02:00",
  "files_changed": [
    "drivers/net/wireless/rndis_wlan.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/wireless/rndis_wlan.c",
      "insertions": 6,
      "deletions": 13
    }
  ],
  "total_insertions": 6,
  "total_deletions": 13,
  "total_changes": 19,
  "parents": [
    "ed05cb177ae5cd7f02f1d6e7706ba627d30f1696"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "bypass"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/rndis_wlan.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}