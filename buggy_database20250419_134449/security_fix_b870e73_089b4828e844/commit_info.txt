Commit Hash: b870e73a56c4cccbec33224233eaf295839f228c
Subject: wifi: rndis_wlan: Prevent buffer overflow in rndis_query_oid


Security Keywords:
- bypass

Full commit message:
wifi: rndis_wlan: Prevent buffer overflow in rndis_query_oid

Since resplen and respoffs are signed integers sufficiently
large values of unsigned int len and offset members of RNDIS
response will result in negative values of prior variables.
This may be utilized to bypass implemented security checks
to either extract memory contents by manipulating offset or
overflow the data buffer via memcpy by manipulating both
offset and len.

Additionally assure that sum of resplen and respoffs does not
overflow so buffer boundaries are kept.

Fixes: 80f8c5b434f9 ("rndis_wlan: copy only useful data from rndis_command respond")
Signed-off-by: Szymon Heidrich <szymon.heidrich@gmail.com>
Reviewed-by: Alexander Duyck <alexanderduyck@fb.com>
Signed-off-by: Kalle Valo <kvalo@kernel.org>
Link: https://lore.kernel.org/r/20230111175031.7049-1-szymon.heidrich@gmail.com

Metadata:
Author: Szymon Heidrich <szymon.heidrich@gmail.com>
Author Date: Wed Jan 11 18:50:31 2023 +0100
Committer: Kalle Valo <kvalo@kernel.org>
Commit Date: Mon Jan 16 13:27:54 2023 +0200

Files Changed: 1
Lines Added: 6
Lines Removed: 13
Total Changes: 19
