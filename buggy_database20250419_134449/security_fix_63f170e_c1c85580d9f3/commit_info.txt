Commit Hash: 63f170e0c80a131cdd549fab7afb5036009944fc
Subject: mac80211: let cfg80211 manage auth state


Security Keywords:
- auth

Full commit message:
mac80211: let cfg80211 manage auth state

mac80211 currently hangs on to the auth state by
keeping it on the work list. That can lead to
confusing behaviour like rejecting scans while
authenticated to any AP (but not yet associated.)
It also means that it needs to keep track of the
work struct while associated for when it gets
disassociated (or disassociates.)

Change this to free the work struct after the
authentication completed successfully and
allocate a new one for associating, thereby
letting cfg80211 manage the auth state. Another
change necessary for this is to tell cfg80211
about all unicast deauth frames sent to mac80211
since now it can no longer check the auth state,
but that check was racy anyway.

Signed-off-by: Johannes Berg <johannes@sipsolutions.net>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Johannes Berg <johannes@sipsolutions.net>
Author Date: Wed Dec 23 13:15:33 2009 +0100
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Mon Dec 28 16:54:52 2009 -0500

Files Changed: 2
Lines Added: 73
Lines Removed: 103
Total Changes: 176
