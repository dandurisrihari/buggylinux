Commit Hash: 30a584d944fbd599d4a8f470f75bf7af1a15b466
Subject: [LLX]: SOCK_DGRAM interface fixes


Security Keywords:
- security issue

Full commit message:
[LLX]: SOCK_DGRAM interface fixes

The datagram interface of LLC is broken in a couple of ways.
These were discovered when trying to use it to build an out-of-kernel
version of STP.

First it didn't pass the source address of the received packet
in recvfrom(). It needs to copy the source address of received LLC packets
into the socket control block. At the same time fix a security issue
because there was uninitialized data leakage. Every recvfrom call
was just copying out old data.

Second, LLC should not merge multiple packets in one receive call
on datagram sockets. LLC should preserve packet boundaries on
SOCK_DGRAM.

This fix goes against the old historical comments about UNIX98 semantics
but without this fix SOCK_DGRAM is broken and useless. So either ANK's
interpretation was incorect or UNIX98 standard was wrong.

Signed-off-by: Stephen Hemminger <shemminger@osdl.org>
Acked-by: Arnaldo Carvalho de Melo <acme@mandriva.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Stephen Hemminger <shemminger@osdl.org>
Author Date: Thu Aug 3 16:38:49 2006 -0700
Committer: David S. Miller <davem@sunset.davemloft.net>
Commit Date: Fri Aug 4 22:59:50 2006 -0700

Files Changed: 2
Lines Added: 10
Lines Removed: 14
Total Changes: 24
