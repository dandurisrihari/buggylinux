{
  "hash": "96fe1c0237224b24a0dfaaee6467a5767902ba4a",
  "hash_short": "96fe1c02",
  "subject": "[IPSEC] AH4: Update IPv4 options handling to conform to RFC 4302.",
  "body": "In testing our ESP/AH offload hardware, I discovered an issue with how\nAH handles mutable fields in IPv4.  RFC 4302 (AH) states the following\non the subject:\n\n        For IPv4, the entire option is viewed as a unit; so even\n        though the type and length fields within most options are immutable\n        in transit, if an option is classified as mutable, the entire option\n        is zeroed for ICV computation purposes.\n\nThe current implementation does not zero the type and length fields,\nresulting in authentication failures when communicating with hosts\nthat do (i.e. FreeBSD).\n\nI have tested record route and timestamp options (ping -R and ping -T)\non a small network involving Windows XP, FreeBSD 6.2, and Linux hosts,\nwith one router.  In the presence of these options, the FreeBSD and\nLinux hosts (with the patch or with the hardware) can communicate.\nThe Windows XP host simply fails to accept these packets with or\nwithout the patch.\n\nI have also been trying to test source routing options (using\ntraceroute -g), but haven't had much luck getting this option to work\n*without* AH, let alone with.\n\nSigned-off-by: Nick Bowler <nbowler@ellipticsemi.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "[IPSEC] AH4: Update IPv4 options handling to conform to RFC 4302.\n\nIn testing our ESP/AH offload hardware, I discovered an issue with how\nAH handles mutable fields in IPv4.  RFC 4302 (AH) states the following\non the subject:\n\n        For IPv4, the entire option is viewed as a unit; so even\n        though the type and length fields within most options are immutable\n        in transit, if an option is classified as mutable, the entire option\n        is zeroed for ICV computation purposes.\n\nThe current implementation does not zero the type and length fields,\nresulting in authentication failures when communicating with hosts\nthat do (i.e. FreeBSD).\n\nI have tested record route and timestamp options (ping -R and ping -T)\non a small network involving Windows XP, FreeBSD 6.2, and Linux hosts,\nwith one router.  In the presence of these options, the FreeBSD and\nLinux hosts (with the patch or with the hardware) can communicate.\nThe Windows XP host simply fails to accept these packets with or\nwithout the patch.\n\nI have also been trying to test source routing options (using\ntraceroute -g), but haven't had much luck getting this option to work\n*without* AH, let alone with.\n\nSigned-off-by: Nick Bowler <nbowler@ellipticsemi.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Nick Bowler",
  "author_email": "nbowler@ellipticsemi.com",
  "author_date": "Wed Aug 22 12:33:51 2007 -0700",
  "author_date_iso": "2007-08-22T12:33:51-07:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@sunset.davemloft.net",
  "committer_date": "Sun Aug 26 18:35:33 2007 -0700",
  "committer_date_iso": "2007-08-26T18:35:33-07:00",
  "files_changed": [
    "net/ipv4/ah4.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/ipv4/ah4.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "50c46637aa894f904e2fb39086a3d7732f68bd50"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.23",
    "v2.6.23-rc4",
    "v2.6.23-rc5",
    "v2.6.23-rc6",
    "v2.6.23-rc7",
    "v2.6.23-rc8",
    "v2.6.23-rc9",
    "v2.6.24",
    "v2.6.24-rc1",
    "v2.6.24-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/ipv4/ah4.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}