Commit Hash: 9543f6e26634537997b6e909c20911b7bf4876de
Subject: x86/cpufeatures: Fix dependencies for GFNI, VAES, and VPCLMULQDQ


Security Keywords:
- vulnerability

Full commit message:
x86/cpufeatures: Fix dependencies for GFNI, VAES, and VPCLMULQDQ

Fix cpuid_deps[] to list the correct dependencies for GFNI, VAES, and
VPCLMULQDQ.  These features don't depend on AVX512, and there exist CPUs
that support these features but not AVX512.  GFNI actually doesn't even
depend on AVX.

This prevents GFNI from being unnecessarily disabled if AVX is disabled
to mitigate the GDS vulnerability.

This also prevents all three features from being unnecessarily disabled
if AVX512VL (or its dependency AVX512F) were to be disabled, but it
looks like there isn't any case where this happens anyway.

Fixes: c128dbfa0f87 ("x86/cpufeatures: Enable new SSE/AVX/AVX512 CPU features")
Signed-off-by: Eric Biggers <ebiggers@google.com>
Signed-off-by: Borislav Petkov (AMD) <bp@alien8.de>
Acked-by: Dave Hansen <dave.hansen@linux.intel.com>
Link: https://lore.kernel.org/r/20240417060434.47101-1-ebiggers@kernel.org

Metadata:
Author: Eric Biggers <ebiggers@google.com>
Author Date: Tue Apr 16 23:04:34 2024 -0700
Committer: Borislav Petkov (AMD) <bp@alien8.de>
Commit Date: Thu Apr 18 17:27:52 2024 +0200

Files Changed: 1
Lines Added: 3
Lines Removed: 3
Total Changes: 6
