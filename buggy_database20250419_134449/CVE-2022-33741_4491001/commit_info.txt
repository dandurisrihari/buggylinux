Commit Hash: 4491001c2e0fa69efbb748c96ec96b100a5cdb7e
Subject: xen/netfront: force data bouncing when backend is untrusted

CVE Identifiers:
- CVE-2022-33741

Full commit message:
xen/netfront: force data bouncing when backend is untrusted

Bounce all data on the skbs to be transmitted into zeroed pages if the
backend is untrusted. This avoids leaking data present in the pages
shared with the backend but not part of the skb fragments.  This
requires introducing a new helper in order to allocate skbs with a
size multiple of XEN_PAGE_SIZE so we don't leak contiguous data on the
granted pages.

Reporting whether the backend is to be trusted can be done using a
module parameter, or from the xenstore frontend path as set by the
toolstack when adding the device.

This is CVE-2022-33741, part of XSA-403.

Signed-off-by: Roger Pau Monn√© <roger.pau@citrix.com>
Reviewed-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Juergen Gross <jgross@suse.com>

Metadata:
Author: Roger Pau Monne <roger.pau@citrix.com>
Author Date: Thu Apr 7 12:20:06 2022 +0200
Committer: Juergen Gross <jgross@suse.com>
Commit Date: Fri Jul 1 10:00:33 2022 +0200

Files Changed: 1
Lines Added: 47
Lines Removed: 2
Total Changes: 49
