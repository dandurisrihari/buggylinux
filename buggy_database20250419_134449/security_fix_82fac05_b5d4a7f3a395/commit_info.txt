Commit Hash: 82fac0542e11c0d3316cc8fdafd2a990d2aab692
Subject: [NETFILTER]: Missing check for CAP_NET_ADMIN in iptables compat layer


Security Keywords:
- exploit

Full commit message:
[NETFILTER]: Missing check for CAP_NET_ADMIN in iptables compat layer

The 32bit compatibility layer has no CAP_NET_ADMIN check in
compat_do_ipt_get_ctl, which for example allows to list the current
iptables rules even without having that capability (the non-compat
version requires it). Other capabilities might be required to exploit
the bug (eg. CAP_NET_RAW to get the nfnetlink socket?), so a plain user
can't exploit it, but a setup actually using the posix capability system
might very well hit such a constellation of granted capabilities.

Signed-off-by: Björn Steinbrink <B.Steinbrink@gmx.de>
Signed-off-by: Patrick McHardy <kaber@trash.net>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Björn Steinbrink <B.Steinbrink@gmx.de>
Author Date: Fri Oct 20 00:21:10 2006 -0700
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Fri Oct 20 00:21:10 2006 -0700

Files Changed: 1
Lines Added: 3
Lines Removed: 0
Total Changes: 3
