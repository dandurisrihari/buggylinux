{
  "hash": "3fdca1e1370ffe89980927cdef0583bebcd8caaf",
  "hash_short": "3fdca1e1",
  "subject": "Bluetooth: Fix connection establishment with low security requirement",
  "body": "The Bluetooth 2.1 specification introduced four different security modes\nthat can be mapped using Legacy Pairing and Simple Pairing. With the\nusage of Simple Pairing it is required that all connections (except\nthe ones for SDP) are encrypted. So even the low security requirement\nmandates an encrypted connection when using Simple Pairing. When using\nLegacy Pairing (for Bluetooth 2.0 devices and older) this is not required\nsince it causes interoperability issues.\n\nTo support this properly the low security requirement translates into\ndifferent host controller transactions depending if Simple Pairing is\nsupported or not. However in case of Simple Pairing the command to\nswitch on encryption after a successful authentication is not triggered\nfor the low security mode. This patch fixes this and actually makes\nthe logic to differentiate between Simple Pairing and Legacy Pairing\na lot simpler.\n\nBased on a report by Ville Tervo <ville.tervo@nokia.com>\n\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "Bluetooth: Fix connection establishment with low security requirement\n\nThe Bluetooth 2.1 specification introduced four different security modes\nthat can be mapped using Legacy Pairing and Simple Pairing. With the\nusage of Simple Pairing it is required that all connections (except\nthe ones for SDP) are encrypted. So even the low security requirement\nmandates an encrypted connection when using Simple Pairing. When using\nLegacy Pairing (for Bluetooth 2.0 devices and older) this is not required\nsince it causes interoperability issues.\n\nTo support this properly the low security requirement translates into\ndifferent host controller transactions depending if Simple Pairing is\nsupported or not. However in case of Simple Pairing the command to\nswitch on encryption after a successful authentication is not triggered\nfor the low security mode. This patch fixes this and actually makes\nthe logic to differentiate between Simple Pairing and Legacy Pairing\na lot simpler.\n\nBased on a report by Ville Tervo <ville.tervo@nokia.com>\n\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Marcel Holtmann",
  "author_email": "marcel@holtmann.org",
  "author_date": "Tue Apr 28 09:04:55 2009 -0700",
  "author_date_iso": "2009-04-28T09:04:55-07:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Tue Apr 28 09:31:39 2009 -0700",
  "committer_date_iso": "2009-04-28T09:31:39-07:00",
  "files_changed": [
    "net/bluetooth/hci_conn.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 3,
      "deletions": 6
    }
  ],
  "total_insertions": 3,
  "total_deletions": 6,
  "total_changes": 9,
  "parents": [
    "052b30b0a8eec8db5b18ad49effdf2a9ba4c1e1a"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.30",
    "v2.6.30-rc4",
    "v2.6.30-rc5",
    "v2.6.30-rc6",
    "v2.6.30-rc7",
    "v2.6.30-rc8",
    "v2.6.31",
    "v2.6.31-rc1",
    "v2.6.31-rc2",
    "v2.6.31-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}