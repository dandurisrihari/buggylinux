Commit Hash: 3fdca1e1370ffe89980927cdef0583bebcd8caaf
Subject: Bluetooth: Fix connection establishment with low security requirement


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix connection establishment with low security requirement

The Bluetooth 2.1 specification introduced four different security modes
that can be mapped using Legacy Pairing and Simple Pairing. With the
usage of Simple Pairing it is required that all connections (except
the ones for SDP) are encrypted. So even the low security requirement
mandates an encrypted connection when using Simple Pairing. When using
Legacy Pairing (for Bluetooth 2.0 devices and older) this is not required
since it causes interoperability issues.

To support this properly the low security requirement translates into
different host controller transactions depending if Simple Pairing is
supported or not. However in case of Simple Pairing the command to
switch on encryption after a successful authentication is not triggered
for the low security mode. This patch fixes this and actually makes
the logic to differentiate between Simple Pairing and Legacy Pairing
a lot simpler.

Based on a report by Ville Tervo <ville.tervo@nokia.com>

Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Marcel Holtmann <marcel@holtmann.org>
Author Date: Tue Apr 28 09:04:55 2009 -0700
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Tue Apr 28 09:31:39 2009 -0700

Files Changed: 1
Lines Added: 3
Lines Removed: 6
Total Changes: 9
