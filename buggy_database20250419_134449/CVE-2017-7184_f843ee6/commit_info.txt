Commit Hash: f843ee6dd019bcece3e74e76ad9df0155655d0df
Subject: xfrm_user: validate XFRM_MSG_NEWAE incoming ESN size harder

CVE Identifiers:
- CVE-2017-7184

Full commit message:
xfrm_user: validate XFRM_MSG_NEWAE incoming ESN size harder

Kees Cook has pointed out that xfrm_replay_state_esn_len() is subject to
wrapping issues.  To ensure we are correctly ensuring that the two ESN
structures are the same size compare both the overall size as reported
by xfrm_replay_state_esn_len() and the internal length are the same.

CVE-2017-7184
Signed-off-by: Andy Whitcroft <apw@canonical.com>
Acked-by: Steffen Klassert <steffen.klassert@secunet.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Andy Whitcroft <apw@canonical.com>
Author Date: Thu Mar 23 07:45:44 2017 +0000
Committer: Linus Torvalds <torvalds@linux-foundation.org>
Commit Date: Wed Mar 29 08:40:15 2017 -0700

Files Changed: 1
Lines Added: 5
Lines Removed: 1
Total Changes: 6
