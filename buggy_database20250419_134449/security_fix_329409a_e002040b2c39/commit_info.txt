Commit Hash: 329409aeda064c4aff00c51f837fcd3bbdaeeba6
Subject: [PATCH] fault injection: stacktrace filtering


Security Keywords:
- injection

Full commit message:
[PATCH] fault injection: stacktrace filtering

This patch provides stacktrace filtering feature.

The stacktrace filter allows failing only for the caller you are
interested in.

For example someone may want to inject kmalloc() failures into
only e100 module. they want to inject not only direct kmalloc() call,
but also indirect allocation, too.

- e100_poll --> netif_receive_skb --> packet_rcv_spkt --> skb_clone
  --> kmem_cache_alloc

This patch enables to detect function calls like this by stacktrace
and inject failures. The script Documentaion/fault-injection/failmodule.sh
helps it.

The range of text section of loaded e100 is expected to be
[/sys/module/e100/sections/.text, /sys/module/e100/sections/.exit.text)

So failmodule.sh stores these values into /debug/failslab/address-start
and /debug/failslab/address-end. The maximum stacktrace depth is specified
by /debug/failslab/stacktrace-depth.

Please see the example that demonstrates how to inject slab allocation
failures only for a specific module
in Documentation/fault-injection/fault-injection.txt

[dwm@meer.net: reject failure if any caller lies within specified range]
Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com>
Signed-off-by: Don Mullis <dwm@meer.net>
Signed-off-by: Andrew Morton <akpm@osdl.org>
Signed-off-by: Linus Torvalds <torvalds@osdl.org>

Metadata:
Author: Akinobu Mita <akinobu.mita@gmail.com>
Author Date: Fri Dec 8 02:39:48 2006 -0800
Committer: Linus Torvalds <torvalds@woody.osdl.org>
Commit Date: Fri Dec 8 08:29:03 2006 -0800

Files Changed: 4
Lines Added: 150
Lines Removed: 5
Total Changes: 155
