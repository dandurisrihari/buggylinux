Commit Hash: 877818802c3e970f67ccb53012facc78bef5f97a
Subject: x86/bugs: Add SRSO_USER_KERNEL_NO support


Security Keywords:
- vulnerability

Full commit message:
x86/bugs: Add SRSO_USER_KERNEL_NO support

If the machine has:

  CPUID Fn8000_0021_EAX[30] (SRSO_USER_KERNEL_NO) -- If this bit is 1,
  it indicates the CPU is not subject to the SRSO vulnerability across
  user/kernel boundaries.

have it fall back to IBPB on VMEXIT only, in the case it is going to run
VMs:

  Speculative Return Stack Overflow: Mitigation: IBPB on VMEXIT only

Signed-off-by: Borislav Petkov (AMD) <bp@alien8.de>
Reviewed-by: Nikolay Borisov <nik.borisov@suse.com>
Link: https://lore.kernel.org/r/20241202120416.6054-2-bp@kernel.org

Metadata:
Author: Borislav Petkov (AMD) <bp@alien8.de>
Author Date: Mon Nov 11 17:22:08 2024 +0100
Committer: Borislav Petkov (AMD) <bp@alien8.de>
Commit Date: Mon Dec 30 17:48:33 2024 +0100

Files Changed: 3
Lines Added: 6
Lines Removed: 0
Total Changes: 6
