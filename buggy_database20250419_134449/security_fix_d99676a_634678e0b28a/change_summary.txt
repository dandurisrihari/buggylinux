Files changed: 23
Insertions: 53743
Deletions: 46654
Total changes: 100397

File-specific changes:
Documentation/devicetree/bindings/display/allwinner,sun4i-a10-display-backend.yaml: +5 -18
Documentation/devicetree/bindings/display/allwinner,sun4i-a10-display-frontend.yaml: +3 -16
Documentation/devicetree/bindings/display/allwinner,sun4i-a10-hdmi.yaml: +3 -16
Documentation/devicetree/bindings/display/allwinner,sun4i-a10-tcon.yaml: +6 -19
Documentation/devicetree/bindings/display/allwinner,sun4i-a10-tv-encoder.yaml: +2 -4
Documentation/devicetree/bindings/display/allwinner,sun6i-a31-drc.yaml: +3 -16
Documentation/devicetree/bindings/display/allwinner,sun6i-a31-mipi-dsi.yaml: +2 -4
Documentation/devicetree/bindings/display/allwinner,sun8i-a83t-de2-mixer.yaml: +3 -16
Documentation/devicetree/bindings/display/allwinner,sun8i-a83t-dw-hdmi.yaml: +3 -16
Documentation/devicetree/bindings/display/allwinner,sun8i-r40-tcon-top.yaml: +7 -103
Documentation/devicetree/bindings/display/allwinner,sun9i-a80-deu.yaml: +3 -16
Documentation/devicetree/bindings/display/amlogic,meson-dw-hdmi.yaml: +2 -2
Documentation/devicetree/bindings/display/amlogic,meson-vpu.yaml: +2 -2
Documentation/devicetree/bindings/display/brcm,bcm2711-hdmi.yaml: +19 -1
Documentation/devicetree/bindings/display/brcm,bcm2835-dpi.yaml: +3 -4
Documentation/devicetree/bindings/display/brcm,bcm2835-dsi0.yaml: +1 -0
Documentation/devicetree/bindings/display/bridge/analogix,anx7625.yaml: +3 -3
Documentation/devicetree/bindings/display/bridge/analogix,anx7814.yaml: +3 -16
Documentation/devicetree/bindings/display/bridge/anx6345.yaml: +5 -13
Documentation/devicetree/bindings/display/bridge/cdns,mhdp8546.yaml: +6 -16
Documentation/devicetree/bindings/display/bridge/chrontel,ch7033.yaml: +3 -3
Documentation/devicetree/bindings/display/bridge/intel,keembay-dsi.yaml: +3 -11
Documentation/devicetree/bindings/display/bridge/ite,it6505.yaml: +1 -1
Documentation/devicetree/bindings/display/bridge/lontium,lt9611.yaml: +7 -63
Documentation/devicetree/bindings/display/bridge/lvds-codec.yaml: +4 -14
Documentation/devicetree/bindings/display/bridge/nwl-dsi.yaml: +7 -34
Documentation/devicetree/bindings/display/bridge/ps8640.yaml: +6 -18
Documentation/devicetree/bindings/display/bridge/renesas,lvds.yaml: +6 -18
Documentation/devicetree/bindings/display/bridge/simple-bridge.yaml: +4 -14
Documentation/devicetree/bindings/display/bridge/snps,dw-mipi-dsi.yaml: +4 -3
Documentation/devicetree/bindings/display/bridge/thine,thc63lvd1024.yaml: +15 -20
Documentation/devicetree/bindings/display/bridge/ti,sn65dsi86.yaml: +6 -39
Documentation/devicetree/bindings/display/bridge/ti,tfp410.yaml: +6 -18
Documentation/devicetree/bindings/display/bridge/toshiba,tc358762.yaml: +5 -47
Documentation/devicetree/bindings/display/bridge/toshiba,tc358768.yaml: +6 -42
Documentation/devicetree/bindings/display/bridge/toshiba,tc358775.yaml: +5 -14
Documentation/devicetree/bindings/display/connector/analog-tv-connector.yaml: +1 -0
Documentation/devicetree/bindings/display/connector/dp-connector.yaml: +56 -0
Documentation/devicetree/bindings/display/connector/dvi-connector.yaml: +1 -0
Documentation/devicetree/bindings/display/connector/hdmi-connector.yaml: +1 -0
Documentation/devicetree/bindings/display/connector/vga-connector.yaml: +1 -0
Documentation/devicetree/bindings/display/imx/nxp,imx8mq-dcss.yaml: +1 -1
Documentation/devicetree/bindings/display/ingenic,ipu.yaml: +2 -3
Documentation/devicetree/bindings/display/ingenic,lcd.yaml: +5 -5
Documentation/devicetree/bindings/display/intel,keembay-display.yaml: +1 -1
Documentation/devicetree/bindings/display/mediatek/mediatek,disp.txt: +11 -1
Documentation/devicetree/bindings/display/panel/advantech,idk-2121wr.yaml: +10 -11
Documentation/devicetree/bindings/display/panel/mantix,mlaf057we51-x.yaml: +1 -0
Documentation/devicetree/bindings/display/panel/panel-common.yaml: +1 -10
Documentation/devicetree/bindings/display/panel/panel-simple-dsi.yaml: +2 -0
Documentation/devicetree/bindings/display/panel/panel-simple.yaml: +2 -0
Documentation/devicetree/bindings/display/panel/samsung,s6e63m0.yaml: +3 -1
Documentation/devicetree/bindings/display/rockchip/rockchip,rk3066-hdmi.yaml: +3 -13
Documentation/devicetree/bindings/display/rockchip/rockchip-vop.yaml: +1 -4
Documentation/devicetree/bindings/display/st,stm32-dsi.yaml: +4 -8
Documentation/devicetree/bindings/display/st,stm32-ltdc.yaml: +3 -5
Documentation/devicetree/bindings/display/ste,mcde.txt: +0 -104
Documentation/devicetree/bindings/display/ste,mcde.yaml: +168 -0
Documentation/devicetree/bindings/display/ti/ti,am65x-dss.yaml: +4 -15
Documentation/devicetree/bindings/display/ti/ti,j721e-dss.yaml: +6 -17
Documentation/devicetree/bindings/display/ti/ti,k2g-dss.yaml: +1 -2
Documentation/devicetree/bindings/vendor-prefixes.yaml: +2 -0
Documentation/gpu/drm-kms.rst: +35 -17
Documentation/gpu/drm-uapi.rst: +3 -0
Documentation/gpu/i915.rst: +1 -1
Documentation/gpu/todo.rst: +19 -0
Documentation/gpu/vkms.rst: +82 -0
MAINTAINERS: +6 -5
arch/arm/boot/dts/omap5.dtsi: +6 -0
arch/arm/configs/omap2plus_defconfig: +1 -1
drivers/dma-buf/Kconfig: +8 -0
drivers/dma-buf/dma-buf.c: +94 -26
drivers/dma-buf/st-dma-fence.c: +5 -2
drivers/gpu/drm/Kconfig: +0 -5
drivers/gpu/drm/Makefile: +3 -3
drivers/gpu/drm/amd/amdgpu/Makefile: +5 -3
drivers/gpu/drm/amd/amdgpu/amdgpu.h: +14 -6
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd.c: +0 -87
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd.h: +119 -19
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gfx_v10.c: +0 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gfx_v10_3.c: +0 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gpuvm.c: +4 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_bios.c: +3 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_cs.c: +1 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c: +6 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_device.c: +111 -33
drivers/gpu/drm/amd/amdgpu/amdgpu_dma_buf.c: +15 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_drv.c: +12 -8
drivers/gpu/drm/amd/amdgpu/amdgpu_fb.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_fw_attestation.c: +3 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_gem.c: +5 -5
drivers/gpu/drm/amd/amdgpu/amdgpu_gfx.c: +8 -7
drivers/gpu/drm/amd/amdgpu/amdgpu_gfx.h: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_gmc.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_hdp.h: +40 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_i2c.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_ib.c: +9 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_ih.c: +45 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_ih.h: +16 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_irq.c: +2 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_job.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_kms.c: +5 -5
drivers/gpu/drm/amd/amdgpu/amdgpu_nbio.h: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_object.c: +8 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_object.h: +2 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_psp.c: +193 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h: +17 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c: +2 -6
drivers/gpu/drm/amd/amdgpu/amdgpu_ring.h: +2 -5
drivers/gpu/drm/amd/amdgpu/amdgpu_securedisplay.c: +176 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_securedisplay.h: +36 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_trace.h: +2 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_ttm.c: +7 -9
drivers/gpu/drm/amd/amdgpu/amdgpu_ucode.h: +4 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_uvd.c: +2 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_vce.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_vcn.c: +6 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_virt.c: +6 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c: +3 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_vram_mgr.c: +3 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_xgmi.c: +4 -6
drivers/gpu/drm/amd/amdgpu/athub_v2_0.c: +0 -1
drivers/gpu/drm/amd/amdgpu/athub_v2_1.c: +0 -1
drivers/gpu/drm/amd/amdgpu/cik.c: +11 -22
drivers/gpu/drm/amd/amdgpu/cz_ih.c: +24 -13
drivers/gpu/drm/amd/amdgpu/dce_virtual.c: +3 -2
drivers/gpu/drm/amd/amdgpu/gfx_v10_0.c: +32 -24
drivers/gpu/drm/amd/amdgpu/gfx_v8_0.c: +67 -5
drivers/gpu/drm/amd/amdgpu/gfx_v9_0.c: +66 -7
drivers/gpu/drm/amd/amdgpu/gmc_v10_0.c: +3 -11
drivers/gpu/drm/amd/amdgpu/gmc_v9_0.c: +34 -71
drivers/gpu/drm/amd/amdgpu/hdp_v4_0.c: +137 -0
drivers/gpu/drm/amd/amdgpu/hdp_v4_0.h: +31 -0
drivers/gpu/drm/amd/amdgpu/hdp_v5_0.c: +212 -0
drivers/gpu/drm/amd/amdgpu/hdp_v5_0.h: +31 -0
drivers/gpu/drm/amd/amdgpu/iceland_ih.c: +23 -13
drivers/gpu/drm/amd/amdgpu/mes_v10_1.c: +1 -1
drivers/gpu/drm/amd/amdgpu/mmhub_v2_3.c: +2 -2
drivers/gpu/drm/amd/amdgpu/mxgpu_ai.c: +1 -0
drivers/gpu/drm/amd/amdgpu/mxgpu_nv.c: +1 -0
drivers/gpu/drm/amd/amdgpu/navi10_ih.c: +166 -312
drivers/gpu/drm/amd/amdgpu/nbio_v2_3.c: +114 -10
drivers/gpu/drm/amd/amdgpu/nbio_v6_1.c: +10 -13
drivers/gpu/drm/amd/amdgpu/nbio_v7_0.c: +0 -10
drivers/gpu/drm/amd/amdgpu/nbio_v7_2.c: +0 -10
drivers/gpu/drm/amd/amdgpu/nbio_v7_4.c: +0 -10
drivers/gpu/drm/amd/amdgpu/nv.c: +86 -168
drivers/gpu/drm/amd/amdgpu/psp_v10_0.c: +10 -2
drivers/gpu/drm/amd/amdgpu/psp_v11_0.c: +1 -37
drivers/gpu/drm/amd/amdgpu/sdma_v4_0.c: +0 -1
drivers/gpu/drm/amd/amdgpu/sdma_v5_0.c: +0 -1
drivers/gpu/drm/amd/amdgpu/sdma_v5_2.c: +5 -26
drivers/gpu/drm/amd/amdgpu/si.c: +24 -18
drivers/gpu/drm/amd/amdgpu/smuio_v11_0_6.c: +77 -0
drivers/gpu/drm/amd/amdgpu/smuio_v11_0_6.h: +30 -0
drivers/gpu/drm/amd/amdgpu/soc15.c: +29 -97
drivers/gpu/drm/amd/amdgpu/ta_secureDisplay_if.h: +154 -0
drivers/gpu/drm/amd/amdgpu/tonga_ih.c: +24 -13
drivers/gpu/drm/amd/amdgpu/uvd_v7_0.c: +0 -1
drivers/gpu/drm/amd/amdgpu/vcn_v1_0.c: +0 -1
drivers/gpu/drm/amd/amdgpu/vega10_ih.c: +188 -295
drivers/gpu/drm/amd/amdgpu/vega20_ih.c: +703 -0
drivers/gpu/drm/amd/amdgpu/vega20_ih.h: +30 -0
drivers/gpu/drm/amd/amdgpu/vi.c: +14 -22
drivers/gpu/drm/amd/amdkfd/Kconfig: +2 -0
drivers/gpu/drm/amd/amdkfd/kfd_device_queue_manager.h: +2 -2
drivers/gpu/drm/amd/amdkfd/kfd_int_process_v9.c: +43 -11
drivers/gpu/drm/amd/amdkfd/kfd_topology.c: +3 -3
drivers/gpu/drm/amd/amdkfd/kfd_topology.h: +0 -1
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c: +133 -14
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.h: +8 -6
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_debugfs.c: +8 -6
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_hdcp.c: +6 -4
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_hdcp.h: +1 -1
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_helpers.c: +4 -5
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_irq.c: +22 -0
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_mst_types.c: +0 -1
drivers/gpu/drm/amd/display/dc/Makefile: +3 -1
drivers/gpu/drm/amd/display/dc/basics/conversion.c: +3 -6
drivers/gpu/drm/amd/display/dc/basics/dc_common.c: +14 -6
drivers/gpu/drm/amd/display/dc/basics/dc_common.h: +2 -2
drivers/gpu/drm/amd/display/dc/bios/bios_parser.c: +58 -61
drivers/gpu/drm/amd/display/dc/bios/bios_parser2.c: +14 -15
drivers/gpu/drm/amd/display/dc/bios/command_table.c: +61 -0
drivers/gpu/drm/amd/display/dc/bios/command_table_helper.c: +8 -12
drivers/gpu/drm/amd/display/dc/bios/command_table_helper2.c: +8 -12
drivers/gpu/drm/amd/display/dc/calcs/dce_calcs.c: +3 -10
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn10/rv1_clk_mgr.c: +3 -27
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn20/dcn20_clk_mgr.c: +1 -2
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn30/dcn30_clk_mgr.c: +9 -9
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn301/dcn301_smu.c: +1 -1
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn301/vg_clk_mgr.c: +2 -1
drivers/gpu/drm/amd/display/dc/core/dc.c: +76 -56
drivers/gpu/drm/amd/display/dc/core/dc_link.c: +76 -28
drivers/gpu/drm/amd/display/dc/core/dc_link_ddc.c: +18 -1
drivers/gpu/drm/amd/display/dc/core/dc_link_dp.c: +31 -18
drivers/gpu/drm/amd/display/dc/core/dc_resource.c: +29 -17
drivers/gpu/drm/amd/display/dc/core/dc_stream.c: +2 -3
drivers/gpu/drm/amd/display/dc/core/dc_surface.c: +1 -1
drivers/gpu/drm/amd/display/dc/dc.h: +10 -12
drivers/gpu/drm/amd/display/dc/dc_dp_types.h: +3 -0
drivers/gpu/drm/amd/display/dc/dc_edid_parser.c: +80 -0
drivers/gpu/drm/amd/display/dc/dc_edid_parser.h: +44 -0
drivers/gpu/drm/amd/display/dc/dc_helper.c: +1 -0
drivers/gpu/drm/amd/display/dc/dc_hw_types.h: +1 -0
drivers/gpu/drm/amd/display/dc/dc_link.h: +10 -0
drivers/gpu/drm/amd/display/dc/dc_stream.h: +11 -0
drivers/gpu/drm/amd/display/dc/dce/dce_audio.c: +1 -1
drivers/gpu/drm/amd/display/dc/dce/dce_aux.c: +1 -7
drivers/gpu/drm/amd/display/dc/dce/dce_aux.h: +0 -1
drivers/gpu/drm/amd/display/dc/dce/dce_clock_source.c: +43 -30
drivers/gpu/drm/amd/display/dc/dce/dce_dmcu.c: +125 -1
drivers/gpu/drm/amd/display/dc/dce/dce_dmcu.h: +11 -2
drivers/gpu/drm/amd/display/dc/dce/dce_i2c_hw.c: +2 -2
drivers/gpu/drm/amd/display/dc/dce/dce_i2c_sw.c: +5 -4
drivers/gpu/drm/amd/display/dc/dce/dce_link_encoder.c: +4 -5
drivers/gpu/drm/amd/display/dc/dce/dce_opp.c: +12 -12
drivers/gpu/drm/amd/display/dc/dce/dce_opp.h: +0 -2
drivers/gpu/drm/amd/display/dc/dce/dce_panel_cntl.c: +4 -4
drivers/gpu/drm/amd/display/dc/dce/dce_stream_encoder.c: +2 -2
drivers/gpu/drm/amd/display/dc/dce/dce_transform.c: +5 -18
drivers/gpu/drm/amd/display/dc/dce/dmub_abm.c: +3 -0
drivers/gpu/drm/amd/display/dc/dce/dmub_hw_lock_mgr.c: +2 -1
drivers/gpu/drm/amd/display/dc/dce/dmub_psr.c: +16 -12
drivers/gpu/drm/amd/display/dc/dce100/Makefile: +2 -0
drivers/gpu/drm/amd/display/dc/dce100/dce100_resource.c: +11 -9
drivers/gpu/drm/amd/display/dc/dce110/Makefile: +2 -0
drivers/gpu/drm/amd/display/dc/dce110/dce110_compressor.c: +0 -55
drivers/gpu/drm/amd/display/dc/dce110/dce110_hw_sequencer.c: +32 -1
drivers/gpu/drm/amd/display/dc/dce110/dce110_mem_input_v.c: +9 -8
drivers/gpu/drm/amd/display/dc/dce110/dce110_resource.c: +9 -10
drivers/gpu/drm/amd/display/dc/dce110/dce110_timing_generator.c: +35 -41
drivers/gpu/drm/amd/display/dc/dce110/dce110_timing_generator_v.c: +9 -10
drivers/gpu/drm/amd/display/dc/dce110/dce110_transform_v.c: +9 -10
drivers/gpu/drm/amd/display/dc/dce112/Makefile: +2 -0
drivers/gpu/drm/amd/display/dc/dce112/dce112_resource.c: +11 -9
drivers/gpu/drm/amd/display/dc/dce120/Makefile: +2 -0
drivers/gpu/drm/amd/display/dc/dce120/dce120_hw_sequencer.c: +1 -1
drivers/gpu/drm/amd/display/dc/dce120/dce120_resource.c: +3 -3
drivers/gpu/drm/amd/display/dc/dce120/dce120_timing_generator.c: +28 -71
drivers/gpu/drm/amd/display/dc/dce60/Makefile: +2 -0
drivers/gpu/drm/amd/display/dc/dce60/dce60_resource.c: +10 -8
drivers/gpu/drm/amd/display/dc/dce60/dce60_timing_generator.c: +2 -2
drivers/gpu/drm/amd/display/dc/dce80/Makefile: +2 -0
drivers/gpu/drm/amd/display/dc/dce80/dce80_resource.c: +3 -1
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_dpp_cm.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_hw_sequencer.c: +31 -8
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_hw_sequencer.h: +5 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_hw_sequencer_debug.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_init.c: +1 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_link_encoder.c: +15 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_link_encoder.h: +11 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_optc.c: +11 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_optc.h: +1 -0
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_hwseq.c: +10 -2
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_init.c: +1 -0
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_link_encoder.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_resource.c: +5 -113
drivers/gpu/drm/amd/display/dc/dcn21/dcn21_hwseq.c: +3 -1
drivers/gpu/drm/amd/display/dc/dcn21/dcn21_init.c: +1 -0
drivers/gpu/drm/amd/display/dc/dcn21/dcn21_resource.c: +18 -2
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_dpp_cm.c: +0 -7
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_hubp.h: +1 -0
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_hwseq.c: +221 -40
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_hwseq.h: +7 -0
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_init.c: +3 -0
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_optc.c: +1 -0
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_resource.c: +29 -118
drivers/gpu/drm/amd/display/dc/dcn301/dcn301_init.c: +1 -0
drivers/gpu/drm/amd/display/dc/dcn301/dcn301_resource.c: +2 -105
drivers/gpu/drm/amd/display/dc/dcn302/dcn302_resource.c: +181 -7
drivers/gpu/drm/amd/display/dc/dcn302/dcn302_resource.h: +2 -0
drivers/gpu/drm/amd/display/dc/dm_cp_psp.h: +4 -3
drivers/gpu/drm/amd/display/dc/dml/dcn20/display_mode_vba_20.c: +5 -4
drivers/gpu/drm/amd/display/dc/dml/dcn20/display_mode_vba_20v2.c: +83 -41
drivers/gpu/drm/amd/display/dc/dml/dcn21/display_mode_vba_21.c: +26 -25
drivers/gpu/drm/amd/display/dc/dml/dcn30/display_mode_vba_30.c: +4 -4
drivers/gpu/drm/amd/display/dc/dml/dcn30/display_rq_dlg_calc_30.c: +16 -16
drivers/gpu/drm/amd/display/dc/dml/display_mode_structs.h: +1 -0
drivers/gpu/drm/amd/display/dc/dml/display_mode_vba.c: +2 -0
drivers/gpu/drm/amd/display/dc/dml/display_mode_vba.h: +1 -0
drivers/gpu/drm/amd/display/dc/gpio/diagnostics/hw_factory_diag.c: +1 -0
drivers/gpu/drm/amd/display/dc/gpio/diagnostics/hw_factory_diag.h: +2 -0
drivers/gpu/drm/amd/display/dc/gpio/diagnostics/hw_translate_diag.c: +1 -0
drivers/gpu/drm/amd/display/dc/gpio/hw_ddc.c: +3 -4
drivers/gpu/drm/amd/display/dc/gpio/hw_factory.c: +0 -14
drivers/gpu/drm/amd/display/dc/inc/core_types.h: +1 -0
drivers/gpu/drm/amd/display/dc/inc/hw/clk_mgr_internal.h: +2 -2
drivers/gpu/drm/amd/display/dc/inc/hw/dmcu.h: +10 -0
drivers/gpu/drm/amd/display/dc/inc/hw/timing_generator.h: +1 -0
drivers/gpu/drm/amd/display/dc/inc/hw_sequencer.h: +8 -0
drivers/gpu/drm/amd/display/dc/irq/dcn10/irq_service_dcn10.c: +31 -0
drivers/gpu/drm/amd/display/dc/irq/irq_service.c: +1 -1
drivers/gpu/drm/amd/display/dc/irq_types.h: +1 -0
drivers/gpu/drm/amd/display/dmub/inc/dmub_cmd.h: +31 -4
drivers/gpu/drm/amd/display/dmub/src/dmub_dcn20.c: +9 -2
drivers/gpu/drm/amd/display/dmub/src/dmub_dcn20.h: +2 -0
drivers/gpu/drm/amd/display/dmub/src/dmub_dcn30.c: +2 -1
drivers/gpu/drm/amd/display/dmub/src/dmub_srv.c: +3 -6
drivers/gpu/drm/amd/display/modules/color/color_table.c: +21 -5
drivers/gpu/drm/amd/display/modules/hdcp/hdcp.h: +1 -1
drivers/gpu/drm/amd/display/modules/hdcp/hdcp_psp.c: +3 -1
drivers/gpu/drm/amd/display/modules/inc/mod_hdcp.h: +2 -2
drivers/gpu/drm/amd/display/modules/info_packet/info_packet.c: +4 -9
drivers/gpu/drm/amd/display/modules/power/power_helpers.c: +4 -4
drivers/gpu/drm/amd/include/amd_pcie.h: +2 -0
drivers/gpu/drm/amd/include/amd_shared.h: +1 -0
drivers/gpu/drm/amd/include/asic_reg/oss/osssys_4_2_0_offset.h: +345 -0
drivers/gpu/drm/amd/include/asic_reg/oss/osssys_4_2_0_sh_mask.h: +1300 -0
drivers/gpu/drm/amd/include/asic_reg/smuio/smuio_11_0_6_offset.h: +35 -0
drivers/gpu/drm/amd/include/asic_reg/smuio/smuio_11_0_6_sh_mask.h: +41 -0
drivers/gpu/drm/amd/include/kgd_pp_interface.h: +4 -1
drivers/gpu/drm/amd/include/renoir_ip_offset.h: +1 -1
drivers/gpu/drm/amd/pm/amdgpu_pm.c: +240 -19
drivers/gpu/drm/amd/pm/inc/amdgpu_smu.h: +579 -4
drivers/gpu/drm/amd/pm/inc/smu11_driver_if_vangogh.h: +0 -1
drivers/gpu/drm/amd/pm/inc/smu_types.h: +7 -2
drivers/gpu/drm/amd/pm/inc/smu_v11_0.h: +12 -13
drivers/gpu/drm/amd/pm/inc/smu_v11_5_ppsmc.h: +5 -1
drivers/gpu/drm/amd/pm/inc/smu_v12_0.h: +0 -2
drivers/gpu/drm/amd/pm/powerplay/hwmgr/hwmgr.c: +1 -1
drivers/gpu/drm/amd/pm/powerplay/hwmgr/ppatomctrl.c: +2 -2
drivers/gpu/drm/amd/pm/powerplay/hwmgr/process_pptables_v1_0.c: +1 -0
drivers/gpu/drm/amd/pm/powerplay/hwmgr/smu10_hwmgr.c: +1 -1
drivers/gpu/drm/amd/pm/powerplay/hwmgr/smu7_hwmgr.c: +2 -2
drivers/gpu/drm/amd/pm/powerplay/hwmgr/vega10_hwmgr.c: +68 -69
drivers/gpu/drm/amd/pm/powerplay/hwmgr/vega10_hwmgr.h: +1 -0
drivers/gpu/drm/amd/pm/powerplay/hwmgr/vega12_hwmgr.c: +5 -6
drivers/gpu/drm/amd/pm/powerplay/hwmgr/vega20_hwmgr.c: +5 -6
drivers/gpu/drm/amd/pm/swsmu/amdgpu_smu.c: +201 -20
drivers/gpu/drm/amd/pm/swsmu/smu11/arcturus_ppt.c: +21 -8
drivers/gpu/drm/amd/pm/swsmu/smu11/navi10_ppt.c: +22 -9
drivers/gpu/drm/amd/pm/swsmu/smu11/sienna_cichlid_ppt.c: +362 -8
drivers/gpu/drm/amd/pm/swsmu/smu11/smu_v11_0.c: +9 -82
drivers/gpu/drm/amd/pm/swsmu/smu11/vangogh_ppt.c: +1230 -71
drivers/gpu/drm/amd/pm/swsmu/smu11/vangogh_ppt.h: +23 -3
drivers/gpu/drm/amd/pm/swsmu/smu12/renoir_ppt.c: +208 -18
drivers/gpu/drm/amd/pm/swsmu/smu12/smu_v12_0.c: +0 -12
drivers/gpu/drm/amd/pm/swsmu/smu_cmn.c: +68 -25
drivers/gpu/drm/amd/pm/swsmu/smu_cmn.h: +4 -0
drivers/gpu/drm/arc/arcpgu_crtc.c: +2 -7
drivers/gpu/drm/arc/arcpgu_drv.c: +1 -1
drivers/gpu/drm/arm/display/komeda/komeda_crtc.c: +0 -1
drivers/gpu/drm/arm/malidp_crtc.c: +0 -1
drivers/gpu/drm/armada/armada_crtc.c: +0 -1
drivers/gpu/drm/ast/ast_cursor.c: +26 -29
drivers/gpu/drm/ast/ast_drv.c: +2 -2
drivers/gpu/drm/ast/ast_drv.h: +0 -2
drivers/gpu/drm/ast/ast_main.c: +13 -12
drivers/gpu/drm/ast/ast_mm.c: +9 -8
drivers/gpu/drm/ast/ast_mode.c: +3 -3
drivers/gpu/drm/ast/ast_post.c: +5 -3
drivers/gpu/drm/atmel-hlcdc/atmel_hlcdc_crtc.c: +0 -1
drivers/gpu/drm/bochs/bochs_drv.c: +0 -1
drivers/gpu/drm/bochs/bochs_hw.c: +2 -2
drivers/gpu/drm/bridge/adv7511/adv7511_drv.c: +2 -4
drivers/gpu/drm/bridge/display-connector.c: +44 -2
drivers/gpu/drm/bridge/synopsys/dw-hdmi.c: +2 -4
drivers/gpu/drm/bridge/thc63lvd1024.c: +1 -1
drivers/gpu/drm/drm_agpsupport.c: +23 -44
drivers/gpu/drm/drm_atomic_helper.c: +9 -70
drivers/gpu/drm/drm_blend.c: +0 -6
drivers/gpu/drm/drm_bufs.c: +2 -2
drivers/gpu/drm/drm_cache.c: +33 -0
drivers/gpu/drm/drm_client_modeset.c: +5 -2
drivers/gpu/drm/drm_color_mgmt.c: +116 -9
drivers/gpu/drm/drm_crtc.c: +101 -29
drivers/gpu/drm/drm_dp_helper.c: +568 -82
drivers/gpu/drm/drm_dp_mst_topology.c: +4 -4
drivers/gpu/drm/drm_drv.c: +5 -11
drivers/gpu/drm/drm_dsc.c: +28 -2
drivers/gpu/drm/drm_dumb_buffers.c: +5 -3
drivers/gpu/drm/drm_edid.c: +109 -1
drivers/gpu/drm/drm_encoder.c: +88 -25
drivers/gpu/drm/drm_fb_helper.c: +20 -5
drivers/gpu/drm/drm_file.c: +3 -5
drivers/gpu/drm/drm_gem.c: +11 -20
drivers/gpu/drm/drm_gem_cma_helper.c: +48 -93
drivers/gpu/drm/drm_internal.h: +3 -0
drivers/gpu/drm/drm_irq.c: +39 -5
drivers/gpu/drm/drm_legacy.h: +1 -1
drivers/gpu/drm/drm_memory.c: +0 -51
drivers/gpu/drm/drm_mode_config.c: +50 -1
drivers/gpu/drm/drm_modes.c: +2 -2
drivers/gpu/drm/drm_pci.c: +37 -22
drivers/gpu/drm/drm_plane.c: +133 -37
drivers/gpu/drm/drm_prime.c: +41 -25
drivers/gpu/drm/drm_probe_helper.c: +2 -1
drivers/gpu/drm/drm_simple_kms_helper.c: +12 -2
drivers/gpu/drm/drm_vblank.c: +1 -1
drivers/gpu/drm/drm_vm.c: +1 -1
drivers/gpu/drm/etnaviv/etnaviv_gem_prime.c: +1 -2
drivers/gpu/drm/gma500/Kconfig: +1 -16
drivers/gpu/drm/gma500/Makefile: +13 -24
drivers/gpu/drm/gma500/cdv_device.c: +19 -11
drivers/gpu/drm/gma500/cdv_intel_crt.c: +2 -3
drivers/gpu/drm/gma500/cdv_intel_display.c: +1 -1
drivers/gpu/drm/gma500/cdv_intel_dp.c: +2 -2
drivers/gpu/drm/gma500/cdv_intel_hdmi.c: +0 -4
drivers/gpu/drm/gma500/cdv_intel_lvds.c: +6 -5
drivers/gpu/drm/gma500/framebuffer.c: +8 -7
drivers/gpu/drm/gma500/gem.c: +4 -2
drivers/gpu/drm/gma500/gem.h: +2 -0
drivers/gpu/drm/gma500/gma_device.c: +3 -1
drivers/gpu/drm/gma500/gma_display.c: +6 -6
drivers/gpu/drm/gma500/gtt.c: +11 -9
drivers/gpu/drm/gma500/intel_bios.c: +4 -4
drivers/gpu/drm/gma500/intel_gmbus.c: +2 -2
drivers/gpu/drm/gma500/intel_i2c.c: +2 -3
drivers/gpu/drm/gma500/mdfld_device.c: +0 -562
drivers/gpu/drm/gma500/mdfld_dsi_dpi.c: +0 -1017
drivers/gpu/drm/gma500/mdfld_dsi_dpi.h: +0 -79
drivers/gpu/drm/gma500/mdfld_dsi_output.c: +0 -603
drivers/gpu/drm/gma500/mdfld_dsi_output.h: +0 -377
drivers/gpu/drm/gma500/mdfld_dsi_pkg_sender.c: +0 -679
drivers/gpu/drm/gma500/mdfld_dsi_pkg_sender.h: +0 -80
drivers/gpu/drm/gma500/mdfld_intel_display.c: +0 -966
drivers/gpu/drm/gma500/mdfld_output.c: +0 -74
drivers/gpu/drm/gma500/mdfld_output.h: +0 -76
drivers/gpu/drm/gma500/mdfld_tmd_vid.c: +0 -197
drivers/gpu/drm/gma500/mdfld_tpo_vid.c: +0 -83
drivers/gpu/drm/gma500/mid_bios.c: +6 -3
drivers/gpu/drm/gma500/mmu.c: +3 -33
drivers/gpu/drm/gma500/oaktrail_crtc.c: +3 -3
drivers/gpu/drm/gma500/oaktrail_device.c: +3 -2
drivers/gpu/drm/gma500/oaktrail_hdmi_i2c.c: +13 -9
drivers/gpu/drm/gma500/oaktrail_lvds.c: +3 -2
drivers/gpu/drm/gma500/oaktrail_lvds_i2c.c: +5 -5
drivers/gpu/drm/gma500/opregion.c: +2 -1
drivers/gpu/drm/gma500/power.c: +11 -10
drivers/gpu/drm/gma500/psb_drv.c: +12 -22
drivers/gpu/drm/gma500/psb_drv.h: +3 -69
drivers/gpu/drm/gma500/psb_intel_display.c: +1 -1
drivers/gpu/drm/gma500/psb_intel_lvds.c: +4 -3
drivers/gpu/drm/gma500/psb_intel_modes.c: +2 -1
drivers/gpu/drm/gma500/psb_intel_reg.h: +1 -11
drivers/gpu/drm/gma500/psb_intel_sdvo.c: +4 -4
drivers/gpu/drm/gma500/psb_irq.c: +2 -73
drivers/gpu/drm/gma500/psb_irq.h: +0 -2
drivers/gpu/drm/gma500/psb_reg.h: +0 -14
drivers/gpu/drm/gma500/tc35876x-dsi-lvds.c: +0 -805
drivers/gpu/drm/gma500/tc35876x-dsi-lvds.h: +0 -38
drivers/gpu/drm/hisilicon/hibmc/Makefile: +1 -1
drivers/gpu/drm/hisilicon/hibmc/hibmc_drm_de.c: +1 -1
drivers/gpu/drm/hisilicon/hibmc/hibmc_drm_drv.c: +50 -54
drivers/gpu/drm/hisilicon/hibmc/hibmc_drm_drv.h: +2 -8
drivers/gpu/drm/hisilicon/hibmc/hibmc_drm_i2c.c: +1 -1
drivers/gpu/drm/hisilicon/hibmc/hibmc_drm_vdac.c: +5 -15
drivers/gpu/drm/hisilicon/hibmc/hibmc_ttm.c: +0 -61
drivers/gpu/drm/i915/Kconfig.debug: +22 -2
drivers/gpu/drm/i915/Makefile: +15 -11
drivers/gpu/drm/i915/display/i9xx_plane.c: +926 -0
drivers/gpu/drm/i915/display/i9xx_plane.h: +24 -0
drivers/gpu/drm/i915/display/icl_dsi.c: +3 -0
drivers/gpu/drm/i915/display/intel_atomic_plane.c: +4 -1
drivers/gpu/drm/i915/display/intel_bios.c: +13 -8
drivers/gpu/drm/i915/display/intel_bw.c: +8 -72
drivers/gpu/drm/i915/display/intel_cdclk.c: +3 -4
drivers/gpu/drm/i915/display/intel_color.c: +16 -0
drivers/gpu/drm/i915/display/intel_combo_phy.c: +16 -4
drivers/gpu/drm/i915/display/intel_connector.c: +11 -18
drivers/gpu/drm/i915/display/intel_connector.h: +2 -1
drivers/gpu/drm/i915/display/intel_crtc.c: +325 -0
drivers/gpu/drm/i915/display/intel_crtc.h: +22 -0
drivers/gpu/drm/i915/display/intel_cursor.c: +806 -0
drivers/gpu/drm/i915/display/intel_cursor.h: +17 -0
drivers/gpu/drm/i915/display/intel_ddi.c: +184 -60
drivers/gpu/drm/i915/display/intel_ddi.h: +3 -3
drivers/gpu/drm/i915/display/intel_display.c: +1874 -5610
drivers/gpu/drm/i915/display/intel_display.h: +21 -6
drivers/gpu/drm/i915/display/intel_display_debugfs.c: +128 -5
drivers/gpu/drm/i915/display/intel_display_debugfs.h: +3 -0
drivers/gpu/drm/i915/display/intel_display_power.c: +98 -35
drivers/gpu/drm/i915/display/intel_display_power.h: +34 -3
drivers/gpu/drm/i915/display/intel_display_types.h: +158 -44
drivers/gpu/drm/i915/display/intel_dp.c: +810 -2302
drivers/gpu/drm/i915/display/intel_dp.h: +6 -5
drivers/gpu/drm/i915/display/intel_dp_aux.c: +692 -0
drivers/gpu/drm/i915/display/intel_dp_aux.h: +18 -0
drivers/gpu/drm/i915/display/intel_dp_aux_backlight.c: +352 -52
drivers/gpu/drm/i915/display/intel_dp_hdcp.c: +152 -26
drivers/gpu/drm/i915/display/intel_dp_link_training.c: +21 -28
drivers/gpu/drm/i915/display/intel_dp_mst.c: +5 -7
drivers/gpu/drm/i915/display/intel_dpll.c: +1363 -0
drivers/gpu/drm/i915/display/intel_dpll.h: +23 -0
drivers/gpu/drm/i915/display/intel_dsi_dcs_backlight.c: +13 -10
drivers/gpu/drm/i915/display/intel_dvo.c: +0 -4
drivers/gpu/drm/i915/display/intel_fbc.c: +13 -8
drivers/gpu/drm/i915/display/intel_fbdev.c: +2 -2
drivers/gpu/drm/i915/display/intel_fdi.c: +683 -0
drivers/gpu/drm/i915/display/intel_fdi.h: +22 -0
drivers/gpu/drm/i915/display/intel_frontbuffer.c: +3 -1
drivers/gpu/drm/i915/display/intel_hdcp.c: +237 -63
drivers/gpu/drm/i915/display/intel_hdcp.h: +6 -2
drivers/gpu/drm/i915/display/intel_hdmi.c: +257 -27
drivers/gpu/drm/i915/display/intel_hdmi.h: +7 -0
drivers/gpu/drm/i915/display/intel_lspcon.c: +139 -23
drivers/gpu/drm/i915/display/intel_lspcon.h: +12 -0
drivers/gpu/drm/i915/display/intel_overlay.c: +1 -0
drivers/gpu/drm/i915/display/intel_panel.c: +324 -228
drivers/gpu/drm/i915/display/intel_panel.h: +4 -0
drivers/gpu/drm/i915/display/intel_pps.c: +1406 -0
drivers/gpu/drm/i915/display/intel_pps.h: +52 -0
drivers/gpu/drm/i915/display/intel_psr.c: +126 -17
drivers/gpu/drm/i915/display/intel_sprite.c: +120 -28
drivers/gpu/drm/i915/display/intel_sprite.h: +10 -0
drivers/gpu/drm/i915/display/intel_tc.c: +1 -1
drivers/gpu/drm/i915/display/intel_vbt_defs.h: +2 -0
drivers/gpu/drm/i915/display/intel_vdsc.c: +1 -3
drivers/gpu/drm/i915/display/intel_vrr.c: +209 -0
drivers/gpu/drm/i915/display/intel_vrr.h: +33 -0
drivers/gpu/drm/i915/dma_resv_utils.c: +17 -0
drivers/gpu/drm/i915/dma_resv_utils.h: +13 -0
drivers/gpu/drm/i915/gem/i915_gem_context.c: +37 -95
drivers/gpu/drm/i915/gem/i915_gem_context.h: +0 -1
drivers/gpu/drm/i915/gem/i915_gem_context_types.h: +0 -1
drivers/gpu/drm/i915/gem/i915_gem_create.c: +113 -0
drivers/gpu/drm/i915/gem/i915_gem_domain.c: +53 -6
drivers/gpu/drm/i915/gem/i915_gem_execbuffer.c: +12 -12
drivers/gpu/drm/i915/gem/i915_gem_lmem.c: +5 -10
drivers/gpu/drm/i915/gem/i915_gem_lmem.h: +4 -4
drivers/gpu/drm/i915/gem/i915_gem_object.c: +65 -47
drivers/gpu/drm/i915/gem/i915_gem_object.h: +31 -12
drivers/gpu/drm/i915/gem/i915_gem_object_blt.c: +5 -4
drivers/gpu/drm/i915/gem/i915_gem_object_types.h: +11 -8
drivers/gpu/drm/i915/gem/i915_gem_pages.c: +27 -24
drivers/gpu/drm/i915/gem/i915_gem_phys.c: +2 -2
drivers/gpu/drm/i915/gem/i915_gem_pm.c: +52 -24
drivers/gpu/drm/i915/gem/i915_gem_pm.h: +3 -0
drivers/gpu/drm/i915/gem/i915_gem_region.c: +33 -19
drivers/gpu/drm/i915/gem/i915_gem_shmem.c: +12 -16
drivers/gpu/drm/i915/gem/i915_gem_shrinker.c: +3 -0
drivers/gpu/drm/i915/gem/i915_gem_stolen.c: +38 -41
drivers/gpu/drm/i915/gem/i915_gem_stolen.h: +2 -0
drivers/gpu/drm/i915/gem/i915_gem_tiling.c: +6 -6
drivers/gpu/drm/i915/gem/i915_gem_wait.c: +36 -18
drivers/gpu/drm/i915/gem/selftests/huge_gem_object.c: +1 -1
drivers/gpu/drm/i915/gem/selftests/huge_pages.c: +22 -0
drivers/gpu/drm/i915/gem/selftests/i915_gem_client_blt.c: +1 -3
drivers/gpu/drm/i915/gem/selftests/i915_gem_coherency.c: +1 -0
drivers/gpu/drm/i915/gem/selftests/i915_gem_mman.c: +1 -0
drivers/gpu/drm/i915/gem/selftests/igt_gem_utils.c: +1 -0
drivers/gpu/drm/i915/gt/debugfs_gt_pm.c: +15 -12
drivers/gpu/drm/i915/gt/gen6_ppgtt.c: +3 -12
drivers/gpu/drm/i915/gt/gen7_renderclear.c: +9 -5
drivers/gpu/drm/i915/gt/gen8_engine_cs.c: +635 -0
drivers/gpu/drm/i915/gt/gen8_engine_cs.h: +127 -0
drivers/gpu/drm/i915/gt/gen8_ppgtt.c: +6 -7
drivers/gpu/drm/i915/gt/intel_breadcrumbs.c: +48 -11
drivers/gpu/drm/i915/gt/intel_breadcrumbs.h: +16 -1
drivers/gpu/drm/i915/gt/intel_breadcrumbs_types.h: +5 -2
drivers/gpu/drm/i915/gt/intel_context.h: +7 -4
drivers/gpu/drm/i915/gt/intel_context_sseu.c: +0 -1
drivers/gpu/drm/i915/gt/intel_context_types.h: +17 -8
drivers/gpu/drm/i915/gt/intel_engine.h: +6 -87
drivers/gpu/drm/i915/gt/intel_engine_cs.c: +88 -79
drivers/gpu/drm/i915/gt/intel_engine_heartbeat.c: +41 -18
drivers/gpu/drm/i915/gt/intel_engine_pm.c: +15 -7
drivers/gpu/drm/i915/gt/intel_engine_stats.h: +60 -0
drivers/gpu/drm/i915/gt/intel_engine_types.h: +8 -14
drivers/gpu/drm/i915/gt/intel_execlists_submission.c: +3896 -0
drivers/gpu/drm/i915/gt/intel_execlists_submission.h: +47 -0
drivers/gpu/drm/i915/gt/intel_ggtt.c: +16 -2
drivers/gpu/drm/i915/gt/intel_ggtt_fencing.c: +20 -2
drivers/gpu/drm/i915/gt/intel_gt.c: +2 -2
drivers/gpu/drm/i915/gt/intel_gt_buffer_pool.c: +9 -3
drivers/gpu/drm/i915/gt/intel_gt_buffer_pool.h: +2 -1
drivers/gpu/drm/i915/gt/intel_gt_buffer_pool_types.h: +2 -2
drivers/gpu/drm/i915/gt/intel_gt_clock_utils.c: +157 -40
drivers/gpu/drm/i915/gt/intel_gt_clock_utils.h: +4 -4
drivers/gpu/drm/i915/gt/intel_gt_irq.c: +1 -0
drivers/gpu/drm/i915/gt/intel_gt_pm.c: +49 -0
drivers/gpu/drm/i915/gt/intel_gt_pm.h: +2 -0
drivers/gpu/drm/i915/gt/intel_gt_requests.c: +1 -6
drivers/gpu/drm/i915/gt/intel_gt_types.h: +25 -0
drivers/gpu/drm/i915/gt/intel_gtt.c: +29 -0
drivers/gpu/drm/i915/gt/intel_gtt.h: +3 -0
drivers/gpu/drm/i915/gt/intel_lrc.c: +1148 -5733
drivers/gpu/drm/i915/gt/intel_lrc.h: +61 -106
drivers/gpu/drm/i915/gt/intel_lrc_reg.h: +41 -0
drivers/gpu/drm/i915/gt/intel_mocs.c: +2 -2
drivers/gpu/drm/i915/gt/intel_ppgtt.c: +1 -1
drivers/gpu/drm/i915/gt/intel_rc6.c: +1 -1
drivers/gpu/drm/i915/{ => gt}/intel_region_lmem.c: +2 -2
drivers/gpu/drm/i915/{ => gt}/intel_region_lmem.h: +0 -2
drivers/gpu/drm/i915/gt/intel_renderstate.c: +2 -1
drivers/gpu/drm/i915/gt/intel_reset.c: +64 -37
drivers/gpu/drm/i915/gt/intel_reset.h: +2 -0
drivers/gpu/drm/i915/gt/intel_ring.c: +3 -1
drivers/gpu/drm/i915/gt/intel_ring_submission.c: +131 -141
drivers/gpu/drm/i915/gt/intel_rps.c: +36 -25
drivers/gpu/drm/i915/gt/intel_rps_types.h: +1 -1
drivers/gpu/drm/i915/gt/intel_timeline.c: +101 -2
drivers/gpu/drm/i915/gt/intel_timeline.h: +18 -7
drivers/gpu/drm/i915/gt/intel_timeline_types.h: +2 -0
drivers/gpu/drm/i915/gt/intel_workarounds.c: +318 -336
drivers/gpu/drm/i915/gt/mock_engine.c: +2 -13
drivers/gpu/drm/i915/gt/selftest_context.c: +1 -1
drivers/gpu/drm/i915/gt/selftest_engine_cs.c: +1 -0
drivers/gpu/drm/i915/gt/selftest_engine_heartbeat.c: +10 -3
drivers/gpu/drm/i915/gt/selftest_engine_pm.c: +203 -0
drivers/gpu/drm/i915/gt/selftest_execlists.c: +4741 -0
drivers/gpu/drm/i915/gt/selftest_gt_pm.c: +4 -4
drivers/gpu/drm/i915/gt/selftest_hangcheck.c: +167 -6
drivers/gpu/drm/i915/gt/selftest_lrc.c: +70 -4701
drivers/gpu/drm/i915/gt/selftest_mocs.c: +28 -52
drivers/gpu/drm/i915/gt/selftest_rc6.c: +1 -0
drivers/gpu/drm/i915/gt/selftest_reset.c: +20 -8
drivers/gpu/drm/i915/gt/selftest_rps.c: +4 -1
drivers/gpu/drm/i915/gt/selftest_timeline.c: +7 -7
drivers/gpu/drm/i915/gt/selftest_workarounds.c: +93 -103
drivers/gpu/drm/i915/gt/shmem_utils.c: +1 -1
drivers/gpu/drm/i915/gt/uc/intel_guc.c: +2 -14
drivers/gpu/drm/i915/gt/uc/intel_guc.h: +0 -7
drivers/gpu/drm/i915/gt/uc/intel_guc_ads.c: +1 -0
drivers/gpu/drm/i915/gt/uc/intel_guc_fw.c: +6 -7
drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c: +270 -187
drivers/gpu/drm/i915/gt/uc/intel_guc_submission.h: +1 -0
drivers/gpu/drm/i915/gt/uc/intel_uc.c: +36 -18
drivers/gpu/drm/i915/gt/uc/intel_uc_fw.c: +1 -6
drivers/gpu/drm/i915/gvt/cmd_parser.c: +267 -70
drivers/gpu/drm/i915/gvt/cmd_parser.h: +5 -0
drivers/gpu/drm/i915/gvt/execlist.h: +0 -3
drivers/gpu/drm/i915/gvt/fb_decoder.h: +4 -2
drivers/gpu/drm/i915/gvt/gtt.h: +10 -1
drivers/gpu/drm/i915/gvt/gvt.h: +40 -1
drivers/gpu/drm/i915/gvt/handlers.c: +11 -11
drivers/gpu/drm/i915/gvt/interrupt.h: +4 -1
drivers/gpu/drm/i915/gvt/mmio.h: +3 -0
drivers/gpu/drm/i915/gvt/mmio_context.c: +1 -0
drivers/gpu/drm/i915/gvt/mmio_context.h: +12 -0
drivers/gpu/drm/i915/gvt/mpt.h: +2 -0
drivers/gpu/drm/i915/gvt/reg.h: +2 -0
drivers/gpu/drm/i915/gvt/scheduler.c: +20 -4
drivers/gpu/drm/i915/gvt/scheduler.h: +5 -0
drivers/gpu/drm/i915/gvt/vgpu.c: +3 -1
drivers/gpu/drm/i915/i915_active.c: +2 -5
drivers/gpu/drm/i915/i915_cmd_parser.c: +2 -1
drivers/gpu/drm/i915/i915_debugfs.c: +52 -711
drivers/gpu/drm/i915/i915_drv.c: +9 -8
drivers/gpu/drm/i915/i915_drv.h: +38 -82
drivers/gpu/drm/i915/i915_gem.c: +6 -157
drivers/gpu/drm/i915/i915_gem.h: +8 -1
drivers/gpu/drm/i915/i915_gem_evict.c: +12 -1
drivers/gpu/drm/i915/i915_gem_gtt.c: +10 -15
drivers/gpu/drm/i915/i915_getparam.c: +1 -1
drivers/gpu/drm/i915/i915_gpu_error.c: +4 -2
drivers/gpu/drm/i915/i915_irq.c: +238 -237
drivers/gpu/drm/i915/i915_irq.h: +0 -3
drivers/gpu/drm/i915/i915_mm.c: +1 -1
drivers/gpu/drm/i915/i915_params.c: +1 -1
drivers/gpu/drm/i915/i915_params.h: +1 -0
drivers/gpu/drm/i915/i915_pci.c: +3 -4
drivers/gpu/drm/i915/i915_perf.c: +11 -6
drivers/gpu/drm/i915/i915_pmu.c: +59 -36
drivers/gpu/drm/i915/i915_pmu.h: +24 -11
drivers/gpu/drm/i915/i915_reg.h: +71 -10
drivers/gpu/drm/i915/i915_request.c: +151 -27
drivers/gpu/drm/i915/i915_request.h: +9 -1
drivers/gpu/drm/i915/i915_scheduler.c: +28 -4
drivers/gpu/drm/i915/i915_scheduler.h: +7 -0
drivers/gpu/drm/i915/i915_scheduler_types.h: +10 -0
drivers/gpu/drm/i915/i915_suspend.c: +17 -16
drivers/gpu/drm/i915/i915_sw_fence.c: +15 -10
drivers/gpu/drm/i915/i915_utils.c: +1 -1
drivers/gpu/drm/i915/i915_utils.h: +6 -1
drivers/gpu/drm/i915/i915_vma.h: +15 -0
drivers/gpu/drm/i915/i915_vma_types.h: +3 -0
drivers/gpu/drm/i915/intel_device_info.c: +1 -158
drivers/gpu/drm/i915/intel_device_info.h: +0 -4
drivers/gpu/drm/i915/intel_dram.c: +94 -42
drivers/gpu/drm/i915/intel_memory_region.c: +1 -1
drivers/gpu/drm/i915/intel_memory_region.h: +4 -9
drivers/gpu/drm/i915/intel_pch.c: +22 -17
drivers/gpu/drm/i915/intel_pm.c: +536 -572
drivers/gpu/drm/i915/intel_pm.h: +6 -1
drivers/gpu/drm/i915/intel_sideband.c: +2 -2
drivers/gpu/drm/i915/intel_uncore.c: +2 -2
drivers/gpu/drm/i915/intel_uncore.h: +3 -3
drivers/gpu/drm/i915/selftests/i915_gem.c: +1 -0
drivers/gpu/drm/i915/selftests/i915_gem_evict.c: +10 -18
drivers/gpu/drm/i915/selftests/i915_gem_gtt.c: +1 -0
drivers/gpu/drm/i915/selftests/i915_perf.c: +1 -1
drivers/gpu/drm/i915/selftests/i915_request.c: +3 -6
drivers/gpu/drm/i915/selftests/igt_spinner.c: +4 -0
drivers/gpu/drm/i915/selftests/intel_memory_region.c: +98 -12
drivers/gpu/drm/i915/selftests/mock_gem_device.c: +0 -2
drivers/gpu/drm/i915/selftests/mock_region.c: +7 -12
drivers/gpu/drm/imx/Kconfig: +2 -1
drivers/gpu/drm/imx/dw_hdmi-imx.c: +41 -54
drivers/gpu/drm/imx/imx-ldb.c: +62 -47
drivers/gpu/drm/imx/imx-tve.c: +55 -54
drivers/gpu/drm/imx/ipuv3-crtc.c: +40 -91
drivers/gpu/drm/imx/ipuv3-plane.c: +34 -35
drivers/gpu/drm/imx/ipuv3-plane.h: +0 -3
drivers/gpu/drm/imx/parallel-display.c: +46 -47
drivers/gpu/drm/ingenic/Kconfig: +1 -0
drivers/gpu/drm/ingenic/ingenic-drm-drv.c: +47 -13
drivers/gpu/drm/ingenic/ingenic-drm.h: +14 -0
drivers/gpu/drm/kmb/kmb_drv.c: +2 -2
drivers/gpu/drm/kmb/kmb_plane.c: +3 -0
drivers/gpu/drm/lima/lima_sched.c: +1 -1
drivers/gpu/drm/mediatek/Makefile: +3 -2
drivers/gpu/drm/mediatek/mtk_disp_ccorr.c: +223 -0
drivers/gpu/drm/mediatek/mtk_disp_color.c: +40 -49
drivers/gpu/drm/mediatek/mtk_disp_drv.h: +92 -0
drivers/gpu/drm/mediatek/mtk_disp_gamma.c: +197 -0
drivers/gpu/drm/mediatek/mtk_disp_ovl.c: +141 -113
drivers/gpu/drm/mediatek/mtk_disp_rdma.c: +106 -88
drivers/gpu/drm/mediatek/mtk_dpi.c: +19 -38
drivers/gpu/drm/mediatek/mtk_drm_crtc.c: +54 -54
drivers/gpu/drm/mediatek/mtk_drm_crtc.h: +0 -1
drivers/gpu/drm/mediatek/mtk_drm_ddp.h: +0 -28
drivers/gpu/drm/mediatek/mtk_drm_ddp_comp.c: +237 -266
drivers/gpu/drm/mediatek/mtk_drm_ddp_comp.h: +57 -43
drivers/gpu/drm/mediatek/mtk_drm_drv.c: +60 -28
drivers/gpu/drm/mediatek/mtk_drm_drv.h: +3 -2
drivers/gpu/drm/mediatek/mtk_drm_gem.c: +1 -1
drivers/gpu/drm/mediatek/mtk_dsi.c: +7 -43
drivers/gpu/drm/mga/mga_ioc32.c: +7 -7
drivers/gpu/drm/mgag200/mgag200_drv.c: +11 -9
drivers/gpu/drm/mgag200/mgag200_i2c.c: +1 -1
drivers/gpu/drm/mgag200/mgag200_mm.c: +6 -4
drivers/gpu/drm/msm/dp/dp_ctrl.c: +2 -4
drivers/gpu/drm/msm/msm_gem.c: +1 -1
drivers/gpu/drm/nouveau/dispnv04/arb.c: +7 -5
drivers/gpu/drm/nouveau/dispnv04/dfp.c: +3 -2
drivers/gpu/drm/nouveau/dispnv04/disp.h: +8 -6
drivers/gpu/drm/nouveau/dispnv04/hw.c: +6 -4
drivers/gpu/drm/nouveau/dispnv50/core507d.c: +1 -1
drivers/gpu/drm/nouveau/dispnv50/corec37d.c: +1 -1
drivers/gpu/drm/nouveau/dispnv50/disp.c: +130 -100
drivers/gpu/drm/nouveau/dispnv50/head.c: +0 -2
drivers/gpu/drm/nouveau/dispnv50/head907d.c: +2 -9
drivers/gpu/drm/nouveau/include/nvif/cl0080.h: +24 -28
drivers/gpu/drm/nouveau/include/nvif/fifo.h: +3 -3
drivers/gpu/drm/nouveau/include/nvkm/core/device.h: +18 -173
drivers/gpu/drm/nouveau/include/nvkm/core/engine.h: +10 -3
drivers/gpu/drm/nouveau/include/nvkm/core/enum.h: +1 -0
drivers/gpu/drm/nouveau/include/nvkm/core/falcon.h: +5 -5
drivers/gpu/drm/nouveau/include/nvkm/core/layout.h: +53 -0
drivers/gpu/drm/nouveau/include/nvkm/core/subdev.h: +21 -10
drivers/gpu/drm/nouveau/include/nvkm/engine/bsp.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/ce.h: +9 -9
drivers/gpu/drm/nouveau/include/nvkm/engine/cipher.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/disp.h: +22 -19
drivers/gpu/drm/nouveau/include/nvkm/engine/dma.h: +5 -5
drivers/gpu/drm/nouveau/include/nvkm/engine/falcon.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/fifo.h: +22 -20
drivers/gpu/drm/nouveau/include/nvkm/engine/gr.h: +40 -40
drivers/gpu/drm/nouveau/include/nvkm/engine/mpeg.h: +5 -5
drivers/gpu/drm/nouveau/include/nvkm/engine/mspdec.h: +4 -4
drivers/gpu/drm/nouveau/include/nvkm/engine/msppp.h: +3 -3
drivers/gpu/drm/nouveau/include/nvkm/engine/msvld.h: +5 -5
drivers/gpu/drm/nouveau/include/nvkm/engine/nvdec.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/nvenc.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/pm.h: +13 -10
drivers/gpu/drm/nouveau/include/nvkm/engine/sec.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/sec2.h: +3 -3
drivers/gpu/drm/nouveau/include/nvkm/engine/sw.h: +4 -4
drivers/gpu/drm/nouveau/include/nvkm/engine/vp.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/engine/xtensa.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/subdev/acr.h: +6 -6
drivers/gpu/drm/nouveau/include/nvkm/subdev/bar.h: +7 -7
drivers/gpu/drm/nouveau/include/nvkm/subdev/bios.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/subdev/bios/conn.h: +1 -0
drivers/gpu/drm/nouveau/include/nvkm/subdev/bus.h: +5 -5
drivers/gpu/drm/nouveau/include/nvkm/subdev/clk.h: +10 -10
drivers/gpu/drm/nouveau/include/nvkm/subdev/devinit.h: +17 -18
drivers/gpu/drm/nouveau/include/nvkm/subdev/fault.h: +4 -4
drivers/gpu/drm/nouveau/include/nvkm/subdev/fb.h: +40 -35
drivers/gpu/drm/nouveau/include/nvkm/subdev/fuse.h: +3 -3
drivers/gpu/drm/nouveau/include/nvkm/subdev/gpio.h: +6 -6
drivers/gpu/drm/nouveau/include/nvkm/subdev/gsp.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/subdev/i2c.h: +9 -9
drivers/gpu/drm/nouveau/include/nvkm/subdev/ibus.h: +0 -12
drivers/gpu/drm/nouveau/include/nvkm/subdev/iccsense.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/subdev/instmem.h: +9 -4
drivers/gpu/drm/nouveau/include/nvkm/subdev/ltc.h: +8 -8
drivers/gpu/drm/nouveau/include/nvkm/subdev/mc.h: +20 -20
drivers/gpu/drm/nouveau/include/nvkm/subdev/mmu.h: +17 -15
drivers/gpu/drm/nouveau/include/nvkm/subdev/mxm.h: +1 -1
drivers/gpu/drm/nouveau/include/nvkm/subdev/pci.h: +11 -11
drivers/gpu/drm/nouveau/include/nvkm/subdev/pmu.h: +13 -12
drivers/gpu/drm/nouveau/include/nvkm/subdev/privring.h: +12 -0
drivers/gpu/drm/nouveau/include/nvkm/subdev/therm.h: +9 -9
drivers/gpu/drm/nouveau/include/nvkm/subdev/timer.h: +4 -4
drivers/gpu/drm/nouveau/include/nvkm/subdev/top.h: +19 -8
drivers/gpu/drm/nouveau/include/nvkm/subdev/volt.h: +6 -6
drivers/gpu/drm/nouveau/nouveau_abi16.c: +11 -10
drivers/gpu/drm/nouveau/nouveau_acpi.c: +1 -1
drivers/gpu/drm/nouveau/nouveau_bios.c: +6 -3
drivers/gpu/drm/nouveau/nouveau_bo.c: +11 -9
drivers/gpu/drm/nouveau/nouveau_chan.c: +2 -1
drivers/gpu/drm/nouveau/nouveau_connector.c: +7 -4
drivers/gpu/drm/nouveau/nouveau_display.c: +4 -4
drivers/gpu/drm/nouveau/nouveau_drm.c: +3 -4
drivers/gpu/drm/nouveau/nouveau_drv.h: +1 -1
drivers/gpu/drm/nouveau/nouveau_encoder.h: +8 -5
drivers/gpu/drm/nouveau/nouveau_fbcon.c: +4 -2
drivers/gpu/drm/nouveau/nouveau_prime.c: +2 -2
drivers/gpu/drm/nouveau/nouveau_sgdma.c: +1 -1
drivers/gpu/drm/nouveau/nouveau_vga.c: +12 -8
drivers/gpu/drm/nouveau/nv17_fence.c: +1 -1
drivers/gpu/drm/nouveau/nv50_fence.c: +1 -1
drivers/gpu/drm/nouveau/nvif/fifo.c: +9 -21
drivers/gpu/drm/nouveau/nvkm/core/engine.c: +29 -22
drivers/gpu/drm/nouveau/nvkm/core/memory.c: +9 -9
drivers/gpu/drm/nouveau/nvkm/core/subdev.c: +35 -75
drivers/gpu/drm/nouveau/nvkm/engine/bsp/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/ce/gf100.c: +4 -13
drivers/gpu/drm/nouveau/nvkm/engine/ce/gk104.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/ce/gm107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/ce/gm200.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/ce/gp100.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/ce/gp102.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/ce/gt215.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/ce/gv100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/ce/tu102.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/cipher/g84.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/device/base.c: +2194 -2405
drivers/gpu/drm/nouveau/nvkm/engine/device/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/device/user.c: +5 -35
drivers/gpu/drm/nouveau/nvkm/engine/disp/base.c: +14 -13
drivers/gpu/drm/nouveau/nvkm/engine/disp/channv50.c: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/disp/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/g94.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/ga102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gf119.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gk110.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gm107.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gm200.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gp100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gp102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gt200.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gt215.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/gv100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/mcp77.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/mcp89.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/nv50.c: +5 -4
drivers/gpu/drm/nouveau/nvkm/engine/disp/nv50.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/disp/priv.h: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/disp/tu102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/gf100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/gf119.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/gv100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/dma/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/falcon.c: +5 -6
drivers/gpu/drm/nouveau/nvkm/engine/fifo/base.c: +6 -4
drivers/gpu/drm/nouveau/nvkm/engine/fifo/chan.c: +23 -15
drivers/gpu/drm/nouveau/nvkm/engine/fifo/chan.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/fifo/chang84.c: +21 -42
drivers/gpu/drm/nouveau/nvkm/engine/fifo/changf100.h: +9 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/changk104.h: +4 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/channv04.h: +5 -1
drivers/gpu/drm/nouveau/nvkm/engine/fifo/channv50.c: +18 -10
drivers/gpu/drm/nouveau/nvkm/engine/fifo/channv50.h: +21 -1
drivers/gpu/drm/nouveau/nvkm/engine/fifo/dmanv04.c: +8 -8
drivers/gpu/drm/nouveau/nvkm/engine/fifo/dmanv10.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/fifo/dmanv17.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/fifo/dmanv40.c: +20 -12
drivers/gpu/drm/nouveau/nvkm/engine/fifo/g84.c: +73 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gf100.c: +51 -48
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gk104.c: +128 -79
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gk104.h: +34 -1
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gk110.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gk208.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gk20a.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gm107.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gm200.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gm20b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gp100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gp10b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gpfifogf100.c: +30 -23
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gpfifogk104.c: +29 -31
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gpfifogv100.c: +8 -19
drivers/gpu/drm/nouveau/nvkm/engine/fifo/gv100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv04.c: +39 -5
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv04.h: +2 -3
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv10.c: +5 -3
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv17.c: +5 -3
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv40.c: +5 -3
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv50.c: +9 -6
drivers/gpu/drm/nouveau/nvkm/engine/fifo/nv50.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/priv.h: +9 -2
drivers/gpu/drm/nouveau/nvkm/engine/fifo/tu102.c: +363 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/g84.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf100.c: +5 -5
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf100.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf108.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf110.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf117.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gf119.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gk104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gk110.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gk110b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gk208.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gk20a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gm107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gm200.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gm20b.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gp100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gp102.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gp104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gp107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gp108.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gp10b.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gt200.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gt215.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/gv100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/mcp79.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/mcp89.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv04.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv10.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv10.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv15.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv17.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv20.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv20.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv25.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv2a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv30.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv34.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv35.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv40.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv40.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv44.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv50.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/gr/nv50.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/gr/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/gr/tu102.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/mpeg/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/mpeg/nv31.c: +5 -5
drivers/gpu/drm/nouveau/nvkm/engine/mpeg/nv31.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/mpeg/nv40.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/mpeg/nv44.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/mpeg/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/mspdec/base.c: +3 -4
drivers/gpu/drm/nouveau/nvkm/engine/mspdec/g98.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/mspdec/gf100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/mspdec/gk104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/mspdec/gt215.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/mspdec/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msppp/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msppp/g98.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msppp/gf100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msppp/gt215.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/msppp/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msvld/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msvld/g98.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msvld/gf100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msvld/gk104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/msvld/gt215.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/msvld/mcp89.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/msvld/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/nvdec/base.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/nvdec/gm107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/nvdec/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/nvenc/base.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/nvenc/gm107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/nvenc/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/pm/base.c: +12 -11
drivers/gpu/drm/nouveau/nvkm/engine/pm/g84.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/gf100.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/pm/gf100.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/gf108.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/gf117.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/gk104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/gt200.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/gt215.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/nv40.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/engine/pm/nv40.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/nv50.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/pm/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/sec/g98.c: +2 -3
drivers/gpu/drm/nouveau/nvkm/engine/sec2/base.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/sec2/gp102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/sec2/gp108.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/sec2/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/engine/sec2/tu102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/engine/sw/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/sw/gf100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/sw/nv04.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/sw/nv10.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/sw/nv50.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/sw/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/engine/vp/g84.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/engine/xtensa.c: +4 -5
drivers/gpu/drm/nouveau/nvkm/falcon/base.c: +6 -8
drivers/gpu/drm/nouveau/nvkm/subdev/Kbuild: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/acr/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/acr/gm200.c: +5 -4
drivers/gpu/drm/nouveau/nvkm/subdev/acr/gm20b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/acr/gp102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/acr/gp108.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/acr/gp10b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/acr/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/acr/tu102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bar/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bar/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bar/gf100.c: +5 -4
drivers/gpu/drm/nouveau/nvkm/subdev/bar/gf100.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/bar/gk20a.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bar/gm107.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bar/gm20b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bar/nv50.c: +5 -4
drivers/gpu/drm/nouveau/nvkm/subdev/bar/nv50.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/bar/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/bar/tu102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bios/base.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bus/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bus/g94.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bus/gf100.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/bus/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bus/nv31.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bus/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/bus/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/clk/base.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/clk/g84.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gf100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gk20a.c: +7 -9
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gk20a.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gm20b.c: +7 -10
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gt215.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/mcp77.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/nv40.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/clk/nv50.c: +5 -4
drivers/gpu/drm/nouveau/nvkm/subdev/clk/nv50.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/clk/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/base.c: +5 -6
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/g84.c: +9 -9
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/g98.c: +8 -8
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/ga100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/gf100.c: +10 -10
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/gm107.c: +6 -6
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/gm200.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/gt215.c: +8 -8
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/gv100.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/mcp89.c: +9 -9
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv04.c: +5 -6
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv04.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv05.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv10.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv1a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv20.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv50.c: +8 -9
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/nv50.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/priv.h: +2 -1
drivers/gpu/drm/nouveau/nvkm/subdev/devinit/tu102.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fault/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fault/gp100.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fault/gp10b.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fault/gv100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fault/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fault/tu102.c: +22 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/base.c: +10 -8
drivers/gpu/drm/nouveau/nvkm/subdev/fb/g84.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/ga100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/ga102.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gf100.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gf100.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gf108.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gk104.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gk110.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gk20a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gm107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gm200.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gm20b.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gp100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gp102.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gp10b.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gt215.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/gv100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/mcp77.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/mcp89.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv04.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv10.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv1a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv20.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv25.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv30.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv35.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv36.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv40.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv41.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv44.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv46.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv47.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv49.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv4e.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv50.c: +4 -5
drivers/gpu/drm/nouveau/nvkm/subdev/fb/nv50.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/fb/priv.h: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/fb/ram.c: +7 -5
drivers/gpu/drm/nouveau/nvkm/subdev/fb/ramgk104.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/fuse/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fuse/gf100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fuse/gm107.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fuse/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/fuse/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/g94.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/ga102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/gf119.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/nv10.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gpio/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gsp/base.c: +3 -5
drivers/gpu/drm/nouveau/nvkm/subdev/gsp/gv100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/gsp/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/g94.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/gf117.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/gf119.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/gk110.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/gm200.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/nv4e.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/i2c/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ibus/Kbuild: +0 -7
drivers/gpu/drm/nouveau/nvkm/subdev/ibus/priv.h: +0 -9
drivers/gpu/drm/nouveau/nvkm/subdev/iccsense/base.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/iccsense/gf100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/iccsense/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/instmem/base.c: +8 -6
drivers/gpu/drm/nouveau/nvkm/subdev/instmem/gk20a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/instmem/nv04.c: +7 -8
drivers/gpu/drm/nouveau/nvkm/subdev/instmem/nv40.c: +7 -8
drivers/gpu/drm/nouveau/nvkm/subdev/instmem/nv50.c: +17 -17
drivers/gpu/drm/nouveau/nvkm/subdev/instmem/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/base.c: +6 -4
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gf100.c: +5 -4
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gm107.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gm200.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gp100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gp102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/gp10b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/ltc/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/base.c: +35 -32
drivers/gpu/drm/nouveau/nvkm/subdev/mc/g84.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/g98.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/ga100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/gf100.c: +8 -8
drivers/gpu/drm/nouveau/nvkm/subdev/mc/gk104.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mc/gk20a.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/gp100.c: +5 -5
drivers/gpu/drm/nouveau/nvkm/subdev/mc/gp10b.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/gt215.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mc/nv04.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/nv11.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/nv17.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/nv44.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/nv50.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mc/priv.h: +7 -7
drivers/gpu/drm/nouveau/nvkm/subdev/mc/tu102.c: +98 -17
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/base.c: +6 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gf100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gk20a.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gm200.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gm20b.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gp100.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gp10b.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/gv100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/mcp77.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/nv41.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/nv44.c: +4 -3
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/priv.h: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/tu102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/vmmgf100.c: +3 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/vmmnv41.c: +3 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/vmmnv50.c: +4 -5
drivers/gpu/drm/nouveau/nvkm/subdev/mmu/vmmtu102.c: +3 -4
drivers/gpu/drm/nouveau/nvkm/subdev/mxm/base.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mxm/nv50.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/mxm/priv.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/pci/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/g92.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/g94.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/gf100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/gf106.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/gp100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/nv40.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/nv46.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/nv4c.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pci/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/base.c: +9 -7
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gf100.c: +6 -5
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gf119.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gk110.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gk208.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gk20a.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gm107.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gm200.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gm20b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gp102.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gp10b.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/gt215.c: +6 -5
drivers/gpu/drm/nouveau/nvkm/subdev/pmu/priv.h: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/privring/Kbuild: +7 -0
drivers/gpu/drm/nouveau/nvkm/subdev/{ibus => privring}/gf100.c: +22 -22
drivers/gpu/drm/nouveau/nvkm/subdev/{ibus => privring}/gf117.c: +8 -8
drivers/gpu/drm/nouveau/nvkm/subdev/{ibus => privring}/gk104.c: +23 -23
drivers/gpu/drm/nouveau/nvkm/subdev/{ibus => privring}/gk20a.c: +15 -15
drivers/gpu/drm/nouveau/nvkm/subdev/{ibus => privring}/gm200.c: +5 -5
drivers/gpu/drm/nouveau/nvkm/subdev/{ibus => privring}/gp10b.c: +9 -9
drivers/gpu/drm/nouveau/nvkm/subdev/privring/priv.h: +8 -0
drivers/gpu/drm/nouveau/nvkm/subdev/therm/base.c: +5 -5
drivers/gpu/drm/nouveau/nvkm/subdev/therm/g84.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gf119.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gk104.c: +20 -23
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gk104.h: +2 -1
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gm107.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gm200.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gp100.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/therm/gt215.c: +3 -3
drivers/gpu/drm/nouveau/nvkm/subdev/therm/nv40.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/therm/nv50.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/therm/priv.h: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/timer/base.c: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/timer/gk20a.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/timer/nv04.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/timer/nv40.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/timer/nv41.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/timer/priv.h: +2 -2
drivers/gpu/drm/nouveau/nvkm/subdev/top/Kbuild: +1 -0
drivers/gpu/drm/nouveau/nvkm/subdev/top/base.c: +15 -55
drivers/gpu/drm/nouveau/nvkm/subdev/top/ga100.c: +107 -0
drivers/gpu/drm/nouveau/nvkm/subdev/top/gk104.c: +23 -23
drivers/gpu/drm/nouveau/nvkm/subdev/top/priv.h: +2 -13
drivers/gpu/drm/nouveau/nvkm/subdev/volt/base.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/volt/gf100.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/volt/gf117.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/volt/gk104.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/volt/gk20a.c: +4 -4
drivers/gpu/drm/nouveau/nvkm/subdev/volt/gk20a.h: +1 -1
drivers/gpu/drm/nouveau/nvkm/subdev/volt/gm20b.c: +6 -5
drivers/gpu/drm/nouveau/nvkm/subdev/volt/nv40.c: +3 -2
drivers/gpu/drm/nouveau/nvkm/subdev/volt/priv.h: +4 -4
drivers/gpu/drm/omapdrm/Kconfig: +118 -2
drivers/gpu/drm/omapdrm/Makefile: +14 -5
drivers/gpu/drm/omapdrm/displays/Kconfig: +0 -10
drivers/gpu/drm/omapdrm/displays/Makefile: +0 -2
drivers/gpu/drm/omapdrm/displays/panel-dsi-cm.c: +0 -1385
drivers/gpu/drm/omapdrm/dss/Kconfig: +0 -135
drivers/gpu/drm/omapdrm/dss/Makefile: +0 -20
drivers/gpu/drm/omapdrm/dss/base.c: +3 -84
drivers/gpu/drm/omapdrm/dss/dispc.c: +87 -115
drivers/gpu/drm/omapdrm/dss/display.c: +0 -60
drivers/gpu/drm/omapdrm/dss/dpi.c: +0 -1
drivers/gpu/drm/omapdrm/dss/dsi.c: +785 -1164
drivers/gpu/drm/omapdrm/dss/dsi.h: +456 -0
drivers/gpu/drm/omapdrm/dss/dss.c: +6 -22
drivers/gpu/drm/omapdrm/dss/dss.h: +70 -2
drivers/gpu/drm/omapdrm/dss/hdmi4.c: +0 -1
drivers/gpu/drm/omapdrm/dss/hdmi5.c: +0 -1
drivers/gpu/drm/omapdrm/dss/omapdss-boot-init.c: +0 -229
drivers/gpu/drm/omapdrm/dss/omapdss.h: +33 -314
drivers/gpu/drm/omapdrm/dss/output.c: +8 -49
drivers/gpu/drm/omapdrm/dss/pll.c: +6 -0
drivers/gpu/drm/omapdrm/dss/sdi.c: +0 -1
drivers/gpu/drm/omapdrm/dss/venc.c: +0 -2
drivers/gpu/drm/omapdrm/omap_connector.c: +0 -157
drivers/gpu/drm/omapdrm/omap_connector.h: +0 -28
drivers/gpu/drm/omapdrm/omap_crtc.c: +75 -78
drivers/gpu/drm/omapdrm/omap_crtc.h: +0 -2
drivers/gpu/drm/omapdrm/omap_drv.c: +33 -40
drivers/gpu/drm/omapdrm/omap_drv.h: +1 -2
drivers/gpu/drm/omapdrm/omap_encoder.c: +1 -58
drivers/gpu/drm/omapdrm/omap_gem.c: +1 -2
drivers/gpu/drm/omapdrm/omap_irq.c: +17 -17
drivers/gpu/drm/omapdrm/omap_plane.c: +35 -6
drivers/gpu/drm/omapdrm/tcm-sita.c: +0 -1
drivers/gpu/drm/panel/Kconfig: +20 -0
drivers/gpu/drm/panel/Makefile: +2 -0
drivers/gpu/drm/panel/panel-dsi-cm.c: +665 -0
drivers/gpu/drm/panel/panel-khadas-ts050.c: +870 -0
drivers/gpu/drm/panel/panel-mantix-mlaf057we51.c: +32 -7
drivers/gpu/drm/panel/panel-samsung-s6e63m0.c: +45 -14
drivers/gpu/drm/panel/panel-simple.c: +181 -42
drivers/gpu/drm/panel/panel-sitronix-st7703.c: +8 -16
drivers/gpu/drm/panfrost/panfrost_devfreq.c: +1 -0
drivers/gpu/drm/pl111/pl111_drv.c: +1 -1
drivers/gpu/drm/qxl/qxl_dev.h: +8 -8
drivers/gpu/drm/qxl/qxl_drv.c: +1 -1
drivers/gpu/drm/qxl/qxl_drv.h: +0 -1
drivers/gpu/drm/qxl/qxl_ioctl.c: +2 -1
drivers/gpu/drm/qxl/qxl_irq.c: +2 -1
drivers/gpu/drm/qxl/qxl_kms.c: +0 -1
drivers/gpu/drm/qxl/qxl_object.h: +1 -1
drivers/gpu/drm/qxl/qxl_release.c: +1 -1
drivers/gpu/drm/qxl/qxl_ttm.c: +0 -1
drivers/gpu/drm/r128/r128_ioc32.c: +7 -7
drivers/gpu/drm/radeon/atombios_encoders.c: +3 -3
drivers/gpu/drm/radeon/r100.c: +13 -14
drivers/gpu/drm/radeon/r600_cs.c: +2 -2
drivers/gpu/drm/radeon/radeon.h: +19 -17
drivers/gpu/drm/radeon/radeon_asic.c: +3 -0
drivers/gpu/drm/radeon/radeon_atombios.c: +45 -44
drivers/gpu/drm/radeon/radeon_bios.c: +3 -3
drivers/gpu/drm/radeon/radeon_combios.c: +29 -26
drivers/gpu/drm/radeon/radeon_cs.c: +3 -3
drivers/gpu/drm/radeon/radeon_device.c: +10 -7
drivers/gpu/drm/radeon/radeon_display.c: +1 -1
drivers/gpu/drm/radeon/radeon_drv.c: +1 -6
drivers/gpu/drm/radeon/radeon_fb.c: +1 -1
drivers/gpu/drm/radeon/radeon_gem.c: +3 -3
drivers/gpu/drm/radeon/radeon_i2c.c: +1 -1
drivers/gpu/drm/radeon/radeon_irq_kms.c: +1 -1
drivers/gpu/drm/radeon/radeon_kms.c: +14 -10
drivers/gpu/drm/radeon/radeon_legacy_encoders.c: +3 -3
drivers/gpu/drm/radeon/radeon_object.c: +6 -7
drivers/gpu/drm/radeon/radeon_object.h: +2 -2
drivers/gpu/drm/radeon/radeon_prime.c: +2 -2
drivers/gpu/drm/radeon/radeon_trace.h: +1 -1
drivers/gpu/drm/radeon/radeon_ttm.c: +7 -8
drivers/gpu/drm/radeon/radeon_uvd.c: +19 -19
drivers/gpu/drm/radeon/radeon_vce.c: +0 -1
drivers/gpu/drm/radeon/rs690.c: +1 -1
drivers/gpu/drm/radeon/rs780_dpm.c: +3 -4
drivers/gpu/drm/radeon/vce_v1_0.c: +0 -1
drivers/gpu/drm/rcar-du/rcar_cmm.c: +1 -1
drivers/gpu/drm/rcar-du/rcar_du_crtc.c: +3 -10
drivers/gpu/drm/rcar-du/rcar_du_drv.c: +13 -20
drivers/gpu/drm/rcar-du/rcar_du_drv.h: +11 -5
drivers/gpu/drm/rcar-du/rcar_du_encoder.c: +49 -49
drivers/gpu/drm/rcar-du/rcar_du_encoder.h: +0 -2
drivers/gpu/drm/rcar-du/rcar_du_kms.c: +29 -13
drivers/gpu/drm/rcar-du/rcar_du_plane.c: +4 -4
drivers/gpu/drm/rcar-du/rcar_du_vsp.c: +20 -8
drivers/gpu/drm/rcar-du/rcar_du_writeback.c: +1 -1
drivers/gpu/drm/rockchip/Kconfig: +1 -1
drivers/gpu/drm/rockchip/dw-mipi-dsi-rockchip.c: +1 -1
drivers/gpu/drm/rockchip/dw_hdmi-rockchip.c: +1 -1
drivers/gpu/drm/rockchip/rockchip_drm_vop.c: +0 -1
drivers/gpu/drm/scheduler/sched_main.c: +67 -56
drivers/gpu/drm/sti/sti_cursor.c: +1 -8
drivers/gpu/drm/sti/sti_gdp.c: +1 -8
drivers/gpu/drm/sti/sti_hqvdp.c: +1 -8
drivers/gpu/drm/stm/ltdc.c: +0 -1
drivers/gpu/drm/sun4i/sun4i_tcon.c: +2 -19
drivers/gpu/drm/sun4i/sun4i_tcon.h: +1 -0
drivers/gpu/drm/sun4i/sun8i_csc.c: +44 -65
drivers/gpu/drm/sun4i/sun8i_mixer.h: +2 -4
drivers/gpu/drm/sun4i/sun8i_vi_layer.c: +2 -0
drivers/gpu/drm/tdfx/tdfx_drv.c: +1 -1
drivers/gpu/drm/tegra/dc.c: +1 -1
drivers/gpu/drm/tegra/drm.c: +2 -0
drivers/gpu/drm/tegra/dsi.c: +1 -1
drivers/gpu/drm/tegra/falcon.c: +5 -4
drivers/gpu/drm/tegra/gr2d.c: +7 -2
drivers/gpu/drm/tegra/hdmi.c: +1 -1
drivers/gpu/drm/tegra/hub.c: +1 -1
drivers/gpu/drm/tegra/sor.c: +1 -1
drivers/gpu/drm/tegra/vic.c: +26 -9
drivers/gpu/drm/tiny/cirrus.c: +0 -1
drivers/gpu/drm/ttm/ttm_agp_backend.c: +0 -1
drivers/gpu/drm/ttm/ttm_bo.c: +42 -63
drivers/gpu/drm/ttm/ttm_bo_util.c: +9 -7
drivers/gpu/drm/ttm/ttm_bo_vm.c: +3 -4
drivers/gpu/drm/ttm/ttm_execbuf_util.c: +2 -2
drivers/gpu/drm/ttm/ttm_memory.c: +2 -1
drivers/gpu/drm/ttm/ttm_module.c: +2 -1
{include => drivers/gpu}/drm/ttm/ttm_module.h: +0 -0
drivers/gpu/drm/ttm/ttm_range_manager.c: +0 -1
drivers/gpu/drm/ttm/ttm_tt.c: +1 -14
drivers/gpu/drm/tve200/tve200_display.c: +0 -1
drivers/gpu/drm/tve200/tve200_drv.c: +0 -1
drivers/gpu/drm/v3d/v3d_drv.c: +2 -2
drivers/gpu/drm/v3d/v3d_irq.c: +2 -5
drivers/gpu/drm/vboxvideo/vbox_drv.c: +6 -5
drivers/gpu/drm/vboxvideo/vbox_irq.c: +3 -1
drivers/gpu/drm/vboxvideo/vbox_main.c: +6 -2
drivers/gpu/drm/vboxvideo/vbox_ttm.c: +4 -3
drivers/gpu/drm/vc4/vc4_bo.c: +19 -92
drivers/gpu/drm/vc4/vc4_crtc.c: +12 -26
drivers/gpu/drm/vc4/vc4_drv.c: +2 -17
drivers/gpu/drm/vc4/vc4_drv.h: +9 -21
drivers/gpu/drm/vc4/vc4_dsi.c: +65 -46
drivers/gpu/drm/vc4/vc4_gem.c: +1 -2
drivers/gpu/drm/vc4/vc4_hdmi.c: +322 -66
drivers/gpu/drm/vc4/vc4_hdmi.h: +25 -9
drivers/gpu/drm/vc4/vc4_hdmi_phy.c: +5 -3
drivers/gpu/drm/vc4/vc4_hdmi_regs.h: +12 -1
drivers/gpu/drm/vc4/vc4_hvs.c: +10 -8
drivers/gpu/drm/vc4/vc4_kms.c: +122 -126
drivers/gpu/drm/vc4/vc4_plane.c: +1 -6
drivers/gpu/drm/vc4/vc4_txp.c: +3 -8
drivers/gpu/drm/vgem/vgem_drv.c: +1 -2
drivers/gpu/drm/via/via_irq.c: +1 -1
drivers/gpu/drm/virtio/Kconfig: +2 -1
drivers/gpu/drm/virtio/virtgpu_debugfs.c: +13 -11
drivers/gpu/drm/virtio/virtgpu_drv.c: +0 -1
drivers/gpu/drm/virtio/virtgpu_drv.h: +1 -0
drivers/gpu/drm/virtio/virtgpu_fence.c: +50 -31
drivers/gpu/drm/virtio/virtgpu_gem.c: +5 -3
drivers/gpu/drm/virtio/virtgpu_kms.c: +1 -0
drivers/gpu/drm/virtio/virtgpu_vram.c: +3 -0
drivers/gpu/drm/vkms/vkms_drv.c: +45 -9
drivers/gpu/drm/vkms/vkms_drv.h: +10 -2
drivers/gpu/drm/vkms/vkms_output.c: +8 -5
drivers/gpu/drm/vmwgfx/Makefile: +3 -3
drivers/gpu/drm/vmwgfx/ttm_object.c: +0 -1
drivers/gpu/drm/vmwgfx/vmwgfx_binding.c: +26 -26
drivers/gpu/drm/vmwgfx/vmwgfx_blit.c: +2 -2
drivers/gpu/drm/vmwgfx/vmwgfx_bo.c: +3 -3
drivers/gpu/drm/vmwgfx/{vmwgfx_fifo.c => vmwgfx_cmd.c}: +59 -67
drivers/gpu/drm/vmwgfx/vmwgfx_cmdbuf.c: +9 -13
drivers/gpu/drm/vmwgfx/vmwgfx_context.c: +20 -20
drivers/gpu/drm/vmwgfx/vmwgfx_cotable.c: +7 -7
drivers/gpu/drm/vmwgfx/vmwgfx_drv.c: +115 -125
drivers/gpu/drm/vmwgfx/vmwgfx_drv.h: +33 -61
drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c: +11 -15
drivers/gpu/drm/vmwgfx/vmwgfx_fb.c: +6 -6
drivers/gpu/drm/vmwgfx/vmwgfx_fence.c: +12 -16
drivers/gpu/drm/vmwgfx/vmwgfx_gmr.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_gmrid_manager.c: +2 -4
drivers/gpu/drm/vmwgfx/vmwgfx_ioctl.c: +7 -8
drivers/gpu/drm/vmwgfx/vmwgfx_irq.c: +3 -7
drivers/gpu/drm/vmwgfx/vmwgfx_kms.c: +36 -40
drivers/gpu/drm/vmwgfx/vmwgfx_ldu.c: +4 -5
drivers/gpu/drm/vmwgfx/vmwgfx_marker.c: +0 -155
drivers/gpu/drm/vmwgfx/vmwgfx_mob.c: +8 -8
drivers/gpu/drm/vmwgfx/vmwgfx_overlay.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_page_dirty.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_resource.c: +3 -3
drivers/gpu/drm/vmwgfx/vmwgfx_scrn.c: +14 -14
drivers/gpu/drm/vmwgfx/vmwgfx_shader.c: +13 -14
drivers/gpu/drm/vmwgfx/vmwgfx_so.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c: +18 -18
drivers/gpu/drm/vmwgfx/vmwgfx_streamoutput.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_surface.c: +23 -24
drivers/gpu/drm/vmwgfx/vmwgfx_thp.c: +0 -1
drivers/gpu/drm/vmwgfx/vmwgfx_ttm_buffer.c: +5 -5
drivers/gpu/drm/xen/xen_drm_front_gem.c: +2 -2
drivers/gpu/drm/zte/zx_plane.c: +1 -6
drivers/gpu/ipu-v3/ipu-di.c: +0 -4
drivers/misc/mei/hdcp/mei_hdcp.c: +1 -2
drivers/pci/pci.c: +10 -2
drivers/pci/pci.h: +0 -1
drivers/soc/mediatek/Makefile: +1 -0
drivers/{gpu/drm/mediatek/mtk_drm_ddp.c => soc/mediatek/mtk-mutex.c}: +169 -159
drivers/video/fbdev/Kconfig: +1 -1
drivers/video/fbdev/aty/atyfb_base.c: +4 -7
drivers/video/fbdev/aty/mach64_ct.c: +9 -6
drivers/video/fbdev/aty/radeon_monitor.c: +1 -3
drivers/video/fbdev/bw2.c: +1 -1
drivers/video/fbdev/cg3.c: +1 -1
drivers/video/fbdev/cg6.c: +1 -1
drivers/video/fbdev/cirrusfb.c: +9 -11
drivers/video/fbdev/controlfb.c: +2 -2
drivers/video/fbdev/core/fb_notify.c: +7 -0
drivers/video/fbdev/core/fbcon.c: +8 -17
drivers/video/fbdev/core/fbmon.c: +1 -1
drivers/video/fbdev/efifb.c: +1 -2
drivers/video/fbdev/ffb.c: +1 -1
drivers/video/fbdev/gbefb.c: +1 -3
drivers/video/fbdev/goldfishfb.c: +2 -0
drivers/video/fbdev/hgafb.c: +5 -5
drivers/video/fbdev/leo.c: +1 -1
drivers/video/fbdev/mmp/hw/mmp_spi.c: +1 -1
drivers/video/fbdev/mx3fb.c: +8 -5
drivers/video/fbdev/neofb.c: +0 -4
drivers/video/fbdev/nvidia/nv_setup.c: +2 -5
drivers/video/fbdev/omap2/omapfb/displays/Kconfig: +1 -0
drivers/video/fbdev/omap2/omapfb/dss/dispc-compat.c: +1 -1
drivers/video/fbdev/omap2/omapfb/dss/dsi.c: +4 -10
drivers/video/fbdev/omap2/omapfb/dss/hdmi4_core.c: +2 -2
drivers/video/fbdev/omap2/omapfb/dss/hdmi5_core.c: +2 -2
drivers/video/fbdev/p9100.c: +1 -1
drivers/video/fbdev/pm2fb.c: +4 -4
drivers/video/fbdev/riva/fbdev.c: +4 -5
drivers/video/fbdev/riva/riva_hw.c: +8 -20
drivers/video/fbdev/s1d13xxxfb.c: +1 -2
drivers/video/fbdev/s3c-fb.c: +6 -5
drivers/video/fbdev/sis/init.c: +5 -28
drivers/video/fbdev/sis/oem310.h: +2 -0
drivers/video/fbdev/sis/sis.h: +0 -1
drivers/video/fbdev/sis/sis_main.c: +4 -5
drivers/video/fbdev/sstfb.c: +1 -1
drivers/video/fbdev/tcx.c: +1 -1
drivers/video/fbdev/tdfxfb.c: +1 -3
drivers/video/fbdev/tgafb.c: +3 -4
drivers/video/fbdev/udlfb.c: +1 -0
drivers/video/fbdev/uvesafb.c: +4 -2
drivers/video/fbdev/via/lcd.c: +1 -3
drivers/video/fbdev/wmt_ge_rops.c: +1 -0
drivers/video/of_display_timing.c: +1 -0
drivers/video/of_videomode.c: +3 -3
include/drm/drm_agpsupport.h: +0 -18
include/drm/drm_atomic.h: +20 -0
include/drm/drm_atomic_helper.h: +0 -4
include/drm/drm_connector.h: +49 -0
include/drm/drm_crtc.h: +33 -0
include/drm/drm_device.h: +8 -15
include/drm/drm_dp_helper.h: +221 -18
include/drm/drm_drv.h: +0 -2
include/drm/drm_dsc.h: +1 -0
include/drm/drm_edid.h: +30 -0
include/drm/drm_encoder.h: +31 -1
include/drm/drm_gem.h: +0 -3
include/drm/drm_gem_cma_helper.h: +5 -9
include/drm/drm_hdcp.h: +4 -4
include/drm/drm_irq.h: +1 -1
include/drm/drm_legacy.h: +6 -4
include/drm/drm_managed.h: +0 -2
include/drm/drm_mipi_dbi.h: +1 -1
include/drm/drm_modes.h: +10 -0
include/drm/drm_modeset_helper_vtables.h: +28 -1
include/drm/drm_plane.h: +42 -0
include/drm/drm_prime.h: +4 -3
include/drm/drm_property.h: +1 -1
include/drm/drm_rect.h: +13 -0
include/drm/drm_simple_kms_helper.h: +24 -0
include/drm/gpu_scheduler.h: +7 -7
include/drm/ttm/ttm_bo_api.h: +7 -6
include/drm/ttm/ttm_bo_driver.h: +3 -3
include/drm/ttm/ttm_resource.h: +4 -1
include/drm/ttm/ttm_tt.h: +0 -2
include/linux/dma-buf.h: +23 -22
include/linux/pci.h: +9 -0
include/linux/soc/mediatek/mtk-mutex.h: +26 -0
include/linux/vgaarb.h: +3 -3
include/uapi/drm/drm.h: +49 -48
include/uapi/drm/drm_fourcc.h: +21 -2
include/uapi/drm/drm_mode.h: +5 -8
include/uapi/drm/i915_drm.h: +2 -1
include/video/sstfb.h: +2 -2
