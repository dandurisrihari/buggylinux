{
  "hash": "eadb2f47a3ced5c64b23b90fd2a3463f63726066",
  "hash_short": "eadb2f47",
  "subject": "lockdown: also lock down previous kgdb use",
  "body": "KGDB and KDB allow read and write access to kernel memory, and thus\nshould be restricted during lockdown.  An attacker with access to a\nserial port (for example, via a hypervisor console, which some cloud\nvendors provide over the network) could trigger the debugger so it is\nimportant that the debugger respect the lockdown mode when/if it is\ntriggered.\n\nFix this by integrating lockdown into kdb's existing permissions\nmechanism.  Unfortunately kgdb does not have any permissions mechanism\n(although it certainly could be added later) so, for now, kgdb is simply\nand brutally disabled by immediately exiting the gdb stub without taking\nany action.\n\nFor lockdowns established early in the boot (e.g. the normal case) then\nthis should be fine but on systems where kgdb has set breakpoints before\nthe lockdown is enacted than \"bad things\" will happen.\n\nCVE: CVE-2022-21499\nCo-developed-by: Stephen Brennan <stephen.s.brennan@oracle.com>\nSigned-off-by: Stephen Brennan <stephen.s.brennan@oracle.com>\nReviewed-by: Douglas Anderson <dianders@chromium.org>\nSigned-off-by: Daniel Thompson <daniel.thompson@linaro.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "lockdown: also lock down previous kgdb use\n\nKGDB and KDB allow read and write access to kernel memory, and thus\nshould be restricted during lockdown.  An attacker with access to a\nserial port (for example, via a hypervisor console, which some cloud\nvendors provide over the network) could trigger the debugger so it is\nimportant that the debugger respect the lockdown mode when/if it is\ntriggered.\n\nFix this by integrating lockdown into kdb's existing permissions\nmechanism.  Unfortunately kgdb does not have any permissions mechanism\n(although it certainly could be added later) so, for now, kgdb is simply\nand brutally disabled by immediately exiting the gdb stub without taking\nany action.\n\nFor lockdowns established early in the boot (e.g. the normal case) then\nthis should be fine but on systems where kgdb has set breakpoints before\nthe lockdown is enacted than \"bad things\" will happen.\n\nCVE: CVE-2022-21499\nCo-developed-by: Stephen Brennan <stephen.s.brennan@oracle.com>\nSigned-off-by: Stephen Brennan <stephen.s.brennan@oracle.com>\nReviewed-by: Douglas Anderson <dianders@chromium.org>\nSigned-off-by: Daniel Thompson <daniel.thompson@linaro.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Daniel Thompson",
  "author_email": "daniel.thompson@linaro.org",
  "author_date": "Mon May 23 19:11:02 2022 +0100",
  "author_date_iso": "2022-05-23T19:11:02+01:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Tue May 24 11:29:34 2022 -0700",
  "committer_date_iso": "2022-05-24T11:29:34-07:00",
  "files_changed": [
    "include/linux/security.h",
    "kernel/debug/debug_core.c",
    "kernel/debug/kdb/kdb_main.c",
    "security/security.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "include/linux/security.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "kernel/debug/debug_core.c",
      "insertions": 24,
      "deletions": 0
    },
    {
      "file": "kernel/debug/kdb/kdb_main.c",
      "insertions": 59,
      "deletions": 3
    },
    {
      "file": "security/security.c",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 87,
  "total_deletions": 3,
  "total_changes": 90,
  "parents": [
    "6f3f04c19074972ea12edeed23b07a32894e9e03"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-21499"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "include/linux/security.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/debug/debug_core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/debug/kdb/kdb_main.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/security.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}