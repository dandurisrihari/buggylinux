{
  "hash": "33f9a623bfc6bed3b9586f68cb4a9ea332589791",
  "hash_short": "33f9a623",
  "subject": "drm/i915/hdcp: Update CP as per the kernel internal state",
  "body": "Content Protection property should be updated as per the kernel\ninternal state. Let's say if Content protection is disabled\nby userspace, CP property should be set to UNDESIRED so that\nreauthentication will not happen until userspace request it again,\nbut when kernel disables the HDCP due to any DDI disabling sequences\nlike modeset/DPMS operation, kernel should set the property to\nDESIRED, so that when opportunity arises, kernel will start the\nHDCP authentication on its own.\n\nSomewhere in the line, state machine to set content protection to\nDESIRED from kernel was broken and IGT coverage was missing for it.\nThis patch fixes it.\n\nv2:\n- Fixing hdcp CP state in connector atomic check function\n  intel_hdcp_atomic_check(). [Maarten]\n  This will require to check hdcp->value in intel_hdcp_update_pipe()\n  in order to avoid enabling hdcp, if it was already enabled.\n\nv3:\n- Rebased.\n\nCc: Ramalingam C <ramalingam.c@intel.com>\nCc: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>\nReviewed-by: Uma Shankar <uma.shankar@intel.com>\nSigned-off-by: Anshuman Gupta <anshuman.gupta@intel.com>\nLink: https://patchwork.freedesktop.org/patch/350962/?series=72664&rev=2 #v1\nLink: https://patchwork.freedesktop.org/patch/359396/?series=72251&rev=3 #v2\nReviewed-by: Ramalingam C <ramalingam.c@intel.com>\nSigned-off-by: Ramalingam C <ramalingam.c@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/20200630082048.22308-1-anshuman.gupta@intel.com",
  "full_message": "drm/i915/hdcp: Update CP as per the kernel internal state\n\nContent Protection property should be updated as per the kernel\ninternal state. Let's say if Content protection is disabled\nby userspace, CP property should be set to UNDESIRED so that\nreauthentication will not happen until userspace request it again,\nbut when kernel disables the HDCP due to any DDI disabling sequences\nlike modeset/DPMS operation, kernel should set the property to\nDESIRED, so that when opportunity arises, kernel will start the\nHDCP authentication on its own.\n\nSomewhere in the line, state machine to set content protection to\nDESIRED from kernel was broken and IGT coverage was missing for it.\nThis patch fixes it.\n\nv2:\n- Fixing hdcp CP state in connector atomic check function\n  intel_hdcp_atomic_check(). [Maarten]\n  This will require to check hdcp->value in intel_hdcp_update_pipe()\n  in order to avoid enabling hdcp, if it was already enabled.\n\nv3:\n- Rebased.\n\nCc: Ramalingam C <ramalingam.c@intel.com>\nCc: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>\nReviewed-by: Uma Shankar <uma.shankar@intel.com>\nSigned-off-by: Anshuman Gupta <anshuman.gupta@intel.com>\nLink: https://patchwork.freedesktop.org/patch/350962/?series=72664&rev=2 #v1\nLink: https://patchwork.freedesktop.org/patch/359396/?series=72251&rev=3 #v2\nReviewed-by: Ramalingam C <ramalingam.c@intel.com>\nSigned-off-by: Ramalingam C <ramalingam.c@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/20200630082048.22308-1-anshuman.gupta@intel.com",
  "author_name": "Anshuman Gupta",
  "author_email": "anshuman.gupta@intel.com",
  "author_date": "Tue Jun 30 13:50:48 2020 +0530",
  "author_date_iso": "2020-06-30T13:50:48+05:30",
  "committer_name": "Ramalingam C",
  "committer_email": "ramalingam.c@intel.com",
  "committer_date": "Wed Jul 8 15:14:18 2020 +0530",
  "committer_date_iso": "2020-07-08T15:14:18+05:30",
  "files_changed": [
    "drivers/gpu/drm/i915/display/intel_hdcp.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/display/intel_hdcp.c",
      "insertions": 23,
      "deletions": 4
    }
  ],
  "total_insertions": 23,
  "total_deletions": 4,
  "total_changes": 27,
  "parents": [
    "52797a8e8529507e3831ed9b4ed6fd7d8671c63f"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/gpu/drm/i915/display/intel_hdcp.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}