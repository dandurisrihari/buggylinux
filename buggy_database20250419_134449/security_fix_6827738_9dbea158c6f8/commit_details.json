{
  "hash": "6827738dc684a87ad54ebba3ae7f3d7c977698eb",
  "hash_short": "6827738d",
  "subject": "dmaengine: idxd: add a write() method for applications to submit work",
  "body": "After the patch to restrict the use of mmap() to CAP_SYS_RAWIO for\nthe currently existing devices, most applications can no longer make\nuse of the accelerators as in production \"you don't run things as root\".\n\nTo keep the DSA and IAA accelerators usable, hook up a write() method\nso that applications can still submit work. In the write method,\nsufficient input validation is performed to avoid the security issue\nthat required the mmap CAP_SYS_RAWIO check.\n\nOne complication is that the DSA device allows for indirect (\"batched\")\ndescriptors. There is no reasonable way to do the input validation\non these indirect descriptors so the write() method will not allow these\nto be submitted to the hardware on affected hardware, and the sysfs\nenumeration of support for the opcode is also removed.\n\nEarly performance data shows that the performance delta for most common\ncases is within the noise.\n\nSigned-off-by: Nikhil Rao <nikhil.rao@intel.com>\nSigned-off-by: Arjan van de Ven <arjan@linux.intel.com>",
  "full_message": "dmaengine: idxd: add a write() method for applications to submit work\n\nAfter the patch to restrict the use of mmap() to CAP_SYS_RAWIO for\nthe currently existing devices, most applications can no longer make\nuse of the accelerators as in production \"you don't run things as root\".\n\nTo keep the DSA and IAA accelerators usable, hook up a write() method\nso that applications can still submit work. In the write method,\nsufficient input validation is performed to avoid the security issue\nthat required the mmap CAP_SYS_RAWIO check.\n\nOne complication is that the DSA device allows for indirect (\"batched\")\ndescriptors. There is no reasonable way to do the input validation\non these indirect descriptors so the write() method will not allow these\nto be submitted to the hardware on affected hardware, and the sysfs\nenumeration of support for the opcode is also removed.\n\nEarly performance data shows that the performance delta for most common\ncases is within the noise.\n\nSigned-off-by: Nikhil Rao <nikhil.rao@intel.com>\nSigned-off-by: Arjan van de Ven <arjan@linux.intel.com>",
  "author_name": "Nikhil Rao",
  "author_email": "nikhil.rao@intel.com",
  "author_date": "Wed Apr 24 15:16:12 2024 +0000",
  "author_date_iso": "2024-04-24T15:16:12+00:00",
  "committer_name": "Arjan van de Ven",
  "committer_email": "arjan@linux.intel.com",
  "committer_date": "Mon May 13 14:07:45 2024 +0000",
  "committer_date_iso": "2024-05-13T14:07:45+00:00",
  "files_changed": [
    "drivers/dma/idxd/cdev.c",
    "drivers/dma/idxd/sysfs.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "drivers/dma/idxd/cdev.c",
      "insertions": 65,
      "deletions": 0
    },
    {
      "file": "drivers/dma/idxd/sysfs.c",
      "insertions": 25,
      "deletions": 2
    }
  ],
  "total_insertions": 90,
  "total_deletions": 2,
  "total_changes": 92,
  "parents": [
    "e11452eb071b2a8e6ba52892b2e270bbdaa6640d"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security issue"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/dma/idxd/cdev.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/dma/idxd/sysfs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}