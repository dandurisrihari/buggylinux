Commit Hash: df3c3931ec58cca3409c71b18ad6da0cd71fe163
Subject: Bluetooth: Fix accepting connect requests for defer_setup


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix accepting connect requests for defer_setup

When authentication completes we shouldn't blindly accept any pending
L2CAP connect requests. If the socket has the defer_setup feature
enabled it should still wait for user space acceptance of the connect
request. The issue only happens for non-SSP connections since with SSP
the L2CAP Connect request may not be sent for non-SDP PSMs before
authentication has completed successfully.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Tue Jun 14 12:48:19 2011 +0300
Committer: Gustavo F. Padovan <padovan@profusion.mobi>
Commit Date: Tue Jun 14 14:48:01 2011 -0300

Files Changed: 1
Lines Added: 15
Lines Removed: 6
Total Changes: 21
