{
  "hash": "b6ffe9ba46016f8351896ccee33bebcd0e5ea7c0",
  "hash_short": "b6ffe9ba",
  "subject": "Merge tag 'libnvdimm-for-4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/nvdimm/nvdimm",
  "body": "Pull libnvdimm updates from Dan Williams:\n \"libnvdimm updates for the latest ACPI and UEFI specifications. This\n  pull request also includes new 'struct dax_operations' enabling to\n  undo the abuse of copy_user_nocache() for copy operations to pmem.\n\n  The dax work originally missed 4.12 to address concerns raised by Al.\n\n  Summary:\n\n   - Introduce the _flushcache() family of memory copy helpers and use\n     them for persistent memory write operations on x86. The\n     _flushcache() semantic indicates that the cache is either bypassed\n     for the copy operation (movnt) or any lines dirtied by the copy\n     operation are written back (clwb, clflushopt, or clflush).\n\n   - Extend dax_operations with ->copy_from_iter() and ->flush()\n     operations. These operations and other infrastructure updates allow\n     all persistent memory specific dax functionality to be pushed into\n     libnvdimm and the pmem driver directly. It also allows dax-specific\n     sysfs attributes to be linked to a host device, for example:\n     /sys/block/pmem0/dax/write_cache\n\n   - Add support for the new NVDIMM platform/firmware mechanisms\n     introduced in ACPI 6.2 and UEFI 2.7. This support includes the v1.2\n     namespace label format, extensions to the address-range-scrub\n     command set, new error injection commands, and a new BTT\n     (block-translation-table) layout. These updates support inter-OS\n     and pre-OS compatibility.\n\n   - Fix a longstanding memory corruption bug in nfit_test.\n\n   - Make the pmem and nvdimm-region 'badblocks' sysfs files poll(2)\n     capable.\n\n   - Miscellaneous fixes and small updates across libnvdimm and the nfit\n     driver.\n\n  Acknowledgements that came after the branch was pushed: commit\n  6aa734a2f38e (\"libnvdimm, region, pmem: fix 'badblocks'\n  sysfs_get_dirent() reference lifetime\") was reviewed by Toshi Kani\n  <toshi.kani@hpe.com>\"\n\n* tag 'libnvdimm-for-4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/nvdimm/nvdimm: (42 commits)\n  libnvdimm, namespace: record 'lbasize' for pmem namespaces\n  acpi/nfit: Issue Start ARS to retrieve existing records\n  libnvdimm: New ACPI 6.2 DSM functions\n  acpi, nfit: Show bus_dsm_mask in sysfs\n  libnvdimm, acpi, nfit: Add bus level dsm mask for pass thru.\n  acpi, nfit: Enable DSM pass thru for root functions.\n  libnvdimm: passthru functions clear to send\n  libnvdimm, btt: convert some info messages to warn/err\n  libnvdimm, region, pmem: fix 'badblocks' sysfs_get_dirent() reference lifetime\n  libnvdimm: fix the clear-error check in nsio_rw_bytes\n  libnvdimm, btt: fix btt_rw_page not returning errors\n  acpi, nfit: quiet invalid block-aperture-region warnings\n  libnvdimm, btt: BTT updates for UEFI 2.7 format\n  acpi, nfit: constify *_attribute_group\n  libnvdimm, pmem: disable dax flushing when pmem is fronting a volatile region\n  libnvdimm, pmem, dax: export a cache control attribute\n  dax: convert to bitmask for flags\n  dax: remove default copy_from_iter fallback\n  libnvdimm, nfit: enable support for volatile ranges\n  libnvdimm, pmem: fix persistence warning\n  ...",
  "full_message": "Merge tag 'libnvdimm-for-4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/nvdimm/nvdimm\n\nPull libnvdimm updates from Dan Williams:\n \"libnvdimm updates for the latest ACPI and UEFI specifications. This\n  pull request also includes new 'struct dax_operations' enabling to\n  undo the abuse of copy_user_nocache() for copy operations to pmem.\n\n  The dax work originally missed 4.12 to address concerns raised by Al.\n\n  Summary:\n\n   - Introduce the _flushcache() family of memory copy helpers and use\n     them for persistent memory write operations on x86. The\n     _flushcache() semantic indicates that the cache is either bypassed\n     for the copy operation (movnt) or any lines dirtied by the copy\n     operation are written back (clwb, clflushopt, or clflush).\n\n   - Extend dax_operations with ->copy_from_iter() and ->flush()\n     operations. These operations and other infrastructure updates allow\n     all persistent memory specific dax functionality to be pushed into\n     libnvdimm and the pmem driver directly. It also allows dax-specific\n     sysfs attributes to be linked to a host device, for example:\n     /sys/block/pmem0/dax/write_cache\n\n   - Add support for the new NVDIMM platform/firmware mechanisms\n     introduced in ACPI 6.2 and UEFI 2.7. This support includes the v1.2\n     namespace label format, extensions to the address-range-scrub\n     command set, new error injection commands, and a new BTT\n     (block-translation-table) layout. These updates support inter-OS\n     and pre-OS compatibility.\n\n   - Fix a longstanding memory corruption bug in nfit_test.\n\n   - Make the pmem and nvdimm-region 'badblocks' sysfs files poll(2)\n     capable.\n\n   - Miscellaneous fixes and small updates across libnvdimm and the nfit\n     driver.\n\n  Acknowledgements that came after the branch was pushed: commit\n  6aa734a2f38e (\"libnvdimm, region, pmem: fix 'badblocks'\n  sysfs_get_dirent() reference lifetime\") was reviewed by Toshi Kani\n  <toshi.kani@hpe.com>\"\n\n* tag 'libnvdimm-for-4.13' of git://git.kernel.org/pub/scm/linux/kernel/git/nvdimm/nvdimm: (42 commits)\n  libnvdimm, namespace: record 'lbasize' for pmem namespaces\n  acpi/nfit: Issue Start ARS to retrieve existing records\n  libnvdimm: New ACPI 6.2 DSM functions\n  acpi, nfit: Show bus_dsm_mask in sysfs\n  libnvdimm, acpi, nfit: Add bus level dsm mask for pass thru.\n  acpi, nfit: Enable DSM pass thru for root functions.\n  libnvdimm: passthru functions clear to send\n  libnvdimm, btt: convert some info messages to warn/err\n  libnvdimm, region, pmem: fix 'badblocks' sysfs_get_dirent() reference lifetime\n  libnvdimm: fix the clear-error check in nsio_rw_bytes\n  libnvdimm, btt: fix btt_rw_page not returning errors\n  acpi, nfit: quiet invalid block-aperture-region warnings\n  libnvdimm, btt: BTT updates for UEFI 2.7 format\n  acpi, nfit: constify *_attribute_group\n  libnvdimm, pmem: disable dax flushing when pmem is fronting a volatile region\n  libnvdimm, pmem, dax: export a cache control attribute\n  dax: convert to bitmask for flags\n  dax: remove default copy_from_iter fallback\n  libnvdimm, nfit: enable support for volatile ranges\n  libnvdimm, pmem: fix persistence warning\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Fri Jul 7 09:44:06 2017 -0700",
  "author_date_iso": "2017-07-07T09:44:06-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Fri Jul 7 09:44:06 2017 -0700",
  "committer_date_iso": "2017-07-07T09:44:06-07:00",
  "files_changed": [
    "MAINTAINERS",
    "arch/x86/Kconfig",
    "drivers/block/brd.c",
    "drivers/dax/super.c",
    "drivers/md/dm-linear.c",
    "drivers/md/dm-stripe.c",
    "drivers/md/dm.c",
    "drivers/nvdimm/btt.c",
    "drivers/nvdimm/pmem.c",
    "drivers/s390/block/dcssblk.c",
    "fs/dax.c",
    "include/linux/device-mapper.h",
    "lib/Kconfig"
  ],
  "files_changed_count": 13,
  "stats": [
    {
      "file": "MAINTAINERS",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "arch/powerpc/sysdev/axonram.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "arch/x86/Kconfig",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/x86/include/asm/pmem.h",
      "insertions": 0,
      "deletions": 136
    },
    {
      "file": "arch/x86/include/asm/string_64.h",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "arch/x86/include/asm/uaccess_64.h",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "arch/x86/lib/usercopy_64.c",
      "insertions": 134,
      "deletions": 0
    },
    {
      "file": "arch/x86/mm/pageattr.c",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "drivers/acpi/nfit/core.c",
      "insertions": 142,
      "deletions": 25
    },
    {
      "file": "drivers/acpi/nfit/mce.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/acpi/nfit/nfit.h",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/block/brd.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/dax/super.c",
      "insertions": 112,
      "deletions": 6
    },
    {
      "file": "drivers/md/dm-linear.c",
      "insertions": 30,
      "deletions": 0
    },
    {
      "file": "drivers/md/dm-stripe.c",
      "insertions": 40,
      "deletions": 0
    },
    {
      "file": "drivers/md/dm.c",
      "insertions": 45,
      "deletions": 0
    },
    {
      "file": "drivers/nvdimm/btt.c",
      "insertions": 30,
      "deletions": 15
    },
    {
      "file": "drivers/nvdimm/btt.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/nvdimm/btt_devs.c",
      "insertions": 49,
      "deletions": 5
    },
    {
      "file": "drivers/nvdimm/bus.c",
      "insertions": 10,
      "deletions": 5
    },
    {
      "file": "drivers/nvdimm/claim.c",
      "insertions": 33,
      "deletions": 5
    },
    {
      "file": "drivers/nvdimm/core.c",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/nvdimm/dax_devs.c",
      "insertions": 9,
      "deletions": 1
    },
    {
      "file": "drivers/nvdimm/dimm_devs.c",
      "insertions": 9,
      "deletions": 1
    },
    {
      "file": "drivers/nvdimm/label.c",
      "insertions": 224,
      "deletions": 27
    },
    {
      "file": "drivers/nvdimm/label.h",
      "insertions": 19,
      "deletions": 2
    },
    {
      "file": "drivers/nvdimm/namespace_devs.c",
      "insertions": 241,
      "deletions": 41
    },
    {
      "file": "drivers/nvdimm/nd-core.h",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "drivers/nvdimm/nd.h",
      "insertions": 15,
      "deletions": 2
    },
    {
      "file": "drivers/nvdimm/pfn_devs.c",
      "insertions": 10,
      "deletions": 2
    },
    {
      "file": "drivers/nvdimm/pmem.c",
      "insertions": 57,
      "deletions": 6
    },
    {
      "file": "drivers/nvdimm/pmem.h",
      "insertions": 15,
      "deletions": 0
    },
    {
      "file": "drivers/nvdimm/region.c",
      "insertions": 15,
      "deletions": 2
    },
    {
      "file": "drivers/nvdimm/region_devs.c",
      "insertions": 64,
      "deletions": 24
    },
    {
      "file": "drivers/s390/block/dcssblk.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "fs/dax.c",
      "insertions": 5,
      "deletions": 4
    },
    {
      "file": "include/linux/dax.h",
      "insertions": 12,
      "deletions": 0
    },
    {
      "file": "include/linux/device-mapper.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "include/linux/libnvdimm.h",
      "insertions": 10,
      "deletions": 1
    },
    {
      "file": "include/linux/nd.h",
      "insertions": 13,
      "deletions": 0
    },
    {
      "file": "include/linux/pmem.h",
      "insertions": 0,
      "deletions": 142
    },
    {
      "file": "include/linux/string.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "include/linux/uio.h",
      "insertions": 15,
      "deletions": 0
    },
    {
      "file": "include/uapi/linux/ndctl.h",
      "insertions": 41,
      "deletions": 1
    },
    {
      "file": "lib/Kconfig",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "lib/iov_iter.c",
      "insertions": 22,
      "deletions": 0
    },
    {
      "file": "tools/testing/nvdimm/test/nfit.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1504,
  "total_deletions": 460,
  "total_changes": 1964,
  "parents": [
    "9f45efb9286268e01d5022d34a58a68f53ca3072",
    "9d92573fff3ec70785ef1815cc80573f70e7a921"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.13",
    "v4.13-rc1",
    "v4.13-rc2",
    "v4.13-rc3",
    "v4.13-rc4",
    "v4.13-rc5",
    "v4.13-rc6",
    "v4.13-rc7",
    "v4.14",
    "v4.14-rc1"
  ],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "MAINTAINERS",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/dax/super.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/md/dm-linear.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/block/brd.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvdimm/btt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/md/dm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/md/dm-stripe.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/s390/block/dcssblk.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvdimm/pmem.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/dax.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/device-mapper.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}