commit 41057ebde0025b0179b852dd785c9f3f0f08adad
Author: David Howells <dhowells@redhat.com>
Date:   Wed Sep 16 08:19:12 2020 +0100

    rxrpc: Support keys with multiple authentication tokens
    
    rxrpc-type keys can have multiple tokens attached for different security
    classes.  Currently, rxrpc always picks the first one, whether or not the
    security class it indicates is supported.
    
    Add preliminary support for choosing which security class will be used
    (this will need to be directed from a higher layer) and go through the
    tokens to find one that's supported.
    
    Signed-off-by: David Howells <dhowells@redhat.com>

diff --git a/net/rxrpc/ar-internal.h b/net/rxrpc/ar-internal.h
index dce48162f6c2..3c417ec94e4c 100644
--- a/net/rxrpc/ar-internal.h
+++ b/net/rxrpc/ar-internal.h
@@ -12,6 +12,7 @@
 #include <net/netns/generic.h>
 #include <net/sock.h>
 #include <net/af_rxrpc.h>
+#include <keys/rxrpc-type.h>
 #include "protocol.h"
 
 #if 0
@@ -217,7 +218,8 @@ struct rxrpc_security {
 	void (*exit)(void);
 
 	/* initialise a connection's security */
-	int (*init_connection_security)(struct rxrpc_connection *);
+	int (*init_connection_security)(struct rxrpc_connection *,
+					struct rxrpc_key_token *);
 
 	/* prime a connection's packet security */
 	int (*prime_packet_security)(struct rxrpc_connection *);