Commit Hash: bd18de517923903a177508fc8813f44e717b1c00
Subject: mac80211_hwsim: drop pending frames on stop


Security Keywords:
- injection

Full commit message:
mac80211_hwsim: drop pending frames on stop

Syzbot reports that we may be able to get into a situation where
mac80211 has pending ACK frames on shutdown with hwsim. It appears
that the reason for this is that syzbot uses the wmediumd hooks to
intercept/injection frames, and may shut down hwsim, removing the
radio(s), while frames are pending in the air simulation.

Clean out the pending queue when the interface is stopped, after
this the frames can't be reported back to mac80211 properly anyway.

Reported-by: syzbot+a063bbf0b15737362592@syzkaller.appspotmail.com
Link: https://lore.kernel.org/r/20210517170429.b0f85ab0eda1.Ie42a6ec6b940c971f3441286aeaaae2fe368e29a@changeid
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Mon May 17 17:04:31 2021 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Mon May 31 21:27:07 2021 +0200

Files Changed: 1
Lines Added: 5
Lines Removed: 0
Total Changes: 5
