commit 5e7c1c918a4433c5dd1844d99f5648e17425fa16
Author: Matt Redfearn <matt.redfearn@mips.com>
Date:   Thu Mar 31 10:05:40 2016 +0100

    MIPS: Introduce plat_get_fdt a platform API to retrieve the FDT
    
    Early access to the kernel command line requires early access to the FDT
    for platforms which pass the command line within the device tree. There
    was no common way to retrieve the location of the FDT without incurring
    side effects, such as plat_mem_setup which, on Malta at least,
    initializes a bunch of other stuff.
    
    This patch adds plat_get_ftd() for IMG platforms.
    
    Signed-off-by: Matt Redfearn <matt.redfearn@imgtec.com>
    Cc: Paul Burton <paul.burton@imgtec.com>
    Cc: linux-mips@linux-mips.org
    Cc: kernel-hardening@lists.openwall.com
    Cc: linux-kernel@vger.kernel.org
    Patchwork: https://patchwork.linux-mips.org/patch/12988/
    Signed-off-by: Ralf Baechle <ralf@linux-mips.org>

diff --git a/arch/mips/mti-malta/malta-setup.c b/arch/mips/mti-malta/malta-setup.c
index 4740c82fb97a..33d5ff5069e5 100644
--- a/arch/mips/mti-malta/malta-setup.c
+++ b/arch/mips/mti-malta/malta-setup.c
@@ -248,10 +248,15 @@ static void __init bonito_quirks_setup(void)
 #endif
 }
 
+void __init *plat_get_fdt(void)
+{
+	return (void *)__dtb_start;
+}
+
 void __init plat_mem_setup(void)
 {
 	unsigned int i;
-	void *fdt = __dtb_start;
+	void *fdt = plat_get_fdt();
 
 	fdt = malta_dt_shim(fdt);
 	__dt_setup_arch(fdt);