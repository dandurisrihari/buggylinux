Commit Hash: a1f1c24368ec9b1d2bbc77075d2ba340ea9d0a83
Subject: Bluetooth: replace deprecated strncpy with strscpy_pad


Security Keywords:
- hardening

Full commit message:
Bluetooth: replace deprecated strncpy with strscpy_pad

strncpy() is deprecated for use on NUL-terminated destination strings [0]
and as such we should prefer more robust and less ambiguous string interfaces.

The CAPI (part II) [1] states that the manufacturer id should be a
"zero-terminated ASCII string" and should "always [be] zero-terminated."

Much the same for the serial number: "The serial number, a seven-digit
number coded as a zero-terminated ASCII string".

Along with this, its clear the original author intended for these
buffers to be NUL-padded as well. To meet the specification as well as
properly NUL-pad, use strscpy_pad().

In doing this, an opportunity to simplify this code is also present.
Remove the min_t() and combine the length check into the main if.

Link: https://www.kernel.org/doc/html/latest/process/deprecated.html#strncpy-on-nul-terminated-strings [0]
Link: https://capi.org/downloads.html [1]
Link: https://manpages.debian.org/testing/linux-manual-4.8/strscpy.9.en.html
Link: https://github.com/KSPP/linux/issues/90
Cc: linux-hardening@vger.kernel.org
Signed-off-by: Justin Stitt <justinstitt@google.com>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

Metadata:
Author: Justin Stitt <justinstitt@google.com>
Author Date: Thu Sep 5 15:54:40 2024 -0700
Committer: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Commit Date: Tue Sep 10 13:06:55 2024 -0400

Files Changed: 1
Lines Added: 8
Lines Removed: 24
Total Changes: 32
