Commit Hash: f8558555f31e177e2644f3c8116801c3e5c29974
Subject: [Bluetooth] Initiate authentication during connection establishment


Security Keywords:
- authentication

Full commit message:
[Bluetooth] Initiate authentication during connection establishment

With Bluetooth 2.1 and Simple Pairing the requirement is that any new
connection needs to be authenticated and that encryption has been
switched on before allowing L2CAP to use it. So make sure that all
the requirements are fulfilled and otherwise drop the connection with
a minimal disconnect timeout of 10 milliseconds.

This change only affects Bluetooth 2.1 devices and Simple Pairing
needs to be enabled locally and in the remote host stack. The previous
changes made sure that these information are discovered before any
kind of authentication and encryption is triggered.

Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Marcel Holtmann <marcel@holtmann.org>
Author Date: Mon Jul 14 20:13:49 2008 +0200
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Mon Jul 14 20:13:49 2008 +0200

Files Changed: 1
Lines Added: 103
Lines Removed: 11
Total Changes: 114
