{
  "hash": "c1644fe041ebaf6519f6809146a77c3ead9193af",
  "hash_short": "c1644fe0",
  "subject": "KEYS: Change the name of the dead type to \".dead\" to prevent user access",
  "body": "This fixes CVE-2017-6951.\n\nUserspace should not be able to do things with the \"dead\" key type as it\ndoesn't have some of the helper functions set upon it that the kernel\nneeds.  Attempting to use it may cause the kernel to crash.\n\nFix this by changing the name of the type to \".dead\" so that it's rejected\nup front on userspace syscalls by key_get_type_from_user().\n\nThough this doesn't seem to affect recent kernels, it does affect older\nones, certainly those prior to:\n\n\tcommit c06cfb08b88dfbe13be44a69ae2fdc3a7c902d81\n\tAuthor: David Howells <dhowells@redhat.com>\n\tDate:   Tue Sep 16 17:36:06 2014 +0100\n\tKEYS: Remove key_type::match in favour of overriding default by match_preparse\n\nwhich went in before 3.18-rc1.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\ncc: stable@vger.kernel.org",
  "full_message": "KEYS: Change the name of the dead type to \".dead\" to prevent user access\n\nThis fixes CVE-2017-6951.\n\nUserspace should not be able to do things with the \"dead\" key type as it\ndoesn't have some of the helper functions set upon it that the kernel\nneeds.  Attempting to use it may cause the kernel to crash.\n\nFix this by changing the name of the type to \".dead\" so that it's rejected\nup front on userspace syscalls by key_get_type_from_user().\n\nThough this doesn't seem to affect recent kernels, it does affect older\nones, certainly those prior to:\n\n\tcommit c06cfb08b88dfbe13be44a69ae2fdc3a7c902d81\n\tAuthor: David Howells <dhowells@redhat.com>\n\tDate:   Tue Sep 16 17:36:06 2014 +0100\n\tKEYS: Remove key_type::match in favour of overriding default by match_preparse\n\nwhich went in before 3.18-rc1.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\ncc: stable@vger.kernel.org",
  "author_name": "David Howells",
  "author_email": "dhowells@redhat.com",
  "author_date": "Tue Apr 18 15:31:08 2017 +0100",
  "author_date_iso": "2017-04-18T15:31:08+01:00",
  "committer_name": "David Howells",
  "committer_email": "dhowells@redhat.com",
  "committer_date": "Tue Apr 18 15:31:39 2017 +0100",
  "committer_date_iso": "2017-04-18T15:31:39+01:00",
  "files_changed": [
    "security/keys/gc.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "security/keys/gc.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "ee8f844e3c5a73b999edf733df1c529d6503ec2f"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.11",
    "v4.11-rc8",
    "v4.12",
    "v4.12-rc1",
    "v4.12-rc2",
    "v4.12-rc3",
    "v4.12-rc4",
    "v4.12-rc5",
    "v4.12-rc6",
    "v4.12-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2017-6951"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "security/keys/gc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}