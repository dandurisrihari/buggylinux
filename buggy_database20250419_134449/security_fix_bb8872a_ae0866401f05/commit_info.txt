Commit Hash: bb8872a1e6bc911869a729240781076ed950764b
Subject: tipc: fix using smp_processor_id() in preemptible


Security Keywords:
- authentication

Full commit message:
tipc: fix using smp_processor_id() in preemptible

The 'this_cpu_ptr()' is used to obtain the AEAD key' TFM on the current
CPU for encryption, however the execution can be preemptible since it's
actually user-space context, so the 'using smp_processor_id() in
preemptible' has been observed.

We fix the issue by using the 'get/put_cpu_ptr()' API which consists of
a 'preempt_disable()' instead.

Fixes: fc1b6d6de220 ("tipc: introduce TIPC encryption & authentication")
Acked-by: Jon Maloy <jmaloy@redhat.com>
Signed-off-by: Tuong Lien <tuong.t.lien@dektech.com.au>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Tuong Lien <tuong.t.lien@dektech.com.au>
Author Date: Sun Aug 30 02:37:55 2020 +0700
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Sun Aug 30 19:12:17 2020 -0700

Files Changed: 1
Lines Added: 9
Lines Removed: 3
Total Changes: 12
