commit 9c9025ea003a03f967affd690f39b4ef3452c0f5
Author: Sean Christopherson <seanjc@google.com>
Date:   Tue Jan 9 17:27:00 2024 -0800

    KVM: x86: Plumb "force_immediate_exit" into kvm_entry() tracepoint
    
    Annotate the kvm_entry() tracepoint with "immediate exit" when KVM is
    forcing a VM-Exit immediately after VM-Enter, e.g. when KVM wants to
    inject an event but needs to first complete some other operation.
    Knowing that KVM is (or isn't) forcing an exit is useful information when
    debugging issues related to event injection.
    
    Suggested-by: Maxim Levitsky <mlevitsk@redhat.com>
    Link: https://lore.kernel.org/r/20240110012705.506918-2-seanjc@google.com
    Signed-off-by: Sean Christopherson <seanjc@google.com>

diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.c
index f97e443ce853..e92f14b9d0d6 100644
--- a/arch/x86/kvm/x86.c
+++ b/arch/x86/kvm/x86.c
@@ -10956,7 +10956,7 @@ static int vcpu_enter_guest(struct kvm_vcpu *vcpu)
 		WARN_ON_ONCE((kvm_vcpu_apicv_activated(vcpu) != kvm_vcpu_apicv_active(vcpu)) &&
 			     (kvm_get_apic_mode(vcpu) != LAPIC_MODE_DISABLED));
 
-		exit_fastpath = static_call(kvm_x86_vcpu_run)(vcpu);
+		exit_fastpath = static_call(kvm_x86_vcpu_run)(vcpu, req_immediate_exit);
 		if (likely(exit_fastpath != EXIT_FASTPATH_REENTER_GUEST))
 			break;