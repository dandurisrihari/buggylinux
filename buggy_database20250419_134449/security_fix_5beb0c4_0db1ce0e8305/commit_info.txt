Commit Hash: 5beb0c435bdde35a09376566b0e28f7df87c9f68
Subject: keys, trusted: seal with a TPM2 authorization policy


Security Keywords:
- auth

Full commit message:
keys, trusted: seal with a TPM2 authorization policy

TPM2 supports authorization policies, which are essentially
combinational logic statements repsenting the conditions where the data
can be unsealed based on the TPM state. This patch enables to use
authorization policies to seal trusted keys.

Two following new options have been added for trusted keys:

* 'policydigest=': provide an auth policy digest for sealing.
* 'policyhandle=': provide a policy session handle for unsealing.

If 'hash=' option is supplied after 'policydigest=' option, this
will result an error because the state of the option would become
mixed.

Signed-off-by: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>
Tested-by: Colin Ian King <colin.king@canonical.com>
Reviewed-by: Mimi Zohar <zohar@linux.vnet.ibm.com>
Acked-by: Peter Huewe <peterhuewe@gmx.de>

Metadata:
Author: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>
Author Date: Sat Oct 31 17:53:44 2015 +0200
Committer: Jarkko Sakkinen <jarkko.sakkinen@linux.intel.com>
Commit Date: Sun Dec 20 15:27:13 2015 +0200

Files Changed: 4
Lines Added: 70
Lines Removed: 18
Total Changes: 88
