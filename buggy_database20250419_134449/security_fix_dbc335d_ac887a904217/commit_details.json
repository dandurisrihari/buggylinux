{
  "hash": "dbc335d2dc3c437649eb6b39f4e9aee2a13eb0af",
  "hash_short": "dbc335d2",
  "subject": "ima: make a copy of template_fmt in template_desc_init_fields()",
  "body": "This patch makes a copy of the 'template_fmt' function argument so that\nthe latter will not be modified by strsep(), which does the splitting by\nreplacing the given separator with '\\0'.\n\n\u00a0IMA: No TPM chip found, activating TPM-bypass!\n\u00a0Unable to handle kernel pointer dereference at virtual kernel address 0000000000842000\n\u00a0Oops: 0004 [#1] SMP\n\u00a0Modules linked in:\n\u00a0CPU: 3 PID: 1 Comm: swapper/0 Not tainted 3.12.0-rc2-00098-g3ce1217d6cd5 #17\n\u00a0task: 000000003ffa0000 ti: 000000003ff84000 task.ti: 000000003ff84000\n\u00a0Krnl PSW : 0704e00180000000 000000000044bf88 (strsep+0x7c/0xa0)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 R:0 T:1 IO:1 EX:1 Key:0 M:1 W:0 P:0 AS:3 CC:2 PM:0 EA:3\n\u00a0Krnl GPRS: 000000000000007c 000000000000007c 000000003ff87d90 0000000000821fd8\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0000000000000000 000000000000007c 0000000000aa37e0 0000000000aa9008\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0000000000000051 0000000000a114d8 0000000100000002 0000000000842bde\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0000000000842bdf 00000000006f97f0 000000000040062c 000000003ff87cf0\n\u00a0Krnl Code: 000000000044bf7c: a7f4000a\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 brc\u00a0\u00a0\u00a0\u00a0 15,44bf90\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf80: b90200cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ltgr\u00a0\u00a0\u00a0 %r12,%r12\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #000000000044bf84: a7840006\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 brc\u00a0\u00a0\u00a0\u00a0 8,44bf90\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 >000000000044bf88: 9200c000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mvi\u00a0\u00a0\u00a0\u00a0 0(%r12),0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf8c: 41c0c001\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 la\u00a0\u00a0\u00a0\u00a0\u00a0 %r12,1(%r12)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf90: e3c020000024\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stg\u00a0\u00a0\u00a0\u00a0 %r12,0(%r2)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf96: b904002b\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 lgr\u00a0\u00a0\u00a0\u00a0 %r2,%r11\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf9a: ebbcf0700004\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 lmg\u00a0\u00a0\u00a0\u00a0 %r11,%r12,112(%r15)\n\u00a0Call Trace:\n\u00a0([<00000000004005fe>] ima_init_template+0xa2/0x1bc)\n\u00a0 [<0000000000a7c896>] ima_init+0x7a/0xa8\n\u00a0 [<0000000000a7c938>] init_ima+0x24/0x40\n\u00a0 [<00000000001000e8>] do_one_initcall+0x68/0x128\n\u00a0 [<0000000000a4eb56>] kernel_init_freeable+0x20a/0x2b4\n\u00a0 [<00000000006a1ff4>] kernel_init+0x30/0x178\n\u00a0 [<00000000006b69fe>] kernel_thread_starter+0x6/0xc\n\u00a0 [<00000000006b69f8>] kernel_thread_starter+0x0/0xc\n\u00a0Last Breaking-Event-Address:\n\u00a0 [<000000000044bf42>] strsep+0x36/0xa0\n\nFixes commit: adf53a7 ima: new templates management mechanism\n\nChangelog v1:\n- make template_fmt 'const char *' (reported-by James Morris)\n- fix kstrdup memory leak (reported-by James Morris)\n\nReported-by: Heiko Carstens <heiko.carstens@de.ibm.com>\nSigned-off-by: Roberto Sassu <roberto.sassu@polito.it>\nSigned-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nTested-by: Heiko Carstens <heiko.carstens@de.ibm.com>",
  "full_message": "ima: make a copy of template_fmt in template_desc_init_fields()\n\nThis patch makes a copy of the 'template_fmt' function argument so that\nthe latter will not be modified by strsep(), which does the splitting by\nreplacing the given separator with '\\0'.\n\n\u00a0IMA: No TPM chip found, activating TPM-bypass!\n\u00a0Unable to handle kernel pointer dereference at virtual kernel address 0000000000842000\n\u00a0Oops: 0004 [#1] SMP\n\u00a0Modules linked in:\n\u00a0CPU: 3 PID: 1 Comm: swapper/0 Not tainted 3.12.0-rc2-00098-g3ce1217d6cd5 #17\n\u00a0task: 000000003ffa0000 ti: 000000003ff84000 task.ti: 000000003ff84000\n\u00a0Krnl PSW : 0704e00180000000 000000000044bf88 (strsep+0x7c/0xa0)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 R:0 T:1 IO:1 EX:1 Key:0 M:1 W:0 P:0 AS:3 CC:2 PM:0 EA:3\n\u00a0Krnl GPRS: 000000000000007c 000000000000007c 000000003ff87d90 0000000000821fd8\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0000000000000000 000000000000007c 0000000000aa37e0 0000000000aa9008\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0000000000000051 0000000000a114d8 0000000100000002 0000000000842bde\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 0000000000842bdf 00000000006f97f0 000000000040062c 000000003ff87cf0\n\u00a0Krnl Code: 000000000044bf7c: a7f4000a\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 brc\u00a0\u00a0\u00a0\u00a0 15,44bf90\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf80: b90200cc\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ltgr\u00a0\u00a0\u00a0 %r12,%r12\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 #000000000044bf84: a7840006\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 brc\u00a0\u00a0\u00a0\u00a0 8,44bf90\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 >000000000044bf88: 9200c000\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 mvi\u00a0\u00a0\u00a0\u00a0 0(%r12),0\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf8c: 41c0c001\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 la\u00a0\u00a0\u00a0\u00a0\u00a0 %r12,1(%r12)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf90: e3c020000024\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 stg\u00a0\u00a0\u00a0\u00a0 %r12,0(%r2)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf96: b904002b\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 lgr\u00a0\u00a0\u00a0\u00a0 %r2,%r11\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 000000000044bf9a: ebbcf0700004\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 lmg\u00a0\u00a0\u00a0\u00a0 %r11,%r12,112(%r15)\n\u00a0Call Trace:\n\u00a0([<00000000004005fe>] ima_init_template+0xa2/0x1bc)\n\u00a0 [<0000000000a7c896>] ima_init+0x7a/0xa8\n\u00a0 [<0000000000a7c938>] init_ima+0x24/0x40\n\u00a0 [<00000000001000e8>] do_one_initcall+0x68/0x128\n\u00a0 [<0000000000a4eb56>] kernel_init_freeable+0x20a/0x2b4\n\u00a0 [<00000000006a1ff4>] kernel_init+0x30/0x178\n\u00a0 [<00000000006b69fe>] kernel_thread_starter+0x6/0xc\n\u00a0 [<00000000006b69f8>] kernel_thread_starter+0x0/0xc\n\u00a0Last Breaking-Event-Address:\n\u00a0 [<000000000044bf42>] strsep+0x36/0xa0\n\nFixes commit: adf53a7 ima: new templates management mechanism\n\nChangelog v1:\n- make template_fmt 'const char *' (reported-by James Morris)\n- fix kstrdup memory leak (reported-by James Morris)\n\nReported-by: Heiko Carstens <heiko.carstens@de.ibm.com>\nSigned-off-by: Roberto Sassu <roberto.sassu@polito.it>\nSigned-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nTested-by: Heiko Carstens <heiko.carstens@de.ibm.com>",
  "author_name": "Roberto Sassu",
  "author_email": "roberto.sassu@polito.it",
  "author_date": "Mon Nov 25 20:18:52 2013 +0100",
  "author_date_iso": "2013-11-25T20:18:52+01:00",
  "committer_name": "Mimi Zohar",
  "committer_email": "zohar@linux.vnet.ibm.com",
  "committer_date": "Mon Nov 25 15:05:33 2013 -0500",
  "committer_date_iso": "2013-11-25T15:05:33-05:00",
  "files_changed": [
    "security/integrity/ima/ima_template.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "security/integrity/ima/ima_template.c",
      "insertions": 14,
      "deletions": 7
    }
  ],
  "total_insertions": 14,
  "total_deletions": 7,
  "total_changes": 21,
  "parents": [
    "3e8e5503a33577d89bdb7469b851b11f507bbed6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.13",
    "v3.13-rc2",
    "v3.13-rc3",
    "v3.13-rc4",
    "v3.13-rc5",
    "v3.13-rc6",
    "v3.13-rc7",
    "v3.13-rc8",
    "v3.14",
    "v3.14-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "bypass"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "security/integrity/ima/ima_template.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}