{
  "hash": "33155c4aae5260475def6f7438e4e35564f4f3ba",
  "hash_short": "33155c4a",
  "subject": "Bluetooth: hci_event: Ignore NULL link key",
  "body": "This change is used to relieve CVE-2020-26555. The description of the\nCVE:\n\nBluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification\n1.0B through 5.2 may permit an unauthenticated nearby device to spoof\nthe BD_ADDR of the peer device to complete pairing without knowledge\nof the PIN. [1]\n\nThe detail of this attack is in IEEE paper:\nBlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols\n[2]\n\nIt's a reflection attack. The paper mentioned that attacker can induce\nthe attacked target to generate null link key (zero key) without PIN\ncode. In BR/EDR, the key generation is actually handled in the controller\nwhich is below HCI.\n\nThus, we can ignore null link key in the handler of \"Link Key Notification\nevent\" to relieve the attack. A similar implementation also shows in\nbtstack project. [3]\n\nv3: Drop the connection when null link key be detected.\n\nv2:\n- Used Link: tag instead of Closes:\n- Used bt_dev_dbg instead of BT_DBG\n- Added Fixes: tag\n\nCc: stable@vger.kernel.org\nFixes: 55ed8ca10f35 (\"Bluetooth: Implement link key handling for the management interface\")\nLink: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]\nLink: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]\nLink: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3722 [3]\nSigned-off-by: Lee, Chun-Yi <jlee@suse.com>\nSigned-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>",
  "full_message": "Bluetooth: hci_event: Ignore NULL link key\n\nThis change is used to relieve CVE-2020-26555. The description of the\nCVE:\n\nBluetooth legacy BR/EDR PIN code pairing in Bluetooth Core Specification\n1.0B through 5.2 may permit an unauthenticated nearby device to spoof\nthe BD_ADDR of the peer device to complete pairing without knowledge\nof the PIN. [1]\n\nThe detail of this attack is in IEEE paper:\nBlueMirror: Reflections on Bluetooth Pairing and Provisioning Protocols\n[2]\n\nIt's a reflection attack. The paper mentioned that attacker can induce\nthe attacked target to generate null link key (zero key) without PIN\ncode. In BR/EDR, the key generation is actually handled in the controller\nwhich is below HCI.\n\nThus, we can ignore null link key in the handler of \"Link Key Notification\nevent\" to relieve the attack. A similar implementation also shows in\nbtstack project. [3]\n\nv3: Drop the connection when null link key be detected.\n\nv2:\n- Used Link: tag instead of Closes:\n- Used bt_dev_dbg instead of BT_DBG\n- Added Fixes: tag\n\nCc: stable@vger.kernel.org\nFixes: 55ed8ca10f35 (\"Bluetooth: Implement link key handling for the management interface\")\nLink: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-26555 [1]\nLink: https://ieeexplore.ieee.org/abstract/document/9474325/authors#authors [2]\nLink: https://github.com/bluekitchen/btstack/blob/master/src/hci.c#L3722 [3]\nSigned-off-by: Lee, Chun-Yi <jlee@suse.com>\nSigned-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>",
  "author_name": "Lee, Chun-Yi",
  "author_email": "jlee@suse.com",
  "author_date": "Sun Oct 1 16:59:31 2023 +0800",
  "author_date_iso": "2023-10-01T16:59:31+08:00",
  "committer_name": "Luiz Augusto von Dentz",
  "committer_email": "luiz.von.dentz@intel.com",
  "committer_date": "Wed Oct 11 11:16:02 2023 -0700",
  "committer_date_iso": "2023-10-11T11:16:02-07:00",
  "files_changed": [
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 9,
      "deletions": 0
    }
  ],
  "total_insertions": 9,
  "total_deletions": 0,
  "total_changes": 9,
  "parents": [
    "acab8ff29a2a226409cfe04e6d2e0896928c1b3a"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-26555",
      "CVE-2020-26555"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}