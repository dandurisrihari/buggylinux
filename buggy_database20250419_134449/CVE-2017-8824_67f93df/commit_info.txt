Commit Hash: 67f93df79aeefc3add4e4b31a752600f834236e2
Subject: dccp: check sk for closed state in dccp_sendmsg()

CVE Identifiers:
- CVE-2017-8824

Full commit message:
dccp: check sk for closed state in dccp_sendmsg()

dccp_disconnect() sets 'dp->dccps_hc_tx_ccid' tx handler to NULL,
therefore if DCCP socket is disconnected and dccp_sendmsg() is
called after it, it will cause a NULL pointer dereference in
dccp_write_xmit().

This crash and the reproducer was reported by syzbot. Looks like
it is reproduced if commit 69c64866ce07 ("dccp: CVE-2017-8824:
use-after-free in DCCP code") is applied.

Reported-by: syzbot+f99ab3887ab65d70f816@syzkaller.appspotmail.com
Signed-off-by: Alexey Kodanev <alexey.kodanev@oracle.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Alexey Kodanev <alexey.kodanev@oracle.com>
Author Date: Tue Mar 6 22:57:01 2018 +0300
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Wed Mar 7 13:38:56 2018 -0500

Files Changed: 1
Lines Added: 5
Lines Removed: 0
Total Changes: 5
