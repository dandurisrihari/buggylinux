{
  "hash": "23c8a812dc3c621009e4f0e5342aa4e2ede1ceaa",
  "hash_short": "23c8a812",
  "subject": "KEYS: Fix ASN.1 indefinite length object parsing",
  "body": "This fixes CVE-2016-0758.\n\nIn the ASN.1 decoder, when the length field of an ASN.1 value is extracted,\nit isn't validated against the remaining amount of data before being added\nto the cursor.  With a sufficiently large size indicated, the check:\n\n\tdatalen - dp < 2\n\nmay then fail due to integer overflow.\n\nFix this by checking the length indicated against the amount of remaining\ndata in both places a definite length is determined.\n\nWhilst we're at it, make the following changes:\n\n (1) Check the maximum size of extended length does not exceed the capacity\n     of the variable it's being stored in (len) rather than the type that\n     variable is assumed to be (size_t).\n\n (2) Compare the EOC tag to the symbolic constant ASN1_EOC rather than the\n     integer 0.\n\n (3) To reduce confusion, move the initialisation of len outside of:\n\n\tfor (len = 0; n > 0; n--) {\n\n     since it doesn't have anything to do with the loop counter n.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\nReviewed-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nAcked-by: David Woodhouse <David.Woodhouse@intel.com>\nAcked-by: Peter Jones <pjones@redhat.com>",
  "full_message": "KEYS: Fix ASN.1 indefinite length object parsing\n\nThis fixes CVE-2016-0758.\n\nIn the ASN.1 decoder, when the length field of an ASN.1 value is extracted,\nit isn't validated against the remaining amount of data before being added\nto the cursor.  With a sufficiently large size indicated, the check:\n\n\tdatalen - dp < 2\n\nmay then fail due to integer overflow.\n\nFix this by checking the length indicated against the amount of remaining\ndata in both places a definite length is determined.\n\nWhilst we're at it, make the following changes:\n\n (1) Check the maximum size of extended length does not exceed the capacity\n     of the variable it's being stored in (len) rather than the type that\n     variable is assumed to be (size_t).\n\n (2) Compare the EOC tag to the symbolic constant ASN1_EOC rather than the\n     integer 0.\n\n (3) To reduce confusion, move the initialisation of len outside of:\n\n\tfor (len = 0; n > 0; n--) {\n\n     since it doesn't have anything to do with the loop counter n.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\nReviewed-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nAcked-by: David Woodhouse <David.Woodhouse@intel.com>\nAcked-by: Peter Jones <pjones@redhat.com>",
  "author_name": "David Howells",
  "author_email": "dhowells@redhat.com",
  "author_date": "Tue Feb 23 11:03:12 2016 +0000",
  "author_date_iso": "2016-02-23T11:03:12+00:00",
  "committer_name": "David Howells",
  "committer_email": "dhowells@redhat.com",
  "committer_date": "Thu May 12 12:01:49 2016 +0100",
  "committer_date_iso": "2016-05-12T12:01:49+01:00",
  "files_changed": [
    "lib/asn1_decoder.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "lib/asn1_decoder.c",
      "insertions": 9,
      "deletions": 7
    }
  ],
  "total_insertions": 9,
  "total_deletions": 7,
  "total_changes": 16,
  "parents": [
    "685764b108a7e5fe9f5ee213d6a627c1166d7c88"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2016-0758"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "lib/asn1_decoder.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}