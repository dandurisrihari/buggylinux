commit 89b223bfb8a89731bea4c84982b5d2ad7ba460e3
Author: Paul Moore <paul@paul-moore.com>
Date:   Wed Dec 18 21:45:08 2019 -0500

    selinux: deprecate disabling SELinux and runtime
    
    Deprecate the CONFIG_SECURITY_SELINUX_DISABLE functionality.  The
    code was originally developed to make it easier for Linux
    distributions to support architectures where adding parameters to the
    kernel command line was difficult.  Unfortunately, supporting runtime
    disable meant we had to make some security trade-offs when it came to
    the LSM hooks, as documented in the Kconfig help text:
    
      NOTE: selecting this option will disable the '__ro_after_init'
      kernel hardening feature for security hooks.   Please consider
      using the selinux=0 boot parameter instead of enabling this
      option.
    
    Fortunately it looks as if that the original motivation for the
    runtime disable functionality is gone, and Fedora/RHEL appears to be
    the only major distribution enabling this capability at build time
    so we are now taking steps to remove it entirely from the kernel.
    The first step is to mark the functionality as deprecated and print
    an error when it is used (what this patch is doing).  As Fedora/RHEL
    makes progress in transitioning the distribution away from runtime
    disable, we will introduce follow-up patches over several kernel
    releases which will block for increasing periods of time when the
    runtime disable is used.  Finally we will remove the option entirely
    once we believe all users have moved to the kernel cmdline approach.
    
    Acked-by: Casey Schaufler <casey@schaufler-ca.com>
    Acked-by: Ondrej Mosnacek <omosnace@redhat.com>
    Acked-by: Stephen Smalley <sds@tycho.nsa.gov>
    Signed-off-by: Paul Moore <paul@paul-moore.com>

diff --git a/Documentation/ABI/obsolete/sysfs-selinux-disable b/Documentation/ABI/obsolete/sysfs-selinux-disable
new file mode 100644
index 000000000000..c340278e3cf8
--- /dev/null
+++ b/Documentation/ABI/obsolete/sysfs-selinux-disable
@@ -0,0 +1,26 @@
+What:		/sys/fs/selinux/disable
+Date:		April 2005 (predates git)
+KernelVersion:	2.6.12-rc2 (predates git)
+Contact:	selinux@vger.kernel.org
+Description:
+
+	The selinuxfs "disable" node allows SELinux to be disabled at runtime
+	prior to a policy being loaded into the kernel.  If disabled via this
+	mechanism, SELinux will remain disabled until the system is rebooted.
+
+	The preferred method of disabling SELinux is via the "selinux=0" boot
+	parameter, but the selinuxfs "disable" node was created to make it
+	easier for systems with primitive bootloaders that did not allow for
+	easy modification of the kernel command line.  Unfortunately, allowing
+	for SELinux to be disabled at runtime makes it difficult to secure the
+	kernel's LSM hooks using the "__ro_after_init" feature.
+
+	Thankfully, the need for the SELinux runtime disable appears to be
+	gone, the default Kconfig configuration disables this selinuxfs node,
+	and only one of the major distributions, Fedora, supports disabling
+	SELinux at runtime.  Fedora is in the process of removing the
+	selinuxfs "disable" node and once that is complete we will start the
+	slow process of removing this code from the kernel.
+
+	More information on /sys/fs/selinux/disable can be found under the
+	CONFIG_SECURITY_SELINUX_DISABLE Kconfig option.