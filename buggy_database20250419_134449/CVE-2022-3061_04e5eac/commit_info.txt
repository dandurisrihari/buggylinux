Commit Hash: 04e5eac8f3ab2ff52fa191c187a46d4fdbc1e288
Subject: fbdev: savage: Error out if pixclock equals zero

CVE Identifiers:
- CVE-2022-3061

Full commit message:
fbdev: savage: Error out if pixclock equals zero

The userspace program could pass any values to the driver through
ioctl() interface. If the driver doesn't check the value of pixclock,
it may cause divide-by-zero error.

Although pixclock is checked in savagefb_decode_var(), but it is not
checked properly in savagefb_probe(). Fix this by checking whether
pixclock is zero in the function savagefb_check_var() before
info->var.pixclock is used as the divisor.

This is similar to CVE-2022-3061 in i740fb which was fixed by
commit 15cf0b8.

Signed-off-by: Fullway Wang <fullwaywang@outlook.com>
Signed-off-by: Helge Deller <deller@gmx.de>

Metadata:
Author: Fullway Wang <fullwaywang@outlook.com>
Author Date: Thu Jan 18 11:49:40 2024 +0800
Committer: Helge Deller <deller@gmx.de>
Commit Date: Sun Jan 21 09:00:14 2024 +0100

Files Changed: 1
Lines Added: 3
Lines Removed: 0
Total Changes: 3
