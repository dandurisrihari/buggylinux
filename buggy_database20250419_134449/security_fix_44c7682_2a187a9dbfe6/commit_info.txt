Commit Hash: 44c76825d6eefee9eb7ce06c38e1a6632ac7eb7d
Subject: x86: Increase brk randomness entropy for 64-bit systems


Security Keywords:
- hardening

Full commit message:
x86: Increase brk randomness entropy for 64-bit systems

In commit c1d171a00294 ("x86: randomize brk"), arch_randomize_brk() was
defined to use a 32MB range (13 bits of entropy), but was never increased
when moving to 64-bit. The default arch_randomize_brk() uses 32MB for
32-bit tasks, and 1GB (18 bits of entropy) for 64-bit tasks.

Update x86_64 to match the entropy used by arm64 and other 64-bit
architectures.

Reported-by: y0un9n132@gmail.com
Signed-off-by: Kees Cook <keescook@chromium.org>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Acked-by: Jiri Kosina <jkosina@suse.com>
Closes: https://lore.kernel.org/linux-hardening/CA+2EKTVLvc8hDZc+2Yhwmus=dzOUG5E4gV7ayCbu0MPJTZzWkw@mail.gmail.com/
Link: https://lore.kernel.org/r/20240217062545.1631668-1-keescook@chromium.org

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Fri Feb 16 22:25:43 2024 -0800
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Tue Feb 27 00:23:55 2024 +0100

Files Changed: 1
Lines Added: 4
Lines Removed: 1
Total Changes: 5
