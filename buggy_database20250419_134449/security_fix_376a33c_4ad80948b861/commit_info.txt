Commit Hash: 376a33c4a0d8344bb575e1a6eeb748ee4d4675d3
Subject: drm/i915/hdcp: Fix when the first read and write are retried


Security Keywords:
- authentication

Full commit message:
drm/i915/hdcp: Fix when the first read and write are retried

Make sure that the first read/write in hdcp2_authentication_key_exchange
are only retried when we have either DP/DPMST encoder connected,
since we do this to give docks and dp encoders some extra time to
get their HDCP DPCD registers ready only for DP/DPMST encoders as
this issue is only observed here no need to burden other encoders
with extra retries as this causes the HDMI connector to have some
other timing issue and fails HDCP authentication.

--v2
-Add intent of patch [Chaitanya]
-Add reasoning for loop [Jani]
-Make sure we forfiet the 50ms wait for non DP/DPMST encoders.

--v3
-Remove the is_dp_encoder check [Jani/Chaitanya]
-Make the commit message more clearer [Jani]

Fixes: 9d5a05f86d2f ("drm/i915/hdcp: Retry first read and writes to downstream")
Signed-off-by: Suraj Kandpal <suraj.kandpal@intel.com>
Reviewed-by: Chaitanya Kumar Borah <chaitanya.kumar.borah@intel.com>
Link: https://patchwork.freedesktop.org/patch/msgid/20241104035951.517837-1-suraj.kandpal@intel.com
(cherry picked from commit 44499559496c1dac43583f4387d38de1b612a69b)
Signed-off-by: Tvrtko Ursulin <tursulin@ursulin.net>

Metadata:
Author: Suraj Kandpal <suraj.kandpal@intel.com>
Author Date: Mon Nov 4 09:29:51 2024 +0530
Committer: Tvrtko Ursulin <tursulin@ursulin.net>
Commit Date: Tue Nov 19 08:11:11 2024 +0000

Files Changed: 1
Lines Added: 20
Lines Removed: 12
Total Changes: 32
