Commit Hash: 44e3c25efae8575e06f1c5d1dc40058a991e3cb2
Subject: nvmet: return DHCHAP status codes from nvmet_setup_auth()


Security Keywords:
- authentication

Full commit message:
nvmet: return DHCHAP status codes from nvmet_setup_auth()

A failure in nvmet_setup_auth() does not mean that the NVMe
authentication command failed, so we should rather return a protocol
error with a 'failure1' response than an NVMe status.

Also update the type used for dhchap_step and dhchap_status to u8 to
avoid confusions with nvme status. Furthermore, split dhchap_status and
nvme status so we don't accidentally mix these return values.

Reviewed-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Hannes Reinecke <hare@suse.de>
[dwagner: - use u8 as type for dhchap_{step|status}
          - separate nvme status from dhcap_status]
Signed-off-by: Daniel Wagner <dwagner@suse.de>
Signed-off-by: Keith Busch <kbusch@kernel.org>

Metadata:
Author: Hannes Reinecke <hare@kernel.org>
Author Date: Tue Apr 30 15:19:25 2024 +0200
Committer: Keith Busch <kbusch@kernel.org>
Commit Date: Wed May 1 03:07:20 2024 -0700

Files Changed: 4
Lines Added: 43
Lines Removed: 45
Total Changes: 88
