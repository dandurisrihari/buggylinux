{
  "hash": "e0e3cea46d31d23dc40df0a49a7a2c04fe8edfea",
  "hash_short": "e0e3cea4",
  "subject": "af_netlink: force credentials passing [CVE-2012-3520]",
  "body": "Pablo Neira Ayuso discovered that avahi and\npotentially NetworkManager accept spoofed Netlink messages because of a\nkernel bug.  The kernel passes all-zero SCM_CREDENTIALS ancillary data\nto the receiver if the sender did not provide such data, instead of not\nincluding any such data at all or including the correct data from the\npeer (as it is the case with AF_UNIX).\n\nThis bug was introduced in commit 16e572626961\n(af_unix: dont send SCM_CREDENTIALS by default)\n\nThis patch forces passing credentials for netlink, as\nbefore the regression.\n\nAnother fix would be to not add SCM_CREDENTIALS in\nnetlink messages if not provided by the sender, but it\nmight break some programs.\n\nWith help from Florian Weimer & Petr Matousek\n\nThis issue is designated as CVE-2012-3520\n\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nCc: Petr Matousek <pmatouse@redhat.com>\nCc: Florian Weimer <fweimer@redhat.com>\nCc: Pablo Neira Ayuso <pablo@netfilter.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "af_netlink: force credentials passing [CVE-2012-3520]\n\nPablo Neira Ayuso discovered that avahi and\npotentially NetworkManager accept spoofed Netlink messages because of a\nkernel bug.  The kernel passes all-zero SCM_CREDENTIALS ancillary data\nto the receiver if the sender did not provide such data, instead of not\nincluding any such data at all or including the correct data from the\npeer (as it is the case with AF_UNIX).\n\nThis bug was introduced in commit 16e572626961\n(af_unix: dont send SCM_CREDENTIALS by default)\n\nThis patch forces passing credentials for netlink, as\nbefore the regression.\n\nAnother fix would be to not add SCM_CREDENTIALS in\nnetlink messages if not provided by the sender, but it\nmight break some programs.\n\nWith help from Florian Weimer & Petr Matousek\n\nThis issue is designated as CVE-2012-3520\n\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nCc: Petr Matousek <pmatouse@redhat.com>\nCc: Florian Weimer <fweimer@redhat.com>\nCc: Pablo Neira Ayuso <pablo@netfilter.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Eric Dumazet",
  "author_email": "edumazet@google.com",
  "author_date": "Tue Aug 21 06:21:17 2012 +0000",
  "author_date_iso": "2012-08-21T06:21:17+00:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Aug 21 14:53:01 2012 -0700",
  "committer_date_iso": "2012-08-21T14:53:01-07:00",
  "files_changed": [
    "include/net/scm.h",
    "net/netlink/af_netlink.c",
    "net/unix/af_unix.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "include/net/scm.h",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "net/netlink/af_netlink.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/unix/af_unix.c",
      "insertions": 2,
      "deletions": 2
    }
  ],
  "total_insertions": 6,
  "total_deletions": 4,
  "total_changes": 10,
  "parents": [
    "a9915a1b52df52ad87f3b33422da95cf25372f09"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2012-3520",
      "CVE-2012-3520",
      "CVE-2012-3520"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "include/net/scm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/netlink/af_netlink.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/unix/af_unix.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}