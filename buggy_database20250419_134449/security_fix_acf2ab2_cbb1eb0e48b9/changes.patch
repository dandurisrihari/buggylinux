diff --cc arch/arm64/kvm/emulate-nested.c
index ee280239f14f,e63be2058173..7bbeb8c8e5a1
--- a/arch/arm64/kvm/emulate-nested.c
+++ b/arch/arm64/kvm/emulate-nested.c
@@@ -83,9 -83,13 +83,14 @@@ enum cgt_group_id 
  	CGT_CPTR_TAM,
  	CGT_CPTR_TCPAC,
  
 +	CGT_HCRX_EnFPM,
  	CGT_HCRX_TCR2En,
  
+ 	CGT_ICH_HCR_TC,
+ 	CGT_ICH_HCR_TALL0,
+ 	CGT_ICH_HCR_TALL1,
+ 	CGT_ICH_HCR_TDIR,
+ 
  	/*
  	 * Anything after this point is a combination of coarse trap
  	 * controls, which must all be evaluated to decide what to do.
@@@ -1115,7 -1141,34 +1148,35 @@@ static const struct encoding_to_trap_co
  	SR_TRAP(SYS_CNTP_CTL_EL0,	CGT_CNTHCTL_EL1PTEN),
  	SR_TRAP(SYS_CNTPCT_EL0,		CGT_CNTHCTL_EL1PCTEN),
  	SR_TRAP(SYS_CNTPCTSS_EL0,	CGT_CNTHCTL_EL1PCTEN),
 +	SR_TRAP(SYS_FPMR,		CGT_HCRX_EnFPM),
+ 	/*
+ 	 * IMPDEF choice:
+ 	 * We treat ICC_SRE_EL2.{SRE,Enable) and ICV_SRE_EL1.SRE as
+ 	 * RAO/WI. We therefore never consider ICC_SRE_EL2.Enable for
+ 	 * ICC_SRE_EL1 access, and always handle it locally.
+ 	 */
+ 	SR_TRAP(SYS_ICC_AP0R0_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_AP0R1_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_AP0R2_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_AP0R3_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_AP1R0_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_AP1R1_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_AP1R2_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_AP1R3_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_BPR0_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_BPR1_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_CTLR_EL1,	CGT_ICH_HCR_TC),
+ 	SR_TRAP(SYS_ICC_DIR_EL1,	CGT_ICH_HCR_TC_TDIR),
+ 	SR_TRAP(SYS_ICC_EOIR0_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_EOIR1_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_HPPIR0_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_HPPIR1_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_IAR0_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_IAR1_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_IGRPEN0_EL1,	CGT_ICH_HCR_TALL0),
+ 	SR_TRAP(SYS_ICC_IGRPEN1_EL1,	CGT_ICH_HCR_TALL1),
+ 	SR_TRAP(SYS_ICC_PMR_EL1,	CGT_ICH_HCR_TC),
+ 	SR_TRAP(SYS_ICC_RPR_EL1,	CGT_ICH_HCR_TC),
  };
  
  static DEFINE_XARRAY(sr_forward_xa);