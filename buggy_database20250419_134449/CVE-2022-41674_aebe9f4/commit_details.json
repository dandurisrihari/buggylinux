{
  "hash": "aebe9f4639b13a1f4e9a6b42cdd2e38c617b442d",
  "hash_short": "aebe9f46",
  "subject": "wifi: cfg80211: fix u8 overflow in cfg80211_update_notlisted_nontrans()",
  "body": "In the copy code of the elements, we do the following calculation\nto reach the end of the MBSSID element:\n\n\t/* copy the IEs after MBSSID */\n\tcpy_len = mbssid[1] + 2;\n\nThis looks fine, however, cpy_len is a u8, the same as mbssid[1],\nso the addition of two can overflow. In this case the subsequent\nmemcpy() will overflow the allocated buffer, since it copies 256\nbytes too much due to the way the allocation and memcpy() sizes\nare calculated.\n\nFix this by using size_t for the cpy_len variable.\n\nThis fixes CVE-2022-41674.\n\nReported-by: Soenke Huster <shuster@seemoo.tu-darmstadt.de>\nTested-by: Soenke Huster <shuster@seemoo.tu-darmstadt.de>\nFixes: 0b8fb8235be8 (\"cfg80211: Parsing of Multiple BSSID information in scanning\")\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: cfg80211: fix u8 overflow in cfg80211_update_notlisted_nontrans()\n\nIn the copy code of the elements, we do the following calculation\nto reach the end of the MBSSID element:\n\n\t/* copy the IEs after MBSSID */\n\tcpy_len = mbssid[1] + 2;\n\nThis looks fine, however, cpy_len is a u8, the same as mbssid[1],\nso the addition of two can overflow. In this case the subsequent\nmemcpy() will overflow the allocated buffer, since it copies 256\nbytes too much due to the way the allocation and memcpy() sizes\nare calculated.\n\nFix this by using size_t for the cpy_len variable.\n\nThis fixes CVE-2022-41674.\n\nReported-by: Soenke Huster <shuster@seemoo.tu-darmstadt.de>\nTested-by: Soenke Huster <shuster@seemoo.tu-darmstadt.de>\nFixes: 0b8fb8235be8 (\"cfg80211: Parsing of Multiple BSSID information in scanning\")\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Wed Sep 28 21:56:15 2022 +0200",
  "author_date_iso": "2022-09-28T21:56:15+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Mon Oct 10 09:49:52 2022 +0200",
  "committer_date_iso": "2022-10-10T09:49:52+02:00",
  "files_changed": [
    "net/wireless/scan.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/wireless/scan.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "af7d23f9d96a3e9647cff8619a6860d73b109b5f"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-41674"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/wireless/scan.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}