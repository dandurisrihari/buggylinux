{
  "hash": "8a04930f2bb0047de4ae18af12e5731084bd555c",
  "hash_short": "8a04930f",
  "subject": "kunit: tool: redo how we construct and mock LinuxSourceTree",
  "body": "Our main function currently has an optional `linux` argument which is\nused to by our unit tests to inject a mock.\nWe currently have the same code copy-pasted several times to do\n  if not linux:\n    linux = MakeRealInstance(cli_args.foo, cli_args.bar, ...)\n\nBut in python, dependency injection isn't necessary or idiomatic when we\ncan just use mock.patch() to mock things out.\n\nThis change\n1. adds a helper to create a LinuxSourceTree from the cli_args\n2. drops the `linux` parameter in favor of mocking the __init__ func.\n\nSigned-off-by: Daniel Latypov <dlatypov@google.com>\nReviewed-by: David Gow <davidgow@google.com>\nReviewed-by: Brendan Higgins <brendanhiggins@google.com>\nSigned-off-by: Shuah Khan <skhan@linuxfoundation.org>",
  "full_message": "kunit: tool: redo how we construct and mock LinuxSourceTree\n\nOur main function currently has an optional `linux` argument which is\nused to by our unit tests to inject a mock.\nWe currently have the same code copy-pasted several times to do\n  if not linux:\n    linux = MakeRealInstance(cli_args.foo, cli_args.bar, ...)\n\nBut in python, dependency injection isn't necessary or idiomatic when we\ncan just use mock.patch() to mock things out.\n\nThis change\n1. adds a helper to create a LinuxSourceTree from the cli_args\n2. drops the `linux` parameter in favor of mocking the __init__ func.\n\nSigned-off-by: Daniel Latypov <dlatypov@google.com>\nReviewed-by: David Gow <davidgow@google.com>\nReviewed-by: Brendan Higgins <brendanhiggins@google.com>\nSigned-off-by: Shuah Khan <skhan@linuxfoundation.org>",
  "author_name": "Daniel Latypov",
  "author_email": "dlatypov@google.com",
  "author_date": "Mon May 16 12:47:29 2022 -0700",
  "author_date_iso": "2022-05-16T12:47:29-07:00",
  "committer_name": "Shuah Khan",
  "committer_email": "skhan@linuxfoundation.org",
  "committer_date": "Thu Jul 7 17:45:59 2022 -0600",
  "committer_date_iso": "2022-07-07T17:45:59-06:00",
  "files_changed": [
    "tools/testing/kunit/kunit.py",
    "tools/testing/kunit/kunit_tool_test.py"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "tools/testing/kunit/kunit.py",
      "insertions": 16,
      "deletions": 33
    },
    {
      "file": "tools/testing/kunit/kunit_tool_test.py",
      "insertions": 49,
      "deletions": 54
    }
  ],
  "total_insertions": 65,
  "total_deletions": 87,
  "total_changes": 152,
  "parents": [
    "76f0d6f581693fbfd1be82aadc28fb52e33000fd"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "tools/testing/kunit/kunit.py",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/kunit/kunit_tool_test.py",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}