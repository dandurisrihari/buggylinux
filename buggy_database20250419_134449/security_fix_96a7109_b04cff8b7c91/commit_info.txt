Commit Hash: 96a7109a16665255b65d021e24141c2edae0e202
Subject: mac80211: Set priority and queue mapping for injected frames


Security Keywords:
- injection

Full commit message:
mac80211: Set priority and queue mapping for injected frames

Some drivers, for example mt76, use the skb priority field, and
expects that to be consistent with the skb queue mapping. On some
frame injection code paths that was not true, and it broke frame
injection. Now the skb queue mapping is set according to the skb
priority value when the frame is injected. The skb priority value
is also derived from the frame data for all frame types, as it
was done prior to commit dbd50a851c50 (only allocate one queue
when using iTXQs). Fixes frame injection with the mt76 driver on
MT7610E chipset.

Signed-off-by: Johan Almbladh <johan.almbladh@anyfinetworks.com>
Link: https://lore.kernel.org/r/20210401164455.978245-1-johan.almbladh@anyfinetworks.com
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johan Almbladh <johan.almbladh@anyfinetworks.com>
Author Date: Thu Apr 1 18:44:55 2021 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Thu Apr 8 15:32:04 2021 +0200

Files Changed: 1
Lines Added: 9
Lines Removed: 11
Total Changes: 20
