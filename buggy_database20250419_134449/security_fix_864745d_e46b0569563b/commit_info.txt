Commit Hash: 864745d291b5ba80ea0bd0edcbe67273de368836
Subject: xfrm_user: return error pointer instead of NULL


Security Keywords:
- privilege escalation

Full commit message:
xfrm_user: return error pointer instead of NULL

When dump_one_state() returns an error, e.g. because of a too small
buffer to dump the whole xfrm state, xfrm_state_netlink() returns NULL
instead of an error pointer. But its callers expect an error pointer
and therefore continue to operate on a NULL skbuff.

This could lead to a privilege escalation (execution of user code in
kernel context) if the attacker has CAP_NET_ADMIN and is able to map
address 0.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Acked-by: Steffen Klassert <steffen.klassert@secunet.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Mathias Krause <minipli@googlemail.com>
Author Date: Thu Sep 13 11:41:26 2012 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Tue Sep 18 16:13:45 2012 -0400

Files Changed: 1
Lines Added: 4
Lines Removed: 2
Total Changes: 6
