Commit Hash: 27c7003697fc2c78f965984aa224ef26cd6b2949
Subject: dm crypt: fix crash by adding missing check for auth key size


Security Keywords:
- auth

Full commit message:
dm crypt: fix crash by adding missing check for auth key size

If dm-crypt uses authenticated mode with separate MAC, there are two
concatenated part of the key structure - key(s) for encryption and
authentication key.

Add a missing check for authenticated key length.  If this key length is
smaller than actually provided key, dm-crypt now properly fails instead
of crashing.

Fixes: ef43aa3806 ("dm crypt: add cryptographic data integrity protection (authenticated encryption)")
Cc: stable@vger.kernel.org # 4.12+
Reported-by: Salah Coronya <salahx@yahoo.com>
Signed-off-by: Milan Broz <gmazyland@gmail.com>
Signed-off-by: Mike Snitzer <snitzer@redhat.com>

Metadata:
Author: Milan Broz <gmazyland@gmail.com>
Author Date: Wed Jan 3 22:48:59 2018 +0100
Committer: Mike Snitzer <snitzer@redhat.com>
Commit Date: Wed Jan 17 09:08:41 2018 -0500

Files Changed: 1
Lines Added: 6
Lines Removed: 1
Total Changes: 7
