Commit Hash: a1f74ae82d133ebb2aabb19d181944b4e83e9960
Subject: [SCSI] mpt2sas: prevent heap overflows and unchecked reads


Security Keywords:
- privilege escalation

Full commit message:
[SCSI] mpt2sas: prevent heap overflows and unchecked reads

At two points in handling device ioctls via /dev/mpt2ctl, user-supplied
length values are used to copy data from userspace into heap buffers
without bounds checking, allowing controllable heap corruption and
subsequently privilege escalation.

Additionally, user-supplied values are used to determine the size of a
copy_to_user() as well as the offset into the buffer to be read, with no
bounds checking, allowing users to read arbitrary kernel memory.

Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com>
Cc: stable@kernel.org
Acked-by: Eric Moore <eric.moore@lsi.com>
Signed-off-by: James Bottomley <James.Bottomley@suse.de>

Metadata:
Author: Dan Rosenberg <drosenberg@vsecurity.com>
Author Date: Tue Apr 5 12:45:59 2011 -0400
Committer: James Bottomley <James.Bottomley@suse.de>
Commit Date: Sun Apr 24 11:01:59 2011 -0500

Files Changed: 1
Lines Added: 21
Lines Removed: 2
Total Changes: 23
