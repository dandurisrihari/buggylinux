Commit Hash: 39fac853a758306285404368fbe392408057b136
Subject: ecryptfs: checking return code of ecryptfs_find_auth_tok_for_sig()


Security Keywords:
- authentication

Full commit message:
ecryptfs: checking return code of ecryptfs_find_auth_tok_for_sig()

This patch replaces the check of the 'matching_auth_tok' pointer with
the exit status of ecryptfs_find_auth_tok_for_sig().
This avoids to use authentication tokens obtained through the function
ecryptfs_keyring_auth_tok_for_sig which are not valid.

Signed-off-by: Roberto Sassu <roberto.sassu@polito.it>
Cc: Dustin Kirkland <kirkland@canonical.com>
Cc: James Morris <jmorris@namei.org>
Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>

Metadata:
Author: Roberto Sassu <roberto.sassu@polito.it>
Author Date: Wed Oct 6 18:31:15 2010 +0200
Committer: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Commit Date: Fri Oct 29 10:31:36 2010 -0500

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
