Commit Hash: 533708867dd6388f643f12c87465b59e732d729d
Subject: IB/mad: Require CM send method for everything except ClassPortInfo


Security Keywords:
- vulnerability

Full commit message:
IB/mad: Require CM send method for everything except ClassPortInfo

Receipt of CM MAD with other than the Send method for an attribute
other than the ClassPortInfo attribute is invalid.

CM attributes other than ClassPortInfo only use the send method.

The SRP initiator does not maintain a timeout policy for CM connect
requests relies on the CM layer to do that. The result was that
the SRP initiator hung as the connect request never completed.

A new SRP target has been observed to respond to Send CM REQ
with GetResp of CM REQ with bad status. This is non conformant
with IBA spec but exposes a vulnerability in the current MAD/CM
code which will respond to the incoming GetResp of CM REQ as if
it was a valid incoming Send of CM REQ rather than tossing
this on the floor. It also causes the MAD layer not to
retransmit the original REQ even though it has not received a REP.

Reviewed-by: Sagi Grimberg <sagig@mellanox.com>
Signed-off-by: Hal Rosenstock <hal@mellanox.com>
Reviewed-by: Ira Weiny <ira.weiny@intel.com>
Signed-off-by: Doug Ledford <dledford@redhat.com>

Metadata:
Author: Hal Rosenstock <hal@dev.mellanox.co.il>
Author Date: Fri Nov 13 15:22:22 2015 -0500
Committer: Doug Ledford <dledford@redhat.com>
Commit Date: Tue Dec 8 12:19:11 2015 -0500

Files Changed: 2
Lines Added: 7
Lines Removed: 0
Total Changes: 7
