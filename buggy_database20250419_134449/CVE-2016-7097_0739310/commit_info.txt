Commit Hash: 073931017b49d9458aa351605b43a7e34598caef
Subject: posix_acl: Clear SGID bit when setting file permissions

CVE Identifiers:
- CVE-2016-7097

Security Keywords:
- bypass

Full commit message:
posix_acl: Clear SGID bit when setting file permissions

When file permissions are modified via chmod(2) and the user is not in
the owning group or capable of CAP_FSETID, the setgid bit is cleared in
inode_change_ok().  Setting a POSIX ACL via setxattr(2) sets the file
permissions as well as the new ACL, but doesn't clear the setgid bit in
a similar way; this allows to bypass the check in chmod(2).  Fix that.

References: CVE-2016-7097
Reviewed-by: Christoph Hellwig <hch@lst.de>
Reviewed-by: Jeff Layton <jlayton@redhat.com>
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Andreas Gruenbacher <agruenba@redhat.com>

Metadata:
Author: Jan Kara <jack@suse.cz>
Author Date: Mon Sep 19 17:39:09 2016 +0200
Committer: Jan Kara <jack@suse.cz>
Commit Date: Thu Sep 22 10:55:32 2016 +0200

Files Changed: 16
Lines Added: 89
Lines Removed: 102
Total Changes: 191
