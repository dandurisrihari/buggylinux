Commit Hash: 1b683b551209ca46ae59b29572018001db5af078
Subject: [NETFILTER]: sip conntrack: better NAT handling


Security Keywords:
- authentication

Full commit message:
[NETFILTER]: sip conntrack: better NAT handling

The NAT handling of the SIP helper has a few problems:

- Request headers are only mangled in the reply direction, From/To headers
  not at all, which can lead to authentication failures with DNAT in case
  the authentication domain is the IP address

- Contact headers in responses are only mangled for REGISTER responses

- Headers may be mangled even though they contain addresses not
  participating in the connection, like alternative addresses

- Packets are droppen when domain names are used where the helper expects
  IP addresses

This patch takes a different approach, instead of fixed rules what field
to mangle to what content, it adds symetric mapping of From/To/Via/Contact
headers, which allows to deal properly with echoed addresses in responses
and foreign addresses not belonging to the connection.

Signed-off-by: Patrick McHardy <kaber@trash.net>

Metadata:
Author: Patrick McHardy <kaber@trash.net>
Author Date: Wed Nov 29 02:35:30 2006 +0100
Committer: David S. Miller <davem@sunset.davemloft.net>
Commit Date: Sat Dec 2 21:31:26 2006 -0800

Files Changed: 3
Lines Added: 135
Lines Removed: 70
Total Changes: 205
