{
  "hash": "1b683b551209ca46ae59b29572018001db5af078",
  "hash_short": "1b683b55",
  "subject": "[NETFILTER]: sip conntrack: better NAT handling",
  "body": "The NAT handling of the SIP helper has a few problems:\n\n- Request headers are only mangled in the reply direction, From/To headers\n  not at all, which can lead to authentication failures with DNAT in case\n  the authentication domain is the IP address\n\n- Contact headers in responses are only mangled for REGISTER responses\n\n- Headers may be mangled even though they contain addresses not\n  participating in the connection, like alternative addresses\n\n- Packets are droppen when domain names are used where the helper expects\n  IP addresses\n\nThis patch takes a different approach, instead of fixed rules what field\nto mangle to what content, it adds symetric mapping of From/To/Via/Contact\nheaders, which allows to deal properly with echoed addresses in responses\nand foreign addresses not belonging to the connection.\n\nSigned-off-by: Patrick McHardy <kaber@trash.net>",
  "full_message": "[NETFILTER]: sip conntrack: better NAT handling\n\nThe NAT handling of the SIP helper has a few problems:\n\n- Request headers are only mangled in the reply direction, From/To headers\n  not at all, which can lead to authentication failures with DNAT in case\n  the authentication domain is the IP address\n\n- Contact headers in responses are only mangled for REGISTER responses\n\n- Headers may be mangled even though they contain addresses not\n  participating in the connection, like alternative addresses\n\n- Packets are droppen when domain names are used where the helper expects\n  IP addresses\n\nThis patch takes a different approach, instead of fixed rules what field\nto mangle to what content, it adds symetric mapping of From/To/Via/Contact\nheaders, which allows to deal properly with echoed addresses in responses\nand foreign addresses not belonging to the connection.\n\nSigned-off-by: Patrick McHardy <kaber@trash.net>",
  "author_name": "Patrick McHardy",
  "author_email": "kaber@trash.net",
  "author_date": "Wed Nov 29 02:35:30 2006 +0100",
  "author_date_iso": "2006-11-29T02:35:30+01:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@sunset.davemloft.net",
  "committer_date": "Sat Dec 2 21:31:26 2006 -0800",
  "committer_date_iso": "2006-12-02T21:31:26-08:00",
  "files_changed": [
    "include/linux/netfilter_ipv4/ip_conntrack_sip.h",
    "net/ipv4/netfilter/ip_conntrack_sip.c",
    "net/ipv4/netfilter/ip_nat_sip.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "include/linux/netfilter_ipv4/ip_conntrack_sip.h",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "net/ipv4/netfilter/ip_conntrack_sip.c",
      "insertions": 27,
      "deletions": 2
    },
    {
      "file": "net/ipv4/netfilter/ip_nat_sip.c",
      "insertions": 104,
      "deletions": 67
    }
  ],
  "total_insertions": 135,
  "total_deletions": 70,
  "total_changes": 205,
  "parents": [
    "77a78dec48386ce958196bf69f192ee76537c07d"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.20",
    "v2.6.20-rc1",
    "v2.6.20-rc2",
    "v2.6.20-rc3",
    "v2.6.20-rc4",
    "v2.6.20-rc5",
    "v2.6.20-rc6",
    "v2.6.20-rc7",
    "v2.6.21",
    "v2.6.21-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/linux/netfilter_ipv4/ip_conntrack_sip.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/netfilter/ip_conntrack_sip.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/netfilter/ip_nat_sip.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}