Commit Hash: a47dd5f06714c844b33f3b5f517b6f3e81ce57b5
Subject: x86/KVM/VMX: Add L1D flush algorithm


Security Keywords:
- vulnerability

Full commit message:
x86/KVM/VMX: Add L1D flush algorithm

To mitigate the L1 Terminal Fault vulnerability it's required to flush L1D
on VMENTER to prevent rogue guests from snooping host memory.

CPUs will have a new control MSR via a microcode update to flush L1D with a
single MSR write, but in the absence of microcode a fallback to a software
based flush algorithm is required.

Add a software flush loop which is based on code from Intel.

[ tglx: Split out from combo patch ]
[ bpetkov: Polish the asm code ]

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

Metadata:
Author: Paolo Bonzini <pbonzini@redhat.com>
Author Date: Mon Jul 2 12:47:38 2018 +0200
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Wed Jul 4 20:49:38 2018 +0200

Files Changed: 1
Lines Added: 66
Lines Removed: 5
Total Changes: 71
