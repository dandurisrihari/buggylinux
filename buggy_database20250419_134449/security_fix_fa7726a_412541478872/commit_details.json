{
  "hash": "fa7726a4d9b91e0a8fb6fbbd819cd20f116f6c21",
  "hash_short": "fa7726a4",
  "subject": "i3c: replace deprecated strncpy",
  "body": "`strncpy` is deprecated for use on NUL-terminated destination strings [1].\n\nWe should prefer more robust and less ambiguous string interfaces.\n\nWe expect adap->name to be NUL-terminated based on i2c_adapter name use:\n| dev_dbg(&adap->dev, \"adapter [%s] registered\\n\", adap->name);\n\nNUL-padding does not seem to be required as `master` is zero-allocated\nand `i3c_master_to_i2c_adapter` simply returns a field from within\n`master`:\n|       master = devm_kzalloc(dev, sizeof(*master), GFP_KERNEL);\n...\n|      \tstruct i2c_adapter *adap = i3c_master_to_i2c_adapter(master);\n...\n|       static struct i2c_adapter *\n|       i3c_master_to_i2c_adapter(struct i3c_master_controller *master)\n|       {\n|       \treturn &master->i2c;\n|       }\n\nThis means that `adap->name` should already be filled with NUL-bytes.\n\nConsidering the above, a suitable replacement is `strscpy` [2] due to\nthe fact that it guarantees NUL-termination on the destination buffer\nwithout unnecessarily NUL-padding.\n\nLink: https://www.kernel.org/doc/html/latest/process/deprecated.html#strncpy-on-nul-terminated-strings [1]\nLink: https://manpages.debian.org/testing/linux-manual-4.8/strscpy.9.en.html [2]\nLink: https://github.com/KSPP/linux/issues/90\nCc: linux-hardening@vger.kernel.org\nSigned-off-by: Justin Stitt <justinstitt@google.com>\nReviewed-by: Kees Cook <keescook@chromium.org>\nLink: https://lore.kernel.org/r/20230921-strncpy-drivers-i3c-master-c-v1-1-9fdb8d8169e1@google.com\nSigned-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>",
  "full_message": "i3c: replace deprecated strncpy\n\n`strncpy` is deprecated for use on NUL-terminated destination strings [1].\n\nWe should prefer more robust and less ambiguous string interfaces.\n\nWe expect adap->name to be NUL-terminated based on i2c_adapter name use:\n| dev_dbg(&adap->dev, \"adapter [%s] registered\\n\", adap->name);\n\nNUL-padding does not seem to be required as `master` is zero-allocated\nand `i3c_master_to_i2c_adapter` simply returns a field from within\n`master`:\n|       master = devm_kzalloc(dev, sizeof(*master), GFP_KERNEL);\n...\n|      \tstruct i2c_adapter *adap = i3c_master_to_i2c_adapter(master);\n...\n|       static struct i2c_adapter *\n|       i3c_master_to_i2c_adapter(struct i3c_master_controller *master)\n|       {\n|       \treturn &master->i2c;\n|       }\n\nThis means that `adap->name` should already be filled with NUL-bytes.\n\nConsidering the above, a suitable replacement is `strscpy` [2] due to\nthe fact that it guarantees NUL-termination on the destination buffer\nwithout unnecessarily NUL-padding.\n\nLink: https://www.kernel.org/doc/html/latest/process/deprecated.html#strncpy-on-nul-terminated-strings [1]\nLink: https://manpages.debian.org/testing/linux-manual-4.8/strscpy.9.en.html [2]\nLink: https://github.com/KSPP/linux/issues/90\nCc: linux-hardening@vger.kernel.org\nSigned-off-by: Justin Stitt <justinstitt@google.com>\nReviewed-by: Kees Cook <keescook@chromium.org>\nLink: https://lore.kernel.org/r/20230921-strncpy-drivers-i3c-master-c-v1-1-9fdb8d8169e1@google.com\nSigned-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>",
  "author_name": "Justin Stitt",
  "author_email": "justinstitt@google.com",
  "author_date": "Thu Sep 21 03:51:04 2023 +0000",
  "author_date_iso": "2023-09-21T03:51:04+00:00",
  "committer_name": "Alexandre Belloni",
  "committer_email": "alexandre.belloni@bootlin.com",
  "committer_date": "Mon Sep 25 23:32:02 2023 +0200",
  "committer_date_iso": "2023-09-25T23:32:02+02:00",
  "files_changed": [
    "drivers/i3c/master.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/i3c/master.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "4bd8405257da717cd556f99e5fb68693d12c9766"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/i3c/master.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}