Commit Hash: bcca852027e5878aec911a347407ecc88d6fff7f
Subject: wifi: cfg80211: avoid nontransmitted BSS list corruption

CVE Identifiers:
- CVE-2022-42721

Full commit message:
wifi: cfg80211: avoid nontransmitted BSS list corruption

If a non-transmitted BSS shares enough information (both
SSID and BSSID!) with another non-transmitted BSS of a
different AP, then we can find and update it, and then
try to add it to the non-transmitted BSS list. We do a
search for it on the transmitted BSS, but if it's not
there (but belongs to another transmitted BSS), the list
gets corrupted.

Since this is an erroneous situation, simply fail the
list insertion in this case and free the non-transmitted
BSS.

This fixes CVE-2022-42721.

Reported-by: Sönke Huster <shuster@seemoo.tu-darmstadt.de>
Tested-by: Sönke Huster <shuster@seemoo.tu-darmstadt.de>
Fixes: 0b8fb8235be8 ("cfg80211: Parsing of Multiple BSSID information in scanning")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Sat Oct 1 00:01:44 2022 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Mon Oct 10 09:51:01 2022 +0200

Files Changed: 1
Lines Added: 9
Lines Removed: 0
Total Changes: 9
