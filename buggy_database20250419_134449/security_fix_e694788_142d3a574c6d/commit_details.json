{
  "hash": "e694788d73efe139b24f78b036deb97fe57fa8cb",
  "hash_short": "e694788d",
  "subject": "Bluetooth: Fix check for connection encryption",
  "body": "The conn->link_key variable tracks the type of link key in use. It is\nset whenever we respond to a link key request as well as when we get a\nlink key notification event.\n\nThese two events do not however always guarantee that encryption is\nenabled: getting a link key request and responding to it may only mean\nthat the remote side has requested authentication but not encryption. On\nthe other hand, the encrypt change event is a certain guarantee that\nencryption is enabled. The real encryption state is already tracked in\nthe conn->link_mode variable through the HCI_LM_ENCRYPT bit.\n\nThis patch fixes a check for encryption in the hci_conn_auth function to\nuse the proper conn->link_mode value and thereby eliminates the chance\nof a false positive result.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nCc: stable@vger.kernel.org",
  "full_message": "Bluetooth: Fix check for connection encryption\n\nThe conn->link_key variable tracks the type of link key in use. It is\nset whenever we respond to a link key request as well as when we get a\nlink key notification event.\n\nThese two events do not however always guarantee that encryption is\nenabled: getting a link key request and responding to it may only mean\nthat the remote side has requested authentication but not encryption. On\nthe other hand, the encrypt change event is a certain guarantee that\nencryption is enabled. The real encryption state is already tracked in\nthe conn->link_mode variable through the HCI_LM_ENCRYPT bit.\n\nThis patch fixes a check for encryption in the hci_conn_auth function to\nuse the proper conn->link_mode value and thereby eliminates the chance\nof a false positive result.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nCc: stable@vger.kernel.org",
  "author_name": "Johan Hedberg",
  "author_email": "johan.hedberg@intel.com",
  "author_date": "Tue Jun 10 09:54:24 2014 +0300",
  "author_date_iso": "2014-06-10T09:54:24+03:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Fri Jun 13 13:30:39 2014 +0200",
  "committer_date_iso": "2014-06-13T13:30:39+02:00",
  "files_changed": [
    "net/bluetooth/hci_conn.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "b62b65055bcc5372d5c3f4103629176cb8db3678"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.16",
    "v3.16-rc3",
    "v3.16-rc4",
    "v3.16-rc5",
    "v3.16-rc6",
    "v3.16-rc7",
    "v3.17",
    "v3.17-rc1",
    "v3.17-rc2",
    "v3.17-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}