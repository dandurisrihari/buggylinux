{
  "hash": "94034c40ab4a3fcf581fbc7f8fdf4e29943c4a24",
  "hash_short": "94034c40",
  "subject": "mac80211: prevent mixed key and fragment cache attacks",
  "body": "Simultaneously prevent mixed key attacks (CVE-2020-24587) and fragment\ncache attacks (CVE-2020-24586). This is accomplished by assigning a\nunique color to every key (per interface) and using this to track which\nkey was used to decrypt a fragment. When reassembling frames, it is\nnow checked whether all fragments were decrypted using the same key.\n\nTo assure that fragment cache attacks are also prevented, the ID that is\nassigned to keys is unique even over (re)associations and (re)connects.\nThis means fragments separated by a (re)association or (re)connect will\nnot be reassembled. Because mac80211 now also prevents the reassembly of\nmixed encrypted and plaintext fragments, all cache attacks are prevented.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>\nLink: https://lore.kernel.org/r/20210511200110.3f8290e59823.I622a67769ed39257327a362cfc09c812320eb979@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: prevent mixed key and fragment cache attacks\n\nSimultaneously prevent mixed key attacks (CVE-2020-24587) and fragment\ncache attacks (CVE-2020-24586). This is accomplished by assigning a\nunique color to every key (per interface) and using this to track which\nkey was used to decrypt a fragment. When reassembling frames, it is\nnow checked whether all fragments were decrypted using the same key.\n\nTo assure that fragment cache attacks are also prevented, the ID that is\nassigned to keys is unique even over (re)associations and (re)connects.\nThis means fragments separated by a (re)association or (re)connect will\nnot be reassembled. Because mac80211 now also prevents the reassembly of\nmixed encrypted and plaintext fragments, all cache attacks are prevented.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>\nLink: https://lore.kernel.org/r/20210511200110.3f8290e59823.I622a67769ed39257327a362cfc09c812320eb979@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Mathy Vanhoef",
  "author_email": "Mathy.Vanhoef@kuleuven.be",
  "author_date": "Tue May 11 20:02:43 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:43+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:12:51 2021 +0200",
  "committer_date_iso": "2021-05-11T20:12:51+02:00",
  "files_changed": [
    "net/mac80211/ieee80211_i.h",
    "net/mac80211/key.c",
    "net/mac80211/key.h",
    "net/mac80211/rx.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/mac80211/key.c",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "net/mac80211/key.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "net/mac80211/rx.c",
      "insertions": 6,
      "deletions": 0
    }
  ],
  "total_insertions": 16,
  "total_deletions": 0,
  "total_changes": 16,
  "parents": [
    "965a7d72e798eb7af0aa67210e37cf7ecd1c9cad"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-24587",
      "CVE-2020-24586"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/key.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/key.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/rx.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}