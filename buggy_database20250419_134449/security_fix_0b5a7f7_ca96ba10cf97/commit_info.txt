Commit Hash: 0b5a7f71b4c557b15ec54a1b49023bc1b21044cc
Subject: crypto: crypto4xx - perform aead icv check in the driver


Security Keywords:
- authentication

Full commit message:
crypto: crypto4xx - perform aead icv check in the driver

The ccm-aes-ppc4xx now fails one of testmgr's expected
failure test cases as such:

|decryption failed on test 10 for ccm-aes-ppc4xx:
|ret was 0, |expected -EBADMSG

It doesn't look like the hardware sets the authentication failure
flag. The original vendor source from which this was ported does
not have any special code or notes about why this would happen or
if there are any WAs.

Hence, this patch converts the aead_done callback handler to
perform the icv check in the driver. And this fixes the false
negative and the ccm-aes-ppc4xx passes the selftests once again.

|name         : ccm(aes)
|driver       : ccm-aes-ppc4xx
|module       : crypto4xx
|priority     : 300
|refcnt       : 1
|selftest     : passed
|internal     : no
|type         : aead
|async        : yes
|blocksize    : 1
|ivsize       : 16
|maxauthsize  : 16
|geniv        : <none>

Signed-off-by: Christian Lamparter <chunkeey@gmail.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

Metadata:
Author: Christian Lamparter <chunkeey@gmail.com>
Author Date: Sat Dec 23 19:45:46 2017 +0100
Committer: Herbert Xu <herbert@gondor.apana.org.au>
Commit Date: Fri Jan 5 18:43:05 2018 +1100

Files Changed: 2
Lines Added: 28
Lines Removed: 32
Total Changes: 60
