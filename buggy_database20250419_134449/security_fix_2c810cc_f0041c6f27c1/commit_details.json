{
  "hash": "2c810ccdbac434ae38f4ec5331d3f047dc90f98a",
  "hash_short": "2c810ccd",
  "subject": "iwlwifi: rework broadcast station management",
  "body": "Currently, the broadcast station is managed along\nwith the interface type, rather than always being\npresent. That leads to a bug with injection -- it\nis currently not possible to inject frames when\nthe only virtual interface is a monitor, because\nin that the required broadcast station is missing.\n\nAdditionally, allocating and deallocating the\nbroadcast station's LQ all the time is wasteful,\nand the code to support this is fairly complex.\n\nSo this changes completely the way we manage the\nbroadcast station. Rather than manage it along\nwith any interface, we now allocate it when we\nbring the device up, and remove it again when we\nbring the device down. When we bring the device\nup, we don't immediately program the broadcast\nstation into it, instead we just mark it active\nand rely on the next restore cycle to upload it\nto the device. This works because an unassociated\nRXON is always required at least once to set up\ndevice parameters, which implies a reprogramming\nof stations into the device.\n\nAs we now manage all stations properly, there no\nlonger is a need for forcing a clearing of them\nvia iwl_clear_ucode_stations(), which can become\na lot simpler.\n\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\nSigned-off-by: Reinette Chatre <reinette.chatre@intel.com>",
  "full_message": "iwlwifi: rework broadcast station management\n\nCurrently, the broadcast station is managed along\nwith the interface type, rather than always being\npresent. That leads to a bug with injection -- it\nis currently not possible to inject frames when\nthe only virtual interface is a monitor, because\nin that the required broadcast station is missing.\n\nAdditionally, allocating and deallocating the\nbroadcast station's LQ all the time is wasteful,\nand the code to support this is fairly complex.\n\nSo this changes completely the way we manage the\nbroadcast station. Rather than manage it along\nwith any interface, we now allocate it when we\nbring the device up, and remove it again when we\nbring the device down. When we bring the device\nup, we don't immediately program the broadcast\nstation into it, instead we just mark it active\nand rely on the next restore cycle to upload it\nto the device. This works because an unassociated\nRXON is always required at least once to set up\ndevice parameters, which implies a reprogramming\nof stations into the device.\n\nAs we now manage all stations properly, there no\nlonger is a need for forcing a clearing of them\nvia iwl_clear_ucode_stations(), which can become\na lot simpler.\n\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\nSigned-off-by: Reinette Chatre <reinette.chatre@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Thu Apr 29 00:53:29 2010 -0700",
  "author_date_iso": "2010-04-29T00:53:29-07:00",
  "committer_name": "Reinette Chatre",
  "committer_email": "reinette.chatre@intel.com",
  "committer_date": "Mon May 10 15:09:02 2010 -0700",
  "committer_date_iso": "2010-05-10T15:09:02-07:00",
  "files_changed": [
    "drivers/net/wireless/iwlwifi/iwl-1000.c",
    "drivers/net/wireless/iwlwifi/iwl-3945.c",
    "drivers/net/wireless/iwlwifi/iwl-4965.c",
    "drivers/net/wireless/iwlwifi/iwl-5000.c",
    "drivers/net/wireless/iwlwifi/iwl-6000.c",
    "drivers/net/wireless/iwlwifi/iwl-agn.c",
    "drivers/net/wireless/iwlwifi/iwl-core.c",
    "drivers/net/wireless/iwlwifi/iwl-core.h",
    "drivers/net/wireless/iwlwifi/iwl-sta.c",
    "drivers/net/wireless/iwlwifi/iwl-sta.h",
    "drivers/net/wireless/iwlwifi/iwl3945-base.c"
  ],
  "files_changed_count": 11,
  "stats": [
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-1000.c",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-3945.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-4965.c",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-5000.c",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-6000.c",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-agn.c",
      "insertions": 8,
      "deletions": 4
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-core.c",
      "insertions": 0,
      "deletions": 7
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-core.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-sta.c",
      "insertions": 67,
      "deletions": 70
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-sta.h",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl3945-base.c",
      "insertions": 6,
      "deletions": 2
    }
  ],
  "total_insertions": 89,
  "total_deletions": 99,
  "total_changes": 188,
  "parents": [
    "a6a0345c837346d1b74f4907d4747e6c1053a99f"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.35",
    "v2.6.35-rc1",
    "v2.6.35-rc2",
    "v2.6.35-rc3",
    "v2.6.35-rc4",
    "v2.6.35-rc5",
    "v2.6.35-rc6",
    "v2.6.36",
    "v2.6.36-rc1",
    "v2.6.36-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-6000.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-1000.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-4965.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-agn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-5000.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-3945.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-core.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-sta.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl-sta.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/iwl3945-base.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}