Commit Hash: 2c810ccdbac434ae38f4ec5331d3f047dc90f98a
Subject: iwlwifi: rework broadcast station management


Security Keywords:
- injection

Full commit message:
iwlwifi: rework broadcast station management

Currently, the broadcast station is managed along
with the interface type, rather than always being
present. That leads to a bug with injection -- it
is currently not possible to inject frames when
the only virtual interface is a monitor, because
in that the required broadcast station is missing.

Additionally, allocating and deallocating the
broadcast station's LQ all the time is wasteful,
and the code to support this is fairly complex.

So this changes completely the way we manage the
broadcast station. Rather than manage it along
with any interface, we now allocate it when we
bring the device up, and remove it again when we
bring the device down. When we bring the device
up, we don't immediately program the broadcast
station into it, instead we just mark it active
and rely on the next restore cycle to upload it
to the device. This works because an unassociated
RXON is always required at least once to set up
device parameters, which implies a reprogramming
of stations into the device.

As we now manage all stations properly, there no
longer is a need for forcing a clearing of them
via iwl_clear_ucode_stations(), which can become
a lot simpler.

Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Reinette Chatre <reinette.chatre@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Thu Apr 29 00:53:29 2010 -0700
Committer: Reinette Chatre <reinette.chatre@intel.com>
Commit Date: Mon May 10 15:09:02 2010 -0700

Files Changed: 11
Lines Added: 89
Lines Removed: 99
Total Changes: 188
