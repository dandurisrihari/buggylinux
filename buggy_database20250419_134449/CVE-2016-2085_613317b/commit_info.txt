Commit Hash: 613317bd212c585c20796c10afe5daaa95d4b0a1
Subject: EVM: Use crypto_memneq() for digest comparisons

CVE Identifiers:
- CVE-2016-2085

Security Keywords:
- vulnerability

Full commit message:
EVM: Use crypto_memneq() for digest comparisons

This patch fixes vulnerability CVE-2016-2085.  The problem exists
because the vm_verify_hmac() function includes a use of memcmp().
Unfortunately, this allows timing side channel attacks; specifically
a MAC forgery complexity drop from 2^128 to 2^12.  This patch changes
the memcmp() to the cryptographically safe crypto_memneq().

Reported-by: Xiaofei Rex Guo <xiaofei.rex.guo@intel.com>
Signed-off-by: Ryan Ware <ware@linux.intel.com>
Cc: stable@vger.kernel.org
Signed-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com>
Signed-off-by: James Morris <james.l.morris@oracle.com>

Metadata:
Author: Ryan Ware <ware@linux.intel.com>
Author Date: Thu Feb 11 15:58:44 2016 -0800
Committer: James Morris <james.l.morris@oracle.com>
Commit Date: Fri Feb 12 18:36:47 2016 +1100

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
