{
  "hash": "8f033d2becc24aa6bfd2a5c104407963560caabc",
  "hash_short": "8f033d2b",
  "subject": "wifi: cfg80211/mac80211: reject bad MBSSID elements",
  "body": "Per spec, the maximum value for the MaxBSSID ('n') indicator is 8,\nand the minimum is 1 since a multiple BSSID set with just one BSSID\ndoesn't make sense (the # of BSSIDs is limited by 2^n).\n\nLimit this in the parsing in both cfg80211 and mac80211, rejecting\nany elements with an invalid value.\n\nThis fixes potentially bad shifts in the processing of these inside\nthe cfg80211_gen_new_bssid() function later.\n\nI found this during the investigation of CVE-2022-41674 fixed by the\nprevious patch.\n\nFixes: 0b8fb8235be8 (\"cfg80211: Parsing of Multiple BSSID information in scanning\")\nFixes: 78ac51f81532 (\"mac80211: support multi-bssid\")\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: cfg80211/mac80211: reject bad MBSSID elements\n\nPer spec, the maximum value for the MaxBSSID ('n') indicator is 8,\nand the minimum is 1 since a multiple BSSID set with just one BSSID\ndoesn't make sense (the # of BSSIDs is limited by 2^n).\n\nLimit this in the parsing in both cfg80211 and mac80211, rejecting\nany elements with an invalid value.\n\nThis fixes potentially bad shifts in the processing of these inside\nthe cfg80211_gen_new_bssid() function later.\n\nI found this during the investigation of CVE-2022-41674 fixed by the\nprevious patch.\n\nFixes: 0b8fb8235be8 (\"cfg80211: Parsing of Multiple BSSID information in scanning\")\nFixes: 78ac51f81532 (\"mac80211: support multi-bssid\")\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Wed Sep 28 22:01:37 2022 +0200",
  "author_date_iso": "2022-09-28T22:01:37+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Mon Oct 10 09:50:15 2022 +0200",
  "committer_date_iso": "2022-10-10T09:50:15+02:00",
  "files_changed": [
    "net/mac80211/util.c",
    "net/wireless/scan.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/mac80211/util.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "net/wireless/scan.c",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 4,
  "total_deletions": 0,
  "total_changes": 4,
  "parents": [
    "aebe9f4639b13a1f4e9a6b42cdd2e38c617b442d"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-41674"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/util.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/wireless/scan.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}