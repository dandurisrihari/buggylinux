Commit Hash: 8f033d2becc24aa6bfd2a5c104407963560caabc
Subject: wifi: cfg80211/mac80211: reject bad MBSSID elements

CVE Identifiers:
- CVE-2022-41674

Full commit message:
wifi: cfg80211/mac80211: reject bad MBSSID elements

Per spec, the maximum value for the MaxBSSID ('n') indicator is 8,
and the minimum is 1 since a multiple BSSID set with just one BSSID
doesn't make sense (the # of BSSIDs is limited by 2^n).

Limit this in the parsing in both cfg80211 and mac80211, rejecting
any elements with an invalid value.

This fixes potentially bad shifts in the processing of these inside
the cfg80211_gen_new_bssid() function later.

I found this during the investigation of CVE-2022-41674 fixed by the
previous patch.

Fixes: 0b8fb8235be8 ("cfg80211: Parsing of Multiple BSSID information in scanning")
Fixes: 78ac51f81532 ("mac80211: support multi-bssid")
Reviewed-by: Kees Cook <keescook@chromium.org>
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Wed Sep 28 22:01:37 2022 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Mon Oct 10 09:50:15 2022 +0200

Files Changed: 2
Lines Added: 4
Lines Removed: 0
Total Changes: 4
