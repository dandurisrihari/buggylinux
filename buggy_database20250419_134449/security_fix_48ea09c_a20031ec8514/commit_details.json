{
  "hash": "48ea09cddae0b794cde2070f106ef676703dbcd3",
  "hash_short": "48ea09cd",
  "subject": "Merge tag 'hardening-v6.2-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux",
  "body": "Pull kernel hardening updates from Kees Cook:\n\n - Convert flexible array members, fix -Wstringop-overflow warnings, and\n   fix KCFI function type mismatches that went ignored by maintainers\n   (Gustavo A. R. Silva, Nathan Chancellor, Kees Cook)\n\n - Remove the remaining side-effect users of ksize() by converting\n   dma-buf, btrfs, and coredump to using kmalloc_size_roundup(), add\n   more __alloc_size attributes, and introduce full testing of all\n   allocator functions. Finally remove the ksize() side-effect so that\n   each allocation-aware checker can finally behave without exceptions\n\n - Introduce oops_limit (default 10,000) and warn_limit (default off) to\n   provide greater granularity of control for panic_on_oops and\n   panic_on_warn (Jann Horn, Kees Cook)\n\n - Introduce overflows_type() and castable_to_type() helpers for cleaner\n   overflow checking\n\n - Improve code generation for strscpy() and update str*() kern-doc\n\n - Convert strscpy and sigphash tests to KUnit, and expand memcpy tests\n\n - Always use a non-NULL argument for prepare_kernel_cred()\n\n - Disable structleak plugin in FORTIFY KUnit test (Anders Roxell)\n\n - Adjust orphan linker section checking to respect CONFIG_WERROR (Xin\n   Li)\n\n - Make sure siginfo is cleared for forced SIGKILL (haifeng.xu)\n\n - Fix um vs FORTIFY warnings for always-NULL arguments\n\n* tag 'hardening-v6.2-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux: (31 commits)\n  ksmbd: replace one-element arrays with flexible-array members\n  hpet: Replace one-element array with flexible-array member\n  um: virt-pci: Avoid GCC non-NULL warning\n  signal: Initialize the info in ksignal\n  lib: fortify_kunit: build without structleak plugin\n  panic: Expose \"warn_count\" to sysfs\n  panic: Introduce warn_limit\n  panic: Consolidate open-coded panic_on_warn checks\n  exit: Allow oops_limit to be disabled\n  exit: Expose \"oops_count\" to sysfs\n  exit: Put an upper limit on how often we can oops\n  panic: Separate sysctl logic from CONFIG_SMP\n  mm/pgtable: Fix multiple -Wstringop-overflow warnings\n  mm: Make ksize() a reporting-only function\n  kunit/fortify: Validate __alloc_size attribute results\n  drm/sti: Fix return type of sti_{dvo,hda,hdmi}_connector_mode_valid()\n  drm/fsl-dcu: Fix return type of fsl_dcu_drm_connector_mode_valid()\n  driver core: Add __alloc_size hint to devm allocators\n  overflow: Introduce overflows_type() and castable_to_type()\n  coredump: Proactively round up to kmalloc bucket size\n  ...",
  "full_message": "Merge tag 'hardening-v6.2-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux\n\nPull kernel hardening updates from Kees Cook:\n\n - Convert flexible array members, fix -Wstringop-overflow warnings, and\n   fix KCFI function type mismatches that went ignored by maintainers\n   (Gustavo A. R. Silva, Nathan Chancellor, Kees Cook)\n\n - Remove the remaining side-effect users of ksize() by converting\n   dma-buf, btrfs, and coredump to using kmalloc_size_roundup(), add\n   more __alloc_size attributes, and introduce full testing of all\n   allocator functions. Finally remove the ksize() side-effect so that\n   each allocation-aware checker can finally behave without exceptions\n\n - Introduce oops_limit (default 10,000) and warn_limit (default off) to\n   provide greater granularity of control for panic_on_oops and\n   panic_on_warn (Jann Horn, Kees Cook)\n\n - Introduce overflows_type() and castable_to_type() helpers for cleaner\n   overflow checking\n\n - Improve code generation for strscpy() and update str*() kern-doc\n\n - Convert strscpy and sigphash tests to KUnit, and expand memcpy tests\n\n - Always use a non-NULL argument for prepare_kernel_cred()\n\n - Disable structleak plugin in FORTIFY KUnit test (Anders Roxell)\n\n - Adjust orphan linker section checking to respect CONFIG_WERROR (Xin\n   Li)\n\n - Make sure siginfo is cleared for forced SIGKILL (haifeng.xu)\n\n - Fix um vs FORTIFY warnings for always-NULL arguments\n\n* tag 'hardening-v6.2-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/kees/linux: (31 commits)\n  ksmbd: replace one-element arrays with flexible-array members\n  hpet: Replace one-element array with flexible-array member\n  um: virt-pci: Avoid GCC non-NULL warning\n  signal: Initialize the info in ksignal\n  lib: fortify_kunit: build without structleak plugin\n  panic: Expose \"warn_count\" to sysfs\n  panic: Introduce warn_limit\n  panic: Consolidate open-coded panic_on_warn checks\n  exit: Allow oops_limit to be disabled\n  exit: Expose \"oops_count\" to sysfs\n  exit: Put an upper limit on how often we can oops\n  panic: Separate sysctl logic from CONFIG_SMP\n  mm/pgtable: Fix multiple -Wstringop-overflow warnings\n  mm: Make ksize() a reporting-only function\n  kunit/fortify: Validate __alloc_size attribute results\n  drm/sti: Fix return type of sti_{dvo,hda,hdmi}_connector_mode_valid()\n  drm/fsl-dcu: Fix return type of fsl_dcu_drm_connector_mode_valid()\n  driver core: Add __alloc_size hint to devm allocators\n  overflow: Introduce overflows_type() and castable_to_type()\n  coredump: Proactively round up to kmalloc bucket size\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Wed Dec 14 12:20:00 2022 -0800",
  "author_date_iso": "2022-12-14T12:20:00-08:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Wed Dec 14 12:20:00 2022 -0800",
  "committer_date_iso": "2022-12-14T12:20:00-08:00",
  "files_changed": [
    "Documentation/admin-guide/sysctl/kernel.rst",
    "Documentation/core-api/kernel-api.rst",
    "MAINTAINERS",
    "Makefile",
    "arch/arm/boot/compressed/Makefile",
    "arch/x86/boot/compressed/Makefile",
    "drivers/gpu/drm/sti/sti_dvo.c",
    "drivers/gpu/drm/sti/sti_hda.c",
    "drivers/gpu/drm/sti/sti_hdmi.c",
    "fs/btrfs/send.c",
    "fs/cifs/cifsacl.c",
    "fs/coredump.c",
    "fs/ksmbd/smb2pdu.c",
    "fs/nfsd/nfs4callback.c",
    "include/linux/device.h",
    "include/linux/fortify-string.h",
    "init/Kconfig",
    "kernel/panic.c",
    "kernel/sched/core.c",
    "kernel/signal.c",
    "lib/Kconfig.debug",
    "lib/Makefile",
    "lib/memcpy_kunit.c",
    "mm/kasan/kasan_test.c",
    "mm/kasan/report.c",
    "mm/kfence/report.c",
    "mm/slab_common.c",
    "scripts/kernel-doc"
  ],
  "files_changed_count": 28,
  "stats": [
    {
      "file": "Documentation/ABI/testing/sysfs-kernel-oops_count",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "Documentation/ABI/testing/sysfs-kernel-warn_count",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "Documentation/admin-guide/sysctl/kernel.rst",
      "insertions": 19,
      "deletions": 0
    },
    {
      "file": "Documentation/core-api/kernel-api.rst",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "MAINTAINERS",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/arm/boot/compressed/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kernel/vdso/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/arm64/kernel/vdso32/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/um/drivers/virt-pci.c",
      "insertions": 6,
      "deletions": 3
    },
    {
      "file": "arch/x86/boot/compressed/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/x86/mm/pgtable.c",
      "insertions": 13,
      "deletions": 9
    },
    {
      "file": "drivers/base/firmware_loader/main.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/dma-buf/dma-resv.c",
      "insertions": 7,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/fsl-dcu/fsl_dcu_drm_rgb.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/i915_user_extensions.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_utils.h",
      "insertions": 0,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/sti/sti_dvo.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/sti/sti_hda.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/sti/sti_hdmi.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "fs/btrfs/send.c",
      "insertions": 6,
      "deletions": 5
    },
    {
      "file": "fs/cifs/cifs_spnego.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/cifs/cifsacl.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/coredump.c",
      "insertions": 5,
      "deletions": 2
    },
    {
      "file": "fs/ksmbd/smb2pdu.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "fs/ksmbd/smb2pdu.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/ksmbd/smb_common.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/ksmbd/smb_common.h",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "fs/nfs/flexfilelayout/flexfilelayout.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "fs/nfs/nfs4idmap.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/nfsd/nfs4callback.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/compiler.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/linux/device.h",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "include/linux/fortify-string.h",
      "insertions": 136,
      "deletions": 12
    },
    {
      "file": "include/linux/hpet.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/overflow.h",
      "insertions": 47,
      "deletions": 0
    },
    {
      "file": "include/linux/panic.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/linux/string.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "init/Kconfig",
      "insertions": 12,
      "deletions": 3
    },
    {
      "file": "kernel/cred.c",
      "insertions": 7,
      "deletions": 8
    },
    {
      "file": "kernel/exit.c",
      "insertions": 60,
      "deletions": 0
    },
    {
      "file": "kernel/kcsan/report.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "kernel/panic.c",
      "insertions": 42,
      "deletions": 3
    },
    {
      "file": "kernel/sched/core.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "kernel/signal.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "lib/Kconfig.debug",
      "insertions": 16,
      "deletions": 12
    },
    {
      "file": "lib/Makefile",
      "insertions": 5,
      "deletions": 2
    },
    {
      "file": "lib/fortify_kunit.c",
      "insertions": 255,
      "deletions": 0
    },
    {
      "file": "lib/memcpy_kunit.c",
      "insertions": 205,
      "deletions": 0
    },
    {
      "file": "lib/overflow_kunit.c",
      "insertions": 381,
      "deletions": 0
    },
    {
      "file": "lib/{test_siphash.c => siphash_kunit.c}",
      "insertions": 70,
      "deletions": 95
    },
    {
      "file": "lib/string.c",
      "insertions": 0,
      "deletions": 82
    },
    {
      "file": "lib/strscpy_kunit.c",
      "insertions": 142,
      "deletions": 0
    },
    {
      "file": "lib/test_strscpy.c",
      "insertions": 0,
      "deletions": 150
    },
    {
      "file": "lib/ubsan.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "mm/kasan/kasan_test.c",
      "insertions": 13,
      "deletions": 6
    },
    {
      "file": "mm/kasan/report.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "mm/kfence/report.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "mm/slab_common.c",
      "insertions": 10,
      "deletions": 16
    },
    {
      "file": "net/dns_resolver/dns_key.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "scripts/kernel-doc",
      "insertions": 5,
      "deletions": 1
    }
  ],
  "total_insertions": 1533,
  "total_deletions": 463,
  "total_changes": 1996,
  "parents": [
    "ad76bf1ff18e059d64b70047940d298641d4cc2f",
    "d272e01fa0a2f15c5c331a37cd99c6875c7b7186"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "Documentation/core-api/kernel-api.rst",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm/boot/compressed/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/boot/compressed/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "Documentation/admin-guide/sysctl/kernel.rst",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/sti/sti_dvo.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/sti/sti_hda.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/cifsacl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "MAINTAINERS",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/ksmbd/smb2pdu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/coredump.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/sti/sti_hdmi.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/panic.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/btrfs/send.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/nfsd/nfs4callback.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "init/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/fortify-string.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/device.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/sched/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/Kconfig.debug",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/memcpy_kunit.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/signal.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "scripts/kernel-doc",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/kasan/kasan_test.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/kasan/report.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/kfence/report.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/slab_common.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}