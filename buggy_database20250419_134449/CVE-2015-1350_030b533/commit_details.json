{
  "hash": "030b533c4fd4d2ec3402363323de4bb2983c9cee",
  "hash_short": "030b533c",
  "subject": "fs: Avoid premature clearing of capabilities",
  "body": "Currently, notify_change() clears capabilities or IMA attributes by\ncalling security_inode_killpriv() before calling into ->setattr. Thus it\nhappens before any other permission checks in inode_change_ok() and user\nis thus allowed to trigger clearing of capabilities or IMA attributes\nfor any file he can look up e.g. by calling chown for that file. This is\nunexpected and can lead to user DoSing a system.\n\nFix the problem by calling security_inode_killpriv() at the end of\ninode_change_ok() instead of from notify_change(). At that moment we are\nsure user has permissions to do the requested change.\n\nReferences: CVE-2015-1350\nReviewed-by: Christoph Hellwig <hch@lst.de>\nSigned-off-by: Jan Kara <jack@suse.cz>",
  "full_message": "fs: Avoid premature clearing of capabilities\n\nCurrently, notify_change() clears capabilities or IMA attributes by\ncalling security_inode_killpriv() before calling into ->setattr. Thus it\nhappens before any other permission checks in inode_change_ok() and user\nis thus allowed to trigger clearing of capabilities or IMA attributes\nfor any file he can look up e.g. by calling chown for that file. This is\nunexpected and can lead to user DoSing a system.\n\nFix the problem by calling security_inode_killpriv() at the end of\ninode_change_ok() instead of from notify_change(). At that moment we are\nsure user has permissions to do the requested change.\n\nReferences: CVE-2015-1350\nReviewed-by: Christoph Hellwig <hch@lst.de>\nSigned-off-by: Jan Kara <jack@suse.cz>",
  "author_name": "Jan Kara",
  "author_email": "jack@suse.cz",
  "author_date": "Thu May 26 17:21:32 2016 +0200",
  "author_date_iso": "2016-05-26T17:21:32+02:00",
  "committer_name": "Jan Kara",
  "committer_email": "jack@suse.cz",
  "committer_date": "Thu Sep 22 10:56:19 2016 +0200",
  "committer_date_iso": "2016-09-22T10:56:19+02:00",
  "files_changed": [
    "fs/attr.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/attr.c",
      "insertions": 14,
      "deletions": 6
    }
  ],
  "total_insertions": 14,
  "total_deletions": 6,
  "total_changes": 20,
  "parents": [
    "31051c85b5e2aaaf6315f74c72a732673632a905"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2015-1350"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "fs/attr.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}