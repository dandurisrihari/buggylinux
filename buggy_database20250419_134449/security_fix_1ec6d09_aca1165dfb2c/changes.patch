diff --cc arch/s390/mm/dump_pagetables.c
index 0a67fcee4414,9e2dc42143b3..fa54f3bc0c8d
--- a/arch/s390/mm/dump_pagetables.c
+++ b/arch/s390/mm/dump_pagetables.c
@@@ -310,6 -247,34 +247,34 @@@ static int ptdump_cmp(const void *a, co
  	return 0;
  }
  
+ static int add_marker(unsigned long start, unsigned long end, const char *name)
+ {
+ 	size_t oldsize, newsize;
+ 
+ 	oldsize = markers_cnt * sizeof(*markers);
+ 	newsize = oldsize + 2 * sizeof(*markers);
+ 	if (!oldsize)
+ 		markers = kvmalloc(newsize, GFP_KERNEL);
+ 	else
 -		markers = kvrealloc(markers, oldsize, newsize, GFP_KERNEL);
++		markers = kvrealloc(markers, newsize, GFP_KERNEL);
+ 	if (!markers)
+ 		goto error;
+ 	markers[markers_cnt].is_start = 1;
+ 	markers[markers_cnt].start_address = start;
+ 	markers[markers_cnt].size = end - start;
+ 	markers[markers_cnt].name = name;
+ 	markers_cnt++;
+ 	markers[markers_cnt].is_start = 0;
+ 	markers[markers_cnt].start_address = end;
+ 	markers[markers_cnt].size = end - start;
+ 	markers[markers_cnt].name = name;
+ 	markers_cnt++;
+ 	return 0;
+ error:
+ 	markers_cnt = 0;
+ 	return -ENOMEM;
+ }
+ 
  static int pt_dump_init(void)
  {
  #ifdef CONFIG_KFENCE