Commit Hash: 8b964eae204d791421677ec56b94a7b18cf8740d
Subject: AppArmor: Fix underflow in xindex calculation


Security Keywords:
- exploit

Full commit message:
AppArmor: Fix underflow in xindex calculation

If the xindex value stored in the accept tables is 0, the extraction of
that value will result in an underflow (0 - 4).

In properly compiled policy this should not happen for file rules but
it may be possible for other rule types in the future.

To exploit this underflow a user would have to be able to load a corrupt
policy, which requires CAP_MAC_ADMIN, overwrite system policy in kernel
memory or know of a compiler error resulting in the flaw being present
for loaded policy (no such flaw is known at this time).

Signed-off-by: John Johansen <john.johansen@canonical.com>
Acked-by: Kees Cook <kees@ubuntu.com>

Metadata:
Author: John Johansen <john.johansen@canonical.com>
Author Date: Wed Feb 22 00:32:30 2012 -0800
Committer: John Johansen <john.johansen@canonical.com>
Commit Date: Mon Feb 27 11:38:21 2012 -0800

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
