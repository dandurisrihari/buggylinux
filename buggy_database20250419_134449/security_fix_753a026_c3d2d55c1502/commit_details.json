{
  "hash": "753a026cfec1429c9e32e004ae4d4c2727cc0111",
  "hash_short": "753a026c",
  "subject": "net: ocelot: add FDMA support",
  "body": "Ethernet frames can be extracted or injected autonomously to or from\nthe device\u2019s DDR3/DDR3L memory and/or PCIe memory space. Linked list\ndata structures in memory are used for injecting or extracting Ethernet\nframes. The FDMA generates interrupts when frame extraction or\ninjection is done and when the linked lists need updating.\n\nThe FDMA is shared between all the ethernet ports of the switch and\nuses a linked list of descriptors (DCB) to inject and extract packets.\nBefore adding descriptors, the FDMA channels must be stopped. It would\nbe inefficient to do that each time a descriptor would be added so the\nchannels are restarted only once they stopped.\n\nBoth channels uses ring-like structure to feed the DCBs to the FDMA.\nhead and tail are never touched by hardware and are completely handled\nby the driver. On top of that, page recycling has been added and is\nmostly taken from gianfar driver.\n\nReviewed-by: Vladimir Oltean <vladimir.oltean@nxp.com>\nCo-developed-by: Alexandre Belloni <alexandre.belloni@bootlin.com>\nSigned-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>\nSigned-off-by: Cl\u00e9ment L\u00e9ger <clement.leger@bootlin.com>\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "net: ocelot: add FDMA support\n\nEthernet frames can be extracted or injected autonomously to or from\nthe device\u2019s DDR3/DDR3L memory and/or PCIe memory space. Linked list\ndata structures in memory are used for injecting or extracting Ethernet\nframes. The FDMA generates interrupts when frame extraction or\ninjection is done and when the linked lists need updating.\n\nThe FDMA is shared between all the ethernet ports of the switch and\nuses a linked list of descriptors (DCB) to inject and extract packets.\nBefore adding descriptors, the FDMA channels must be stopped. It would\nbe inefficient to do that each time a descriptor would be added so the\nchannels are restarted only once they stopped.\n\nBoth channels uses ring-like structure to feed the DCBs to the FDMA.\nhead and tail are never touched by hardware and are completely handled\nby the driver. On top of that, page recycling has been added and is\nmostly taken from gianfar driver.\n\nReviewed-by: Vladimir Oltean <vladimir.oltean@nxp.com>\nCo-developed-by: Alexandre Belloni <alexandre.belloni@bootlin.com>\nSigned-off-by: Alexandre Belloni <alexandre.belloni@bootlin.com>\nSigned-off-by: Cl\u00e9ment L\u00e9ger <clement.leger@bootlin.com>\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Cl\u00e9ment L\u00e9ger",
  "author_email": "clement.leger@bootlin.com",
  "author_date": "Thu Dec 9 16:49:11 2021 +0100",
  "author_date_iso": "2021-12-09T16:49:11+01:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Fri Dec 10 20:56:58 2021 -0800",
  "committer_date_iso": "2021-12-10T20:56:58-08:00",
  "files_changed": [
    "drivers/net/ethernet/mscc/Makefile",
    "drivers/net/ethernet/mscc/ocelot_fdma.c",
    "drivers/net/ethernet/mscc/ocelot_fdma.h",
    "drivers/net/ethernet/mscc/ocelot_net.c",
    "drivers/net/ethernet/mscc/ocelot_vsc7514.c",
    "include/soc/mscc/ocelot.h"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "drivers/net/ethernet/mscc/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_fdma.c",
      "insertions": 894,
      "deletions": 0
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_fdma.h",
      "insertions": 166,
      "deletions": 0
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_net.c",
      "insertions": 21,
      "deletions": 4
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_vsc7514.c",
      "insertions": 10,
      "deletions": 0
    },
    {
      "file": "include/soc/mscc/ocelot.h",
      "insertions": 3,
      "deletions": 0
    }
  ],
  "total_insertions": 1095,
  "total_deletions": 4,
  "total_changes": 1099,
  "parents": [
    "de5841e1c93f2275bb73c471255b718b5ec2f0ec"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/ethernet/mscc/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_fdma.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_fdma.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/soc/mscc/ocelot.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_vsc7514.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/ethernet/mscc/ocelot_net.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}