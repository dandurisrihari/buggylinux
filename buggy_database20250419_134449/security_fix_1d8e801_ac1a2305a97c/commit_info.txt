Commit Hash: 1d8e801422d66e4b8c7b187c52196bef94eed887
Subject: Bluetooth: Avoid redundant authentication


Security Keywords:
- authentication

Full commit message:
Bluetooth: Avoid redundant authentication

While executing the Android 13 CTS Verifier Secure Server test on a
ChromeOS device, it was observed that the Bluetooth host initiates
authentication for an RFCOMM connection after SSP completes.
When this happens, some Intel Bluetooth controllers, like AC9560, would
disconnect with "Connection Rejected due to Security Reasons (0x0e)".

Historically, BlueZ did not mandate this authentication while an
authenticated combination key was already in use for the connection.
This behavior was changed since commit 7b5a9241b780
("Bluetooth: Introduce requirements for security level 4").
So, this patch addresses the aforementioned disconnection issue by
restoring the previous behavior.

Signed-off-by: Ying Hsu <yinghsu@chromium.org>
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>

Metadata:
Author: Ying Hsu <yinghsu@chromium.org>
Author Date: Thu Sep 7 04:39:34 2023 +0000
Committer: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Commit Date: Wed Sep 20 11:02:22 2023 -0700

Files Changed: 1
Lines Added: 35
Lines Removed: 28
Total Changes: 63
