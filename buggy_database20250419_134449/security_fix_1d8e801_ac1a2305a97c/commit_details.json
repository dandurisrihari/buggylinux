{
  "hash": "1d8e801422d66e4b8c7b187c52196bef94eed887",
  "hash_short": "1d8e8014",
  "subject": "Bluetooth: Avoid redundant authentication",
  "body": "While executing the Android 13 CTS Verifier Secure Server test on a\nChromeOS device, it was observed that the Bluetooth host initiates\nauthentication for an RFCOMM connection after SSP completes.\nWhen this happens, some Intel Bluetooth controllers, like AC9560, would\ndisconnect with \"Connection Rejected due to Security Reasons (0x0e)\".\n\nHistorically, BlueZ did not mandate this authentication while an\nauthenticated combination key was already in use for the connection.\nThis behavior was changed since commit 7b5a9241b780\n(\"Bluetooth: Introduce requirements for security level 4\").\nSo, this patch addresses the aforementioned disconnection issue by\nrestoring the previous behavior.\n\nSigned-off-by: Ying Hsu <yinghsu@chromium.org>\nSigned-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>",
  "full_message": "Bluetooth: Avoid redundant authentication\n\nWhile executing the Android 13 CTS Verifier Secure Server test on a\nChromeOS device, it was observed that the Bluetooth host initiates\nauthentication for an RFCOMM connection after SSP completes.\nWhen this happens, some Intel Bluetooth controllers, like AC9560, would\ndisconnect with \"Connection Rejected due to Security Reasons (0x0e)\".\n\nHistorically, BlueZ did not mandate this authentication while an\nauthenticated combination key was already in use for the connection.\nThis behavior was changed since commit 7b5a9241b780\n(\"Bluetooth: Introduce requirements for security level 4\").\nSo, this patch addresses the aforementioned disconnection issue by\nrestoring the previous behavior.\n\nSigned-off-by: Ying Hsu <yinghsu@chromium.org>\nSigned-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>",
  "author_name": "Ying Hsu",
  "author_email": "yinghsu@chromium.org",
  "author_date": "Thu Sep 7 04:39:34 2023 +0000",
  "author_date_iso": "2023-09-07T04:39:34+00:00",
  "committer_name": "Luiz Augusto von Dentz",
  "committer_email": "luiz.von.dentz@intel.com",
  "committer_date": "Wed Sep 20 11:02:22 2023 -0700",
  "committer_date_iso": "2023-09-20T11:02:22-07:00",
  "files_changed": [
    "net/bluetooth/hci_conn.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 35,
      "deletions": 28
    }
  ],
  "total_insertions": 35,
  "total_deletions": 28,
  "total_changes": 63,
  "parents": [
    "e0275ea52169412b8faccb4e2f4fed8a057844c6"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}