Commit Hash: 7aa81cc04781b5b99a0647ec04533599d78cd219
Subject: KVM: Refactor hypercall infrastructure (v3)


Security Keywords:
- injection

Full commit message:
KVM: Refactor hypercall infrastructure (v3)

This patch refactors the current hypercall infrastructure to better
support live migration and SMP.  It eliminates the hypercall page by
trapping the UD exception that would occur if you used the wrong hypercall
instruction for the underlying architecture and replacing it with the right
one lazily.

A fall-out of this patch is that the unhandled hypercalls no longer trap to
userspace.  There is very little reason though to use a hypercall to
communicate with userspace as PIO or MMIO can be used.  There is no code
in tree that uses userspace hypercalls.

[avi: fix #ud injection on vmx]

Signed-off-by: Anthony Liguori <aliguori@us.ibm.com>
Signed-off-by: Avi Kivity <avi@qumranet.com>

Metadata:
Author: Anthony Liguori <aliguori@us.ibm.com>
Author Date: Mon Sep 17 14:57:50 2007 -0500
Committer: Avi Kivity <avi@qumranet.com>
Commit Date: Wed Jan 30 17:52:46 2008 +0200

Files Changed: 6
Lines Added: 199
Lines Removed: 183
Total Changes: 382
