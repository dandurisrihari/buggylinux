Commit Hash: e305509e678b3a4af2b3cfd410f409f7cdaabb52
Subject: Bluetooth: use correct lock to prevent UAF of hdev object


Security Keywords:
- vulnerability

Full commit message:
Bluetooth: use correct lock to prevent UAF of hdev object

The hci_sock_dev_event() function will cleanup the hdev object for
sockets even if this object may still be in used within the
hci_sock_bound_ioctl() function, result in UAF vulnerability.

This patch replace the BH context lock to serialize these affairs
and prevent the race condition.

Signed-off-by: Lin Ma <linma@zju.edu.cn>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Lin Ma <linma@zju.edu.cn>
Author Date: Sun May 30 21:37:43 2021 +0800
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Mon May 31 14:33:26 2021 +0200

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
