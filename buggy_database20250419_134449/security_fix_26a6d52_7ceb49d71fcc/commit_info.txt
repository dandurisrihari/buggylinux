Commit Hash: 26a6d5274865532502c682ff378ac8ebe2886238
Subject: wil6210: fix length check in __wmi_send


Security Keywords:
- bypass

Full commit message:
wil6210: fix length check in __wmi_send

The current length check:
sizeof(cmd) + len > r->entry_size
will allow very large values of len (> U16_MAX - sizeof(cmd))
and can cause a buffer overflow. Fix the check to cover this case.
In addition, ensure the mailbox entry_size is not too small,
since this can also bypass the above check.

Signed-off-by: Lior David <qca_liord@qca.qualcomm.com>
Signed-off-by: Maya Erez <qca_merez@qca.qualcomm.com>
Signed-off-by: Kalle Valo <kvalo@qca.qualcomm.com>

Metadata:
Author: Lior David <qca_liord@qca.qualcomm.com>
Author Date: Tue Nov 14 15:25:37 2017 +0200
Committer: Kalle Valo <kvalo@qca.qualcomm.com>
Commit Date: Sat Dec 2 16:18:28 2017 +0200

Files Changed: 2
Lines Added: 22
Lines Removed: 2
Total Changes: 24
