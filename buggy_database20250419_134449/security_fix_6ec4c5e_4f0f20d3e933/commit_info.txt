Commit Hash: 6ec4c5eee1750d5d17951c4e1960d953376a0dda
Subject: KVM: x86: Protect MSR-based index computations from Spectre-v1/L1TF attacks in x86.c


Security Keywords:
- vulnerability

Full commit message:
KVM: x86: Protect MSR-based index computations from Spectre-v1/L1TF attacks in x86.c

This fixes a Spectre-v1/L1TF vulnerability in set_msr_mce() and
get_msr_mce().
Both functions contain index computations based on the
(attacker-controlled) MSR number.

Fixes: 890ca9aefa78 ("KVM: Add MCE support")

Signed-off-by: Nick Finco <nifi@google.com>
Signed-off-by: Marios Pomonis <pomonis@google.com>
Reviewed-by: Andrew Honig <ahonig@google.com>
Cc: stable@vger.kernel.org
Reviewed-by: Jim Mattson <jmattson@google.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Marios Pomonis <pomonis@google.com>
Author Date: Wed Dec 11 12:47:49 2019 -0800
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Mon Jan 27 19:59:41 2020 +0100

Files Changed: 1
Lines Added: 8
Lines Removed: 2
Total Changes: 10
