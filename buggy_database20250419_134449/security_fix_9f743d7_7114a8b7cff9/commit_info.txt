Commit Hash: 9f743d7499bc2c4dc8c35af33bdb2a29bea663b9
Subject: Bluetooth: Fix using uninitialized variable when pairing


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix using uninitialized variable when pairing

Commit 6c53823ae0e10e723131055e1e65dd6a328a228e reshuffled the way the
authentication requirement gets set in the hci_io_capa_request_evt()
function, but at the same time it failed to update an if-statement where
cp.authentication is used before it has been initialized. The correct
value the code should be looking for in this if-statement is
conn->auth_type.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
Cc: stable@vger.kernel.org # 3.16

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Thu Jul 17 11:56:33 2014 +0300
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Thu Jul 17 11:38:00 2014 +0200

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
