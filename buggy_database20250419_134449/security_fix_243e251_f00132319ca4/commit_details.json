{
  "hash": "243e25112d06b348f087a6f7aba4bbc288285bdd",
  "hash_short": "243e2511",
  "subject": "powerpc/xive: Native exploitation of the XIVE interrupt controller",
  "body": "The XIVE interrupt controller is the new interrupt controller\nfound in POWER9. It supports advanced virtualization capabilities\namong other things.\n\nCurrently we use a set of firmware calls that simulate the old\n\"XICS\" interrupt controller but this is fairly inefficient.\n\nThis adds the framework for using XIVE along with a native\nbackend which OPAL for configuration. Later, a backend allowing\nthe use in a KVM or PowerVM guest will also be provided.\n\nThis disables some fast path for interrupts in KVM when XIVE is\nenabled as these rely on the firmware emulation code which is no\nlonger available when the XIVE is used natively by Linux.\n\nA latter patch will make KVM also directly exploit the XIVE, thus\nrecovering the lost performance (and more).\n\nSigned-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>\n[mpe: Fixup pr_xxx(\"XIVE:\"...), don't split pr_xxx() strings,\n tweak Kconfig so XIVE_NATIVE selects XIVE and depends on POWERNV,\n fix build errors when SMP=n, fold in fixes from Ben:\n   Don't call cpu_online() on an invalid CPU number\n   Fix irq target selection returning out of bounds cpu#\n   Extra sanity checks on cpu numbers\n ]\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>",
  "full_message": "powerpc/xive: Native exploitation of the XIVE interrupt controller\n\nThe XIVE interrupt controller is the new interrupt controller\nfound in POWER9. It supports advanced virtualization capabilities\namong other things.\n\nCurrently we use a set of firmware calls that simulate the old\n\"XICS\" interrupt controller but this is fairly inefficient.\n\nThis adds the framework for using XIVE along with a native\nbackend which OPAL for configuration. Later, a backend allowing\nthe use in a KVM or PowerVM guest will also be provided.\n\nThis disables some fast path for interrupts in KVM when XIVE is\nenabled as these rely on the firmware emulation code which is no\nlonger available when the XIVE is used natively by Linux.\n\nA latter patch will make KVM also directly exploit the XIVE, thus\nrecovering the lost performance (and more).\n\nSigned-off-by: Benjamin Herrenschmidt <benh@kernel.crashing.org>\n[mpe: Fixup pr_xxx(\"XIVE:\"...), don't split pr_xxx() strings,\n tweak Kconfig so XIVE_NATIVE selects XIVE and depends on POWERNV,\n fix build errors when SMP=n, fold in fixes from Ben:\n   Don't call cpu_online() on an invalid CPU number\n   Fix irq target selection returning out of bounds cpu#\n   Extra sanity checks on cpu numbers\n ]\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>",
  "author_name": "Benjamin Herrenschmidt",
  "author_email": "benh@kernel.crashing.org",
  "author_date": "Wed Apr 5 17:54:50 2017 +1000",
  "author_date_iso": "2017-04-05T17:54:50+10:00",
  "committer_name": "Michael Ellerman",
  "committer_email": "mpe@ellerman.id.au",
  "committer_date": "Mon Apr 10 21:41:34 2017 +1000",
  "committer_date_iso": "2017-04-10T21:41:34+10:00",
  "files_changed": [
    "arch/powerpc/include/asm/xive-regs.h",
    "arch/powerpc/include/asm/xive.h",
    "arch/powerpc/include/asm/xmon.h",
    "arch/powerpc/kvm/book3s_hv_builtin.c",
    "arch/powerpc/platforms/powernv/Kconfig",
    "arch/powerpc/platforms/powernv/setup.c",
    "arch/powerpc/platforms/powernv/smp.c",
    "arch/powerpc/sysdev/Kconfig",
    "arch/powerpc/sysdev/Makefile",
    "arch/powerpc/sysdev/xive/Kconfig",
    "arch/powerpc/sysdev/xive/Makefile",
    "arch/powerpc/sysdev/xive/common.c",
    "arch/powerpc/sysdev/xive/native.c",
    "arch/powerpc/sysdev/xive/xive-internal.h",
    "arch/powerpc/xmon/xmon.c"
  ],
  "files_changed_count": 15,
  "stats": [
    {
      "file": "arch/powerpc/include/asm/xive-regs.h",
      "insertions": 97,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/include/asm/xive.h",
      "insertions": 163,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/include/asm/xmon.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/kvm/book3s_hv_builtin.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/platforms/powernv/Kconfig",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/platforms/powernv/setup.c",
      "insertions": 12,
      "deletions": 3
    },
    {
      "file": "arch/powerpc/platforms/powernv/smp.c",
      "insertions": 32,
      "deletions": 7
    },
    {
      "file": "arch/powerpc/sysdev/Kconfig",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/sysdev/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/sysdev/xive/Kconfig",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/sysdev/xive/Makefile",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/sysdev/xive/common.c",
      "insertions": 1302,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/sysdev/xive/native.c",
      "insertions": 639,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/sysdev/xive/xive-internal.h",
      "insertions": 62,
      "deletions": 0
    },
    {
      "file": "arch/powerpc/xmon/xmon.c",
      "insertions": 92,
      "deletions": 2
    }
  ],
  "total_insertions": 2427,
  "total_deletions": 12,
  "total_changes": 2439,
  "parents": [
    "a978e13965a40ac07163643cc3fa0ddb0d354198"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.12",
    "v4.12-rc1",
    "v4.12-rc2",
    "v4.12-rc3",
    "v4.12-rc4",
    "v4.12-rc5",
    "v4.12-rc6",
    "v4.12-rc7",
    "v4.13",
    "v4.13-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/powerpc/include/asm/xive.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/include/asm/xive-regs.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/kvm/book3s_hv_builtin.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/platforms/powernv/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/platforms/powernv/setup.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/platforms/powernv/smp.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/include/asm/xmon.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/xive/xive-internal.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/xmon/xmon.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/xive/common.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/xive/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/xive/native.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/sysdev/xive/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}