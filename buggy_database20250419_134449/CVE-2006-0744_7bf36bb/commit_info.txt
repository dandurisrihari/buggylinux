Commit Hash: 7bf36bbc5e0c09271f9efe22162f8cc3f8ebd3d2
Subject: [PATCH] x86_64: When user could have changed RIP always force IRET

CVE Identifiers:
- CVE-2006-0744

Full commit message:
[PATCH] x86_64: When user could have changed RIP always force IRET

Intel EM64T CPUs handle uncanonical return addresses differently
from AMD CPUs.

The exception is reported in the SYSRET, not the next instruction.
This leads to the kernel exception handler running on the user stack
with the wrong GS because the kernel didn't expect exceptions
on this instruction.

This version of the patch has the teething problems that plagued an earlier
version fixed.

This is CVE-2006-0744

Thanks to Ernie Petrides and Asit B. Mallick for analysis and initial
patches.

Signed-off-by: Andi Kleen <ak@suse.de>
Signed-off-by: Linus Torvalds <torvalds@osdl.org>

Metadata:
Author: Andi Kleen <ak@suse.de>
Author Date: Fri Apr 7 19:50:00 2006 +0200
Committer: Linus Torvalds <torvalds@g5.osdl.org>
Commit Date: Sun Apr 9 11:53:52 2006 -0700

Files Changed: 1
Lines Added: 10
Lines Removed: 2
Total Changes: 12
