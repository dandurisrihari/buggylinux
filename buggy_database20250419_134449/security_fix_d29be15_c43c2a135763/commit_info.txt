Commit Hash: d29be158a68254f58cf1fbf60ce1e89557a321aa
Subject: Audit: add support to match lsm labels on user audit messages


Security Keywords:
- authentication

Full commit message:
Audit: add support to match lsm labels on user audit messages

Add support for matching by security label (e.g. SELinux context) of
the sender of an user-space audit record.

The audit filter code already allows user space to configure such
filters, but they were ignored during evaluation.  This patch implements
evaluation of these filters.

For example, after application of this patch, PAM authentication logs
caused by cron can be disabled using
	auditctl -a user,never -F subj_type=crond_t

Signed-off-by: Miloslav Trmac <mitr@redhat.com>
Acked-by: Eric Paris <eparis@redhat.com>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

Metadata:
Author: Miloslav Trmac <mitr@redhat.com>
Author Date: Thu Sep 16 18:14:11 2010 -0400
Committer: Al Viro <viro@zeniv.linux.org.uk>
Commit Date: Sat Oct 30 01:41:57 2010 -0400

Files Changed: 1
Lines Added: 12
Lines Removed: 0
Total Changes: 12
