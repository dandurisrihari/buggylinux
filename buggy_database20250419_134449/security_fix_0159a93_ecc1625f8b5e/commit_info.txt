Commit Hash: 0159a9305d401fd21a1cda5e7baaf62122c46a5b
Subject: can: slcan: use scnprintf() as a hardening measure


Security Keywords:
- hardening

Full commit message:
can: slcan: use scnprintf() as a hardening measure

The snprintf() function returns the number of bytes which *would* have
been copied if there were no space. So, since this code does not check
the return value, there if the buffer was not large enough then there
would be a buffer overflow two lines later when it does:

	actual = sl->tty->ops->write(sl->tty, sl->xbuff, n);

Use scnprintf() instead because that returns the number of bytes which
were actually copied.

Fixes: 52f9ac85b876 ("can: slcan: allow to send commands to the adapter")
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Link: https://lore.kernel.org/all/YsVA9KoY/ZSvNGYk@kili
Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>

Metadata:
Author: Dan Carpenter <dan.carpenter@oracle.com>
Author Date: Wed Jul 6 10:59:48 2022 +0300
Committer: Marc Kleine-Budde <mkl@pengutronix.de>
Commit Date: Tue Jul 19 20:29:36 2022 +0200

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
