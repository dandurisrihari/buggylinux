{
  "hash": "0159a9305d401fd21a1cda5e7baaf62122c46a5b",
  "hash_short": "0159a930",
  "subject": "can: slcan: use scnprintf() as a hardening measure",
  "body": "The snprintf() function returns the number of bytes which *would* have\nbeen copied if there were no space. So, since this code does not check\nthe return value, there if the buffer was not large enough then there\nwould be a buffer overflow two lines later when it does:\n\n\tactual = sl->tty->ops->write(sl->tty, sl->xbuff, n);\n\nUse scnprintf() instead because that returns the number of bytes which\nwere actually copied.\n\nFixes: 52f9ac85b876 (\"can: slcan: allow to send commands to the adapter\")\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nLink: https://lore.kernel.org/all/YsVA9KoY/ZSvNGYk@kili\nSigned-off-by: Marc Kleine-Budde <mkl@pengutronix.de>",
  "full_message": "can: slcan: use scnprintf() as a hardening measure\n\nThe snprintf() function returns the number of bytes which *would* have\nbeen copied if there were no space. So, since this code does not check\nthe return value, there if the buffer was not large enough then there\nwould be a buffer overflow two lines later when it does:\n\n\tactual = sl->tty->ops->write(sl->tty, sl->xbuff, n);\n\nUse scnprintf() instead because that returns the number of bytes which\nwere actually copied.\n\nFixes: 52f9ac85b876 (\"can: slcan: allow to send commands to the adapter\")\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nLink: https://lore.kernel.org/all/YsVA9KoY/ZSvNGYk@kili\nSigned-off-by: Marc Kleine-Budde <mkl@pengutronix.de>",
  "author_name": "Dan Carpenter",
  "author_email": "dan.carpenter@oracle.com",
  "author_date": "Wed Jul 6 10:59:48 2022 +0300",
  "author_date_iso": "2022-07-06T10:59:48+03:00",
  "committer_name": "Marc Kleine-Budde",
  "committer_email": "mkl@pengutronix.de",
  "committer_date": "Tue Jul 19 20:29:36 2022 +0200",
  "committer_date_iso": "2022-07-19T20:29:36+02:00",
  "files_changed": [
    "drivers/net/can/slcan/slcan-core.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/can/slcan/slcan-core.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "e22c88799f2629088504e1357384f2ec3798da46"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/can/slcan/slcan-core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}