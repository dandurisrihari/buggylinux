Commit Hash: a9f61ca793becabdefab03b77568d6c6f8c1bc79
Subject: Drivers: hv: avoid vfree() on crash


Security Keywords:
- injection

Full commit message:
Drivers: hv: avoid vfree() on crash

When we crash from NMI context (e.g. after NMI injection from host when
'sysctl -w kernel.unknown_nmi_panic=1' is set) we hit

    kernel BUG at mm/vmalloc.c:1530!

as vfree() is denied. While the issue could be solved with in_nmi() check
instead I opted for skipping vfree on all sorts of crashes to reduce the
amount of work which can cause consequent crashes. We don't really need to
free anything on crash.

Signed-off-by: Vitaly Kuznetsov <vkuznets@redhat.com>
Signed-off-by: K. Y. Srinivasan <kys@microsoft.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>

Metadata:
Author: Vitaly Kuznetsov <vkuznets@redhat.com>
Author Date: Fri Jun 3 17:09:22 2016 -0700
Committer: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Commit Date: Wed Aug 31 13:05:40 2016 +0200

Files Changed: 3
Lines Added: 10
Lines Removed: 8
Total Changes: 18
