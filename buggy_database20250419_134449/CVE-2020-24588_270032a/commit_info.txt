Commit Hash: 270032a2a9c4535799736142e1e7c413ca7b836e
Subject: mac80211: drop A-MSDUs on old ciphers

CVE Identifiers:
- CVE-2020-24588

Full commit message:
mac80211: drop A-MSDUs on old ciphers

With old ciphers (WEP and TKIP) we shouldn't be using A-MSDUs
since A-MSDUs are only supported if we know that they are, and
the only practical way for that is HT support which doesn't
support old ciphers.

However, we would normally accept them anyway. Since we check
the MMIC before deaggregating A-MSDUs, and the A-MSDU bit in
the QoS header is not protected in TKIP (or WEP), this enables
attacks similar to CVE-2020-24588. To prevent that, drop A-MSDUs
completely with old ciphers.

Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/r/20210511200110.076543300172.I548e6e71f1ee9cad4b9a37bf212ae7db723587aa@changeid
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Tue May 11 20:02:46 2021 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Tue May 11 20:13:23 2021 +0200

Files Changed: 1
Lines Added: 18
Lines Removed: 1
Total Changes: 19
