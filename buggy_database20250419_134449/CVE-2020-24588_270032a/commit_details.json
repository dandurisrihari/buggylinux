{
  "hash": "270032a2a9c4535799736142e1e7c413ca7b836e",
  "hash_short": "270032a2",
  "subject": "mac80211: drop A-MSDUs on old ciphers",
  "body": "With old ciphers (WEP and TKIP) we shouldn't be using A-MSDUs\nsince A-MSDUs are only supported if we know that they are, and\nthe only practical way for that is HT support which doesn't\nsupport old ciphers.\n\nHowever, we would normally accept them anyway. Since we check\nthe MMIC before deaggregating A-MSDUs, and the A-MSDU bit in\nthe QoS header is not protected in TKIP (or WEP), this enables\nattacks similar to CVE-2020-24588. To prevent that, drop A-MSDUs\ncompletely with old ciphers.\n\nCc: stable@vger.kernel.org\nLink: https://lore.kernel.org/r/20210511200110.076543300172.I548e6e71f1ee9cad4b9a37bf212ae7db723587aa@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: drop A-MSDUs on old ciphers\n\nWith old ciphers (WEP and TKIP) we shouldn't be using A-MSDUs\nsince A-MSDUs are only supported if we know that they are, and\nthe only practical way for that is HT support which doesn't\nsupport old ciphers.\n\nHowever, we would normally accept them anyway. Since we check\nthe MMIC before deaggregating A-MSDUs, and the A-MSDU bit in\nthe QoS header is not protected in TKIP (or WEP), this enables\nattacks similar to CVE-2020-24588. To prevent that, drop A-MSDUs\ncompletely with old ciphers.\n\nCc: stable@vger.kernel.org\nLink: https://lore.kernel.org/r/20210511200110.076543300172.I548e6e71f1ee9cad4b9a37bf212ae7db723587aa@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Tue May 11 20:02:46 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:46+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:13:23 2021 +0200",
  "committer_date_iso": "2021-05-11T20:13:23+02:00",
  "files_changed": [
    "net/mac80211/rx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/rx.c",
      "insertions": 18,
      "deletions": 1
    }
  ],
  "total_insertions": 18,
  "total_deletions": 1,
  "total_changes": 19,
  "parents": [
    "2b8a1fee3488c602aca8bea004a087e60806a5cf"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-24588"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/rx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}