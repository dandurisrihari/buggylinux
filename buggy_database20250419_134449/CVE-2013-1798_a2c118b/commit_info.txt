Commit Hash: a2c118bfab8bc6b8bb213abfc35201e441693d55
Subject: KVM: Fix bounds checking in ioapic indirect register reads (CVE-2013-1798)

CVE Identifiers:
- CVE-2013-1798
- CVE-2013-1798

Full commit message:
KVM: Fix bounds checking in ioapic indirect register reads (CVE-2013-1798)

If the guest specifies a IOAPIC_REG_SELECT with an invalid value and follows
that with a read of the IOAPIC_REG_WINDOW KVM does not properly validate
that request.  ioapic_read_indirect contains an
ASSERT(redir_index < IOAPIC_NUM_PINS), but the ASSERT has no effect in
non-debug builds.  In recent kernels this allows a guest to cause a kernel
oops by reading invalid memory.  In older kernels (pre-3.3) this allows a
guest to read from large ranges of host memory.

Tested: tested against apic unit tests.

Signed-off-by: Andrew Honig <ahonig@google.com>
Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>

Metadata:
Author: Andy Honig <ahonig@google.com>
Author Date: Wed Feb 20 14:49:16 2013 -0800
Committer: Marcelo Tosatti <mtosatti@redhat.com>
Commit Date: Tue Mar 19 14:20:21 2013 -0300

Files Changed: 1
Lines Added: 5
Lines Removed: 2
Total Changes: 7
