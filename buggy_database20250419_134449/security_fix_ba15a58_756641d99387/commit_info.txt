Commit Hash: ba15a58b179ed76a7e887177f2b06de12c58ec8f
Subject: Bluetooth: Fix SSP acceptor just-works confirmation without MITM


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix SSP acceptor just-works confirmation without MITM

From the Bluetooth Core Specification 4.1 page 1958:

"if both devices have set the Authentication_Requirements parameter to
one of the MITM Protection Not Required options, authentication stage 1
shall function as if both devices set their IO capabilities to
DisplayOnly (e.g., Numeric comparison with automatic confirmation on
both devices)"

So far our implementation has done user confirmation for all just-works
cases regardless of the MITM requirements, however following the
specification to the word means that we should not be doing confirmation
when neither side has the MITM flag set.

Signed-off-by: Johan Hedberg <johan.hedberg@intel.com>
Tested-by: Szymon Janc <szymon.janc@tieto.com>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
Cc: stable@vger.kernel.org

Metadata:
Author: Johan Hedberg <johan.hedberg@intel.com>
Author Date: Mon Jun 9 13:58:14 2014 +0300
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Fri Jun 13 13:30:42 2014 +0200

Files Changed: 1
Lines Added: 5
Lines Removed: 2
Total Changes: 7
