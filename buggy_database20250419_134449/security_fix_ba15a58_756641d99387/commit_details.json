{
  "hash": "ba15a58b179ed76a7e887177f2b06de12c58ec8f",
  "hash_short": "ba15a58b",
  "subject": "Bluetooth: Fix SSP acceptor just-works confirmation without MITM",
  "body": "From the Bluetooth Core Specification 4.1 page 1958:\n\n\"if both devices have set the Authentication_Requirements parameter to\none of the MITM Protection Not Required options, authentication stage 1\nshall function as if both devices set their IO capabilities to\nDisplayOnly (e.g., Numeric comparison with automatic confirmation on\nboth devices)\"\n\nSo far our implementation has done user confirmation for all just-works\ncases regardless of the MITM requirements, however following the\nspecification to the word means that we should not be doing confirmation\nwhen neither side has the MITM flag set.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nTested-by: Szymon Janc <szymon.janc@tieto.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nCc: stable@vger.kernel.org",
  "full_message": "Bluetooth: Fix SSP acceptor just-works confirmation without MITM\n\nFrom the Bluetooth Core Specification 4.1 page 1958:\n\n\"if both devices have set the Authentication_Requirements parameter to\none of the MITM Protection Not Required options, authentication stage 1\nshall function as if both devices set their IO capabilities to\nDisplayOnly (e.g., Numeric comparison with automatic confirmation on\nboth devices)\"\n\nSo far our implementation has done user confirmation for all just-works\ncases regardless of the MITM requirements, however following the\nspecification to the word means that we should not be doing confirmation\nwhen neither side has the MITM flag set.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nTested-by: Szymon Janc <szymon.janc@tieto.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nCc: stable@vger.kernel.org",
  "author_name": "Johan Hedberg",
  "author_email": "johan.hedberg@intel.com",
  "author_date": "Mon Jun 9 13:58:14 2014 +0300",
  "author_date_iso": "2014-06-09T13:58:14+03:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Fri Jun 13 13:30:42 2014 +0200",
  "committer_date_iso": "2014-06-13T13:30:42+02:00",
  "files_changed": [
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 5,
      "deletions": 2
    }
  ],
  "total_insertions": 5,
  "total_deletions": 2,
  "total_changes": 7,
  "parents": [
    "e694788d73efe139b24f78b036deb97fe57fa8cb"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.16",
    "v3.16-rc3",
    "v3.16-rc4",
    "v3.16-rc5",
    "v3.16-rc6",
    "v3.16-rc7",
    "v3.17",
    "v3.17-rc1",
    "v3.17-rc2",
    "v3.17-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}