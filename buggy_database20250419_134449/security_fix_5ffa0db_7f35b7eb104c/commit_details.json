{
  "hash": "5ffa0dbfdc9fc05acae02d5b0dc766ec778569ac",
  "hash_short": "5ffa0dbf",
  "subject": "platform/chrome: cros_ec: jump to RW before probing",
  "body": "There are EC devices, like FPMCU, that use RWSIG as a method of\nauthenticating RW section. After the authentication succeeds, EC device\nwaits some time before jumping to RW. EC can be probed before the jump,\nwhich means there is a time window after jump to RW in which EC won't\nrespond, because it is not initialized. It can cause a communication\nerrors after probing.\n\nTo avoid such problems, send the RWSIG continue command first, which\nskips waiting for the jump to RW. Send the command more times, to make\nsure EC is ready in RW before the start of the actual probing process. If\na EC device doesn't support the RWSIG, it will respond with invalid\ncommand error code and probing will continue as usual.\n\nSigned-off-by: Dawid Niedzwiecki <dawidn@google.com>\nLink: https://lore.kernel.org/r/20241206091514.2538350-2-dawidn@google.com\nSigned-off-by: Tzung-Bi Shih <tzungbi@kernel.org>",
  "full_message": "platform/chrome: cros_ec: jump to RW before probing\n\nThere are EC devices, like FPMCU, that use RWSIG as a method of\nauthenticating RW section. After the authentication succeeds, EC device\nwaits some time before jumping to RW. EC can be probed before the jump,\nwhich means there is a time window after jump to RW in which EC won't\nrespond, because it is not initialized. It can cause a communication\nerrors after probing.\n\nTo avoid such problems, send the RWSIG continue command first, which\nskips waiting for the jump to RW. Send the command more times, to make\nsure EC is ready in RW before the start of the actual probing process. If\na EC device doesn't support the RWSIG, it will respond with invalid\ncommand error code and probing will continue as usual.\n\nSigned-off-by: Dawid Niedzwiecki <dawidn@google.com>\nLink: https://lore.kernel.org/r/20241206091514.2538350-2-dawidn@google.com\nSigned-off-by: Tzung-Bi Shih <tzungbi@kernel.org>",
  "author_name": "Dawid Niedzwiecki",
  "author_email": "dawidn@google.com",
  "author_date": "Fri Dec 6 09:15:13 2024 +0000",
  "author_date_iso": "2024-12-06T09:15:13+00:00",
  "committer_name": "Tzung-Bi Shih",
  "committer_email": "tzungbi@kernel.org",
  "committer_date": "Mon Dec 30 01:31:05 2024 +0000",
  "committer_date_iso": "2024-12-30T01:31:05+00:00",
  "files_changed": [
    "drivers/platform/chrome/cros_ec.c",
    "drivers/platform/chrome/cros_ec_i2c.c",
    "drivers/platform/chrome/cros_ec_ishtp.c",
    "drivers/platform/chrome/cros_ec_lpc.c",
    "drivers/platform/chrome/cros_ec_proto.c",
    "drivers/platform/chrome/cros_ec_rpmsg.c",
    "drivers/platform/chrome/cros_ec_spi.c",
    "drivers/platform/chrome/cros_ec_uart.c",
    "include/linux/platform_data/cros_ec_proto.h"
  ],
  "files_changed_count": 9,
  "stats": [
    {
      "file": "drivers/platform/chrome/cros_ec.c",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "drivers/platform/chrome/cros_ec_i2c.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/platform/chrome/cros_ec_ishtp.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/platform/chrome/cros_ec_lpc.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/platform/chrome/cros_ec_proto.c",
      "insertions": 60,
      "deletions": 0
    },
    {
      "file": "drivers/platform/chrome/cros_ec_rpmsg.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/platform/chrome/cros_ec_spi.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/platform/chrome/cros_ec_uart.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/platform_data/cros_ec_proto.h",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 74,
  "total_deletions": 6,
  "total_changes": 80,
  "parents": [
    "cfa842c80c99966db06f5ee7ec03e7d513965247"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/platform/chrome/cros_ec_i2c.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec_ishtp.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec_rpmsg.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec_proto.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec_spi.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec_uart.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/platform_data/cros_ec_proto.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/platform/chrome/cros_ec_lpc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}