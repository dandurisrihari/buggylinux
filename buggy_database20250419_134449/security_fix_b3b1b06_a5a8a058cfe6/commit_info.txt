Commit Hash: b3b1b061583ba4909b59a2f736825d86495fe956
Subject: Bluetooth: Double check sec req for pre 2.1 device


Security Keywords:
- authentication

Full commit message:
Bluetooth: Double check sec req for pre 2.1 device

In case of pre v2.1 devices authentication request will return
success immediately if the link key already exists without any
authentication process.

That means, it's not possible to re-authenticate the link if you
already have combination key and for instance want to re-authenticate
to get the high security (use 16 digit pin).

Therefore, it's necessary to check security requirements on auth
complete event to prevent not enough secure connection.

Signed-off-by: Waldemar Rymarkiewicz <waldemar.rymarkiewicz@tieto.com>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

Metadata:
Author: Waldemar Rymarkiewicz <waldemar.rymarkiewicz@tieto.com>
Author Date: Fri May 6 09:42:31 2011 +0200
Committer: Gustavo F. Padovan <padovan@profusion.mobi>
Commit Date: Wed May 11 14:56:28 2011 -0300

Files Changed: 3
Lines Added: 19
Lines Removed: 1
Total Changes: 20
