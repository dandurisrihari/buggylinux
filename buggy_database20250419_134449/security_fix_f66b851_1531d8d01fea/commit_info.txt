Commit Hash: f66b85171a0ebd55a7efc3e82575ae187d62322c
Subject: scsi: scsi_debug: call resp_*() function after setting host_scribble


Security Keywords:
- injection

Full commit message:
scsi: scsi_debug: call resp_*() function after setting host_scribble

Error injection in scsi_debug (e.g. opts=16, SDEBUG_OPT_TRANSPORT_ERR)
currently doesn't work correctly because the test for sqcp in
resp_read_dt0() and similar resp_*() functions always fails.  sqcp is
set from cmnd->host_scribble, which is set in schedule_resp(), which is
called from scsi_debug_queuecommand() after calling the resp_* function.

Defer calling resp_*() until after cmnd->host_scribble is set in
schedule_resp().

Fixes: c483739430f1 "scsi_debug: add multiple queue support"
Signed-off-by: Martin Wilck <mwilck@suse.com>
Acked-by: Douglas Gilbert <dgilbert@interlog.com>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

Metadata:
Author: Martin Wilck <mwilck@suse.com>
Author Date: Wed Feb 14 11:05:57 2018 +0100
Committer: Martin K. Petersen <martin.petersen@oracle.com>
Commit Date: Thu Feb 15 18:34:24 2018 -0500

Files Changed: 1
Lines Added: 33
Lines Removed: 20
Total Changes: 53
