{
  "hash": "ad7f402ae4f466647c3a669b8a6f3e5d4271c84a",
  "hash_short": "ad7f402a",
  "subject": "xen/netback: Ensure protocol headers don't fall in the non-linear area",
  "body": "In some cases, the frontend may send a packet where the protocol headers\nare spread across multiple slots. This would result in netback creating\nan skb where the protocol headers spill over into the non-linear area.\nSome drivers and NICs don't handle this properly resulting in an\ninterface reset or worse.\n\nThis issue was introduced by the removal of an unconditional skb pull in\nthe tx path to improve performance.  Fix this without reintroducing the\npull by setting up grant copy ops for as many slots as needed to reach\nthe XEN_NETBACK_TX_COPY_LEN size. Adjust the rest of the code to handle\nmultiple copy operations per skb.\n\nThis is XSA-423 / CVE-2022-3643.\n\nFixes: 7e5d7753956b (\"xen-netback: remove unconditional __pskb_pull_tail() in guest Tx path\")\nSigned-off-by: Ross Lagerwall <ross.lagerwall@citrix.com>\nReviewed-by: Paul Durrant <paul@xen.org>\nSigned-off-by: Juergen Gross <jgross@suse.com>",
  "full_message": "xen/netback: Ensure protocol headers don't fall in the non-linear area\n\nIn some cases, the frontend may send a packet where the protocol headers\nare spread across multiple slots. This would result in netback creating\nan skb where the protocol headers spill over into the non-linear area.\nSome drivers and NICs don't handle this properly resulting in an\ninterface reset or worse.\n\nThis issue was introduced by the removal of an unconditional skb pull in\nthe tx path to improve performance.  Fix this without reintroducing the\npull by setting up grant copy ops for as many slots as needed to reach\nthe XEN_NETBACK_TX_COPY_LEN size. Adjust the rest of the code to handle\nmultiple copy operations per skb.\n\nThis is XSA-423 / CVE-2022-3643.\n\nFixes: 7e5d7753956b (\"xen-netback: remove unconditional __pskb_pull_tail() in guest Tx path\")\nSigned-off-by: Ross Lagerwall <ross.lagerwall@citrix.com>\nReviewed-by: Paul Durrant <paul@xen.org>\nSigned-off-by: Juergen Gross <jgross@suse.com>",
  "author_name": "Ross Lagerwall",
  "author_email": "ross.lagerwall@citrix.com",
  "author_date": "Tue Nov 22 09:16:59 2022 +0000",
  "author_date_iso": "2022-11-22T09:16:59+00:00",
  "committer_name": "Juergen Gross",
  "committer_email": "jgross@suse.com",
  "committer_date": "Tue Dec 6 16:00:30 2022 +0100",
  "committer_date_iso": "2022-12-06T16:00:30+01:00",
  "files_changed": [
    "drivers/net/xen-netback/netback.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/xen-netback/netback.c",
      "insertions": 123,
      "deletions": 100
    }
  ],
  "total_insertions": 123,
  "total_deletions": 100,
  "total_changes": 223,
  "parents": [
    "76dcd734eca23168cb008912c0f69ff408905235"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-3643"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/xen-netback/netback.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}