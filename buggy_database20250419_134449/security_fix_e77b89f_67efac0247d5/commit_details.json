{
  "hash": "e77b89f13a0d48aea70b69976e854f2a2444a519",
  "hash_short": "e77b89f1",
  "subject": "[CPUFREQ] Fix use after free on governor restore",
  "body": "Currently on governer backup/restore path we storing governor's pointer.\nThis is wrong because one may unload governor's module after cpu goes\noffline. As result use-after-free will take place on restored cpu.\nIt is not easy to exploit this bug, but still we have to close this\nissue ASAP. Issue was introduced by following commit\n084f34939424161669467c19280dbcf637730314\n\n##TESTCASE##\n#!/bin/sh -x\nmodprobe acpi_cpufreq\n# Any non default governor, in may case it is \"ondemand\"\nmodprobe cpufreq_ondemand\necho ondemand > /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor\nrmmod acpi_cpufreq\nrmmod cpufreq_ondemand\nmodprobe acpi_cpufreq  # << use-after-free here.\n\nSigned-off-by: Dmitry Monakhov <dmonakhov@openvz.org>\nSigned-off-by: Dave Jones <davej@redhat.com>",
  "full_message": "[CPUFREQ] Fix use after free on governor restore\n\nCurrently on governer backup/restore path we storing governor's pointer.\nThis is wrong because one may unload governor's module after cpu goes\noffline. As result use-after-free will take place on restored cpu.\nIt is not easy to exploit this bug, but still we have to close this\nissue ASAP. Issue was introduced by following commit\n084f34939424161669467c19280dbcf637730314\n\n##TESTCASE##\n#!/bin/sh -x\nmodprobe acpi_cpufreq\n# Any non default governor, in may case it is \"ondemand\"\nmodprobe cpufreq_ondemand\necho ondemand > /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor\nrmmod acpi_cpufreq\nrmmod cpufreq_ondemand\nmodprobe acpi_cpufreq  # << use-after-free here.\n\nSigned-off-by: Dmitry Monakhov <dmonakhov@openvz.org>\nSigned-off-by: Dave Jones <davej@redhat.com>",
  "author_name": "Dmitry Monakhov",
  "author_email": "dmonakhov@openvz.org",
  "author_date": "Mon Oct 5 00:38:55 2009 +0400",
  "author_date_iso": "2009-10-05T00:38:55+04:00",
  "committer_name": "Dave Jones",
  "committer_email": "davej@redhat.com",
  "committer_date": "Tue Nov 17 23:15:04 2009 -0500",
  "committer_date_iso": "2009-11-17T23:15:04-05:00",
  "files_changed": [
    "drivers/cpufreq/cpufreq.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/cpufreq/cpufreq.c",
      "insertions": 10,
      "deletions": 6
    }
  ],
  "total_insertions": 10,
  "total_deletions": 6,
  "total_changes": 16,
  "parents": [
    "293afe44d75abce4252db76cbb303a7de4297ce1"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.32",
    "v2.6.32-rc8",
    "v2.6.33",
    "v2.6.33-rc1",
    "v2.6.33-rc2",
    "v2.6.33-rc3",
    "v2.6.33-rc4",
    "v2.6.33-rc5",
    "v2.6.33-rc6",
    "v2.6.33-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/cpufreq/cpufreq.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}