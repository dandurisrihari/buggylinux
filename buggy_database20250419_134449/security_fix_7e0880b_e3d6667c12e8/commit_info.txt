Commit Hash: 7e0880b9fbbe7d21e29347020bef0b7329cb0e9d
Subject: crypto: caam - add Derived Key Protocol (DKP) support


Security Keywords:
- authentication

Full commit message:
crypto: caam - add Derived Key Protocol (DKP) support

Offload split key generation in CAAM engine, using DKP.
DKP is supported starting with Era 6.

Note that the way assoclen is transmitted from the job descriptor
to the shared descriptor changes - DPOVRD register is used instead
of MATH3 (where available), since DKP protocol thrashes the MATH
registers.

The replacement of MDHA split key generation with DKP has the side
effect of the crypto engine writing the authentication key, and thus
the DMA mapping direction for the buffer holding the key has to change
from DMA_TO_DEVICE to DMA_BIDIRECTIONAL.
There are two cases:
-key is inlined in descriptor - descriptor buffer mapping changes
-key is referenced - key buffer mapping changes

Signed-off-by: Horia Geantă <horia.geanta@nxp.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

Metadata:
Author: Horia Geantă <horia.geanta@nxp.com>
Author Date: Tue Dec 19 12:16:07 2017 +0200
Committer: Herbert Xu <herbert@gondor.apana.org.au>
Commit Date: Thu Dec 28 17:56:48 2017 +1100

Files Changed: 9
Lines Added: 384
Lines Removed: 171
Total Changes: 555
