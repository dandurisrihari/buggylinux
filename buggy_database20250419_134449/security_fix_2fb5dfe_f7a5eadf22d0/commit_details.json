{
  "hash": "2fb5dfe18e8255dbec4d0f8e81297de8e3490285",
  "hash_short": "2fb5dfe1",
  "subject": "wifi: mac80211: mlme: re-parse if AP mode is less than client",
  "body": "If the AP mode ends up being determined less than the client mode,\nthere may be different reasons for this, e.g. AP misconfiguration.\nIf this happens in a way that causes e.g. EHT to be rejected, the\nelements need to be re-parsed since we'll connect as HE, but not\nreparsing means that we'll still think it's OK to use multi-link,\nso we can connect in a non-sensical configuration of advertising\nonly HE on a secondary link. This normally won't happen for the\nassoc link because that reuses the mode from authentication, and\nif that's not EHT, multi-link association is rejected.\n\nFix this inconsistency by parsing the elements again if the mode\nwas different from the first parsing attempt. Print the message a\nbit later to avoid printing \"determined AP ... to be HE\" twice in\ncases where ieee80211_determine_ap_chan() returned a lesser mode,\nrather than the regulatory downgrades below changing it.\n\nFixes: 310c8387c638 (\"wifi: mac80211: clean up connection process\")\nReviewed-by: Miriam Rachel Korenblit <miriam.rachel.korenblit@intel.com>\nLink: https://msgid.link/20240418105220.d1f25d92cfe7.Ia21eff6cdcae2f5aca13cf8e742a986af5e70f89@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: mac80211: mlme: re-parse if AP mode is less than client\n\nIf the AP mode ends up being determined less than the client mode,\nthere may be different reasons for this, e.g. AP misconfiguration.\nIf this happens in a way that causes e.g. EHT to be rejected, the\nelements need to be re-parsed since we'll connect as HE, but not\nreparsing means that we'll still think it's OK to use multi-link,\nso we can connect in a non-sensical configuration of advertising\nonly HE on a secondary link. This normally won't happen for the\nassoc link because that reuses the mode from authentication, and\nif that's not EHT, multi-link association is rejected.\n\nFix this inconsistency by parsing the elements again if the mode\nwas different from the first parsing attempt. Print the message a\nbit later to avoid printing \"determined AP ... to be HE\" twice in\ncases where ieee80211_determine_ap_chan() returned a lesser mode,\nrather than the regulatory downgrades below changing it.\n\nFixes: 310c8387c638 (\"wifi: mac80211: clean up connection process\")\nReviewed-by: Miriam Rachel Korenblit <miriam.rachel.korenblit@intel.com>\nLink: https://msgid.link/20240418105220.d1f25d92cfe7.Ia21eff6cdcae2f5aca13cf8e742a986af5e70f89@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Thu Apr 18 10:52:22 2024 +0200",
  "author_date_iso": "2024-04-18T10:52:22+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Fri Apr 19 10:02:14 2024 +0200",
  "committer_date_iso": "2024-04-19T10:02:14+02:00",
  "files_changed": [
    "net/mac80211/mlme.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/mlme.c",
      "insertions": 9,
      "deletions": 4
    }
  ],
  "total_insertions": 9,
  "total_deletions": 4,
  "total_changes": 13,
  "parents": [
    "1ac6f60aab36ae3f0520cc7ace02ad32240b8a1f"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/mlme.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}