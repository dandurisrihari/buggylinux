{
  "hash": "006df0f34930e18d0aa52f05705bdfe1fc565943",
  "hash_short": "006df0f3",
  "subject": "KVM: arm/arm64: Support calling vgic_update_irq_pending from irq context",
  "body": "We are about to optimize our timer handling logic which involves\ninjecting irqs to the vgic directly from the irq handler.\n\nUnfortunately, the injection path can take any AP list lock and irq lock\nand we must therefore make sure to use spin_lock_irqsave where ever\ninterrupts are enabled and we are taking any of those locks, to avoid\ndeadlocking between process context and the ISR.\n\nThis changes a lot of the VGIC code, but the good news are that the\nchanges are mostly mechanical.\n\nAcked-by: Marc Zyngier <marc,zyngier@arm.com>\nSigned-off-by: Christoffer Dall <cdall@linaro.org>",
  "full_message": "KVM: arm/arm64: Support calling vgic_update_irq_pending from irq context\n\nWe are about to optimize our timer handling logic which involves\ninjecting irqs to the vgic directly from the irq handler.\n\nUnfortunately, the injection path can take any AP list lock and irq lock\nand we must therefore make sure to use spin_lock_irqsave where ever\ninterrupts are enabled and we are taking any of those locks, to avoid\ndeadlocking between process context and the ISR.\n\nThis changes a lot of the VGIC code, but the good news are that the\nchanges are mostly mechanical.\n\nAcked-by: Marc Zyngier <marc,zyngier@arm.com>\nSigned-off-by: Christoffer Dall <cdall@linaro.org>",
  "author_name": "Christoffer Dall",
  "author_email": "cdall@linaro.org",
  "author_date": "Sun Oct 16 22:19:11 2016 +0200",
  "author_date_iso": "2016-10-16T22:19:11+02:00",
  "committer_name": "Christoffer Dall",
  "committer_email": "christoffer.dall@linaro.org",
  "committer_date": "Mon Nov 6 16:23:10 2017 +0100",
  "committer_date_iso": "2017-11-06T16:23:10+01:00",
  "files_changed": [
    "virt/kvm/arm/vgic/vgic-its.c",
    "virt/kvm/arm/vgic/vgic-mmio-v2.c",
    "virt/kvm/arm/vgic/vgic-mmio-v3.c",
    "virt/kvm/arm/vgic/vgic-mmio.c",
    "virt/kvm/arm/vgic/vgic-v2.c",
    "virt/kvm/arm/vgic/vgic-v3.c",
    "virt/kvm/arm/vgic/vgic.c",
    "virt/kvm/arm/vgic/vgic.h"
  ],
  "files_changed_count": 8,
  "stats": [
    {
      "file": "virt/kvm/arm/vgic/vgic-its.c",
      "insertions": 10,
      "deletions": 7
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-mmio-v2.c",
      "insertions": 13,
      "deletions": 9
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-mmio-v3.c",
      "insertions": 10,
      "deletions": 7
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-mmio.c",
      "insertions": 26,
      "deletions": 18
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-v2.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-v3.c",
      "insertions": 7,
      "deletions": 5
    },
    {
      "file": "virt/kvm/arm/vgic/vgic.c",
      "insertions": 36,
      "deletions": 23
    },
    {
      "file": "virt/kvm/arm/vgic/vgic.h",
      "insertions": 2,
      "deletions": 1
    }
  ],
  "total_insertions": 107,
  "total_deletions": 72,
  "total_changes": 179,
  "parents": [
    "f39d16cbabf9f939745a3850a33760910d22ef35"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.15",
    "v4.15-rc1",
    "v4.15-rc2",
    "v4.15-rc3",
    "v4.15-rc4",
    "v4.15-rc5",
    "v4.15-rc6",
    "v4.15-rc7",
    "v4.15-rc8",
    "v4.15-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "virt/kvm/arm/vgic/vgic-its.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-mmio.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-v2.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-mmio-v3.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-mmio-v2.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic-v3.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "virt/kvm/arm/vgic/vgic.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}