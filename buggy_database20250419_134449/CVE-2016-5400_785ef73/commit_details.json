{
  "hash": "785ef73dba6e9fefd2e5dd24546e0efa8698e5cd",
  "hash_short": "785ef73d",
  "subject": "[media] airspy: fix error logic during device register",
  "body": "This patch addresses CVE-2016-5400, a local DOS vulnerability caused by\na memory leak in the airspy usb device driver.\n\nThe vulnerability is triggered when more than 64 usb devices register\nwith v4l2 of type VFL_TYPE_SDR or VFL_TYPE_SUBDEV.A badusb device can\nemulate 64 of these devices then through continual emulated\nconnect/disconnect of the 65th device, cause the kernel to run out of\nRAM and crash the kernel.\n\nThe vulnerability exists in kernel versions from 3.17 to current 4.7.\n\nThe memory leak is caused by the probe function of the airspy driver\nmishandeling errors and not freeing the corresponding control structures\nwhen an error occours registering the device to v4l2 core.\n\nSigned-off-by: James Patrick-Evans <james@jmp-e.com>\nCc: stable@vger.kernel.org # Up to Kernel 3.17\nSigned-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>",
  "full_message": "[media] airspy: fix error logic during device register\n\nThis patch addresses CVE-2016-5400, a local DOS vulnerability caused by\na memory leak in the airspy usb device driver.\n\nThe vulnerability is triggered when more than 64 usb devices register\nwith v4l2 of type VFL_TYPE_SDR or VFL_TYPE_SUBDEV.A badusb device can\nemulate 64 of these devices then through continual emulated\nconnect/disconnect of the 65th device, cause the kernel to run out of\nRAM and crash the kernel.\n\nThe vulnerability exists in kernel versions from 3.17 to current 4.7.\n\nThe memory leak is caused by the probe function of the airspy driver\nmishandeling errors and not freeing the corresponding control structures\nwhen an error occours registering the device to v4l2 core.\n\nSigned-off-by: James Patrick-Evans <james@jmp-e.com>\nCc: stable@vger.kernel.org # Up to Kernel 3.17\nSigned-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>",
  "author_name": "James Patrick-Evans",
  "author_email": "james@jmp-e.com",
  "author_date": "Fri Jul 15 12:40:45 2016 -0300",
  "author_date_iso": "2016-07-15T12:40:45-03:00",
  "committer_name": "Mauro Carvalho Chehab",
  "committer_email": "mchehab@s-opensource.com",
  "committer_date": "Fri Jul 15 13:32:21 2016 -0300",
  "committer_date_iso": "2016-07-15T13:32:21-03:00",
  "files_changed": [
    "drivers/media/usb/airspy/airspy.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/media/usb/airspy/airspy.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "70ad89a2508936c553d0222cc0b7c95648ee3580"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2016-5400"
    ],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/media/usb/airspy/airspy.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}