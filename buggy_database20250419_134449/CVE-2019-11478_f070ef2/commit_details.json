{
  "hash": "f070ef2ac66716357066b683fb0baf55f8191a2e",
  "hash_short": "f070ef2a",
  "subject": "tcp: tcp_fragment() should apply sane memory limits",
  "body": "Jonathan Looney reported that a malicious peer can force a sender\nto fragment its retransmit queue into tiny skbs, inflating memory\nusage and/or overflow 32bit counters.\n\nTCP allows an application to queue up to sk_sndbuf bytes,\nso we need to give some allowance for non malicious splitting\nof retransmit queue.\n\nA new SNMP counter is added to monitor how many times TCP\ndid not allow to split an skb if the allowance was exceeded.\n\nNote that this counter might increase in the case applications\nuse SO_SNDBUF socket option to lower sk_sndbuf.\n\nCVE-2019-11478 : tcp_fragment, prevent fragmenting a packet when the\n\tsocket is already using more than half the allowed space\n\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Jonathan Looney <jtl@netflix.com>\nAcked-by: Neal Cardwell <ncardwell@google.com>\nAcked-by: Yuchung Cheng <ycheng@google.com>\nReviewed-by: Tyler Hicks <tyhicks@canonical.com>\nCc: Bruce Curtis <brucec@netflix.com>\nCc: Jonathan Lemon <jonathan.lemon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "tcp: tcp_fragment() should apply sane memory limits\n\nJonathan Looney reported that a malicious peer can force a sender\nto fragment its retransmit queue into tiny skbs, inflating memory\nusage and/or overflow 32bit counters.\n\nTCP allows an application to queue up to sk_sndbuf bytes,\nso we need to give some allowance for non malicious splitting\nof retransmit queue.\n\nA new SNMP counter is added to monitor how many times TCP\ndid not allow to split an skb if the allowance was exceeded.\n\nNote that this counter might increase in the case applications\nuse SO_SNDBUF socket option to lower sk_sndbuf.\n\nCVE-2019-11478 : tcp_fragment, prevent fragmenting a packet when the\n\tsocket is already using more than half the allowed space\n\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReported-by: Jonathan Looney <jtl@netflix.com>\nAcked-by: Neal Cardwell <ncardwell@google.com>\nAcked-by: Yuchung Cheng <ycheng@google.com>\nReviewed-by: Tyler Hicks <tyhicks@canonical.com>\nCc: Bruce Curtis <brucec@netflix.com>\nCc: Jonathan Lemon <jonathan.lemon@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Eric Dumazet",
  "author_email": "edumazet@google.com",
  "author_date": "Sat May 18 05:12:05 2019 -0700",
  "author_date_iso": "2019-05-18T05:12:05-07:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Sat Jun 15 18:47:31 2019 -0700",
  "committer_date_iso": "2019-06-15T18:47:31-07:00",
  "files_changed": [
    "include/uapi/linux/snmp.h",
    "net/ipv4/proc.c",
    "net/ipv4/tcp_output.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "include/uapi/linux/snmp.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/ipv4/proc.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/ipv4/tcp_output.c",
      "insertions": 5,
      "deletions": 0
    }
  ],
  "total_insertions": 7,
  "total_deletions": 0,
  "total_changes": 7,
  "parents": [
    "3b4929f65b0d8249f19a50245cd88ed1a2f78cff"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.2",
    "v5.2-rc6",
    "v5.2-rc7",
    "v5.3",
    "v5.3-rc1",
    "v5.3-rc2",
    "v5.3-rc3",
    "v5.3-rc4",
    "v5.3-rc5",
    "v5.3-rc6"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2019-11478"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "include/uapi/linux/snmp.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/proc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/tcp_output.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}