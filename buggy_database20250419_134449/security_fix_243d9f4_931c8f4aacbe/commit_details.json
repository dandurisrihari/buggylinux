{
  "hash": "243d9f436f89f95c304011bd32485afc27581986",
  "hash_short": "243d9f43",
  "subject": "IB/hfi1: Add transmit fault injection feature",
  "body": "Add ability to fault packets on transmit by opcode.\nDropping by packet can be achieved by setting the mask to 0.\n\nIn order to drop non-verbs traffic we set PbcInsertHrc\nto NONE (0x2). The packet will still be delivered to\nthe receiving node but a KHdrHCRCErr (KDETH packet\nwith a bad HCRC) will be triggered and the packet will\nnot be delivered to the correct context.\n\nIn order to drop regular verbs traffic we set the\nPbcTestEbp flag. The packet will still be delivered\nto the receiving node but a 'late ebp error' will\nbe triggered and will be dropped.\n\nA global toggle (/sys/kernel/debug/hfi1/hfi1_X/fault_suppress_err)\nhas been added to suppress the error messages on the receive\nnode when a packet was faulted on the sending node.\n\nReviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>\nSigned-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>\nSigned-off-by: Don Hiatt <don.hiatt@intel.com>\nSigned-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>\nSigned-off-by: Doug Ledford <dledford@redhat.com>",
  "full_message": "IB/hfi1: Add transmit fault injection feature\n\nAdd ability to fault packets on transmit by opcode.\nDropping by packet can be achieved by setting the mask to 0.\n\nIn order to drop non-verbs traffic we set PbcInsertHrc\nto NONE (0x2). The packet will still be delivered to\nthe receiving node but a KHdrHCRCErr (KDETH packet\nwith a bad HCRC) will be triggered and the packet will\nnot be delivered to the correct context.\n\nIn order to drop regular verbs traffic we set the\nPbcTestEbp flag. The packet will still be delivered\nto the receiving node but a 'late ebp error' will\nbe triggered and will be dropped.\n\nA global toggle (/sys/kernel/debug/hfi1/hfi1_X/fault_suppress_err)\nhas been added to suppress the error messages on the receive\nnode when a packet was faulted on the sending node.\n\nReviewed-by: Dennis Dalessandro <dennis.dalessandro@intel.com>\nSigned-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>\nSigned-off-by: Don Hiatt <don.hiatt@intel.com>\nSigned-off-by: Dennis Dalessandro <dennis.dalessandro@intel.com>\nSigned-off-by: Doug Ledford <dledford@redhat.com>",
  "author_name": "Don Hiatt",
  "author_email": "don.hiatt@intel.com",
  "author_date": "Mon Mar 20 17:26:20 2017 -0700",
  "author_date_iso": "2017-03-20T17:26:20-07:00",
  "committer_name": "Doug Ledford",
  "committer_email": "dledford@redhat.com",
  "committer_date": "Wed Apr 5 14:45:09 2017 -0400",
  "committer_date_iso": "2017-04-05T14:45:09-04:00",
  "files_changed": [
    "drivers/infiniband/hw/hfi1/chip.c",
    "drivers/infiniband/hw/hfi1/debugfs.c",
    "drivers/infiniband/hw/hfi1/debugfs.h",
    "drivers/infiniband/hw/hfi1/driver.c",
    "drivers/infiniband/hw/hfi1/verbs.c",
    "drivers/infiniband/hw/hfi1/verbs.h",
    "include/rdma/ib_pack.h"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "drivers/infiniband/hw/hfi1/chip.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/hfi1/debugfs.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/hfi1/debugfs.h",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/hfi1/driver.c",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/hfi1/verbs.c",
      "insertions": 42,
      "deletions": 7
    },
    {
      "file": "drivers/infiniband/hw/hfi1/verbs.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/rdma/ib_pack.h",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 79,
  "total_deletions": 7,
  "total_changes": 86,
  "parents": [
    "0181ce31b26021f7c2f9506112a05c847a36f0f2"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.12",
    "v4.12-rc1",
    "v4.12-rc2",
    "v4.12-rc3",
    "v4.12-rc4",
    "v4.12-rc5",
    "v4.12-rc6",
    "v4.12-rc7",
    "v4.13",
    "v4.13-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/infiniband/hw/hfi1/debugfs.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/hfi1/debugfs.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/hfi1/chip.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/rdma/ib_pack.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/hfi1/verbs.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/hfi1/driver.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/hfi1/verbs.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}