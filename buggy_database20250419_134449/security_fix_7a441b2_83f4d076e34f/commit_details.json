{
  "hash": "7a441b2110527851f630144ec76ab8409e1d6c61",
  "hash_short": "7a441b21",
  "subject": "iommu/amd: Use pci_ats_supported()",
  "body": "The pci_ats_supported() function checks if a device supports ATS and is\nallowed to use it. In addition to checking that the device has an ATS\ncapability and that the global pci=noats is not set\n(pci_ats_disabled()), it also checks if a device is untrusted.\n\nA device is untrusted if it is plugged into an external-facing port such\nas Thunderbolt and could be spoofing an existing device to exploit\nweaknesses in the IOMMU configuration. By calling pci_ats_supported() we\nkeep DTE[I]=0 for untrusted devices and abort transactions with\nPretranslated Addresses.\n\nSigned-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>\nReviewed-by: Joerg Roedel <jroedel@suse.de>\nLink: https://lore.kernel.org/r/20200520152201.3309416-3-jean-philippe@linaro.org\nSigned-off-by: Joerg Roedel <jroedel@suse.de>",
  "full_message": "iommu/amd: Use pci_ats_supported()\n\nThe pci_ats_supported() function checks if a device supports ATS and is\nallowed to use it. In addition to checking that the device has an ATS\ncapability and that the global pci=noats is not set\n(pci_ats_disabled()), it also checks if a device is untrusted.\n\nA device is untrusted if it is plugged into an external-facing port such\nas Thunderbolt and could be spoofing an existing device to exploit\nweaknesses in the IOMMU configuration. By calling pci_ats_supported() we\nkeep DTE[I]=0 for untrusted devices and abort transactions with\nPretranslated Addresses.\n\nSigned-off-by: Jean-Philippe Brucker <jean-philippe@linaro.org>\nReviewed-by: Joerg Roedel <jroedel@suse.de>\nLink: https://lore.kernel.org/r/20200520152201.3309416-3-jean-philippe@linaro.org\nSigned-off-by: Joerg Roedel <jroedel@suse.de>",
  "author_name": "Jean-Philippe Brucker",
  "author_email": "jean-philippe@linaro.org",
  "author_date": "Wed May 20 17:22:01 2020 +0200",
  "author_date_iso": "2020-05-20T17:22:01+02:00",
  "committer_name": "Joerg Roedel",
  "committer_email": "jroedel@suse.de",
  "committer_date": "Wed May 27 14:35:41 2020 +0200",
  "committer_date_iso": "2020-05-27T14:35:41+02:00",
  "files_changed": [
    "drivers/iommu/amd_iommu.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/iommu/amd_iommu.c",
      "insertions": 4,
      "deletions": 8
    }
  ],
  "total_insertions": 4,
  "total_deletions": 8,
  "total_changes": 12,
  "parents": [
    "521376741b2c26fe53a1ec24d02da24d477eb739"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/iommu/amd_iommu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}