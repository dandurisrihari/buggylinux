Commit Hash: 45cf86f26148e549c5ba4a8ab32a390e4bde216e
Subject: kvm: x86: Advertise FLUSH_L1D to user space


Security Keywords:
- vulnerability

Full commit message:
kvm: x86: Advertise FLUSH_L1D to user space

FLUSH_L1D was already added in 11e34e64e4103, but the feature is not
visible to userspace yet.

The bit definition:
CPUID.(EAX=7,ECX=0):EDX[bit 28]

If the feature is supported by the host, kvm should support it too so
that userspace can choose whether to expose it to the guest or not.
One disadvantage of not exposing it is that the guest will report
a non existing vulnerability in
/sys/devices/system/cpu/vulnerabilities/mmio_stale_data
because the mitigation is present only if the guest supports
(FLUSH_L1D and MD_CLEAR) or FB_CLEAR.

Signed-off-by: Emanuele Giuseppe Esposito <eesposit@redhat.com>
Message-Id: <20230201132905.549148-4-eesposit@redhat.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Emanuele Giuseppe Esposito <eesposit@redhat.com>
Author Date: Wed Feb 1 08:29:05 2023 -0500
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Thu Mar 16 10:18:05 2023 -0400

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
