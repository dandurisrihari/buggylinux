{
  "hash": "eaf06b241b091357e72b76863ba16e89610d31bd",
  "hash_short": "eaf06b24",
  "subject": "Restrict unprivileged access to kernel syslog",
  "body": "The kernel syslog contains debugging information that is often useful\nduring exploitation of other vulnerabilities, such as kernel heap\naddresses.  Rather than futilely attempt to sanitize hundreds (or\nthousands) of printk statements and simultaneously cripple useful\ndebugging functionality, it is far simpler to create an option that\nprevents unprivileged users from reading the syslog.\n\nThis patch, loosely based on grsecurity's GRKERNSEC_DMESG, creates the\ndmesg_restrict sysctl.  When set to \"0\", the default, no restrictions are\nenforced.  When set to \"1\", only users with CAP_SYS_ADMIN can read the\nkernel syslog via dmesg(8) or other mechanisms.\n\n[akpm@linux-foundation.org: explain the config option in kernel.txt]\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nAcked-by: Ingo Molnar <mingo@elte.hu>\nAcked-by: Eugene Teo <eugeneteo@kernel.org>\nAcked-by: Kees Cook <kees.cook@canonical.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "Restrict unprivileged access to kernel syslog\n\nThe kernel syslog contains debugging information that is often useful\nduring exploitation of other vulnerabilities, such as kernel heap\naddresses.  Rather than futilely attempt to sanitize hundreds (or\nthousands) of printk statements and simultaneously cripple useful\ndebugging functionality, it is far simpler to create an option that\nprevents unprivileged users from reading the syslog.\n\nThis patch, loosely based on grsecurity's GRKERNSEC_DMESG, creates the\ndmesg_restrict sysctl.  When set to \"0\", the default, no restrictions are\nenforced.  When set to \"1\", only users with CAP_SYS_ADMIN can read the\nkernel syslog via dmesg(8) or other mechanisms.\n\n[akpm@linux-foundation.org: explain the config option in kernel.txt]\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nAcked-by: Ingo Molnar <mingo@elte.hu>\nAcked-by: Eugene Teo <eugeneteo@kernel.org>\nAcked-by: Kees Cook <kees.cook@canonical.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Dan Rosenberg",
  "author_email": "drosenberg@vsecurity.com",
  "author_date": "Thu Nov 11 14:05:18 2010 -0800",
  "author_date_iso": "2010-11-11T14:05:18-08:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Fri Nov 12 07:55:32 2010 -0800",
  "committer_date_iso": "2010-11-12T07:55:32-08:00",
  "files_changed": [
    "Documentation/sysctl/kernel.txt",
    "include/linux/kernel.h",
    "kernel/printk.c",
    "kernel/sysctl.c",
    "security/Kconfig",
    "security/commoncap.c"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "Documentation/sysctl/kernel.txt",
      "insertions": 14,
      "deletions": 0
    },
    {
      "file": "include/linux/kernel.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "kernel/printk.c",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "kernel/sysctl.c",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "security/Kconfig",
      "insertions": 12,
      "deletions": 0
    },
    {
      "file": "security/commoncap.c",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 44,
  "total_deletions": 0,
  "total_changes": 44,
  "parents": [
    "203f40a5a030ed4048cd40e3bd9ab5df6c5df589"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.37",
    "v2.6.37-rc2",
    "v2.6.37-rc3",
    "v2.6.37-rc4",
    "v2.6.37-rc5",
    "v2.6.37-rc6",
    "v2.6.37-rc7",
    "v2.6.37-rc8",
    "v2.6.38",
    "v2.6.38-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "sanitize"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "kernel/printk.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "Documentation/sysctl/kernel.txt",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/kernel.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/commoncap.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/sysctl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}