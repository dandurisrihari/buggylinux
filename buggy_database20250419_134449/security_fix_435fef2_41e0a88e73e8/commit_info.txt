Commit Hash: 435fef20acfc48f46476abad55b0cd3aa47b8365
Subject: Bluetooth: Don't enforce authentication for L2CAP PSM 1 and 3


Security Keywords:
- authentication

Full commit message:
Bluetooth: Don't enforce authentication for L2CAP PSM 1 and 3

The recommendation for the L2CAP PSM 1 (SDP) is to not use any kind
of authentication or encryption. So don't trigger authentication
for incoming and outgoing SDP connections.

For L2CAP PSM 3 (RFCOMM) there is no clear requirement, but with
Bluetooth 2.1 the initiator is required to enable authentication
and encryption first and this gets enforced. So there is no need
to trigger an additional authentication step. The RFCOMM service
security will make sure that a secure enough link key is present.

When the encryption gets enabled after the SDP connection setup,
then switch the security level from SDP to low security.

Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Marcel Holtmann <marcel@holtmann.org>
Author Date: Mon Feb 9 03:55:28 2009 +0100
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Fri Feb 27 06:14:41 2009 +0100

Files Changed: 2
Lines Added: 7
Lines Removed: 1
Total Changes: 8
