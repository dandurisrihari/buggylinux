Commit Hash: 09b661b33268698d3b453dceb78cda129ad899b4
Subject: wl12xx: fix potential buffer overflow in testmode nvs push


Security Keywords:
- security hole

Full commit message:
wl12xx: fix potential buffer overflow in testmode nvs push

We were allocating the size of the NVS file struct and not checking
whether the length of the buffer passed was correct before copying it
into the allocated memory.  This is a security hole because buffer
overflows can occur if the userspace passes a bigger file than what is
expected.

With this patch, we check if the size of the data passed from
userspace matches the size required.

This bug was introduced in 2.6.36.

Cc: stable@kernel.org
Reported-by: Ido Yariv <ido@wizery.com>
Signed-off-by: Luciano Coelho <coelho@ti.com>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Luciano Coelho <coelho@ti.com>
Author Date: Fri Apr 1 19:42:02 2011 +0300
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Mon Apr 4 15:22:12 2011 -0400

Files Changed: 1
Lines Added: 4
Lines Removed: 1
Total Changes: 5
