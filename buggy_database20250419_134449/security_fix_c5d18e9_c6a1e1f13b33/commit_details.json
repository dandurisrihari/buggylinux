{
  "hash": "c5d18e984a313adf5a1a4ae69e0b1d93cf410229",
  "hash_short": "c5d18e98",
  "subject": "[IPSEC]: Fix catch-22 with algorithm IDs above 31",
  "body": "As it stands it's impossible to use any authentication algorithms\nwith an ID above 31 portably.  It just happens to work on x86 but\nfails miserably on ppc64.\n\nThe reason is that we're using a bit mask to check the algorithm\nID but the mask is only 32 bits wide.\n\nAfter looking at how this is used in the field, I have concluded\nthat in the long term we should phase out state matching by IDs\nbecause this is made superfluous by the reqid feature.  For current\napplications, the best solution IMHO is to allow all algorithms when\nthe bit masks are all ~0.\n\nThe following patch does exactly that.\n\nThis bug was identified by IBM when testing on the ppc64 platform\nusing the NULL authentication algorithm which has an ID of 251.\n\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "[IPSEC]: Fix catch-22 with algorithm IDs above 31\n\nAs it stands it's impossible to use any authentication algorithms\nwith an ID above 31 portably.  It just happens to work on x86 but\nfails miserably on ppc64.\n\nThe reason is that we're using a bit mask to check the algorithm\nID but the mask is only 32 bits wide.\n\nAfter looking at how this is used in the field, I have concluded\nthat in the long term we should phase out state matching by IDs\nbecause this is made superfluous by the reqid feature.  For current\napplications, the best solution IMHO is to allow all algorithms when\nthe bit masks are all ~0.\n\nThe following patch does exactly that.\n\nThis bug was identified by IBM when testing on the ppc64 platform\nusing the NULL authentication algorithm which has an ID of 251.\n\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Herbert Xu",
  "author_email": "herbert@gondor.apana.org.au",
  "author_date": "Tue Apr 22 00:46:42 2008 -0700",
  "author_date_iso": "2008-04-22T00:46:42-07:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Apr 22 00:46:42 2008 -0700",
  "committer_date_iso": "2008-04-22T00:46:42-07:00",
  "files_changed": [
    "include/net/xfrm.h",
    "net/key/af_key.c",
    "net/xfrm/xfrm_policy.c",
    "net/xfrm/xfrm_user.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "include/net/xfrm.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "net/key/af_key.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/xfrm/xfrm_policy.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/xfrm/xfrm_user.c",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 7,
  "total_deletions": 2,
  "total_changes": 9,
  "parents": [
    "7c3f944e29c02d71e13442e977cf4cec19c39e98"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.26",
    "v2.6.26-rc1",
    "v2.6.26-rc2",
    "v2.6.26-rc3",
    "v2.6.26-rc4",
    "v2.6.26-rc5",
    "v2.6.26-rc6",
    "v2.6.26-rc7",
    "v2.6.26-rc8",
    "v2.6.26-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/xfrm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/key/af_key.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/xfrm/xfrm_policy.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/xfrm/xfrm_user.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}