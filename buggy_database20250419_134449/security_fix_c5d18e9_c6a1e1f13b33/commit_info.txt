Commit Hash: c5d18e984a313adf5a1a4ae69e0b1d93cf410229
Subject: [IPSEC]: Fix catch-22 with algorithm IDs above 31


Security Keywords:
- authentication

Full commit message:
[IPSEC]: Fix catch-22 with algorithm IDs above 31

As it stands it's impossible to use any authentication algorithms
with an ID above 31 portably.  It just happens to work on x86 but
fails miserably on ppc64.

The reason is that we're using a bit mask to check the algorithm
ID but the mask is only 32 bits wide.

After looking at how this is used in the field, I have concluded
that in the long term we should phase out state matching by IDs
because this is made superfluous by the reqid feature.  For current
applications, the best solution IMHO is to allow all algorithms when
the bit masks are all ~0.

The following patch does exactly that.

This bug was identified by IBM when testing on the ppc64 platform
using the NULL authentication algorithm which has an ID of 251.

Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Herbert Xu <herbert@gondor.apana.org.au>
Author Date: Tue Apr 22 00:46:42 2008 -0700
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Tue Apr 22 00:46:42 2008 -0700

Files Changed: 4
Lines Added: 7
Lines Removed: 2
Total Changes: 9
