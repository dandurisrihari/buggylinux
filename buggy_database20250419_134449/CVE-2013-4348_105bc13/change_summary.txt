Files changed: 8
Insertions: 3066
Deletions: 231
Total changes: 3297

File-specific changes:
include/linux/bpf.h: +1 -0
include/linux/bpf_types.h: +1 -0
include/linux/skbuff.h: +20 -0
include/net/net_namespace.h: +3 -0
include/net/sch_generic.h: +9 -3
include/uapi/linux/bpf.h: +26 -0
kernel/bpf/arraymap.c: +24 -1
kernel/bpf/sockmap.c: +2 -4
kernel/bpf/syscall.c: +8 -0
kernel/bpf/verifier.c: +40 -8
net/core/filter.c: +109 -30
net/core/flow_dissector.c: +140 -0
samples/bpf/bpf_load.c: +0 -1
samples/bpf/sampleip_user.c: +0 -1
samples/bpf/sockex2_kern.c: +6 -5
samples/bpf/sockex3_kern.c: +4 -4
samples/bpf/sockex3_user.c: +2 -2
samples/bpf/test_current_task_under_cgroup_user.c: +0 -1
tools/bpf/bpftool/Documentation/bpftool-net.rst: +139 -0
tools/bpf/bpftool/Documentation/bpftool.rst: +4 -2
tools/bpf/bpftool/bash-completion/bpftool: +13 -4
tools/bpf/bpftool/main.c: +2 -1
tools/bpf/bpftool/main.h: +8 -0
tools/bpf/bpftool/map.c: +4 -8
tools/bpf/bpftool/net.c: +272 -0
tools/bpf/bpftool/netlink_dumper.c: +174 -0
tools/bpf/bpftool/netlink_dumper.h: +95 -0
tools/bpf/bpftool/prog.c: +1 -0
tools/include/uapi/linux/bpf.h: +26 -0
tools/lib/bpf/Build: +1 -1
tools/lib/bpf/bpf.c: +0 -129
tools/lib/bpf/libbpf.c: +3 -1
tools/lib/bpf/libbpf.h: +16 -0
tools/lib/bpf/libbpf_errno.c: +1 -0
tools/lib/bpf/netlink.c: +331 -0
tools/lib/bpf/nlattr.c: +21 -12
tools/lib/bpf/nlattr.h: +38 -0
tools/testing/selftests/bpf/.gitignore: +6 -0
tools/testing/selftests/bpf/Makefile: +5 -3
tools/testing/selftests/bpf/bpf_flow.c: +373 -0
tools/testing/selftests/bpf/config: +1 -0
tools/testing/selftests/bpf/flow_dissector_load.c: +140 -0
tools/testing/selftests/bpf/test_flow_dissector.c: +782 -0
tools/testing/selftests/bpf/test_flow_dissector.sh: +115 -0
tools/testing/selftests/bpf/test_progs.c: +10 -10
tools/testing/selftests/bpf/with_addr.sh: +54 -0
tools/testing/selftests/bpf/with_tunnels.sh: +36 -0
