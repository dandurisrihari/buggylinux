Commit Hash: fd19d3b45164466a4adce7cbff448ba9189e1427
Subject: KVM: nVMX: update last_nonleaf_level when initializing nested EPT

CVE Identifiers:
- CVE-2017-12188

Full commit message:
KVM: nVMX: update last_nonleaf_level when initializing nested EPT

The function updates context->root_level but didn't call
update_last_nonleaf_level so the previous and potentially wrong value
was used for page walks.  For example, a zero value of last_nonleaf_level
would allow a potential out-of-bounds access in arch/x86/mmu/paging_tmpl.h's
walk_addr_generic function (CVE-2017-12188).

Fixes: 155a97a3d7c78b46cef6f1a973c831bc5a4f82bb
Signed-off-by: Ladi Prosek <lprosek@redhat.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Ladi Prosek <lprosek@redhat.com>
Author Date: Thu Oct 5 11:10:22 2017 +0200
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Tue Oct 10 15:31:18 2017 +0200

Files Changed: 1
Lines Added: 1
Lines Removed: 0
Total Changes: 1
