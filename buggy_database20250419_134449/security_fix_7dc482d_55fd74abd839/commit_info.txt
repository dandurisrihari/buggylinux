Commit Hash: 7dc482dfeeeefcfd000d4271c4626937406756d7
Subject: drm/r128: Add test for initialisation to all ioctls that require it


Security Keywords:
- security vulnerability
- vulnerability

Full commit message:
drm/r128: Add test for initialisation to all ioctls that require it

Almost all r128's private ioctls require that the CCE state has
already been initialised.  However, most do not test that this has
been done, and will proceed to dereference a null pointer.  This may
result in a security vulnerability, since some ioctls are
unprivileged.

This adds a macro for the common initialisation test and changes all
ioctl implementations that require prior initialisation to use that
macro.

Also, r128_do_init_cce() does not test that the CCE state has not
been initialised already.  Repeated initialisation may lead to a crash
or resource leak.  This adds that test.

Signed-off-by: Ben Hutchings <ben@decadent.org.uk>
Signed-off-by: Dave Airlie <airlied@redhat.com>

Metadata:
Author: Ben Hutchings <ben@decadent.org.uk>
Author Date: Sun Aug 23 16:59:04 2009 +0100
Committer: Dave Airlie <airlied@redhat.com>
Commit Date: Mon Aug 31 09:09:30 2009 +1000

Files Changed: 3
Lines Added: 41
Lines Removed: 21
Total Changes: 62
