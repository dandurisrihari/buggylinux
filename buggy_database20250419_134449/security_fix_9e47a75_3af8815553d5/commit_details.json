{
  "hash": "9e47a758b70167c9301d2b44d2569f86c7796f2d",
  "hash_short": "9e47a758",
  "subject": "crypto: lib/mpi - avoid null pointer deref in mpi_cmp_ui()",
  "body": "During NVMeTCP Authentication a controller can trigger a kernel\noops by specifying the 8192 bit Diffie Hellman group and passing\na correctly sized, but zeroed Diffie Hellamn value.\nmpi_cmp_ui() was detecting this if the second parameter was 0,\nbut 1 is passed from dh_is_pubkey_valid(). This causes the null\npointer u->d to be dereferenced towards the end of mpi_cmp_ui()\n\nSigned-off-by: Mark O'Donovan <shiftee@posteo.net>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "crypto: lib/mpi - avoid null pointer deref in mpi_cmp_ui()\n\nDuring NVMeTCP Authentication a controller can trigger a kernel\noops by specifying the 8192 bit Diffie Hellman group and passing\na correctly sized, but zeroed Diffie Hellamn value.\nmpi_cmp_ui() was detecting this if the second parameter was 0,\nbut 1 is passed from dh_is_pubkey_valid(). This causes the null\npointer u->d to be dereferenced towards the end of mpi_cmp_ui()\n\nSigned-off-by: Mark O'Donovan <shiftee@posteo.net>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Mark O'Donovan",
  "author_email": "shiftee@posteo.net",
  "author_date": "Fri Aug 4 09:32:18 2023 +0000",
  "author_date_iso": "2023-08-04T09:32:18+00:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Fri Aug 11 19:19:52 2023 +0800",
  "committer_date_iso": "2023-08-11T19:19:52+08:00",
  "files_changed": [
    "lib/crypto/mpi/mpi-cmp.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "lib/crypto/mpi/mpi-cmp.c",
      "insertions": 6,
      "deletions": 2
    }
  ],
  "total_insertions": 6,
  "total_deletions": 2,
  "total_changes": 8,
  "parents": [
    "2a598d0b2800aa23ba51adcf060cec524aaa63b2"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "lib/crypto/mpi/mpi-cmp.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}