Commit Hash: 9e47a758b70167c9301d2b44d2569f86c7796f2d
Subject: crypto: lib/mpi - avoid null pointer deref in mpi_cmp_ui()


Security Keywords:
- Authentication

Full commit message:
crypto: lib/mpi - avoid null pointer deref in mpi_cmp_ui()

During NVMeTCP Authentication a controller can trigger a kernel
oops by specifying the 8192 bit Diffie Hellman group and passing
a correctly sized, but zeroed Diffie Hellamn value.
mpi_cmp_ui() was detecting this if the second parameter was 0,
but 1 is passed from dh_is_pubkey_valid(). This causes the null
pointer u->d to be dereferenced towards the end of mpi_cmp_ui()

Signed-off-by: Mark O'Donovan <shiftee@posteo.net>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

Metadata:
Author: Mark O'Donovan <shiftee@posteo.net>
Author Date: Fri Aug 4 09:32:18 2023 +0000
Committer: Herbert Xu <herbert@gondor.apana.org.au>
Commit Date: Fri Aug 11 19:19:52 2023 +0800

Files Changed: 1
Lines Added: 6
Lines Removed: 2
Total Changes: 8
