Commit Hash: 75c1182e18f4a66bbd2c91511b6b629dac6a27dc
Subject: security: don't treat structure as an array of struct hlist_head


Security Keywords:
- hardening

Full commit message:
security: don't treat structure as an array of struct hlist_head

The initialization of "security_hook_heads" is done by casting it to
another structure pointer type, and treating it as an array of "struct
hlist_head" objects. This requires an exception be made in "randstruct",
because otherwise it will emit an error, reducing the effectiveness of
the hardening technique.

Instead of using a cast, initialize the individual struct hlist_head
elements in security_hook_heads explicitly. This removes the need for
the cast and randstruct exception.

Signed-off-by: Bill Wendling <morbo@google.com>
Cc: Kees Cook <keescook@chromium.org>
Signed-off-by: Kees Cook <keescook@chromium.org>
Link: https://lore.kernel.org/r/20220407175930.471870-1-morbo@google.com

Metadata:
Author: Bill Wendling <morbo@google.com>
Author Date: Thu Apr 7 10:59:30 2022 -0700
Committer: Kees Cook <keescook@chromium.org>
Commit Date: Wed Apr 13 12:15:53 2022 -0700

Files Changed: 2
Lines Added: 4
Lines Removed: 7
Total Changes: 11
