Commit Hash: 8c23670f2b0004edb8f7135e314114f0c3452085
Subject: KVM: nVMX: Suppress external interrupt VM-Exit injection if there's no IRQ


Security Keywords:
- injection

Full commit message:
KVM: nVMX: Suppress external interrupt VM-Exit injection if there's no IRQ

In the should-be-impossible scenario that kvm_cpu_get_interrupt() doesn't
return a valid vector after checking kvm_cpu_has_interrupt(), skip VM-Exit
injection to reduce the probability of crashing/confusing L1.  Now that
KVM gets the IRQ _before_ calling nested_vmx_vmexit(), squashing the
VM-Exit injection is trivial since there are no actions that need to be
undone.

Reviewed-by: Chao Gao <chao.gao@intel.com>
Link: https://lore.kernel.org/r/20240906043413.1049633-4-seanjc@google.com
Signed-off-by: Sean Christopherson <seanjc@google.com>

Metadata:
Author: Sean Christopherson <seanjc@google.com>
Author Date: Thu Sep 5 21:34:09 2024 -0700
Committer: Sean Christopherson <seanjc@google.com>
Commit Date: Mon Sep 9 20:14:59 2024 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
