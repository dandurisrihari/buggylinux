Commit Hash: b6ab149654ef1fada0b37b379c04c475c2fdc675
Subject: net: lan966x: Fix sleep in atomic context when injecting frames


Security Keywords:
- injection

Full commit message:
net: lan966x: Fix sleep in atomic context when injecting frames

On lan966x, when injecting a frame it was polling the register
QS_INJ_STATUS to see if it can continue with the injection of the frame.
The problem was that it was using readx_poll_timeout which could sleep
in atomic context.
This patch fixes this issue by using readx_poll_timeout_atomic.

Fixes: d28d6d2e37d10d ("net: lan966x: add port module support")
Signed-off-by: Horatiu Vultur <horatiu.vultur@microchip.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Horatiu Vultur <horatiu.vultur@microchip.com>
Author Date: Tue Jan 25 12:48:15 2022 +0100
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Wed Jan 26 15:45:49 2022 +0000

Files Changed: 1
Lines Added: 3
Lines Removed: 3
Total Changes: 6
