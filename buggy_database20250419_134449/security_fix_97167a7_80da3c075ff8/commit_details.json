{
  "hash": "97167a7681e9a587ee75955bcbbf27e90f0883b9",
  "hash_short": "97167a76",
  "subject": "mm/madvise.c: clean up MADV_SOFT_OFFLINE and MADV_HWPOISON",
  "body": "This cleans up handling MADV_SOFT_OFFLINE and MADV_HWPOISON called\nthrough madvise() system call.\n\n* madvise_memory_failure() was misleading to accommodate handling of\n  both memory_failure() as well as soft_offline_page() functions.\n  Basically it handles memory error injection from user space which\n  can go either way as memory failure or soft offline. Renamed as\n  madvise_inject_error() instead.\n\n* Renamed struct page pointer 'p' to 'page'.\n\n* pr_info() was essentially printing PFN value but it said 'page'\n  which was misleading. Made the process virtual address explicit.\n\nBefore the patch:\n\nSoft offlining page 0x15e3e at 0x3fff8c230000\nSoft offlining page 0x1f3 at 0x3fffa0da0000\nSoft offlining page 0x744 at 0x3fff7d200000\nSoft offlining page 0x1634d at 0x3fff95e20000\nSoft offlining page 0x16349 at 0x3fff95e30000\nSoft offlining page 0x1d6 at 0x3fff9e8b0000\nSoft offlining page 0x5f3 at 0x3fff91bd0000\n\nInjecting memory failure for page 0x15c8b at 0x3fff83280000\nInjecting memory failure for page 0x16190 at 0x3fff83290000\nInjecting memory failure for page 0x740 at 0x3fff9a2e0000\nInjecting memory failure for page 0x741 at 0x3fff9a2f0000\n\nAfter the patch:\n\nSoft offlining pfn 0x1484e at process virtual address 0x3fff883c0000\nSoft offlining pfn 0x1484f at process virtual address 0x3fff883d0000\nSoft offlining pfn 0x14850 at process virtual address 0x3fff883e0000\nSoft offlining pfn 0x14851 at process virtual address 0x3fff883f0000\nSoft offlining pfn 0x14852 at process virtual address 0x3fff88400000\nSoft offlining pfn 0x14853 at process virtual address 0x3fff88410000\nSoft offlining pfn 0x14854 at process virtual address 0x3fff88420000\nSoft offlining pfn 0x1521c at process virtual address 0x3fff6bc70000\n\nInjecting memory failure for pfn 0x10fcf at process virtual address 0x3fff86310000\nInjecting memory failure for pfn 0x10fd0 at process virtual address 0x3fff86320000\nInjecting memory failure for pfn 0x10fd1 at process virtual address 0x3fff86330000\nInjecting memory failure for pfn 0x10fd2 at process virtual address 0x3fff86340000\nInjecting memory failure for pfn 0x10fd3 at process virtual address 0x3fff86350000\nInjecting memory failure for pfn 0x10fd4 at process virtual address 0x3fff86360000\nInjecting memory failure for pfn 0x10fd5 at process virtual address 0x3fff86370000\n\nLink: http://lkml.kernel.org/r/20170410084701.11248-1-khandual@linux.vnet.ibm.com\nSigned-off-by: Anshuman Khandual <khandual@linux.vnet.ibm.com>\nReviewed-by: Naoya Horiguchi <n-horiguchi@ah.jp.nec.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "mm/madvise.c: clean up MADV_SOFT_OFFLINE and MADV_HWPOISON\n\nThis cleans up handling MADV_SOFT_OFFLINE and MADV_HWPOISON called\nthrough madvise() system call.\n\n* madvise_memory_failure() was misleading to accommodate handling of\n  both memory_failure() as well as soft_offline_page() functions.\n  Basically it handles memory error injection from user space which\n  can go either way as memory failure or soft offline. Renamed as\n  madvise_inject_error() instead.\n\n* Renamed struct page pointer 'p' to 'page'.\n\n* pr_info() was essentially printing PFN value but it said 'page'\n  which was misleading. Made the process virtual address explicit.\n\nBefore the patch:\n\nSoft offlining page 0x15e3e at 0x3fff8c230000\nSoft offlining page 0x1f3 at 0x3fffa0da0000\nSoft offlining page 0x744 at 0x3fff7d200000\nSoft offlining page 0x1634d at 0x3fff95e20000\nSoft offlining page 0x16349 at 0x3fff95e30000\nSoft offlining page 0x1d6 at 0x3fff9e8b0000\nSoft offlining page 0x5f3 at 0x3fff91bd0000\n\nInjecting memory failure for page 0x15c8b at 0x3fff83280000\nInjecting memory failure for page 0x16190 at 0x3fff83290000\nInjecting memory failure for page 0x740 at 0x3fff9a2e0000\nInjecting memory failure for page 0x741 at 0x3fff9a2f0000\n\nAfter the patch:\n\nSoft offlining pfn 0x1484e at process virtual address 0x3fff883c0000\nSoft offlining pfn 0x1484f at process virtual address 0x3fff883d0000\nSoft offlining pfn 0x14850 at process virtual address 0x3fff883e0000\nSoft offlining pfn 0x14851 at process virtual address 0x3fff883f0000\nSoft offlining pfn 0x14852 at process virtual address 0x3fff88400000\nSoft offlining pfn 0x14853 at process virtual address 0x3fff88410000\nSoft offlining pfn 0x14854 at process virtual address 0x3fff88420000\nSoft offlining pfn 0x1521c at process virtual address 0x3fff6bc70000\n\nInjecting memory failure for pfn 0x10fcf at process virtual address 0x3fff86310000\nInjecting memory failure for pfn 0x10fd0 at process virtual address 0x3fff86320000\nInjecting memory failure for pfn 0x10fd1 at process virtual address 0x3fff86330000\nInjecting memory failure for pfn 0x10fd2 at process virtual address 0x3fff86340000\nInjecting memory failure for pfn 0x10fd3 at process virtual address 0x3fff86350000\nInjecting memory failure for pfn 0x10fd4 at process virtual address 0x3fff86360000\nInjecting memory failure for pfn 0x10fd5 at process virtual address 0x3fff86370000\n\nLink: http://lkml.kernel.org/r/20170410084701.11248-1-khandual@linux.vnet.ibm.com\nSigned-off-by: Anshuman Khandual <khandual@linux.vnet.ibm.com>\nReviewed-by: Naoya Horiguchi <n-horiguchi@ah.jp.nec.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Anshuman Khandual",
  "author_email": "khandual@linux.vnet.ibm.com",
  "author_date": "Wed May 3 14:55:25 2017 -0700",
  "author_date_iso": "2017-05-03T14:55:25-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Wed May 3 15:52:11 2017 -0700",
  "committer_date_iso": "2017-05-03T15:52:11-07:00",
  "files_changed": [
    "mm/madvise.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "mm/madvise.c",
      "insertions": 20,
      "deletions": 14
    }
  ],
  "total_insertions": 20,
  "total_deletions": 14,
  "total_changes": 34,
  "parents": [
    "70bc0dc578b3f3aafefc4f5e874bdd378680acca"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.12",
    "v4.12-rc1",
    "v4.12-rc2",
    "v4.12-rc3",
    "v4.12-rc4",
    "v4.12-rc5",
    "v4.12-rc6",
    "v4.12-rc7",
    "v4.13",
    "v4.13-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "mm/madvise.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}