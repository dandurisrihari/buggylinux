{
  "hash": "cc25b994acfbc901429da682d0f73c190e960206",
  "hash_short": "cc25b994",
  "subject": "X.509: Fix the time validation [ver #2]",
  "body": "This fixes CVE-2015-5327.  It affects kernels from 4.3-rc1 onwards.\n\nFix the X.509 time validation to use month number-1 when looking up the\nnumber of days in that month.  Also put the month number validation before\ndoing the lookup so as not to risk overrunning the array.\n\nThis can be tested by doing the following:\n\ncat <<EOF | openssl x509 -outform DER | keyctl padd asymmetric \"\" @s\n-----BEGIN CERTIFICATE-----\nMIIDbjCCAlagAwIBAgIJAN/lUld+VR4hMA0GCSqGSIb3DQEBCwUAMCkxETAPBgNV\nBAoMCGxvY2FsLWNhMRQwEgYDVQQDDAtzaWduaW5nIGtleTAeFw0xNTA5MDEyMTMw\nMThaFw0xNjA4MzEyMTMwMThaMCkxETAPBgNVBAoMCGxvY2FsLWNhMRQwEgYDVQQD\nDAtzaWduaW5nIGtleTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANrn\ncrcMfMeG67nagX4+m02Xk9rkmsMKI5XTUxbikROe7GSUVJ27sPVPZp4mgzoWlvhh\njfK8CC/qhEhwep8Pgg4EJZyWOjhZb7R97ckGvLIoUC6IO3FC2ZnR7WtmWDgo2Jcj\nVlXwJdHhKU1VZwulh81O61N8IBKqz2r/kDhIWiicUCUkI/Do/RMRfKAoDBcSh86m\ngOeIAGfq62vbiZhVsX5dOE8Oo2TK5weAvwUIOR7OuGBl5AqwFlPnXQolewiHzKry\nTHg9e44HfzG4Mi6wUvcJxVaQT1h5SrKD779Z5+8+wf1JLaooetcEUArvWyuxCU59\nqxA4lsTjBwl4cmEki+cCAwEAAaOBmDCBlTAMBgNVHRMEBTADAQH/MAsGA1UdDwQE\nAwIHgDAdBgNVHQ4EFgQUyND/eKUis7ep/hXMJ8iZMdUhI+IwWQYDVR0jBFIwUIAU\nyND/eKUis7ep/hXMJ8iZMdUhI+KhLaQrMCkxETAPBgNVBAoMCGxvY2FsLWNhMRQw\nEgYDVQQDDAtzaWduaW5nIGtleYIJAN/lUld+VR4hMA0GCSqGSIb3DQEBCwUAA4IB\nAQAMqm1N1yD5pimUELLhT5eO2lRdGUfTozljRxc7e2QT3RLk2TtGhg65JFFN6eml\nXS58AEPVcAsSLDlR6WpOpOLB2giM0+fV/eYFHHmh22yqTJl4YgkdUwyzPdCHNOZL\nhmSKeY9xliHb6PNrNWWtZwhYYvRaO2DX4GXOMR0Oa2O4vaYu6/qGlZOZv3U6qZLY\nwwHEJSrqeBDyMuwN+eANHpoSpiBzD77S4e+7hUDJnql4j6xzJ65+nWJ89fCrQypR\n4sN5R3aGeIh3QAQUIKpHilwek0CtEaYERgc5m+jGyKSc1rezJW62hWRTaitOc+d5\nG5hh+9YpnYcxQHEKnZ7rFNKJ\n-----END CERTIFICATE-----\nEOF\n\nIf it works, it emit a key ID; if it fails, it should give a bad message\nerror.\n\nReported-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nSigned-off-by: David Howells <dhowells@redhat.com>\nTested-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nAcked-by: David Woodhouse <David.Woodhouse@intel.com>\nSigned-off-by: James Morris <james.l.morris@oracle.com>",
  "full_message": "X.509: Fix the time validation [ver #2]\n\nThis fixes CVE-2015-5327.  It affects kernels from 4.3-rc1 onwards.\n\nFix the X.509 time validation to use month number-1 when looking up the\nnumber of days in that month.  Also put the month number validation before\ndoing the lookup so as not to risk overrunning the array.\n\nThis can be tested by doing the following:\n\ncat <<EOF | openssl x509 -outform DER | keyctl padd asymmetric \"\" @s\n-----BEGIN CERTIFICATE-----\nMIIDbjCCAlagAwIBAgIJAN/lUld+VR4hMA0GCSqGSIb3DQEBCwUAMCkxETAPBgNV\nBAoMCGxvY2FsLWNhMRQwEgYDVQQDDAtzaWduaW5nIGtleTAeFw0xNTA5MDEyMTMw\nMThaFw0xNjA4MzEyMTMwMThaMCkxETAPBgNVBAoMCGxvY2FsLWNhMRQwEgYDVQQD\nDAtzaWduaW5nIGtleTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANrn\ncrcMfMeG67nagX4+m02Xk9rkmsMKI5XTUxbikROe7GSUVJ27sPVPZp4mgzoWlvhh\njfK8CC/qhEhwep8Pgg4EJZyWOjhZb7R97ckGvLIoUC6IO3FC2ZnR7WtmWDgo2Jcj\nVlXwJdHhKU1VZwulh81O61N8IBKqz2r/kDhIWiicUCUkI/Do/RMRfKAoDBcSh86m\ngOeIAGfq62vbiZhVsX5dOE8Oo2TK5weAvwUIOR7OuGBl5AqwFlPnXQolewiHzKry\nTHg9e44HfzG4Mi6wUvcJxVaQT1h5SrKD779Z5+8+wf1JLaooetcEUArvWyuxCU59\nqxA4lsTjBwl4cmEki+cCAwEAAaOBmDCBlTAMBgNVHRMEBTADAQH/MAsGA1UdDwQE\nAwIHgDAdBgNVHQ4EFgQUyND/eKUis7ep/hXMJ8iZMdUhI+IwWQYDVR0jBFIwUIAU\nyND/eKUis7ep/hXMJ8iZMdUhI+KhLaQrMCkxETAPBgNVBAoMCGxvY2FsLWNhMRQw\nEgYDVQQDDAtzaWduaW5nIGtleYIJAN/lUld+VR4hMA0GCSqGSIb3DQEBCwUAA4IB\nAQAMqm1N1yD5pimUELLhT5eO2lRdGUfTozljRxc7e2QT3RLk2TtGhg65JFFN6eml\nXS58AEPVcAsSLDlR6WpOpOLB2giM0+fV/eYFHHmh22yqTJl4YgkdUwyzPdCHNOZL\nhmSKeY9xliHb6PNrNWWtZwhYYvRaO2DX4GXOMR0Oa2O4vaYu6/qGlZOZv3U6qZLY\nwwHEJSrqeBDyMuwN+eANHpoSpiBzD77S4e+7hUDJnql4j6xzJ65+nWJ89fCrQypR\n4sN5R3aGeIh3QAQUIKpHilwek0CtEaYERgc5m+jGyKSc1rezJW62hWRTaitOc+d5\nG5hh+9YpnYcxQHEKnZ7rFNKJ\n-----END CERTIFICATE-----\nEOF\n\nIf it works, it emit a key ID; if it fails, it should give a bad message\nerror.\n\nReported-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nSigned-off-by: David Howells <dhowells@redhat.com>\nTested-by: Mimi Zohar <zohar@linux.vnet.ibm.com>\nAcked-by: David Woodhouse <David.Woodhouse@intel.com>\nSigned-off-by: James Morris <james.l.morris@oracle.com>",
  "author_name": "David Howells",
  "author_email": "dhowells@redhat.com",
  "author_date": "Thu Nov 12 09:36:40 2015 +0000",
  "author_date_iso": "2015-11-12T09:36:40+00:00",
  "committer_name": "James Morris",
  "committer_email": "james.l.morris@oracle.com",
  "committer_date": "Thu Nov 12 21:17:15 2015 +1100",
  "committer_date_iso": "2015-11-12T21:17:15+11:00",
  "files_changed": [
    "crypto/asymmetric_keys/x509_cert_parser.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "crypto/asymmetric_keys/x509_cert_parser.c",
      "insertions": 7,
      "deletions": 5
    }
  ],
  "total_insertions": 7,
  "total_deletions": 5,
  "total_changes": 12,
  "parents": [
    "5ca9d3a4286a1a4aaa46acc7c1c29a15d8d0fea2"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2015-5327"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "crypto/asymmetric_keys/x509_cert_parser.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}