{
  "hash": "b2590bdd0b1dfb91737e6cb07ebb47bd74957f7e",
  "hash_short": "b2590bdd",
  "subject": "IB/hfi1: Do not update hcrc for a KDETH packet during fault injection",
  "body": "When a KDETH packet is subject to fault injection during transmission,\nHCRC is supposed to be omitted from the packet so that the hardware on the\nreceiver side would drop the packet. When creating pbc, the PbcInsertHcrc\nfield is set to be PBC_IHCRC_NONE if the KDETH packet is subject to fault\ninjection, but overwritten with PBC_IHCRC_LKDETH when update_hcrc() is\ncalled later.\n\nThis problem is fixed by not calling update_hcrc() when the packet is\nsubject to fault injection.\n\nFixes: 6b6cf9357f78 (\"IB/hfi1: Set PbcInsertHcrc for TID RDMA packets\")\nCc: <stable@vger.kernel.org>\nLink: https://lore.kernel.org/r/20190715164546.74174.99296.stgit@awfm-01.aw.intel.com\nReviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>\nSigned-off-by: Kaike Wan <kaike.wan@intel.com>\nSigned-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>\nSigned-off-by: Jason Gunthorpe <jgg@mellanox.com>",
  "full_message": "IB/hfi1: Do not update hcrc for a KDETH packet during fault injection\n\nWhen a KDETH packet is subject to fault injection during transmission,\nHCRC is supposed to be omitted from the packet so that the hardware on the\nreceiver side would drop the packet. When creating pbc, the PbcInsertHcrc\nfield is set to be PBC_IHCRC_NONE if the KDETH packet is subject to fault\ninjection, but overwritten with PBC_IHCRC_LKDETH when update_hcrc() is\ncalled later.\n\nThis problem is fixed by not calling update_hcrc() when the packet is\nsubject to fault injection.\n\nFixes: 6b6cf9357f78 (\"IB/hfi1: Set PbcInsertHcrc for TID RDMA packets\")\nCc: <stable@vger.kernel.org>\nLink: https://lore.kernel.org/r/20190715164546.74174.99296.stgit@awfm-01.aw.intel.com\nReviewed-by: Mike Marciniszyn <mike.marciniszyn@intel.com>\nSigned-off-by: Kaike Wan <kaike.wan@intel.com>\nSigned-off-by: Mike Marciniszyn <mike.marciniszyn@intel.com>\nSigned-off-by: Jason Gunthorpe <jgg@mellanox.com>",
  "author_name": "Kaike Wan",
  "author_email": "kaike.wan@intel.com",
  "author_date": "Mon Jul 15 12:45:46 2019 -0400",
  "author_date_iso": "2019-07-15T12:45:46-04:00",
  "committer_name": "Jason Gunthorpe",
  "committer_email": "jgg@mellanox.com",
  "committer_date": "Mon Jul 22 16:10:48 2019 -0300",
  "committer_date_iso": "2019-07-22T16:10:48-03:00",
  "files_changed": [
    "drivers/infiniband/hw/hfi1/verbs.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/infiniband/hw/hfi1/verbs.c",
      "insertions": 9,
      "deletions": 8
    }
  ],
  "total_insertions": 9,
  "total_deletions": 8,
  "total_changes": 17,
  "parents": [
    "5f9e832c137075045d15cd6899ab0505cfb2ca4b"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.4",
    "v5.4-rc1",
    "v5.4-rc2",
    "v5.4-rc3",
    "v5.4-rc4",
    "v5.4-rc5",
    "v5.4-rc6",
    "v5.4-rc7",
    "v5.4-rc8",
    "v5.5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/infiniband/hw/hfi1/verbs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}