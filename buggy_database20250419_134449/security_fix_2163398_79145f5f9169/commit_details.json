{
  "hash": "2163398192f6a53e84765cfe3e5a2088437c3d2d",
  "hash_short": "21633981",
  "subject": "rslib: Split rs control struct",
  "body": "The decoder library uses variable length arrays on stack. To get rid of\nthem it would be simple to allocate fixed length arrays on stack, but those\nmight become rather large. The other solution is to allocate the buffers in\nthe rs control structure, but this cannot be done as long as the structure\ncan be shared by several users. Sharing is desired because the RS polynom\ntables are large and initialization is time consuming.\n\nTo solve this split the codec information out of the control structure and\nhave a pointer to a shared codec in it. Instantiate the control structure\nfor each user, create a new codec if no shareable is avaiable yet.  Adjust\nall affected usage sites to the new scheme.\n\nThis allows to add per instance decoder buffers to the control structure\nlater on.\n\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nAcked-by: Boris Brezillon <boris.brezillon@bootlin.com>\nCc: Tony Luck <tony.luck@intel.com>\nCc: Kees Cook <keescook@chromium.org>\nCc: Segher Boessenkool <segher@kernel.crashing.org>\nCc: Kernel Hardening <kernel-hardening@lists.openwall.com>\nCc: Richard Weinberger <richard@nod.at>\nCc: Mike Snitzer <snitzer@redhat.com>\nCc: Anton Vorontsov <anton@enomsg.org>\nCc: Colin Cross <ccross@android.com>\nCc: Andrew Morton <akpm@linuxfoundation.org>\nCc: David Woodhouse <dwmw2@infradead.org>\nCc: Alasdair Kergon <agk@redhat.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "full_message": "rslib: Split rs control struct\n\nThe decoder library uses variable length arrays on stack. To get rid of\nthem it would be simple to allocate fixed length arrays on stack, but those\nmight become rather large. The other solution is to allocate the buffers in\nthe rs control structure, but this cannot be done as long as the structure\ncan be shared by several users. Sharing is desired because the RS polynom\ntables are large and initialization is time consuming.\n\nTo solve this split the codec information out of the control structure and\nhave a pointer to a shared codec in it. Instantiate the control structure\nfor each user, create a new codec if no shareable is avaiable yet.  Adjust\nall affected usage sites to the new scheme.\n\nThis allows to add per instance decoder buffers to the control structure\nlater on.\n\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nAcked-by: Boris Brezillon <boris.brezillon@bootlin.com>\nCc: Tony Luck <tony.luck@intel.com>\nCc: Kees Cook <keescook@chromium.org>\nCc: Segher Boessenkool <segher@kernel.crashing.org>\nCc: Kernel Hardening <kernel-hardening@lists.openwall.com>\nCc: Richard Weinberger <richard@nod.at>\nCc: Mike Snitzer <snitzer@redhat.com>\nCc: Anton Vorontsov <anton@enomsg.org>\nCc: Colin Cross <ccross@android.com>\nCc: Andrew Morton <akpm@linuxfoundation.org>\nCc: David Woodhouse <dwmw2@infradead.org>\nCc: Alasdair Kergon <agk@redhat.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "author_name": "Thomas Gleixner",
  "author_email": "tglx@linutronix.de",
  "author_date": "Sun Apr 22 18:23:53 2018 +0200",
  "author_date_iso": "2018-04-22T18:23:53+02:00",
  "committer_name": "Kees Cook",
  "committer_email": "keescook@chromium.org",
  "committer_date": "Tue Apr 24 19:50:08 2018 -0700",
  "committer_date_iso": "2018-04-24T19:50:08-07:00",
  "files_changed": [
    "drivers/mtd/nand/raw/cafe_nand.c",
    "drivers/mtd/nand/raw/diskonchip.c",
    "include/linux/rslib.h",
    "lib/reed_solomon/decode_rs.c",
    "lib/reed_solomon/encode_rs.c",
    "lib/reed_solomon/reed_solomon.c"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "drivers/mtd/nand/raw/cafe_nand.c",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "drivers/mtd/nand/raw/diskonchip.c",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "include/linux/rslib.h",
      "insertions": 13,
      "deletions": 6
    },
    {
      "file": "lib/reed_solomon/decode_rs.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "lib/reed_solomon/encode_rs.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "lib/reed_solomon/reed_solomon.c",
      "insertions": 77,
      "deletions": 58
    }
  ],
  "total_insertions": 100,
  "total_deletions": 70,
  "total_changes": 170,
  "parents": [
    "a85e126abf944884d5b3eba86ec7d541e8327256"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.18",
    "v4.18-rc1",
    "v4.18-rc2",
    "v4.18-rc3",
    "v4.18-rc4",
    "v4.18-rc5",
    "v4.18-rc6",
    "v4.18-rc7",
    "v4.18-rc8",
    "v4.19"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/mtd/nand/raw/cafe_nand.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/reed_solomon/decode_rs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/reed_solomon/reed_solomon.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/mtd/nand/raw/diskonchip.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/rslib.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/reed_solomon/encode_rs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}