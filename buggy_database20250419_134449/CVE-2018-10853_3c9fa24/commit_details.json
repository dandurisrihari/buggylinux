{
  "hash": "3c9fa24ca7c9c47605672916491f79e8ccacb9e6",
  "hash_short": "3c9fa24c",
  "subject": "kvm: x86: use correct privilege level for sgdt/sidt/fxsave/fxrstor access",
  "body": "The functions that were used in the emulation of fxrstor, fxsave, sgdt and\nsidt were originally meant for task switching, and as such they did not\ncheck privilege levels.  This is very bad when the same functions are used\nin the emulation of unprivileged instructions.  This is CVE-2018-10853.\n\nThe obvious fix is to add a new argument to ops->read_std and ops->write_std,\nwhich decides whether the access is a \"system\" access or should use the\nprocessor's CPL.\n\nFixes: 129a72a0d3c8 (\"KVM: x86: Introduce segmented_write_std\", 2017-01-12)\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "kvm: x86: use correct privilege level for sgdt/sidt/fxsave/fxrstor access\n\nThe functions that were used in the emulation of fxrstor, fxsave, sgdt and\nsidt were originally meant for task switching, and as such they did not\ncheck privilege levels.  This is very bad when the same functions are used\nin the emulation of unprivileged instructions.  This is CVE-2018-10853.\n\nThe obvious fix is to add a new argument to ops->read_std and ops->write_std,\nwhich decides whether the access is a \"system\" access or should use the\nprocessor's CPL.\n\nFixes: 129a72a0d3c8 (\"KVM: x86: Introduce segmented_write_std\", 2017-01-12)\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Paolo Bonzini",
  "author_email": "pbonzini@redhat.com",
  "author_date": "Wed Jun 6 17:38:09 2018 +0200",
  "author_date_iso": "2018-06-06T17:38:09+02:00",
  "committer_name": "Paolo Bonzini",
  "committer_email": "pbonzini@redhat.com",
  "committer_date": "Tue Jun 12 15:06:34 2018 +0200",
  "committer_date_iso": "2018-06-12T15:06:34+02:00",
  "files_changed": [
    "arch/x86/include/asm/kvm_emulate.h",
    "arch/x86/kvm/emulate.c",
    "arch/x86/kvm/x86.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "arch/x86/include/asm/kvm_emulate.h",
      "insertions": 4,
      "deletions": 2
    },
    {
      "file": "arch/x86/kvm/emulate.c",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "arch/x86/kvm/x86.c",
      "insertions": 16,
      "deletions": 6
    }
  ],
  "total_insertions": 26,
  "total_deletions": 14,
  "total_changes": 40,
  "parents": [
    "ce14e868a54edeb2e30cb7a7b104a2fc4b9d76ca"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.18",
    "v4.18-rc1",
    "v4.18-rc2",
    "v4.18-rc3",
    "v4.18-rc4",
    "v4.18-rc5",
    "v4.18-rc6",
    "v4.18-rc7",
    "v4.18-rc8",
    "v4.19"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2018-10853"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "arch/x86/include/asm/kvm_emulate.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/emulate.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/x86.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}