{
  "hash": "8c1671e0d13d4a0ba4fb3a0da932bf3736d7ff73",
  "hash_short": "8c1671e0",
  "subject": "net: hns3: fix get wrong pfc_en when query PFC configuration",
  "body": "Currently, when query PFC configuration by dcbtool, driver will return\nPFC enable status based on TC. As all priorities are mapped to TC0 by\ndefault, if TC0 is enabled, then all priorities mapped to TC0 will be\nshown as enabled status when query PFC setting, even though some\npriorities have never been set.\n\nfor example:\n$ dcb pfc show dev eth0\npfc-cap 4 macsec-bypass off delay 0\nprio-pfc 0:off 1:off 2:off 3:off 4:off 5:off 6:off 7:off\n$ dcb pfc set dev eth0 prio-pfc 0:on 1:on 2:on 3:on\n$ dcb pfc show dev eth0\npfc-cap 4 macsec-bypass off delay 0\nprio-pfc 0:on 1:on 2:on 3:on 4:on 5:on 6:on 7:on\n\nTo fix this problem, just returns user's PFC config parameter saved in\ndriver.\n\nFixes: cacde272dd00 (\"net: hns3: Add hclge_dcb module for the support of DCB feature\")\nSigned-off-by: Guangbin Huang <huangguangbin2@huawei.com>\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "net: hns3: fix get wrong pfc_en when query PFC configuration\n\nCurrently, when query PFC configuration by dcbtool, driver will return\nPFC enable status based on TC. As all priorities are mapped to TC0 by\ndefault, if TC0 is enabled, then all priorities mapped to TC0 will be\nshown as enabled status when query PFC setting, even though some\npriorities have never been set.\n\nfor example:\n$ dcb pfc show dev eth0\npfc-cap 4 macsec-bypass off delay 0\nprio-pfc 0:off 1:off 2:off 3:off 4:off 5:off 6:off 7:off\n$ dcb pfc set dev eth0 prio-pfc 0:on 1:on 2:on 3:on\n$ dcb pfc show dev eth0\npfc-cap 4 macsec-bypass off delay 0\nprio-pfc 0:on 1:on 2:on 3:on 4:on 5:on 6:on 7:on\n\nTo fix this problem, just returns user's PFC config parameter saved in\ndriver.\n\nFixes: cacde272dd00 (\"net: hns3: Add hclge_dcb module for the support of DCB feature\")\nSigned-off-by: Guangbin Huang <huangguangbin2@huawei.com>\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Guangbin Huang",
  "author_email": "huangguangbin2@huawei.com",
  "author_date": "Thu Aug 26 19:22:01 2021 +0800",
  "author_date_iso": "2021-08-26T19:22:01+08:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Thu Aug 26 07:24:17 2021 -0700",
  "committer_date_iso": "2021-08-26T07:24:17-07:00",
  "files_changed": [
    "drivers/net/ethernet/hisilicon/hns3/hns3pf/hclge_dcb.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/ethernet/hisilicon/hns3/hns3pf/hclge_dcb.c",
      "insertions": 2,
      "deletions": 11
    }
  ],
  "total_insertions": 2,
  "total_deletions": 11,
  "total_changes": 13,
  "parents": [
    "3462207d2d684658d97499ca77c00c9ac7c87ea8"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "bypass"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/ethernet/hisilicon/hns3/hns3pf/hclge_dcb.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}