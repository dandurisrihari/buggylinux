Commit Hash: 5961060692f8b17cd2080620a3d27b95d2ae05ca
Subject: net/tls: Fix authentication failure in CCM mode


Security Keywords:
- authentication

Full commit message:
net/tls: Fix authentication failure in CCM mode

When the TLS cipher suite uses CCM mode, including AES CCM and
SM4 CCM, the first byte of the B0 block is flags, and the real
IV starts from the second byte. The XOR operation of the IV and
rec_seq should be skip this byte, that is, add the iv_offset.

Fixes: f295b3ae9f59 ("net/tls: Add support of AES128-CCM based ciphers")
Signed-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
Cc: Vakul Garg <vakul.garg@nxp.com>
Cc: stable@vger.kernel.org # v5.2+
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>
Author Date: Mon Nov 29 17:32:12 2021 +0800
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Nov 29 12:48:28 2021 +0000

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
