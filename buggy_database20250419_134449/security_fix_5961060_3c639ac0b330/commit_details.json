{
  "hash": "5961060692f8b17cd2080620a3d27b95d2ae05ca",
  "hash_short": "59610606",
  "subject": "net/tls: Fix authentication failure in CCM mode",
  "body": "When the TLS cipher suite uses CCM mode, including AES CCM and\nSM4 CCM, the first byte of the B0 block is flags, and the real\nIV starts from the second byte. The XOR operation of the IV and\nrec_seq should be skip this byte, that is, add the iv_offset.\n\nFixes: f295b3ae9f59 (\"net/tls: Add support of AES128-CCM based ciphers\")\nSigned-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>\nCc: Vakul Garg <vakul.garg@nxp.com>\nCc: stable@vger.kernel.org # v5.2+\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "net/tls: Fix authentication failure in CCM mode\n\nWhen the TLS cipher suite uses CCM mode, including AES CCM and\nSM4 CCM, the first byte of the B0 block is flags, and the real\nIV starts from the second byte. The XOR operation of the IV and\nrec_seq should be skip this byte, that is, add the iv_offset.\n\nFixes: f295b3ae9f59 (\"net/tls: Add support of AES128-CCM based ciphers\")\nSigned-off-by: Tianjia Zhang <tianjia.zhang@linux.alibaba.com>\nCc: Vakul Garg <vakul.garg@nxp.com>\nCc: stable@vger.kernel.org # v5.2+\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Tianjia Zhang",
  "author_email": "tianjia.zhang@linux.alibaba.com",
  "author_date": "Mon Nov 29 17:32:12 2021 +0800",
  "author_date_iso": "2021-11-29T17:32:12+08:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Mon Nov 29 12:48:28 2021 +0000",
  "committer_date_iso": "2021-11-29T12:48:28+00:00",
  "files_changed": [
    "net/tls/tls_sw.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/tls/tls_sw.c",
      "insertions": 2,
      "deletions": 2
    }
  ],
  "total_insertions": 2,
  "total_deletions": 2,
  "total_changes": 4,
  "parents": [
    "ef56b64001625c84e80ff7e061ccb0f28e606abb"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/tls/tls_sw.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}