{
  "hash": "264b8b4e973f8741adf530a388be72af4bfee953",
  "hash_short": "264b8b4e",
  "subject": "Bluetooth: Fix outgoing authentication requirement check",
  "body": "The check for HIGH security level dates back to pre-mgmt times when a\nraw L2CAP socket with HIGH security level was used to trigger dedicated\nbonding. For legacy pairing checking for the security level was the only\nway to catch the need to authenticate in all scenarios. With mgmt\nhowever, the pair_device command does not use HIGH security but MEDIUM\nsecurity. Therefore, the existing code would never trigger\nauthentication for a non-SSP connection without an MITM requirement\n(e.g. if user space provided a NoInputNoOutput IO capability). In such a\nscenario the mgmt_pair_device command would return success without\nactually triggering any kind of pairing.\n\nThis patch updates the authentication requirement check to also consider\nMEDIUM security level, and thereby ensures that mgmt_pair_device will\nalways trigger authentication.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "Bluetooth: Fix outgoing authentication requirement check\n\nThe check for HIGH security level dates back to pre-mgmt times when a\nraw L2CAP socket with HIGH security level was used to trigger dedicated\nbonding. For legacy pairing checking for the security level was the only\nway to catch the need to authenticate in all scenarios. With mgmt\nhowever, the pair_device command does not use HIGH security but MEDIUM\nsecurity. Therefore, the existing code would never trigger\nauthentication for a non-SSP connection without an MITM requirement\n(e.g. if user space provided a NoInputNoOutput IO capability). In such a\nscenario the mgmt_pair_device command would return success without\nactually triggering any kind of pairing.\n\nThis patch updates the authentication requirement check to also consider\nMEDIUM security level, and thereby ensures that mgmt_pair_device will\nalways trigger authentication.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Johan Hedberg",
  "author_email": "johan.hedberg@intel.com",
  "author_date": "Wed Jan 8 16:40:39 2014 +0200",
  "author_date_iso": "2014-01-08T16:40:39+02:00",
  "committer_name": "Johan Hedberg",
  "committer_email": "johan.hedberg@intel.com",
  "committer_date": "Thu Feb 13 09:51:31 2014 +0200",
  "committer_date_iso": "2014-02-13T09:51:31+02:00",
  "files_changed": [
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 5,
      "deletions": 2
    }
  ],
  "total_insertions": 5,
  "total_deletions": 2,
  "total_changes": 7,
  "parents": [
    "e57f1734d87aa0e9a00905ed08888f0c62f56227"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.15",
    "v3.15-rc1",
    "v3.15-rc2",
    "v3.15-rc3",
    "v3.15-rc4",
    "v3.15-rc5",
    "v3.15-rc6",
    "v3.15-rc7",
    "v3.15-rc8",
    "v3.16"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}