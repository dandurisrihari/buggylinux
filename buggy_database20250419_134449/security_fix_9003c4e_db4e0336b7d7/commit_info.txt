Commit Hash: 9003c4e220c2954a53c5da0d739ed15a46c13429
Subject: Bluetooth: Don't modify sec_level if auth failed


Security Keywords:
- auth

Full commit message:
Bluetooth: Don't modify sec_level if auth failed

If authentication fails the security level should stay as it was set
before the process has started. Setting BT_SECURITY_LOW can hide real
security level on a link eg. having BT_SECURITY_MEDIUM on the link,
re-authenticate with failure to get BT_SECURITY_HIGH, as  a result we
get BT_SECURITY_LOW on the link while the real security is still medium.

Signed-off-by: Waldemar Rymarkiewicz <waldemar.rymarkiewicz@tieto.com>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

Metadata:
Author: Waldemar Rymarkiewicz <waldemar.rymarkiewicz@tieto.com>
Author Date: Thu Apr 28 12:07:54 2011 +0200
Committer: Gustavo F. Padovan <padovan@profusion.mobi>
Commit Date: Thu Apr 28 15:02:08 2011 -0300

Files Changed: 1
Lines Added: 0
Lines Removed: 1
Total Changes: 1
