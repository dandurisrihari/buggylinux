{
  "hash": "d6d142cb7f79bec6051c5ecf744b7a5309c5a0ee",
  "hash_short": "d6d142cb",
  "subject": "IB/iser: Fix login with authentication",
  "body": "The iSER Initiator uses two types of receive buffers:\n\n  - one big login buffer posted by iser_post_recvl();\n  - several small message buffers posted by iser_post_recvm().\n\nThe login buffer is used at the login phase and full feature phase in\nthe discovery session. It may take a few requests and responses to\ncomplete the login phase. The message buffers are only used in the\nnormal operational session at the full feature phase.\n\nAfter the commit referred in the fixes line, the login operation fails\nif the authentication is enabled. That happens because the Initiator\nposts a small receive buffer after the first response from Target. So,\nthe next send operation fails because Target's second response does not\nfit into the small receive buffer.\n\nThis commit adds additional checks to prevent posting small receive\nbuffers until the full feature phase.\n\nFixes: 39b169ea0d36 (\"IB/iser: Fix RNR errors\")\nLink: https://lore.kernel.org/r/20220805060135.18493-1-sergeygo@nvidia.com\nSigned-off-by: Sergey Gorenko <sergeygo@nvidia.com>\nReviewed-by: Max Gurtovoy <mgurtovoy@nvidia.com>\nSigned-off-by: Leon Romanovsky <leon@kernel.org>",
  "full_message": "IB/iser: Fix login with authentication\n\nThe iSER Initiator uses two types of receive buffers:\n\n  - one big login buffer posted by iser_post_recvl();\n  - several small message buffers posted by iser_post_recvm().\n\nThe login buffer is used at the login phase and full feature phase in\nthe discovery session. It may take a few requests and responses to\ncomplete the login phase. The message buffers are only used in the\nnormal operational session at the full feature phase.\n\nAfter the commit referred in the fixes line, the login operation fails\nif the authentication is enabled. That happens because the Initiator\nposts a small receive buffer after the first response from Target. So,\nthe next send operation fails because Target's second response does not\nfit into the small receive buffer.\n\nThis commit adds additional checks to prevent posting small receive\nbuffers until the full feature phase.\n\nFixes: 39b169ea0d36 (\"IB/iser: Fix RNR errors\")\nLink: https://lore.kernel.org/r/20220805060135.18493-1-sergeygo@nvidia.com\nSigned-off-by: Sergey Gorenko <sergeygo@nvidia.com>\nReviewed-by: Max Gurtovoy <mgurtovoy@nvidia.com>\nSigned-off-by: Leon Romanovsky <leon@kernel.org>",
  "author_name": "Sergey Gorenko",
  "author_email": "sergeygo@nvidia.com",
  "author_date": "Fri Aug 5 09:01:35 2022 +0300",
  "author_date_iso": "2022-08-05T09:01:35+03:00",
  "committer_name": "Leon Romanovsky",
  "committer_email": "leonro@nvidia.com",
  "committer_date": "Tue Aug 16 15:56:33 2022 +0300",
  "committer_date_iso": "2022-08-16T15:56:33+03:00",
  "files_changed": [
    "drivers/infiniband/ulp/iser/iser_initiator.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/infiniband/ulp/iser/iser_initiator.c",
      "insertions": 6,
      "deletions": 1
    }
  ],
  "total_insertions": 6,
  "total_deletions": 1,
  "total_changes": 7,
  "parents": [
    "568035b01cfb107af8d2e4bd2fb9aea22cf5b868"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/infiniband/ulp/iser/iser_initiator.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}