{
  "hash": "71755ee5350b63fb1f283de8561cdb61b47f4d1d",
  "hash_short": "71755ee5",
  "subject": "squashfs: more metadata hardening",
  "body": "The squashfs fragment reading code doesn't actually verify that the\nfragment is inside the fragment table.  The end result _is_ verified to\nbe inside the image when actually reading the fragment data, but before\nthat is done, we may end up taking a page fault because the fragment\ntable itself might not even exist.\n\nAnother report from Anatoly and his endless squashfs image fuzzing.\n\nReported-by: \u0410\u043d\u0430\u0442\u043e\u043b\u0438\u0439 \u0422\u0440\u043e\u0441\u0438\u043d\u0435\u043d\u043a\u043e <anatoly.trosinenko@gmail.com>\nAcked-by:: Phillip Lougher <phillip.lougher@gmail.com>,\nCc: Willy Tarreau <w@1wt.eu>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "squashfs: more metadata hardening\n\nThe squashfs fragment reading code doesn't actually verify that the\nfragment is inside the fragment table.  The end result _is_ verified to\nbe inside the image when actually reading the fragment data, but before\nthat is done, we may end up taking a page fault because the fragment\ntable itself might not even exist.\n\nAnother report from Anatoly and his endless squashfs image fuzzing.\n\nReported-by: \u0410\u043d\u0430\u0442\u043e\u043b\u0438\u0439 \u0422\u0440\u043e\u0441\u0438\u043d\u0435\u043d\u043a\u043e <anatoly.trosinenko@gmail.com>\nAcked-by:: Phillip Lougher <phillip.lougher@gmail.com>,\nCc: Willy Tarreau <w@1wt.eu>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Thu Aug 2 08:43:35 2018 -0700",
  "author_date_iso": "2018-08-02T08:43:35-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Thu Aug 2 09:32:23 2018 -0700",
  "committer_date_iso": "2018-08-02T09:32:23-07:00",
  "files_changed": [
    "fs/squashfs/fragment.c",
    "fs/squashfs/squashfs_fs_sb.h",
    "fs/squashfs/super.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "fs/squashfs/fragment.c",
      "insertions": 9,
      "deletions": 4
    },
    {
      "file": "fs/squashfs/squashfs_fs_sb.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "fs/squashfs/super.c",
      "insertions": 3,
      "deletions": 2
    }
  ],
  "total_insertions": 13,
  "total_deletions": 6,
  "total_changes": 19,
  "parents": [
    "6b4703768268d09ac928c64474fd686adf4574f9"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.18",
    "v4.18-rc8",
    "v4.19",
    "v4.19-rc1",
    "v4.19-rc2",
    "v4.19-rc3",
    "v4.19-rc4",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/squashfs/fragment.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/squashfs/squashfs_fs_sb.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/squashfs/super.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}