commit f805ef1ce5d695c260986fdf2e28f5d6c98cf3a8
Merge: 0bd35146642b 94a853eca720
Author: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date:   Sun Aug 15 08:32:07 2021 +0200

    Merge tag 'iio-for-5.15a' of https://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio into staging-next
    
    Jonathan writes:
    
    First set of new IIO and counter device support, cleanups and features for 5.15
    
    Usual mix of cleanups and new device support.
    
    Counter
    ======
    
    Cleanups and refactoring:
    * treewide
      - Ensure attempts to set invalid modes result in -EINVAL return.
      - Rename counter_count_function to counter_function as the middle count
        is redundant.
      - Standardize error returns when limits are exceeded.
    * 104-quad:
      - Document the lock.
      - Return an error if attempt to set the ceiling value in a mode that
        doesn't support it.
    * intel-qep
      - Drop unused bitops.h include
    
    IIO
    ===
    
    New device support
    * bma255
      - Add support fo the bosch,bmc156_accel which oddly only exposes the INT2
        interrupt pin and not INT1. Patch set includes enabling use of INT2.
    * ingenic_adc
      - Add support for JZ4760 and similar and update bindings
      - Add support for JZ4760B and update bindings
    * rockchip_saradc
      - Add support for rk3568 ADC (separate channel array as more channels)
    * sgp40 gas sensor used to measure air quality
      - New driver including binding and ABI documentation.
    
    Bindings
    --------
    
    * Add missing bindings for many DACs where the binding was effectively
      implicit due to fallback probe methods in I2C and SPI.
      adi,ad5064
      adi,ad5360
      adi,ad5380
      adi,ad5421
      adi,ad5449
      adi,ad5504
      adi,ad5624r
      adi,ad5686 / adi,ad5696
      adi,ad5761
      adi,ad5764
      adi,ad5791
      adi,ad8801
      capella,cm3323 (also add explicit of_device_id table)
      microchip,mcp4922
    * bosch,bma255
      - Interrupt type in example was opposite of what the device expects.
        It's possible that a particular board had an inverter, but we
        definitely don't want the example to suggest this would be normal.
      - Add interrupt-names to allow for cases where only INT2 is connected.
      - Sort compatibles
      - Merge in very similar bosch,bma180 binding.
    
    New feature
    -----------
    
    * Devices only allowed to provide either extended_name or a label for given
      channel. If extend_name is used (generally discouraged but can't be
      removed as it would be a userspaece ABI change), then the label sysfs
      attribute will provide the extended_name. This allows some userspace
      parser simplications and hardening.
    * hid-sensors-pres
      - Add a timestamp channel (either from hardware, or locally filled).
    * vcnl3020
      - Add periodic sensor mode used to provide IIO events.
    
    Cleanups / minor fixes
    ----------------------
    
    * core/buffers
      - Avoid unnecessary zeroing of bitmaps that are immediately overwritten.
      - Move a sanity check earlier to simplify error path.
    * Quite a few cases of refactors to use devm_* for all of probe and drop
      remove
      - adjd_s311
      - adxl345
      - bma220
      - da280
      - dmard10
      - ds311
      - max5481
      - max5821
      - rfd77402
      - tcs3414
      - tmp006
    * ad5624r
      - Fix incorrect handling of a regulator that was preventing use of
        internal regulators.
    * adjd_s311
      - Allocate a buffer as part of iio_priv() structure as maximum size
        is small enough, no significant advantage in making it flexible sized.
    * bma220
      - Make handling of suspend and resume closer to the probe() wrt to the
        rather odd interface, that suspend mode is entered by reading a register.
    * ep93xx
      - Prepare clock before using (part of conversion to CCF)
    * fsl-imx25-gcq
      - Use local device pointer.
      - Adjust handling of platform_get_irq() to not check for 0 as an error.
        The function is documented as never returning it.
    * hid-sensors
      - Use devm_kmemdup() consistently across all drivers to simplify channel
        structure allocation management.
    * meson-saradc
      - Drop BL30 integration on G12A and newer SoCs as not used.
      - Whitespace fixes.
    * mpu6050
      - Add per device type startup times. This avoids an issue with having
        to dsicard initial data from gyroscopes when they were still stabilizing.
    * rfd77402
      - Change from passing private data, to passing i2c_client where only
        that is needed, reducing back and forth in pm functions.
    * si1145
      - Drop pointless continue
    * st-sensors
      - Cleanup of includes to remove unused and add missing headers that are used.
      - Use some devm functions to simplify probe() and remove() - gets us part way
        towards a fully device managed driver.
    * sx9310
      - Switch from of to generic properties to enable ACPI bindings.
    * vcnl3020
      - Add DMA safe buffer for bulk transfers.
      - Drop use of iio_claim_direct() in a driver that has no mode changes.
        A local lock is more appropriate.
    
    * tag 'iio-for-5.15a' of https://git.kernel.org/pub/scm/linux/kernel/git/jic23/iio: (77 commits)
      counter: 104-quad-8: Describe member 'lock' in 'quad8'
      iio: hid-sensor-press: Add timestamp channel
      counter: Rename counter_count_function to counter_function
      counter: Rename counter_signal_value to counter_signal_level
      counter: Standardize to ERANGE for limit exceeded errors
      counter: Return error code on invalid modes
      counter: 104-quad-8: Return error when invalid mode during ceiling_write
      iio: accel: bmc150: Add support for BMC156
      iio: accel: bmc150: Make it possible to configure INT2 instead of INT1
      dt-bindings: iio: accel: bma255: Add bosch,bmc156_accel
      dt-bindings: iio: accel: bma255: Add interrupt-names
      iio: light: cm3323: Add of_device_id table
      dt-bindings: Add bindings for Capella cm3323 Ambient Light Sensor
      iio: chemical: Add driver support for sgp40
      dt-bindings: iio: chemical: Add trivial DT binding for sgp40
      iio: ep93xx: Prepare clock before using it
      iio: adc: fsl-imx25-gcq: adjust irq check to match docs and simplify code
      iio: dac: max5821: convert device register to device managed function
      dt-bindings: iio/adc: ingenic: add the JZ4760(B) socs to the sadc Documentation
      iio/adc: ingenic: add JZ4760B support to the sadc driver
      ...