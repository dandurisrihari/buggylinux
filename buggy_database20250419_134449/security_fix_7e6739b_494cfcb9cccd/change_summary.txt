Files changed: 43
Insertions: 113180
Deletions: 35976
Total changes: 149156

File-specific changes:
Documentation/devicetree/bindings/display/bridge/chipone,icn6211.yaml: +9 -0
Documentation/devicetree/bindings/display/bridge/renesas,dw-hdmi.yaml: +5 -0
Documentation/devicetree/bindings/display/ingenic,lcd.yaml: +2 -0
Documentation/devicetree/bindings/display/mediatek/mediatek,dp.yaml: +116 -0
Documentation/devicetree/bindings/display/msm/dp-controller.yaml: +41 -6
Documentation/devicetree/bindings/display/msm/dpu-msm8998.yaml: +4 -0
Documentation/devicetree/bindings/display/msm/dpu-qcm2290.yaml: +3 -0
Documentation/devicetree/bindings/display/msm/dpu-sc7180.yaml: +3 -0
Documentation/devicetree/bindings/display/msm/dpu-sc7280.yaml: +3 -0
Documentation/devicetree/bindings/display/msm/dpu-sdm845.yaml: +4 -0
Documentation/devicetree/bindings/display/msm/gmu.yaml: +146 -20
Documentation/devicetree/bindings/display/msm/gpu.yaml: +2 -1
Documentation/devicetree/bindings/display/msm/mdp4.yaml: +1 -1
Documentation/devicetree/bindings/display/panel/panel-simple.yaml: +4 -0
Documentation/devicetree/bindings/display/panel/sitronix,st7701.yaml: +4 -0
Documentation/devicetree/bindings/display/rockchip/dw_mipi_dsi_rockchip.txt: +1 -0
Documentation/devicetree/bindings/phy/qcom,hdmi-phy-qmp.yaml: +12 -3
Documentation/gpu/amdgpu/apu-asic-info-table.csv: +8 -0
Documentation/gpu/amdgpu/dgpu-asic-info-table.csv: +24 -0
Documentation/gpu/amdgpu/display/dc-glossary.rst: +1 -1
Documentation/gpu/amdgpu/display/dcn-overview.rst: +59 -0
Documentation/gpu/amdgpu/display/dcn2_cm_drm_current.svg: +1370 -0
Documentation/gpu/amdgpu/display/dcn3_cm_drm_current.svg: +1529 -0
Documentation/gpu/amdgpu/display/display-manager.rst: +141 -0
Documentation/gpu/amdgpu/display/index.rst: +1 -0
Documentation/gpu/amdgpu/display/mpo-cursor.svg: +435 -0
Documentation/gpu/amdgpu/display/mpo-overview.rst: +242 -0
Documentation/gpu/amdgpu/display/multi-display-hdcp-mpo-less-pipe-ex.svg: +220 -0
Documentation/gpu/amdgpu/display/multi-display-hdcp-mpo.svg: +171 -0
Documentation/gpu/amdgpu/display/pipeline_4k_no_split.svg: +958 -0
Documentation/gpu/amdgpu/display/pipeline_4k_split.svg: +1062 -0
Documentation/gpu/amdgpu/display/single-display-mpo-multi-video.svg: +339 -0
Documentation/gpu/amdgpu/display/single-display-mpo.svg: +266 -0
Documentation/gpu/amdgpu/driver-misc.rst: +17 -0
Documentation/gpu/amdgpu/thermal.rst: +17 -1
Documentation/gpu/drm-kms-helpers.rst: +4 -4
Documentation/gpu/drm-kms.rst: +2 -0
Documentation/gpu/drm-mm.rst: +8 -8
Documentation/gpu/todo.rst: +0 -36
Documentation/gpu/vkms.rst: +1 -6
MAINTAINERS: +5 -0
drivers/dma-buf/dma-fence.c: +13 -9
drivers/dma-buf/st-dma-fence-chain.c: +4 -0
drivers/dma-buf/st-dma-fence-unwrap.c: +22 -0
drivers/dma-buf/st-dma-fence.c: +16 -0
drivers/dma-buf/st-dma-resv.c: +10 -0
drivers/dma-buf/sync_file.c: +4 -4
drivers/dma-buf/udmabuf.c: +6 -3
drivers/firmware/sysfb.c: +4 -0
drivers/gpu/drm/Kconfig: +6 -19
drivers/gpu/drm/Makefile: +3 -4
drivers/gpu/drm/amd/amdgpu/Makefile: +4 -3
drivers/gpu/drm/amd/amdgpu/amdgpu.h: +9 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_acpi.c: +13 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd.c: +5 -5
drivers/gpu/drm/amd/amdgpu/amdgpu_amdkfd_gpuvm.c: +19 -11
drivers/gpu/drm/amd/amdgpu/amdgpu_connectors.c: +6 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_cs.c: +898 -844
drivers/gpu/drm/amd/amdgpu/amdgpu_cs.h: +7 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_ctx.c: +2 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_ctx.h: +0 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_debugfs.c: +170 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_device.c: +100 -22
drivers/gpu/drm/amd/amdgpu/amdgpu_discovery.c: +16 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_dma_buf.c: +1 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_drv.c: +39 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_gfx.c: +180 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_gfx.h: +12 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_gfxhub.h: +3 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_gmc.c: +9 -39
drivers/gpu/drm/amd/amdgpu/amdgpu_gmc.h: +26 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_gtt_mgr.c: +38 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_job.c: +47 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_job.h: +10 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_kms.c: +49 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_mode.h: +0 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_object.c: +2 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_psp.c: +35 -17
drivers/gpu/drm/amd/amdgpu/amdgpu_psp.h: +6 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_ras.c: +18 -17
drivers/gpu/drm/amd/amdgpu/amdgpu_ras_eeprom.c: +10 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_reset.c: +21 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_reset.h: +4 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_ring.c: +3 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_rlc.c: +8 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_sdma.c: +133 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_sdma.h: +4 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_sync.c: +3 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_trace.h: +7 -5
drivers/gpu/drm/amd/amdgpu/amdgpu_ttm.c: +15 -33
drivers/gpu/drm/amd/amdgpu/amdgpu_ucode.c: +118 -50
drivers/gpu/drm/amd/amdgpu/amdgpu_ucode.h: +1 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_umc.h: +6 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_vcn.h: +19 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_virt.c: +56 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_virt.h: +5 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_vkms.c: +2 -2
drivers/gpu/drm/amd/amdgpu/amdgpu_vm.c: +67 -30
drivers/gpu/drm/amd/amdgpu/amdgpu_vm.h: +8 -1
drivers/gpu/drm/amd/amdgpu/amdgpu_vm_pt.c: +41 -3
drivers/gpu/drm/amd/amdgpu/amdgpu_vm_sdma.c: +8 -4
drivers/gpu/drm/amd/amdgpu/amdgpu_vram_mgr.c: +68 -0
drivers/gpu/drm/amd/amdgpu/amdgpu_xgmi.c: +18 -6
drivers/gpu/drm/amd/amdgpu/amdgpu_xgmi.h: +1 -0
drivers/gpu/drm/amd/amdgpu/gfx_v10_0.c: +24 -267
drivers/gpu/drm/amd/amdgpu/gfx_v11_0.c: +37 -180
drivers/gpu/drm/amd/amdgpu/gfx_v9_0.c: +25 -193
drivers/gpu/drm/amd/amdgpu/gfxhub_v2_1.c: +108 -0
drivers/gpu/drm/amd/amdgpu/gfxhub_v3_0_3.c: +511 -0
drivers/gpu/drm/amd/amdgpu/gfxhub_v3_0_3.h: +29 -0
drivers/gpu/drm/amd/amdgpu/gmc_v11_0.c: +16 -3
drivers/gpu/drm/amd/amdgpu/ih_v6_0.c: +23 -3
drivers/gpu/drm/amd/amdgpu/imu_v11_0.c: +6 -0
drivers/gpu/drm/amd/amdgpu/imu_v11_0_3.c: +145 -0
drivers/gpu/drm/amd/amdgpu/imu_v11_0_3.h: +29 -0
drivers/gpu/drm/amd/amdgpu/mes_v11_0.c: +11 -0
drivers/gpu/drm/amd/amdgpu/mmhub_v3_0.c: +5 -5
drivers/gpu/drm/amd/amdgpu/mmsch_v4_0.h: +140 -0
drivers/gpu/drm/amd/amdgpu/mxgpu_ai.c: +1 -0
drivers/gpu/drm/amd/amdgpu/mxgpu_nv.c: +1 -0
drivers/gpu/drm/amd/amdgpu/mxgpu_vi.c: +1 -0
drivers/gpu/drm/amd/amdgpu/nbio_v4_3.c: +44 -0
drivers/gpu/drm/amd/amdgpu/nbio_v4_3.h: +1 -0
drivers/gpu/drm/amd/amdgpu/psp_v13_0.c: +9 -0
drivers/gpu/drm/amd/amdgpu/sdma_v4_0.c: +19 -91
drivers/gpu/drm/amd/amdgpu/sdma_v5_0.c: +9 -40
drivers/gpu/drm/amd/amdgpu/sdma_v5_2.c: +3 -71
drivers/gpu/drm/amd/amdgpu/sdma_v6_0.c: +10 -77
drivers/gpu/drm/amd/amdgpu/sienna_cichlid.c: +303 -0
drivers/gpu/drm/amd/{display/dc/inc/dml_wrapper.h => amdgpu/sienna_cichlid.h}: +6 -8
drivers/gpu/drm/amd/amdgpu/soc21.c: +18 -1
drivers/gpu/drm/amd/amdgpu/umc_v6_7.c: +33 -25
drivers/gpu/drm/amd/amdgpu/umc_v8_10.c: +3 -9
drivers/gpu/drm/amd/amdgpu/vcn_v3_0.c: +10 -7
drivers/gpu/drm/amd/amdgpu/vcn_v4_0.c: +312 -31
drivers/gpu/drm/amd/amdkfd/cwsr_trap_handler.h: +387 -384
drivers/gpu/drm/amd/amdkfd/cwsr_trap_handler_gfx10.asm: +21 -0
drivers/gpu/drm/amd/amdkfd/kfd_chardev.c: +41 -13
drivers/gpu/drm/amd/amdkfd/kfd_crat.c: +2 -1
drivers/gpu/drm/amd/amdkfd/kfd_device.c: +8 -0
drivers/gpu/drm/amd/amdkfd/kfd_device_queue_manager.c: +21 -24
drivers/gpu/drm/amd/amdkfd/kfd_doorbell.c: +12 -0
drivers/gpu/drm/amd/amdkfd/kfd_migrate.c: +36 -21
drivers/gpu/drm/amd/amdkfd/kfd_mqd_manager_v11.c: +12 -73
drivers/gpu/drm/amd/amdkfd/kfd_process.c: +0 -5
drivers/gpu/drm/amd/amdkfd/kfd_process_queue_manager.c: +7 -0
drivers/gpu/drm/amd/amdkfd/kfd_svm.c: +59 -23
drivers/gpu/drm/amd/amdkfd/kfd_svm.h: +1 -2
drivers/gpu/drm/amd/display/Kconfig: +0 -2
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.c: +54 -96
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm.h: +41 -6
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_color.c: +81 -28
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_helpers.c: +104 -77
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_mst_types.c: +123 -86
drivers/gpu/drm/amd/display/amdgpu_dm/amdgpu_dm_plane.c: +1 -1
drivers/gpu/drm/amd/display/dc/bios/bios_parser2.c: +76 -27
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn31/dcn31_clk_mgr.c: +46 -0
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn314/dcn314_clk_mgr.c: +49 -1
drivers/gpu/drm/amd/display/dc/clk_mgr/dcn315/dcn315_clk_mgr.c: +47 -1
drivers/gpu/drm/amd/display/dc/core/dc.c: +122 -78
drivers/gpu/drm/amd/display/dc/core/dc_hw_sequencer.c: +38 -0
drivers/gpu/drm/amd/display/dc/core/dc_link.c: +84 -46
drivers/gpu/drm/amd/display/dc/core/dc_link_ddc.c: +18 -0
drivers/gpu/drm/amd/display/dc/core/dc_link_dp.c: +206 -231
drivers/gpu/drm/amd/display/dc/core/dc_link_dpia.c: +21 -12
drivers/gpu/drm/amd/display/dc/core/dc_resource.c: +22 -3
drivers/gpu/drm/amd/display/dc/core/dc_stream.c: +2 -1
drivers/gpu/drm/amd/display/dc/dc.h: +123 -17
drivers/gpu/drm/amd/display/dc/dc_dmub_srv.c: +68 -7
drivers/gpu/drm/amd/display/dc/dc_dmub_srv.h: +2 -0
drivers/gpu/drm/amd/display/dc/dc_hw_types.h: +141 -7
drivers/gpu/drm/amd/display/dc/dc_link.h: +29 -1
drivers/gpu/drm/amd/display/dc/dc_stream.h: +2 -6
drivers/gpu/drm/amd/display/dc/dce/dce_audio.c: +1 -1
drivers/gpu/drm/amd/display/dc/dce/dce_aux.c: +5 -7
drivers/gpu/drm/amd/display/dc/dce/dmub_psr.c: +4 -3
drivers/gpu/drm/amd/display/dc/dce110/dce110_hw_sequencer.c: +146 -10
drivers/gpu/drm/amd/display/dc/dce110/dce110_hw_sequencer.h: +19 -1
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_dpp.c: +3 -2
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_hubp.c: +3 -6
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_hw_sequencer.c: +91 -62
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_hw_sequencer.h: +1 -2
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_optc.c: +42 -5
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_optc.h: +2 -0
drivers/gpu/drm/amd/display/dc/dcn10/dcn10_resource.c: +18 -0
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_dccg.h: +1 -0
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_hubp.c: +3 -6
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_hwseq.c: +33 -4
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn20/dcn20_mmhubbub.c: +2 -1
drivers/gpu/drm/amd/display/dc/dcn201/dcn201_hwseq.c: +2 -1
drivers/gpu/drm/amd/display/dc/dcn201/dcn201_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn21/dcn21_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_hwseq.c: +20 -1
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_mmhubbub.h: +0 -8
drivers/gpu/drm/amd/display/dc/dcn30/dcn30_resource.c: +4 -3
drivers/gpu/drm/amd/display/dc/dcn301/dcn301_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn301/dcn301_resource.c: +4 -1
drivers/gpu/drm/amd/display/dc/dcn302/dcn302_resource.c: +2 -1
drivers/gpu/drm/amd/display/dc/dcn303/dcn303_resource.c: +1 -0
drivers/gpu/drm/amd/display/dc/dcn31/dcn31_hpo_dp_stream_encoder.c: +3 -3
drivers/gpu/drm/amd/display/dc/dcn31/dcn31_hubbub.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn31/dcn31_hubbub.h: +2 -0
drivers/gpu/drm/amd/display/dc/dcn31/dcn31_hwseq.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn31/dcn31_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn31/dcn31_resource.c: +1 -2
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_dccg.c: +3 -3
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_dccg.h: +52 -18
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_dio_stream_encoder.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_hwseq.c: +3 -0
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_init.c: +4 -0
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_optc.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn314/dcn314_resource.c: +2 -3
drivers/gpu/drm/amd/display/dc/dcn315/dcn315_resource.c: +0 -1
drivers/gpu/drm/amd/display/dc/dcn316/dcn316_resource.c: +0 -1
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_dccg.c: +4 -4
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_dio_link_encoder.c: +2 -2
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_dio_stream_encoder.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_dpp.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_hubbub.c: +7 -7
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_hubbub.h: +29 -0
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_hwseq.c: +268 -123
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_hwseq.h: +16 -0
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_init.c: +7 -0
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_mmhubbub.c: +1 -1
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_mmhubbub.h: +0 -10
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_mpc.c: +3 -3
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_optc.c: +3 -3
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_resource.c: +402 -370
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_resource.h: +1167 -2
drivers/gpu/drm/amd/display/dc/dcn32/dcn32_resource_helpers.c: +138 -28
drivers/gpu/drm/amd/display/dc/dcn321/dcn321_resource.c: +360 -318
drivers/gpu/drm/amd/display/dc/dm_helpers.h: +9 -3
drivers/gpu/drm/amd/display/dc/dml/calcs/bw_fixed.c: +6 -8
drivers/gpu/drm/amd/display/dc/dml/calcs/dcn_calc_auto.c: +11 -11
drivers/gpu/drm/amd/display/dc/dml/calcs/dcn_calc_math.c: +7 -9
drivers/gpu/drm/amd/display/dc/dml/calcs/dcn_calcs.c: +6 -26
drivers/gpu/drm/amd/display/dc/dml/dcn20/dcn20_fpu.c: +17 -17
drivers/gpu/drm/amd/display/dc/dml/dcn20/display_mode_vba_20v2.c: +5 -5
drivers/gpu/drm/amd/display/dc/dml/dcn21/display_mode_vba_21.c: +5 -3
drivers/gpu/drm/amd/display/dc/dml/dcn30/display_mode_vba_30.c: +65 -237
drivers/gpu/drm/amd/display/dc/dml/dcn301/dcn301_fpu.c: +26 -19
drivers/gpu/drm/amd/display/dc/dml/dcn31/dcn31_fpu.c: +59 -35
drivers/gpu/drm/amd/display/dc/dml/dcn31/display_mode_vba_31.c: +6 -4
drivers/gpu/drm/amd/display/dc/dml/dcn314/dcn314_fpu.c: +7 -0
drivers/gpu/drm/amd/display/dc/dml/dcn314/display_mode_vba_314.c: +6 -4
drivers/gpu/drm/amd/display/dc/dml/dcn32/dcn32_fpu.c: +159 -37
drivers/gpu/drm/amd/display/dc/dml/dcn32/dcn32_fpu.h: +2 -8
drivers/gpu/drm/amd/display/dc/dml/dcn32/display_mode_vba_32.c: +6 -4
drivers/gpu/drm/amd/display/dc/dml/dcn32/display_mode_vba_util_32.c: +21 -25
drivers/gpu/drm/amd/display/dc/dml/dcn32/display_mode_vba_util_32.h: +1 -0
drivers/gpu/drm/amd/display/dc/dml/dcn321/dcn321_fpu.c: +9 -5
drivers/gpu/drm/amd/display/dc/dml/display_mode_structs.h: +33 -4
drivers/gpu/drm/amd/display/dc/dml/display_mode_vba.c: +1 -0
drivers/gpu/drm/amd/display/dc/dml/display_mode_vba.h: +1 -0
drivers/gpu/drm/amd/display/dc/dml/dml_inline_defs.h: +2 -7
drivers/gpu/drm/amd/display/dc/dml/dml_wrapper.c: +0 -1884
drivers/gpu/drm/amd/display/dc/dml/dml_wrapper_translation.c: +0 -284
drivers/gpu/drm/amd/display/dc/inc/core_types.h: +4 -0
drivers/gpu/drm/amd/display/dc/inc/dc_link_dp.h: +5 -0
drivers/gpu/drm/amd/display/dc/inc/hw/hw_shared.h: +14 -0
drivers/gpu/drm/amd/display/dc/inc/hw/mpc.h: +77 -14
drivers/gpu/drm/amd/display/dc/inc/hw/timing_generator.h: +11 -3
drivers/gpu/drm/amd/display/dc/inc/hw_sequencer.h: +31 -7
drivers/gpu/drm/amd/display/dc/inc/hw_sequencer_private.h: +2 -0
drivers/gpu/drm/amd/display/dc/inc/link_hwss.h: +3 -3
drivers/gpu/drm/amd/display/dc/inc/resource.h: +2 -0
drivers/gpu/drm/amd/display/dc/link/link_hwss_dio.c: +2 -2
drivers/gpu/drm/amd/display/dc/link/link_hwss_dio.h: +1 -1
drivers/gpu/drm/amd/display/dc/link/link_hwss_dpia.c: +1 -1
drivers/gpu/drm/amd/display/dc/link/link_hwss_hpo_dp.c: +1 -1
drivers/gpu/drm/amd/display/dc/virtual/virtual_link_hwss.c: +8 -0
drivers/gpu/drm/amd/display/dmub/dmub_srv.h: +1 -0
drivers/gpu/drm/amd/display/dmub/inc/dmub_cmd.h: +65 -4
drivers/gpu/drm/amd/display/include/dal_asic_id.h: +1 -0
drivers/gpu/drm/amd/display/include/ddc_service_types.h: +2 -2
drivers/gpu/drm/amd/display/include/link_service_types.h: +12 -3
drivers/gpu/drm/amd/include/asic_reg/gc/gc_10_3_0_offset.h: +108 -0
drivers/gpu/drm/amd/include/asic_reg/gc/gc_10_3_0_sh_mask.h: +1468 -1
drivers/gpu/drm/amd/include/asic_reg/gc/gc_11_0_3_offset.h: +12086 -0
drivers/gpu/drm/amd/include/asic_reg/gc/gc_11_0_3_sh_mask.h: +44640 -0
drivers/gpu/drm/amd/include/asic_reg/mmhub/mmhub_9_4_1_offset.h: +4 -0
drivers/gpu/drm/amd/include/asic_reg/mmhub/mmhub_9_4_1_sh_mask.h: +8 -0
drivers/gpu/drm/amd/include/kgd_pp_interface.h: +58 -0
drivers/gpu/drm/amd/pm/amdgpu_dpm.c: +45 -0
drivers/gpu/drm/amd/pm/amdgpu_pm.c: +0 -3
drivers/gpu/drm/amd/pm/inc/amdgpu_dpm.h: +3 -0
drivers/gpu/drm/amd/pm/powerplay/amd_powerplay.c: +4 -1
drivers/gpu/drm/amd/pm/powerplay/hwmgr/vega10_thermal.c: +12 -13
drivers/gpu/drm/amd/pm/powerplay/hwmgr/vega12_processpptables.c: +1 -4
drivers/gpu/drm/amd/pm/powerplay/inc/hardwaremanager.h: +0 -2
drivers/gpu/drm/amd/pm/powerplay/smumgr/polaris10_smumgr.c: +1 -3
drivers/gpu/drm/amd/pm/swsmu/amdgpu_smu.c: +34 -0
drivers/gpu/drm/amd/pm/swsmu/inc/amdgpu_smu.h: +22 -0
drivers/gpu/drm/amd/pm/swsmu/inc/pmfw_if/smu_v11_0_7_ppsmc.h: +2 -2
drivers/gpu/drm/amd/pm/swsmu/inc/pmfw_if/smu_v11_5_ppsmc.h: +4 -1
drivers/gpu/drm/amd/pm/swsmu/inc/smu_types.h: +5 -1
drivers/gpu/drm/amd/pm/swsmu/inc/smu_v13_0.h: +1 -0
drivers/gpu/drm/amd/pm/swsmu/smu11/sienna_cichlid_ppt.c: +54 -0
drivers/gpu/drm/amd/pm/swsmu/smu11/vangogh_ppt.c: +224 -12
drivers/gpu/drm/amd/pm/swsmu/smu13/smu_v13_0.c: +15 -0
drivers/gpu/drm/amd/pm/swsmu/smu_cmn.c: +3 -0
drivers/gpu/drm/amd/pm/swsmu/smu_internal.h: +3 -0
drivers/gpu/drm/arm/Kconfig: +2 -2
drivers/gpu/drm/arm/display/Kconfig: +1 -1
drivers/gpu/drm/arm/display/komeda/d71/d71_dev.c: +1 -2
drivers/gpu/drm/arm/display/komeda/komeda_crtc.c: +2 -3
drivers/gpu/drm/arm/display/komeda/komeda_drv.c: +2 -0
drivers/gpu/drm/arm/display/komeda/komeda_framebuffer.c: +6 -6
drivers/gpu/drm/arm/display/komeda/komeda_kms.c: +25 -6
drivers/gpu/drm/arm/display/komeda/komeda_kms.h: +2 -0
drivers/gpu/drm/arm/display/komeda/komeda_pipeline_state.c: +1 -1
drivers/gpu/drm/arm/display/komeda/komeda_plane.c: +0 -1
drivers/gpu/drm/arm/hdlcd_crtc.c: +5 -6
drivers/gpu/drm/arm/hdlcd_drv.c: +28 -49
drivers/gpu/drm/arm/malidp_drv.c: +4 -5
drivers/gpu/drm/arm/malidp_mw.c: +4 -4
drivers/gpu/drm/arm/malidp_planes.c: +17 -18
drivers/gpu/drm/arm/malidp_regs.h: +1 -1
drivers/gpu/drm/armada/armada_crtc.c: +0 -1
drivers/gpu/drm/armada/armada_gem.c: +3 -3
drivers/gpu/drm/armada/armada_overlay.c: +1 -7
drivers/gpu/drm/armada/armada_plane.c: +1 -1
drivers/gpu/drm/aspeed/Kconfig: +1 -1
drivers/gpu/drm/aspeed/aspeed_gfx_crtc.c: +5 -5
drivers/gpu/drm/aspeed/aspeed_gfx_drv.c: +3 -4
drivers/gpu/drm/ast/ast_drv.c: +1 -1
drivers/gpu/drm/ast/ast_mode.c: +21 -7
drivers/gpu/drm/ast/ast_tables.h: +7 -0
drivers/gpu/drm/atmel-hlcdc/Kconfig: +1 -1
drivers/gpu/drm/atmel-hlcdc/atmel_hlcdc_dc.c: +3 -3
drivers/gpu/drm/atmel-hlcdc/atmel_hlcdc_plane.c: +4 -5
drivers/gpu/drm/bridge/adv7511/adv7511.h: +1 -4
drivers/gpu/drm/bridge/adv7511/adv7511_cec.c: +2 -2
drivers/gpu/drm/bridge/adv7511/adv7511_drv.c: +2 -3
drivers/gpu/drm/bridge/analogix/anx7625.c: +32 -6
drivers/gpu/drm/bridge/analogix/anx7625.h: +6 -0
drivers/gpu/drm/bridge/cadence/cdns-mhdp8546-core.c: +2 -1
drivers/gpu/drm/bridge/chipone-icn6211.c: +38 -10
drivers/gpu/drm/bridge/ite-it6505.c: +18 -9
drivers/gpu/drm/bridge/lontium-lt8912b.c: +17 -9
drivers/gpu/drm/bridge/lontium-lt9611.c: +2 -1
drivers/gpu/drm/bridge/megachips-stdpxxxx-ge-b850v3-fw.c: +3 -1
drivers/gpu/drm/bridge/panel.c: +74 -0
drivers/gpu/drm/bridge/parade-ps8640.c: +7 -2
drivers/gpu/drm/bridge/synopsys/dw-hdmi-ahb-audio.c: +3 -3
drivers/gpu/drm/bridge/synopsys/dw-hdmi.c: +8 -5
drivers/gpu/drm/bridge/tc358762.c: +1 -3
drivers/gpu/drm/bridge/tc358764.c: +1 -3
drivers/gpu/drm/bridge/tc358767.c: +40 -50
drivers/gpu/drm/bridge/ti-sn65dsi86.c: +96 -23
drivers/gpu/drm/display/drm_dp_helper.c: +33 -10
drivers/gpu/drm/display/drm_dp_mst_topology.c: +518 -631
drivers/gpu/drm/display/drm_scdc_helper.c: +13 -0
drivers/gpu/drm/drm_aperture.c: +5 -5
drivers/gpu/drm/drm_atomic_helper.c: +75 -9
drivers/gpu/drm/drm_auth.c: +2 -2
drivers/gpu/drm/drm_bridge.c: +2 -2
drivers/gpu/drm/drm_client.c: +2 -2
drivers/gpu/drm/drm_color_mgmt.c: +1 -1
drivers/gpu/drm/drm_connector.c: +107 -28
drivers/gpu/drm/drm_crtc.c: +82 -12
drivers/gpu/drm/drm_crtc_helper.c: +0 -1
drivers/gpu/drm/drm_damage_helper.c: +7 -4
drivers/gpu/drm/drm_edid.c: +51 -1
drivers/gpu/drm/drm_encoder.c: +64 -11
drivers/gpu/drm/{drm_fb_cma_helper.c => drm_fb_dma_helper.c}: +36 -31
drivers/gpu/drm/drm_fb_helper.c: +75 -26
drivers/gpu/drm/drm_file.c: +1 -142
drivers/gpu/drm/drm_format_helper.c: +456 -246
drivers/gpu/drm/drm_fourcc.c: +54 -1
drivers/gpu/drm/drm_framebuffer.c: +35 -35
drivers/gpu/drm/drm_gem.c: +170 -0
drivers/gpu/drm/{drm_gem_cma_helper.c => drm_gem_dma_helper.c}: +151 -151
drivers/gpu/drm/drm_gem_framebuffer_helper.c: +3 -9
drivers/gpu/drm/drm_gem_shmem_helper.c: +1 -1
drivers/gpu/drm/drm_gem_vram_helper.c: +3 -3
drivers/gpu/drm/drm_ioctl.c: +7 -1
drivers/gpu/drm/drm_mipi_dbi.c: +24 -25
drivers/gpu/drm/drm_mipi_dsi.c: +4 -1
drivers/gpu/drm/drm_mode_config.c: +5 -2
drivers/gpu/drm/drm_modeset_helper.c: +30 -36
drivers/gpu/drm/drm_panel_orientation_quirks.c: +18 -0
drivers/gpu/drm/drm_plane.c: +38 -32
drivers/gpu/drm/drm_plane_helper.c: +93 -21
drivers/gpu/drm/drm_probe_helper.c: +64 -0
drivers/gpu/drm/drm_simple_kms_helper.c: +2 -3
drivers/gpu/drm/exynos/exynos_drm_plane.c: +0 -1
drivers/gpu/drm/exynos/exynos_hdmi.c: +3 -3
drivers/gpu/drm/exynos/exynos_mixer.c: +1 -1
drivers/gpu/drm/fsl-dcu/Kconfig: +1 -1
drivers/gpu/drm/fsl-dcu/fsl_dcu_drm_drv.c: +3 -4
drivers/gpu/drm/fsl-dcu/fsl_dcu_drm_kms.c: +0 -1
drivers/gpu/drm/fsl-dcu/fsl_dcu_drm_plane.c: +6 -12
drivers/gpu/drm/gma500/backlight.c: +68 -34
drivers/gpu/drm/gma500/cdv_device.c: +9 -41
drivers/gpu/drm/gma500/cdv_intel_dp.c: +1 -1
drivers/gpu/drm/gma500/gma_display.c: +1 -18
drivers/gpu/drm/gma500/gma_display.h: +0 -2
drivers/gpu/drm/gma500/oaktrail_crtc.c: +1 -1
drivers/gpu/drm/gma500/oaktrail_device.c: +5 -60
drivers/gpu/drm/gma500/oaktrail_lvds.c: +0 -1
drivers/gpu/drm/gma500/opregion.c: +1 -5
drivers/gpu/drm/gma500/power.c: +30 -128
drivers/gpu/drm/gma500/power.h: +0 -18
drivers/gpu/drm/gma500/psb_device.c: +4 -69
drivers/gpu/drm/gma500/psb_drv.c: +5 -45
drivers/gpu/drm/gma500/psb_drv.h: +8 -12
drivers/gpu/drm/gma500/psb_intel_display.c: +0 -2
drivers/gpu/drm/gma500/psb_intel_drv.h: +0 -5
drivers/gpu/drm/gma500/psb_intel_sdvo.c: +41 -21
drivers/gpu/drm/gma500/psb_irq.c: +7 -8
drivers/gpu/drm/gud/gud_pipe.c: +21 -13
drivers/gpu/drm/hisilicon/kirin/Kconfig: +1 -1
drivers/gpu/drm/hisilicon/kirin/kirin_drm_ade.c: +7 -8
drivers/gpu/drm/hisilicon/kirin/kirin_drm_drv.c: +1 -2
drivers/gpu/drm/hyperv/hyperv_drm_modeset.c: +4 -5
drivers/gpu/drm/i915/Makefile: +3 -1
drivers/gpu/drm/i915/display/g4x_dp.c: +2 -2
drivers/gpu/drm/i915/display/hsw_ips.c: +1 -1
drivers/gpu/drm/i915/display/i9xx_plane.c: +3 -4
drivers/gpu/drm/i915/display/icl_dsi.c: +7 -10
drivers/gpu/drm/i915/display/intel_atomic.c: +4 -5
drivers/gpu/drm/i915/display/intel_atomic_plane.c: +1 -2
drivers/gpu/drm/i915/display/intel_audio.c: +51 -51
drivers/gpu/drm/i915/display/intel_backlight.c: +22 -20
drivers/gpu/drm/i915/display/intel_backlight_regs.h: +124 -0
drivers/gpu/drm/i915/display/intel_bios.c: +204 -171
drivers/gpu/drm/i915/display/intel_bios.h: +1 -0
drivers/gpu/drm/i915/display/intel_bw.c: +103 -35
drivers/gpu/drm/i915/display/intel_cdclk.c: +150 -143
drivers/gpu/drm/i915/display/intel_cdclk.h: +2 -2
drivers/gpu/drm/i915/display/intel_color.c: +18 -17
drivers/gpu/drm/i915/display/intel_connector.c: +4 -4
drivers/gpu/drm/i915/display/intel_crt.c: +7 -6
drivers/gpu/drm/i915/display/intel_crtc.c: +0 -1
drivers/gpu/drm/i915/display/intel_crtc_state_dump.c: +5 -4
drivers/gpu/drm/i915/display/intel_cursor.c: +3 -4
drivers/gpu/drm/i915/display/intel_ddi.c: +45 -44
drivers/gpu/drm/i915/display/intel_display.c: +171 -210
drivers/gpu/drm/i915/display/intel_display.h: +4 -4
drivers/gpu/drm/i915/display/intel_display_core.h: +418 -0
drivers/gpu/drm/i915/display/intel_display_debugfs.c: +49 -98
drivers/gpu/drm/i915/display/intel_display_power.c: +80 -73
drivers/gpu/drm/i915/display/intel_display_power_map.c: +116 -3
drivers/gpu/drm/i915/display/intel_display_power_well.c: +87 -42
drivers/gpu/drm/i915/display/intel_display_power_well.h: +10 -6
drivers/gpu/drm/i915/display/intel_display_types.h: +3 -2
drivers/gpu/drm/i915/display/intel_dmc.c: +108 -34
drivers/gpu/drm/i915/display/intel_dmc.h: +1 -0
drivers/gpu/drm/i915/display/intel_dmc_regs.h: +2 -0
drivers/gpu/drm/i915/display/intel_dp.c: +82 -39
drivers/gpu/drm/i915/display/intel_dp_aux.c: +54 -3
drivers/gpu/drm/i915/display/intel_dp_aux_backlight.c: +13 -2
drivers/gpu/drm/i915/display/intel_dp_hdcp.c: +1 -0
drivers/gpu/drm/i915/display/intel_dp_link_training.c: +36 -47
drivers/gpu/drm/i915/display/intel_dp_mst.c: +39 -66
drivers/gpu/drm/i915/display/intel_dpio_phy.c: +1 -1
drivers/gpu/drm/i915/display/intel_dpll.c: +82 -29
drivers/gpu/drm/i915/display/intel_dpll_mgr.c: +178 -148
drivers/gpu/drm/i915/display/intel_dsb.c: +30 -0
drivers/gpu/drm/i915/display/intel_dsb.h: +0 -28
drivers/gpu/drm/i915/display/intel_dsi.c: +1 -1
drivers/gpu/drm/i915/display/intel_dsi.h: +0 -3
drivers/gpu/drm/i915/display/intel_dsi_dcs_backlight.c: +8 -6
drivers/gpu/drm/i915/display/intel_dvo_dev.h: +2 -2
drivers/gpu/drm/i915/display/intel_fb.c: +9 -9
drivers/gpu/drm/i915/display/intel_fb_pin.c: +2 -2
drivers/gpu/drm/i915/display/intel_fb_pin.h: +2 -2
drivers/gpu/drm/i915/display/intel_fbc.c: +12 -6
drivers/gpu/drm/i915/display/intel_fbc.h: +1 -0
drivers/gpu/drm/i915/display/intel_fbdev.c: +24 -16
drivers/gpu/drm/i915/display/intel_fdi.c: +10 -10
drivers/gpu/drm/i915/display/intel_frontbuffer.c: +29 -27
drivers/gpu/drm/i915/display/intel_frontbuffer.h: +18 -0
drivers/gpu/drm/i915/display/intel_gmbus.c: +153 -137
drivers/gpu/drm/i915/display/intel_gmbus.h: +1 -0
drivers/gpu/drm/i915/display/intel_gmbus_regs.h: +81 -0
drivers/gpu/drm/i915/display/intel_hdcp.c: +93 -70
drivers/gpu/drm/i915/display/intel_hdcp_regs.h: +270 -0
drivers/gpu/drm/i915/display/intel_hdmi.c: +11 -1
drivers/gpu/drm/i915/display/intel_hotplug.c: +58 -58
drivers/gpu/drm/i915/display/intel_lpe_audio.c: +24 -23
drivers/gpu/drm/i915/display/intel_lvds.c: +2 -2
drivers/gpu/drm/i915/display/intel_modeset_setup.c: +8 -7
drivers/gpu/drm/i915/display/intel_modeset_verify.c: +4 -4
drivers/gpu/drm/i915/display/intel_opregion.c: +21 -21
drivers/gpu/drm/i915/display/intel_overlay.c: +8 -8
drivers/gpu/drm/i915/display/intel_panel.c: +24 -21
drivers/gpu/drm/i915/display/intel_panel.h: +3 -0
drivers/gpu/drm/i915/display/intel_pch_refclk.c: +13 -3
drivers/gpu/drm/i915/display/intel_pch_refclk.h: +1 -0
drivers/gpu/drm/i915/display/intel_plane_initial.c: +1 -1
drivers/gpu/drm/i915/display/intel_pps.c: +26 -25
drivers/gpu/drm/i915/display/intel_psr.c: +20 -23
drivers/gpu/drm/i915/display/intel_quirks.c: +16 -6
drivers/gpu/drm/i915/display/intel_quirks.h: +13 -1
drivers/gpu/drm/i915/display/intel_sdvo.c: +9 -9
drivers/gpu/drm/i915/display/intel_snps_phy.c: +1116 -0
drivers/gpu/drm/i915/display/intel_sprite.c: +4 -5
drivers/gpu/drm/i915/display/intel_tc.c: +2 -2
drivers/gpu/drm/i915/display/intel_tv.c: +17 -6
drivers/gpu/drm/i915/display/intel_vbt_defs.h: +196 -150
drivers/gpu/drm/i915/display/intel_vdsc.c: +3 -1
drivers/gpu/drm/i915/display/intel_vrr.c: +10 -4
drivers/gpu/drm/i915/display/skl_universal_plane.c: +5 -6
drivers/gpu/drm/i915/display/skl_watermark.c: +3562 -0
drivers/gpu/drm/i915/display/skl_watermark.h: +80 -0
drivers/gpu/drm/i915/display/vlv_dsi.c: +11 -16
drivers/gpu/drm/i915/display/vlv_dsi_pll.c: +86 -55
drivers/gpu/drm/i915/display/vlv_dsi_regs.h: +95 -93
drivers/gpu/drm/i915/gem/i915_gem_domain.c: +2 -2
drivers/gpu/drm/i915/gem/i915_gem_lmem.h: +0 -2
drivers/gpu/drm/i915/gem/i915_gem_mman.c: +30 -9
drivers/gpu/drm/i915/gem/i915_gem_mman.h: +1 -0
drivers/gpu/drm/i915/gem/i915_gem_object.c: +1 -1
drivers/gpu/drm/i915/gem/i915_gem_object.h: +1 -1
drivers/gpu/drm/i915/gem/i915_gem_object_types.h: +2 -1
drivers/gpu/drm/i915/gem/i915_gem_pages.c: +2 -2
drivers/gpu/drm/i915/gem/i915_gem_pm.c: +1 -1
drivers/gpu/drm/i915/gem/i915_gem_shmem.c: +3 -3
drivers/gpu/drm/i915/gem/i915_gem_stolen.c: +24 -38
drivers/gpu/drm/i915/gem/i915_gem_tiling.c: +2 -2
drivers/gpu/drm/i915/gem/i915_gem_ttm.c: +38 -46
drivers/gpu/drm/i915/gem/i915_gem_ttm_pm.c: +6 -1
drivers/gpu/drm/i915/gem/selftests/huge_pages.c: +9 -9
drivers/gpu/drm/i915/gem/selftests/i915_gem_client_blt.c: +1 -1
drivers/gpu/drm/i915/gem/selftests/i915_gem_coherency.c: +1 -1
drivers/gpu/drm/i915/gem/selftests/i915_gem_dmabuf.c: +1 -1
drivers/gpu/drm/i915/gem/selftests/i915_gem_mman.c: +5 -5
drivers/gpu/drm/i915/gem/selftests/i915_gem_object.c: +1 -1
drivers/gpu/drm/i915/gt/gen6_ppgtt.c: +8 -8
drivers/gpu/drm/i915/gt/gen8_engine_cs.c: +10 -5
drivers/gpu/drm/i915/gt/gen8_engine_cs.h: +2 -1
drivers/gpu/drm/i915/gt/gen8_ppgtt.c: +30 -28
drivers/gpu/drm/i915/gt/intel_engine_cs.c: +84 -74
drivers/gpu/drm/i915/gt/intel_engine_regs.h: +1 -0
drivers/gpu/drm/i915/gt/intel_ggtt.c: +12 -4
drivers/gpu/drm/i915/gt/intel_ggtt_fencing.c: +1 -2
drivers/gpu/drm/i915/gt/intel_gsc.c: +96 -10
drivers/gpu/drm/i915/gt/intel_gsc.h: +3 -0
drivers/gpu/drm/i915/gt/intel_gt.c: +85 -29
drivers/gpu/drm/i915/gt/intel_gt.h: +2 -2
drivers/gpu/drm/i915/gt/intel_gt_clock_utils.c: +81 -93
drivers/gpu/drm/i915/gt/intel_gt_irq.c: +27 -8
drivers/gpu/drm/i915/gt/intel_gt_pm.h: +8 -0
drivers/gpu/drm/i915/gt/intel_gt_pm_debugfs.c: +2 -2
drivers/gpu/drm/i915/gt/intel_gt_pm_irq.c: +4 -4
drivers/gpu/drm/i915/gt/intel_gt_regs.h: +23 -0
drivers/gpu/drm/i915/gt/intel_gt_sysfs.c: +5 -5
drivers/gpu/drm/i915/gt/intel_gt_sysfs.h: +6 -0
drivers/gpu/drm/i915/gt/intel_gt_sysfs_pm.c: +34 -0
drivers/gpu/drm/i915/gt/intel_gt_types.h: +44 -1
drivers/gpu/drm/i915/gt/intel_gtt.c: +3 -0
drivers/gpu/drm/i915/gt/intel_gtt.h: +0 -3
drivers/gpu/drm/i915/gt/intel_lrc.c: +47 -3
drivers/gpu/drm/i915/gt/intel_migrate.c: +4 -33
drivers/gpu/drm/i915/gt/intel_ppgtt.c: +1 -1
drivers/gpu/drm/i915/gt/intel_region_lmem.c: +10 -7
drivers/gpu/drm/i915/gt/intel_reset.c: +4 -4
drivers/gpu/drm/i915/gt/intel_rps.c: +24 -14
drivers/gpu/drm/i915/gt/intel_sa_media.c: +47 -0
drivers/gpu/drm/i915/gt/intel_sa_media.h: +15 -0
drivers/gpu/drm/i915/gt/intel_sseu.c: +2 -3
drivers/gpu/drm/i915/gt/intel_workarounds.c: +61 -24
drivers/gpu/drm/i915/gt/selftest_execlists.c: +11 -5
drivers/gpu/drm/i915/gt/selftest_hangcheck.c: +9 -3
drivers/gpu/drm/i915/gt/selftest_lrc.c: +95 -20
drivers/gpu/drm/i915/gt/selftest_slpc.c: +9 -0
drivers/gpu/drm/i915/gt/uc/abi/guc_communication_ctb_abi.h: +5 -3
drivers/gpu/drm/i915/gt/uc/intel_guc.c: +40 -54
drivers/gpu/drm/i915/gt/uc/intel_guc.h: +2 -0
drivers/gpu/drm/i915/gt/uc/intel_guc_ads.c: +7 -3
drivers/gpu/drm/i915/gt/uc/intel_guc_capture.c: +61 -52
drivers/gpu/drm/i915/gt/uc/intel_guc_capture.h: +0 -1
drivers/gpu/drm/i915/gt/uc/intel_guc_ct.c: +36 -9
drivers/gpu/drm/i915/gt/uc/intel_guc_log.c: +188 -41
drivers/gpu/drm/i915/gt/uc/intel_guc_log.h: +26 -16
drivers/gpu/drm/i915/gt/uc/intel_guc_reg.h: +4 -0
drivers/gpu/drm/i915/gt/uc/intel_guc_slpc.c: +31 -67
drivers/gpu/drm/i915/gt/uc/intel_guc_submission.c: +23 -32
drivers/gpu/drm/i915/gt/uc/intel_uc.c: +7 -5
drivers/gpu/drm/i915/gt/uc/intel_uc_fw.c: +323 -153
drivers/gpu/drm/i915/gt/uc/intel_uc_fw.h: +20 -19
drivers/gpu/drm/i915/gt/uc/intel_uc_fw_abi.h: +5 -3
drivers/gpu/drm/i915/gt/uc/selftest_guc.c: +21 -19
drivers/gpu/drm/i915/gt/uc/selftest_guc_hangcheck.c: +159 -0
drivers/gpu/drm/i915/gt/uc/selftest_guc_multi_lrc.c: +5 -5
drivers/gpu/drm/i915/gvt/cfg_space.c: +3 -2
drivers/gpu/drm/i915/gvt/edid.c: +2 -1
drivers/gpu/drm/i915/gvt/handlers.c: +2 -2
drivers/gpu/drm/i915/i915_debugfs.c: +31 -32
drivers/gpu/drm/i915/i915_driver.c: +100 -47
drivers/gpu/drm/i915/i915_drv.h: +35 -496
drivers/gpu/drm/i915/i915_gem.c: +48 -8
drivers/gpu/drm/i915/i915_gem.h: +43 -0
drivers/gpu/drm/i915/i915_getparam.c: +1 -1
drivers/gpu/drm/i915/i915_gpu_error.c: +68 -16
drivers/gpu/drm/i915/i915_gpu_error.h: +19 -2
drivers/gpu/drm/i915/i915_irq.c: +50 -50
drivers/gpu/drm/i915/i915_pci.c: +175 -133
drivers/gpu/drm/i915/i915_pci.h: +6 -0
drivers/gpu/drm/i915/i915_perf.c: +2 -1
drivers/gpu/drm/i915/i915_reg.h: +90 -451
drivers/gpu/drm/i915/i915_sw_fence.c: +0 -2
drivers/gpu/drm/i915/i915_sw_fence.h: +5 -1
drivers/gpu/drm/i915/i915_ttm_buddy_manager.c: +73 -0
drivers/gpu/drm/i915/i915_utils.h: +0 -4
drivers/gpu/drm/i915/i915_vma.c: +20 -20
drivers/gpu/drm/i915/i915_vma.h: +9 -9
drivers/gpu/drm/i915/i915_vma_resource.c: +4 -0
drivers/gpu/drm/i915/i915_vma_types.h: +21 -21
drivers/gpu/drm/i915/intel_device_info.c: +57 -40
drivers/gpu/drm/i915/intel_device_info.h: +58 -39
drivers/gpu/drm/i915/intel_dram.c: +40 -1
drivers/gpu/drm/i915/intel_gvt_mmio_table.c: +1 -0
drivers/gpu/drm/i915/intel_mchbar_regs.h: +3 -0
drivers/gpu/drm/i915/intel_pch.c: +8 -1
drivers/gpu/drm/i915/intel_pch.h: +4 -0
drivers/gpu/drm/i915/intel_pci_config.h: +7 -0
drivers/gpu/drm/i915/intel_pm.c: +323 -3745
drivers/gpu/drm/i915/intel_pm.h: +5 -60
drivers/gpu/drm/i915/intel_uncore.c: +70 -42
drivers/gpu/drm/i915/intel_uncore.h: +35 -5
drivers/gpu/drm/i915/pxp/intel_pxp.c: +17 -2
drivers/gpu/drm/i915/pxp/intel_pxp_debugfs.c: +2 -2
drivers/gpu/drm/i915/pxp/intel_pxp_irq.c: +7 -7
drivers/gpu/drm/i915/pxp/intel_pxp_session.c: +2 -2
drivers/gpu/drm/i915/selftests/i915_gem_gtt.c: +2 -2
drivers/gpu/drm/i915/selftests/i915_live_selftests.h: +1 -0
drivers/gpu/drm/i915/selftests/i915_perf.c: +1 -1
drivers/gpu/drm/i915/selftests/i915_request.c: +2 -2
drivers/gpu/drm/i915/selftests/i915_vma.c: +35 -35
drivers/gpu/drm/i915/selftests/mock_gem_device.c: +5 -4
drivers/gpu/drm/imx/Kconfig: +1 -1
drivers/gpu/drm/imx/dcss/Kconfig: +1 -1
drivers/gpu/drm/imx/dcss/dcss-kms.c: +3 -3
drivers/gpu/drm/imx/dcss/dcss-plane.c: +9 -9
drivers/gpu/drm/imx/imx-drm-core.c: +4 -6
drivers/gpu/drm/imx/imx-drm.h: +1 -1
drivers/gpu/drm/imx/ipuv3-crtc.c: +1 -2
drivers/gpu/drm/imx/ipuv3-plane.c: +16 -17
drivers/gpu/drm/ingenic/Kconfig: +1 -1
drivers/gpu/drm/ingenic/ingenic-drm-drv.c: +43 -15
drivers/gpu/drm/ingenic/ingenic-ipu.c: +9 -8
drivers/gpu/drm/kmb/Kconfig: +1 -1
drivers/gpu/drm/kmb/kmb_drv.c: +3 -3
drivers/gpu/drm/kmb/kmb_plane.c: +7 -8
drivers/gpu/drm/logicvc/Kconfig: +2 -2
drivers/gpu/drm/logicvc/logicvc_crtc.c: +1 -1
drivers/gpu/drm/logicvc/logicvc_drm.c: +5 -5
drivers/gpu/drm/logicvc/logicvc_interface.c: +1 -1
drivers/gpu/drm/logicvc/logicvc_layer.c: +5 -6
drivers/gpu/drm/logicvc/logicvc_mode.c: +1 -2
drivers/gpu/drm/mcde/Kconfig: +1 -1
drivers/gpu/drm/mcde/mcde_display.c: +4 -4
drivers/gpu/drm/mcde/mcde_drv.c: +5 -5
drivers/gpu/drm/mediatek/Kconfig: +10 -1
drivers/gpu/drm/mediatek/Makefile: +2 -0
drivers/gpu/drm/mediatek/mtk_dp.c: +2663 -0
drivers/gpu/drm/mediatek/mtk_dp_reg.h: +350 -0
drivers/gpu/drm/mediatek/mtk_dpi.c: +0 -1
drivers/gpu/drm/mediatek/mtk_drm_crtc.c: +0 -1
drivers/gpu/drm/mediatek/mtk_drm_drv.c: +2 -5
drivers/gpu/drm/mediatek/mtk_drm_gem.c: +2 -2
drivers/gpu/drm/mediatek/mtk_drm_plane.c: +4 -5
drivers/gpu/drm/mediatek/mtk_hdmi.c: +0 -1
drivers/gpu/drm/meson/Kconfig: +1 -1
drivers/gpu/drm/meson/meson_drv.c: +18 -6
drivers/gpu/drm/meson/meson_drv.h: +7 -0
drivers/gpu/drm/meson/meson_encoder_cvbs.c: +13 -0
drivers/gpu/drm/meson/meson_encoder_cvbs.h: +1 -0
drivers/gpu/drm/meson/meson_encoder_hdmi.c: +13 -0
drivers/gpu/drm/meson/meson_encoder_hdmi.h: +1 -0
drivers/gpu/drm/meson/meson_overlay.c: +9 -10
drivers/gpu/drm/meson/meson_plane.c: +6 -7
drivers/gpu/drm/mgag200/Makefile: +2 -2
drivers/gpu/drm/mgag200/mgag200_bmc.c: +99 -0
drivers/gpu/drm/mgag200/mgag200_drv.c: +11 -10
drivers/gpu/drm/mgag200/mgag200_drv.h: +167 -41
drivers/gpu/drm/mgag200/mgag200_g200.c: +250 -4
drivers/gpu/drm/mgag200/mgag200_g200eh.c: +273 -4
drivers/gpu/drm/mgag200/mgag200_g200eh3.c: +177 -4
drivers/gpu/drm/mgag200/mgag200_g200er.c: +311 -4
drivers/gpu/drm/mgag200/mgag200_g200ev.c: +312 -4
drivers/gpu/drm/mgag200/mgag200_g200ew3.c: +188 -4
drivers/gpu/drm/mgag200/mgag200_g200se.c: +429 -2
drivers/gpu/drm/mgag200/mgag200_g200wb.c: +322 -4
drivers/gpu/drm/mgag200/mgag200_mode.c: +219 -507
drivers/gpu/drm/mgag200/mgag200_pll.c: +0 -997
drivers/gpu/drm/mgag200/mgag200_reg.h: +1 -1
drivers/gpu/drm/msm/adreno/a3xx_gpu.c: +1 -1
drivers/gpu/drm/msm/adreno/a4xx_gpu.c: +1 -1
drivers/gpu/drm/msm/adreno/a6xx.xml.h: +4 -0
drivers/gpu/drm/msm/adreno/a6xx_gmu.c: +52 -31
drivers/gpu/drm/msm/adreno/a6xx_gpu.c: +41 -4
drivers/gpu/drm/msm/disp/dpu1/dpu_crtc.c: +16 -34
drivers/gpu/drm/msm/disp/dpu1/dpu_crtc.h: +0 -1
drivers/gpu/drm/msm/disp/dpu1/dpu_encoder.c: +15 -16
drivers/gpu/drm/msm/disp/dpu1/dpu_encoder.h: +1 -1
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_catalog.c: +2 -7
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_catalog.h: +1 -1
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_ctl.c: +33 -45
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_ctl.h: +26 -9
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_dsc.c: +37 -37
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_dsc.h: +2 -2
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_mdss.h: +2 -4
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_sspp.c: +1 -2
drivers/gpu/drm/msm/disp/dpu1/dpu_hw_sspp.h: +1 -3
drivers/gpu/drm/msm/disp/dpu1/dpu_kms.c: +9 -18
drivers/gpu/drm/msm/disp/dpu1/dpu_plane.c: +14 -80
drivers/gpu/drm/msm/disp/dpu1/dpu_plane.h: +1 -21
drivers/gpu/drm/msm/disp/dpu1/dpu_vbif.c: +37 -28
drivers/gpu/drm/msm/disp/mdp5/mdp5_kms.c: +3 -6
drivers/gpu/drm/msm/dp/dp_catalog.c: +1 -1
drivers/gpu/drm/msm/dp/dp_ctrl.c: +59 -89
drivers/gpu/drm/msm/dp/dp_ctrl.h: +0 -1
drivers/gpu/drm/msm/dp/dp_link.c: +2 -3
drivers/gpu/drm/msm/dsi/dsi.c: +3 -34
drivers/gpu/drm/msm/dsi/dsi.h: +4 -27
drivers/gpu/drm/msm/dsi/dsi_cfg.c: +86 -86
drivers/gpu/drm/msm/dsi/dsi_cfg.h: +2 -1
drivers/gpu/drm/msm/dsi/dsi_host.c: +89 -210
drivers/gpu/drm/msm/dsi/dsi_manager.c: +32 -256
drivers/gpu/drm/msm/dsi/phy/dsi_phy.c: +33 -127
drivers/gpu/drm/msm/dsi/phy/dsi_phy.h: +3 -2
drivers/gpu/drm/msm/dsi/phy/dsi_phy_10nm.c: +86 -99
drivers/gpu/drm/msm/dsi/phy/dsi_phy_14nm.c: +41 -46
drivers/gpu/drm/msm/dsi/phy/dsi_phy_20nm.c: +7 -7
drivers/gpu/drm/msm/dsi/phy/dsi_phy_28nm.c: +66 -79
drivers/gpu/drm/msm/dsi/phy/dsi_phy_28nm_8960.c: +46 -56
drivers/gpu/drm/msm/dsi/phy/dsi_phy_7nm.c: +90 -98
drivers/gpu/drm/msm/hdmi/hdmi_phy_8996.c: +14 -11
drivers/gpu/drm/msm/msm_debugfs.c: +8 -0
drivers/gpu/drm/msm/msm_drv.c: +36 -12
drivers/gpu/drm/msm/msm_drv.h: +62 -27
drivers/gpu/drm/msm/msm_gem.c: +64 -115
drivers/gpu/drm/msm/msm_gem.h: +12 -111
drivers/gpu/drm/msm/msm_gem_prime.c: +2 -2
drivers/gpu/drm/msm/msm_gem_shrinker.c: +76 -88
drivers/gpu/drm/msm/msm_gem_submit.c: +29 -49
drivers/gpu/drm/msm/msm_gpu.c: +14 -10
drivers/gpu/drm/msm/msm_gpu.h: +7 -7
drivers/gpu/drm/msm/msm_gpu_trace.h: +17 -19
drivers/gpu/drm/msm/msm_io_utils.c: +22 -0
drivers/gpu/drm/msm/msm_iommu.c: +86 -15
drivers/gpu/drm/msm/msm_ringbuffer.c: +0 -4
drivers/gpu/drm/msm/msm_submitqueue.c: +1 -0
drivers/gpu/drm/mxsfb/Kconfig: +2 -2
drivers/gpu/drm/mxsfb/lcdif_drv.c: +6 -21
drivers/gpu/drm/mxsfb/lcdif_drv.h: +1 -0
drivers/gpu/drm/mxsfb/lcdif_kms.c: +12 -13
drivers/gpu/drm/mxsfb/mxsfb_drv.c: +3 -3
drivers/gpu/drm/mxsfb/mxsfb_kms.c: +19 -20
drivers/gpu/drm/nouveau/dispnv04/crtc.c: +16 -27
drivers/gpu/drm/nouveau/dispnv04/overlay.c: +7 -6
drivers/gpu/drm/nouveau/dispnv50/base507c.c: +2 -3
drivers/gpu/drm/nouveau/dispnv50/curs507a.c: +2 -3
drivers/gpu/drm/nouveau/dispnv50/disp.c: +91 -107
drivers/gpu/drm/nouveau/dispnv50/disp.h: +2 -0
drivers/gpu/drm/nouveau/dispnv50/ovly507e.c: +2 -3
drivers/gpu/drm/nouveau/dispnv50/wndwc37e.c: +2 -3
drivers/gpu/drm/nouveau/dispnv50/wndwc57e.c: +0 -1
drivers/gpu/drm/nouveau/nouveau_bo.c: +8 -5
drivers/gpu/drm/nouveau/nouveau_connector.c: +19 -2
drivers/gpu/drm/nouveau/nouveau_connector.h: +3 -0
drivers/gpu/drm/nouveau/nouveau_hwmon.c: +17 -68
drivers/gpu/drm/nouveau/nouveau_mem.c: +29 -0
drivers/gpu/drm/nouveau/nouveau_mem.h: +6 -0
drivers/gpu/drm/nouveau/nouveau_prime.c: +0 -1
drivers/gpu/drm/nouveau/nouveau_ttm.c: +24 -0
drivers/gpu/drm/nouveau/nvkm/subdev/bios/pmu.c: +1 -4
drivers/gpu/drm/nouveau/nvkm/subdev/clk/gm20b.c: +1 -1
drivers/gpu/drm/omapdrm/dss/dispc.c: +1 -1
drivers/gpu/drm/omapdrm/dss/dss.c: +3 -0
drivers/gpu/drm/omapdrm/omap_crtc.c: +0 -1
drivers/gpu/drm/omapdrm/omap_dmm_tiler.c: +1 -3
drivers/gpu/drm/omapdrm/omap_overlay.c: +0 -1
drivers/gpu/drm/omapdrm/omap_plane.c: +0 -1
drivers/gpu/drm/panel/Kconfig: +2 -2
drivers/gpu/drm/panel/panel-asus-z00t-tm5p5-n35596.c: +1 -3
drivers/gpu/drm/panel/panel-boe-bf060y8m-aj0.c: +1 -3
drivers/gpu/drm/panel/panel-boe-himax8279d.c: +1 -3
drivers/gpu/drm/panel/panel-boe-tv101wum-nl6.c: +1 -3
drivers/gpu/drm/panel/panel-dsi-cm.c: +1 -3
drivers/gpu/drm/panel/panel-ebbg-ft8719.c: +1 -3
drivers/gpu/drm/panel/panel-edp.c: +25 -17
drivers/gpu/drm/panel/panel-elida-kd35t133.c: +1 -3
drivers/gpu/drm/panel/panel-feixin-k101-im2ba02.c: +1 -3
drivers/gpu/drm/panel/panel-feiyang-fy07024di26a30d.c: +1 -3
drivers/gpu/drm/panel/panel-ilitek-ili9341.c: +4 -3
drivers/gpu/drm/panel/panel-ilitek-ili9881c.c: +1 -3
drivers/gpu/drm/panel/panel-innolux-p079zca.c: +1 -3
drivers/gpu/drm/panel/panel-jdi-fhd-r63452.c: +1 -3
drivers/gpu/drm/panel/panel-jdi-lt070me05000.c: +1 -3
drivers/gpu/drm/panel/panel-khadas-ts050.c: +1 -3
drivers/gpu/drm/panel/panel-kingdisplay-kd097d04.c: +1 -3
drivers/gpu/drm/panel/panel-leadtek-ltk050h3146w.c: +1 -3
drivers/gpu/drm/panel/panel-leadtek-ltk500hd1829.c: +1 -3
drivers/gpu/drm/panel/panel-mantix-mlaf057we51.c: +1 -3
drivers/gpu/drm/panel/panel-novatek-nt35510.c: +5 -4
drivers/gpu/drm/panel/panel-novatek-nt35560.c: +1 -3
drivers/gpu/drm/panel/panel-novatek-nt35950.c: +1 -3
drivers/gpu/drm/panel/panel-novatek-nt36672a.c: +1 -3
drivers/gpu/drm/panel/panel-orisetech-otm8009a.c: +1 -3
drivers/gpu/drm/panel/panel-osd-osd101t2587-53ts.c: +1 -3
drivers/gpu/drm/panel/panel-panasonic-vvx10f034n00.c: +1 -3
drivers/gpu/drm/panel/panel-raydium-rm67191.c: +1 -3
drivers/gpu/drm/panel/panel-raydium-rm68200.c: +1 -3
drivers/gpu/drm/panel/panel-ronbo-rb070d30.c: +1 -3
drivers/gpu/drm/panel/panel-samsung-s6d16d0.c: +1 -3
drivers/gpu/drm/panel/panel-samsung-s6e3ha2.c: +1 -3
drivers/gpu/drm/panel/panel-samsung-s6e63j0x03.c: +1 -3
drivers/gpu/drm/panel/panel-samsung-s6e63m0-dsi.c: +1 -2
drivers/gpu/drm/panel/panel-samsung-s6e88a0-ams452ef01.c: +1 -3
drivers/gpu/drm/panel/panel-samsung-s6e8aa0.c: +1 -3
drivers/gpu/drm/panel/panel-samsung-sofef00.c: +1 -3
drivers/gpu/drm/panel/panel-sharp-lq101r1sx01.c: +2 -4
drivers/gpu/drm/panel/panel-sharp-ls043t1le01.c: +1 -3
drivers/gpu/drm/panel/panel-sharp-ls060t1sx01.c: +1 -3
drivers/gpu/drm/panel/panel-simple.c: +76 -12
drivers/gpu/drm/panel/panel-sitronix-st7701.c: +462 -85
drivers/gpu/drm/panel/panel-sitronix-st7703.c: +1 -3
drivers/gpu/drm/panel/panel-sony-tulip-truly-nt35521.c: +1 -3
drivers/gpu/drm/panel/panel-tdo-tl070wsh30.c: +1 -3
drivers/gpu/drm/panel/panel-truly-nt35597.c: +1 -2
drivers/gpu/drm/panel/panel-visionox-rm69299.c: +1 -2
drivers/gpu/drm/panel/panel-xinpeng-xpp055c272.c: +1 -3
drivers/gpu/drm/panfrost/Kconfig: +1 -0
drivers/gpu/drm/panfrost/Makefile: +2 -1
drivers/gpu/drm/panfrost/panfrost_dump.c: +249 -0
drivers/gpu/drm/panfrost/panfrost_dump.h: +12 -0
drivers/gpu/drm/panfrost/panfrost_job.c: +3 -0
drivers/gpu/drm/panfrost/panfrost_mmu.c: +27 -17
drivers/gpu/drm/panfrost/panfrost_regs.h: +24 -18
drivers/gpu/drm/pl111/Kconfig: +1 -1
drivers/gpu/drm/pl111/pl111_display.c: +4 -4
drivers/gpu/drm/pl111/pl111_drv.c: +4 -5
drivers/gpu/drm/pl111/pl111_versatile.c: +1 -0
drivers/gpu/drm/qxl/qxl_cmd.c: +0 -8
drivers/gpu/drm/qxl/qxl_display.c: +2 -2
drivers/gpu/drm/qxl/qxl_drv.c: +2 -1
drivers/gpu/drm/qxl/qxl_drv.h: +0 -2
drivers/gpu/drm/qxl/qxl_kms.c: +1 -3
drivers/gpu/drm/qxl/qxl_object.c: +1 -1
drivers/gpu/drm/radeon/Makefile: +1 -1
drivers/gpu/drm/radeon/atombios_crtc.c: +1 -10
drivers/gpu/drm/radeon/atombios_encoders.c: +0 -59
drivers/gpu/drm/radeon/ci_dpm.c: +2 -4
drivers/gpu/drm/radeon/r600_cs.c: +0 -2
drivers/gpu/drm/radeon/radeon.h: +0 -3
drivers/gpu/drm/radeon/radeon_atombios.c: +0 -2
drivers/gpu/drm/radeon/radeon_connectors.c: +3 -58
drivers/gpu/drm/radeon/radeon_device.c: +0 -1
drivers/gpu/drm/radeon/radeon_display.c: +0 -1
drivers/gpu/drm/radeon/radeon_dp_mst.c: +0 -778
drivers/gpu/drm/radeon/radeon_drv.c: +1 -8
drivers/gpu/drm/radeon/radeon_encoders.c: +1 -13
drivers/gpu/drm/radeon/radeon_irq_kms.c: +1 -9
drivers/gpu/drm/radeon/radeon_mode.h: +0 -41
drivers/gpu/drm/radeon/radeon_object.c: +3 -3
drivers/gpu/drm/radeon/radeon_pm.c: +1 -1
drivers/gpu/drm/rcar-du/Kconfig: +1 -1
drivers/gpu/drm/rcar-du/Makefile: +0 -7
drivers/gpu/drm/rcar-du/rcar_du_crtc.c: +29 -5
drivers/gpu/drm/rcar-du/rcar_du_drv.c: +4 -5
drivers/gpu/drm/rcar-du/rcar_du_drv.h: +3 -0
drivers/gpu/drm/rcar-du/rcar_du_encoder.c: +4 -5
drivers/gpu/drm/rcar-du/rcar_du_kms.c: +20 -21
drivers/gpu/drm/rcar-du/rcar_du_plane.c: +18 -13
drivers/gpu/drm/rcar-du/rcar_du_vsp.c: +29 -6
drivers/gpu/drm/rcar-du/rcar_du_writeback.c: +2 -2
drivers/gpu/drm/rcar-du/rcar_lvds.c: +4 -4
drivers/gpu/drm/rcar-du/rcar_lvds.h: +5 -5
drivers/gpu/drm/rcar-du/rcar_mipi_dsi.c: +62 -7
drivers/gpu/drm/rcar-du/rcar_mipi_dsi.h: +31 -0
drivers/gpu/drm/rockchip/Kconfig: +1 -1
drivers/gpu/drm/rockchip/dw-mipi-dsi-rockchip.c: +49 -2
drivers/gpu/drm/rockchip/rockchip_drm_drv.c: +1 -1
drivers/gpu/drm/rockchip/rockchip_drm_gem.c: +2 -2
drivers/gpu/drm/rockchip/rockchip_drm_vop.c: +76 -46
drivers/gpu/drm/rockchip/rockchip_drm_vop.h: +2 -0
drivers/gpu/drm/rockchip/rockchip_drm_vop2.c: +0 -1
drivers/gpu/drm/rockchip/rockchip_vop_reg.c: +22 -2
drivers/gpu/drm/rockchip/rockchip_vop_reg.h: +1 -0
drivers/gpu/drm/scheduler/sched_main.c: +5 -5
drivers/gpu/drm/selftests/Makefile: +0 -8
drivers/gpu/drm/selftests/drm_buddy_selftests.h: +0 -15
drivers/gpu/drm/selftests/drm_cmdline_selftests.h: +0 -68
drivers/gpu/drm/selftests/drm_mm_selftests.h: +0 -28
drivers/gpu/drm/selftests/drm_modeset_selftests.h: +0 -40
drivers/gpu/drm/selftests/drm_selftest.c: +0 -109
drivers/gpu/drm/selftests/drm_selftest.h: +0 -41
drivers/gpu/drm/selftests/test-drm_buddy.c: +0 -994
drivers/gpu/drm/selftests/test-drm_cmdline_parser.c: +0 -1141
drivers/gpu/drm/selftests/test-drm_damage_helper.c: +0 -668
drivers/gpu/drm/selftests/test-drm_format.c: +0 -280
drivers/gpu/drm/selftests/test-drm_modeset_common.c: +0 -32
drivers/gpu/drm/selftests/test-drm_modeset_common.h: +0 -52
drivers/gpu/drm/selftests/test-drm_rect.c: +0 -223
drivers/gpu/drm/shmobile/Kconfig: +1 -1
drivers/gpu/drm/shmobile/shmob_drm_crtc.c: +7 -8
drivers/gpu/drm/shmobile/shmob_drm_drv.c: +3 -3
drivers/gpu/drm/shmobile/shmob_drm_kms.c: +1 -2
drivers/gpu/drm/shmobile/shmob_drm_kms.h: +1 -1
drivers/gpu/drm/shmobile/shmob_drm_plane.c: +11 -10
drivers/gpu/drm/sis/sis_drv.c: +1 -1
drivers/gpu/drm/solomon/ssd130x-spi.c: +5 -16
drivers/gpu/drm/solomon/ssd130x.c: +179 -84
drivers/gpu/drm/solomon/ssd130x.h: +7 -2
drivers/gpu/drm/sprd/Kconfig: +1 -1
drivers/gpu/drm/sprd/sprd_dpu.c: +7 -8
drivers/gpu/drm/sprd/sprd_drm.c: +3 -3
drivers/gpu/drm/sti/Kconfig: +1 -1
drivers/gpu/drm/sti/sti_crtc.c: +0 -1
drivers/gpu/drm/sti/sti_cursor.c: +7 -7
drivers/gpu/drm/sti/sti_drv.c: +3 -4
drivers/gpu/drm/sti/sti_gdp.c: +9 -9
drivers/gpu/drm/sti/sti_hqvdp.c: +9 -9
drivers/gpu/drm/sti/sti_plane.c: +1 -2
drivers/gpu/drm/sti/sti_plane.h: +0 -1
drivers/gpu/drm/stm/Kconfig: +1 -1
drivers/gpu/drm/stm/drv.c: +5 -6
drivers/gpu/drm/stm/ltdc.c: +8 -9
drivers/gpu/drm/sun4i/Kconfig: +16 -12
drivers/gpu/drm/sun4i/sun4i_backend.c: +8 -9
drivers/gpu/drm/sun4i/sun4i_drv.c: +4 -5
drivers/gpu/drm/sun4i/sun4i_frontend.c: +14 -12
drivers/gpu/drm/sun4i/sun4i_layer.c: +0 -1
drivers/gpu/drm/sun4i/sun4i_tv.c: +21 -43
drivers/gpu/drm/sun4i/sun8i_mixer.c: +1 -3
drivers/gpu/drm/sun4i/sun8i_ui_layer.c: +13 -14
drivers/gpu/drm/sun4i/sun8i_vi_layer.c: +13 -14
drivers/gpu/drm/tegra/dc.c: +0 -1
drivers/gpu/drm/tegra/fb.c: +1 -1
drivers/gpu/drm/tegra/plane.c: +0 -1
drivers/gpu/drm/tests/Makefile: +3 -1
drivers/gpu/drm/tests/drm_buddy_test.c: +756 -0
drivers/gpu/drm/tests/drm_cmdline_parser_test.c: +991 -0
drivers/gpu/drm/tests/drm_damage_helper_test.c: +639 -0
drivers/gpu/drm/{selftests/test-drm_dp_mst_helper.c => tests/drm_dp_mst_helper_test.c}: +50 -39
drivers/gpu/drm/tests/drm_format_helper_test.c: +336 -34
drivers/gpu/drm/tests/drm_format_test.c: +359 -0
drivers/gpu/drm/{selftests/test-drm_framebuffer.c => tests/drm_framebuffer_test.c}: +76 -44
drivers/gpu/drm/{selftests/test-drm_mm.c => tests/drm_mm_test.c}: +511 -742
drivers/gpu/drm/{selftests/test-drm_plane_helper.c => tests/drm_plane_helper_test.c}: +84 -71
drivers/gpu/drm/tests/drm_rect_test.c: +214 -0
drivers/gpu/drm/tidss/Kconfig: +1 -1
drivers/gpu/drm/tidss/tidss_crtc.c: +1 -3
drivers/gpu/drm/tidss/tidss_dispc.c: +14 -14
drivers/gpu/drm/tidss/tidss_drv.c: +3 -3
drivers/gpu/drm/tidss/tidss_kms.c: +1 -2
drivers/gpu/drm/tidss/tidss_plane.c: +0 -1
drivers/gpu/drm/tilcdc/Kconfig: +1 -1
drivers/gpu/drm/tilcdc/tilcdc_crtc.c: +5 -5
drivers/gpu/drm/tilcdc/tilcdc_drv.c: +3 -3
drivers/gpu/drm/tilcdc/tilcdc_plane.c: +4 -6
drivers/gpu/drm/tiny/Kconfig: +11 -11
drivers/gpu/drm/tiny/arcpgu.c: +7 -7
drivers/gpu/drm/tiny/bochs.c: +11 -3
drivers/gpu/drm/tiny/cirrus.c: +10 -9
drivers/gpu/drm/tiny/hx8357d.c: +4 -3
drivers/gpu/drm/tiny/ili9163.c: +4 -3
drivers/gpu/drm/tiny/ili9225.c: +6 -6
drivers/gpu/drm/tiny/ili9341.c: +4 -3
drivers/gpu/drm/tiny/ili9486.c: +4 -3
drivers/gpu/drm/tiny/mi0283qt.c: +4 -3
drivers/gpu/drm/tiny/panel-mipi-dbi.c: +4 -3
drivers/gpu/drm/tiny/repaper.c: +21 -21
drivers/gpu/drm/tiny/simpledrm.c: +270 -324
drivers/gpu/drm/tiny/st7586.c: +10 -7
drivers/gpu/drm/tiny/st7735r.c: +4 -3
drivers/gpu/drm/ttm/ttm_bo.c: +115 -57
drivers/gpu/drm/ttm/ttm_bo_util.c: +9 -2
drivers/gpu/drm/ttm/ttm_range_manager.c: +33 -0
drivers/gpu/drm/ttm/ttm_resource.c: +62 -2
drivers/gpu/drm/tve200/Kconfig: +1 -1
drivers/gpu/drm/tve200/tve200_display.c: +6 -6
drivers/gpu/drm/tve200/tve200_drv.c: +5 -5
drivers/gpu/drm/udl/udl_drv.c: +18 -1
drivers/gpu/drm/udl/udl_drv.h: +3 -2
drivers/gpu/drm/udl/udl_main.c: +62 -66
drivers/gpu/drm/udl/udl_modeset.c: +9 -40
drivers/gpu/drm/udl/udl_transfer.c: +5 -41
drivers/gpu/drm/v3d/v3d_drv.c: +0 -1
drivers/gpu/drm/v3d/v3d_gem.c: +2 -2
drivers/gpu/drm/v3d/v3d_perfmon.c: +1 -1
drivers/gpu/drm/vboxvideo/vbox_mode.c: +6 -6
drivers/gpu/drm/vboxvideo/vboxvideo.h: +1 -1
drivers/gpu/drm/vc4/Kconfig: +1 -1
drivers/gpu/drm/vc4/vc4_bo.c: +52 -27
drivers/gpu/drm/vc4/vc4_crtc.c: +97 -52
drivers/gpu/drm/vc4/vc4_debugfs.c: +33 -39
drivers/gpu/drm/vc4/vc4_dpi.c: +70 -61
drivers/gpu/drm/vc4/vc4_drv.c: +19 -9
drivers/gpu/drm/vc4/vc4_drv.h: +35 -30
drivers/gpu/drm/vc4/vc4_dsi.c: +87 -44
drivers/gpu/drm/vc4/vc4_gem.c: +14 -8
drivers/gpu/drm/vc4/vc4_hdmi.c: +693 -278
drivers/gpu/drm/vc4/vc4_hdmi.h: +4 -11
drivers/gpu/drm/vc4/vc4_hvs.c: +133 -12
drivers/gpu/drm/vc4/vc4_irq.c: +2 -2
drivers/gpu/drm/vc4/vc4_kms.c: +0 -1
drivers/gpu/drm/vc4/vc4_perfmon.c: +1 -0
drivers/gpu/drm/vc4/vc4_plane.c: +41 -30
drivers/gpu/drm/vc4/vc4_render_cl.c: +20 -20
drivers/gpu/drm/vc4/vc4_txp.c: +37 -26
drivers/gpu/drm/vc4/vc4_v3d.c: +47 -26
drivers/gpu/drm/vc4/vc4_validate.c: +14 -14
drivers/gpu/drm/vc4/vc4_validate_shaders.c: +1 -1
drivers/gpu/drm/vc4/vc4_vec.c: +112 -161
drivers/gpu/drm/via/Makefile: +1 -1
drivers/gpu/drm/via/via_3d_reg.h: +235 -114
drivers/gpu/drm/via/via_dma.c: +0 -744
drivers/gpu/drm/via/via_dmablit.c: +0 -807
drivers/gpu/drm/via/via_dmablit.h: +0 -140
drivers/gpu/drm/via/via_dri1.c: +3630 -0
drivers/gpu/drm/via/via_drv.c: +0 -124
drivers/gpu/drm/via/via_drv.h: +0 -229
drivers/gpu/drm/via/via_irq.c: +0 -388
drivers/gpu/drm/via/via_map.c: +0 -132
drivers/gpu/drm/via/via_mm.c: +0 -241
drivers/gpu/drm/via/via_verifier.c: +0 -1110
drivers/gpu/drm/via/via_verifier.h: +0 -62
drivers/gpu/drm/via/via_video.c: +0 -94
drivers/gpu/drm/virtio/virtgpu_display.c: +2 -0
drivers/gpu/drm/virtio/virtgpu_drv.c: +13 -40
drivers/gpu/drm/virtio/virtgpu_drv.h: +1 -4
drivers/gpu/drm/virtio/virtgpu_gem.c: +3 -1
drivers/gpu/drm/virtio/virtgpu_ioctl.c: +2 -2
drivers/gpu/drm/virtio/virtgpu_kms.c: +10 -13
drivers/gpu/drm/virtio/virtgpu_object.c: +15 -50
drivers/gpu/drm/virtio/virtgpu_plane.c: +12 -28
drivers/gpu/drm/virtio/virtgpu_vq.c: +9 -12
drivers/gpu/drm/vkms/Makefile: +1 -0
drivers/gpu/drm/vkms/vkms_composer.c: +139 -175
drivers/gpu/drm/vkms/vkms_drv.h: +23 -10
drivers/gpu/drm/vkms/vkms_formats.c: +286 -0
drivers/gpu/drm/vkms/vkms_formats.h: +12 -0
drivers/gpu/drm/vkms/vkms_plane.c: +32 -24
drivers/gpu/drm/vkms/vkms_writeback.c: +31 -8
drivers/gpu/drm/vmwgfx/device_include/vm_basic_types.h: +1 -1
drivers/gpu/drm/vmwgfx/ttm_object.h: +2 -2
drivers/gpu/drm/vmwgfx/vmwgfx_bo.c: +6 -8
drivers/gpu/drm/vmwgfx/vmwgfx_cmdbuf_res.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_drv.c: +0 -13
drivers/gpu/drm/vmwgfx/vmwgfx_drv.h: +0 -1
drivers/gpu/drm/vmwgfx/vmwgfx_execbuf.c: +2 -2
drivers/gpu/drm/vmwgfx/vmwgfx_kms.c: +5 -6
drivers/gpu/drm/vmwgfx/vmwgfx_kms.h: +1 -1
drivers/gpu/drm/vmwgfx/vmwgfx_ldu.c: +0 -1
drivers/gpu/drm/vmwgfx/vmwgfx_msg.c: +1 -0
drivers/gpu/drm/vmwgfx/vmwgfx_resource.c: +4 -4
drivers/gpu/drm/vmwgfx/vmwgfx_scrn.c: +1 -2
drivers/gpu/drm/vmwgfx/vmwgfx_simple_resource.c: +1 -1
drivers/gpu/drm/vmwgfx/vmwgfx_stdu.c: +0 -1
drivers/gpu/drm/xlnx/Kconfig: +1 -1
drivers/gpu/drm/xlnx/zynqmp_disp.c: +6 -7
drivers/gpu/drm/xlnx/zynqmp_dpsub.c: +4 -4
drivers/media/platform/renesas/vsp1/vsp1_drm.c: +2 -0
drivers/misc/mei/bus-fixup.c: +71 -35
drivers/misc/mei/client.c: +8 -8
drivers/misc/mei/debugfs.c: +18 -1
drivers/misc/mei/gsc-me.c: +67 -10
drivers/misc/mei/hbm.c: +7 -7
drivers/misc/mei/hw-me-regs.h: +8 -1
drivers/misc/mei/hw-me.c: +118 -20
drivers/misc/mei/hw-me.h: +15 -2
drivers/misc/mei/hw-txe.c: +2 -2
drivers/misc/mei/hw.h: +6 -1
drivers/misc/mei/init.c: +23 -12
drivers/misc/mei/main.c: +2 -2
drivers/misc/mei/mei_dev.h: +34 -1
drivers/misc/mei/mkhi.h: +55 -0
drivers/misc/mei/pci-me.c: +2 -2
drivers/staging/sm750fb/sm750.c: +5 -10
drivers/video/aperture.c: +39 -30
drivers/video/fbdev/arkfb.c: +5 -0
drivers/video/fbdev/asiliantfb.c: +5 -0
drivers/video/fbdev/aty/aty128fb.c: +31 -26
drivers/video/fbdev/aty/atyfb_base.c: +6 -1
drivers/video/fbdev/aty/radeon_base.c: +37 -46
drivers/video/fbdev/carminefb.c: +5 -0
drivers/video/fbdev/chipsfb.c: +9 -4
drivers/video/fbdev/cirrusfb.c: +5 -0
drivers/video/fbdev/core/fbmem.c: +28 -191
drivers/video/fbdev/cyber2000fb.c: +5 -0
drivers/video/fbdev/geode/gx1fb_core.c: +5 -0
drivers/video/fbdev/geode/gxfb_core.c: +5 -0
drivers/video/fbdev/geode/lxfb_core.c: +5 -0
drivers/video/fbdev/gxt4500.c: +5 -0
drivers/video/fbdev/hyperv_fb.c: +4 -2
drivers/video/fbdev/i740fb.c: +5 -0
drivers/video/fbdev/i810/i810_main.c: +160 -155
drivers/video/fbdev/imsttfb.c: +21 -15
drivers/video/fbdev/intelfb/intelfbdrv.c: +5 -0
drivers/video/fbdev/kyro/fbdev.c: +5 -0
drivers/video/fbdev/matrox/matroxfb_base.c: +5 -0
drivers/video/fbdev/mb862xx/mb862xxfbdrv.c: +5 -0
drivers/video/fbdev/neofb.c: +23 -18
drivers/video/fbdev/nvidia/nvidia.c: +6 -1
drivers/video/fbdev/pm2fb.c: +5 -0
drivers/video/fbdev/pm3fb.c: +5 -0
drivers/video/fbdev/pvr2fb.c: +5 -0
drivers/video/fbdev/riva/fbdev.c: +36 -31
drivers/video/fbdev/s3fb.c: +5 -0
drivers/video/fbdev/savage/savagefb_driver.c: +5 -0
drivers/video/fbdev/sis/sis_main.c: +5 -0
drivers/video/fbdev/skeletonfb.c: +109 -101
drivers/video/fbdev/sm712fb.c: +5 -0
drivers/video/fbdev/sstfb.c: +24 -19
drivers/video/fbdev/sunxvr2500.c: +5 -0
drivers/video/fbdev/sunxvr500.c: +5 -0
drivers/video/fbdev/tdfxfb.c: +5 -0
drivers/video/fbdev/tgafb.c: +12 -5
drivers/video/fbdev/tridentfb.c: +5 -0
drivers/video/fbdev/vermilion/vermilion.c: +6 -1
drivers/video/fbdev/vga16fb.c: +73 -118
drivers/video/fbdev/via/via-core.c: +5 -0
drivers/video/fbdev/vt8623fb.c: +5 -0
drivers/video/hdmi.c: +63 -19
include/drm/display/drm_dp.h: +3 -0
include/drm/display/drm_dp_helper.h: +2 -0
include/drm/display/drm_dp_mst_helper.h: +136 -101
include/drm/drm_atomic_helper.h: +12 -0
include/drm/drm_bridge.h: +12 -0
include/drm/drm_connector.h: +26 -0
include/drm/drm_crtc.h: +9 -0
include/drm/drm_encoder.h: +6 -0
include/drm/{drm_fb_cma_helper.h => drm_fb_dma_helper.h}: +5 -5
include/drm/drm_file.h: +0 -9
include/drm/drm_format_helper.h: +38 -31
include/drm/drm_fourcc.h: +4 -0
include/drm/drm_framebuffer.h: +4 -4
include/drm/drm_gem.h: +56 -1
include/drm/{drm_gem_cma_helper.h => drm_gem_dma_helper.h}: +79 -79
include/drm/drm_gem_shmem_helper.h: +1 -1
include/drm/drm_mipi_dbi.h: +2 -0
include/drm/drm_mipi_dsi.h: +3 -1
include/drm/drm_modes.h: +30 -5
include/drm/drm_panel.h: +0 -7
include/drm/drm_plane.h: +45 -7
include/drm/drm_plane_helper.h: +27 -13
include/drm/drm_probe_helper.h: +8 -1
include/drm/gpu_scheduler.h: +5 -4
include/drm/i915_pciids.h: +1 -0
include/drm/ttm/ttm_bo_api.h: +8 -85
include/drm/ttm/ttm_bo_driver.h: +1 -1
include/drm/ttm/ttm_resource.h: +40 -0
include/linux/dma-resv.h: +13 -3
include/linux/fb.h: +0 -10
include/linux/hdmi.h: +6 -1
include/linux/iosys-map.h: +14 -1
include/linux/mei_aux.h: +12 -0
include/media/vsp1.h: +2 -0
include/uapi/drm/amdgpu_drm.h: +8 -0
include/uapi/drm/drm_fourcc.h: +30 -4
include/uapi/drm/drm_mode.h: +4 -4
include/uapi/drm/panfrost_drm.h: +47 -0
include/video/vga.h: +11 -9
