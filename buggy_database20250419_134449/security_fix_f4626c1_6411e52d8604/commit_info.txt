Commit Hash: f4626c12e4b538f757a73d08f4d86d564175b4f7
Subject: ubsan: Add awareness of signed integer overflow traps


Security Keywords:
- hardening

Full commit message:
ubsan: Add awareness of signed integer overflow traps

On arm64, UBSAN traps can be decoded from the trap instruction. Add the
add, sub, and mul overflow trap codes now that CONFIG_UBSAN_SIGNED_WRAP
exists. Seen under clang 19:

  Internal error: UBSAN: unrecognized failure code: 00000000f2005515 [#1] PREEMPT SMP

Reported-by: Nathan Chancellor <nathan@kernel.org>
Closes: https://lore.kernel.org/lkml/20240411-fix-ubsan-in-hardening-config-v1-0-e0177c80ffaa@kernel.org
Fixes: 557f8c582a9b ("ubsan: Reintroduce signed overflow sanitizer")
Tested-by: Nathan Chancellor <nathan@kernel.org>
Link: https://lore.kernel.org/r/20240415182832.work.932-kees@kernel.org
Signed-off-by: Kees Cook <keescook@chromium.org>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Mon Apr 15 11:28:35 2024 -0700
Committer: Kees Cook <keescook@chromium.org>
Commit Date: Mon Apr 15 17:42:43 2024 -0700

Files Changed: 1
Lines Added: 16
Lines Removed: 2
Total Changes: 18
