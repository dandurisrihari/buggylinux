diff --cc arch/x86/kernel/cpu/common.c
index 532691b6c8fe,fefd9b7e93e1..7505f7b13e71
--- a/arch/x86/kernel/cpu/common.c
+++ b/arch/x86/kernel/cpu/common.c
@@@ -1114,9 -1126,12 +1127,10 @@@ void syscall_init(void
  
  	/* Flags to clear on syscall */
  	wrmsrl(MSR_SYSCALL_MASK,
- 	       X86_EFLAGS_TF|X86_EFLAGS_DF|X86_EFLAGS_IF|X86_EFLAGS_IOPL);
+ 	       X86_EFLAGS_TF|X86_EFLAGS_DF|X86_EFLAGS_IF|
+ 	       X86_EFLAGS_IOPL|X86_EFLAGS_AC);
  }
  
 -unsigned long kernel_eflags;
 -
  /*
   * Copies of the original ist values from the tss are only accessed during
   * debugging, no special alignment required.
diff --cc arch/x86/kernel/entry_64.S
index 066334be7b74,ce87e3d10c63..44531acd9a81
--- a/arch/x86/kernel/entry_64.S
+++ b/arch/x86/kernel/entry_64.S
@@@ -56,7 -56,7 +56,8 @@@
  #include <asm/ftrace.h>
  #include <asm/percpu.h>
  #include <asm/asm.h>
 +#include <asm/rcu.h>
+ #include <asm/smap.h>
  #include <linux/err.h>
  
  /* Avoid __ASSEMBLER__'ifying <linux/audit.h> just for this.  */