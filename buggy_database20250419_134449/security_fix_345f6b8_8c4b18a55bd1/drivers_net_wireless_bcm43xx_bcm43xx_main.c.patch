commit 345f6b8beb20338a2d792bf5974d01d457abee53
Author: Daniel Drake <dsd@gentoo.org>
Date:   Tue Jul 11 23:16:34 2006 +0100

    [PATCH] softmac: do shared key auth in workqueue
    
    Johann Uhrmann reported a bcm43xx crash and Michael Buesch tracked
    it down to a problem with the new shared key auth code (recursive
    calls into the driver)
    
    This patch (effectively Michael's patch with a couple of small
    modifications) solves the problem by sending the authentication
    challenge response frame from a workqueue entry.
    
    I also removed a lone \n from the bcm43xx messages relating to
    authentication mode - this small change was previously discussed but
    not patched in.
    
    Signed-off-by: Daniel Drake <dsd@gentoo.org>
    Acked-by: Johannes Berg <johannes@sipsolutions.net>
    Signed-off-by: Michael Buesch <mb@bu3sch.de>
    Signed-off-by: John W. Linville <linville@tuxdriver.com>

diff --git a/drivers/net/wireless/bcm43xx/bcm43xx_main.c b/drivers/net/wireless/bcm43xx/bcm43xx_main.c
index 3889f79e7128..df317c1e12a8 100644
--- a/drivers/net/wireless/bcm43xx/bcm43xx_main.c
+++ b/drivers/net/wireless/bcm43xx/bcm43xx_main.c
@@ -3701,7 +3701,7 @@ static void bcm43xx_ieee80211_set_security(struct net_device *net_dev,
 	}
 	if (sec->flags & SEC_AUTH_MODE) {
 		secinfo->auth_mode = sec->auth_mode;
-		dprintk(", .auth_mode = %d\n", sec->auth_mode);
+		dprintk(", .auth_mode = %d", sec->auth_mode);
 	}
 	dprintk("\n");
 	if (bcm43xx_status(bcm) == BCM43xx_STAT_INITIALIZED &&