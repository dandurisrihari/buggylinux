{
  "hash": "32f8807a48ae55be0e76880cfe8607a18b5bb0df",
  "hash_short": "32f8807a",
  "subject": "Merge branch 'sctp-enhancements-for-the-verification-tag'",
  "body": "Xin Long says:\n\n====================\nsctp: enhancements for the verification tag\n\nThis patchset is to address CVE-2021-3772:\n\n  A flaw was found in the Linux SCTP stack. A blind attacker may be able to\n  kill an existing SCTP association through invalid chunks if the attacker\n  knows the IP-addresses and port numbers being used and the attacker can\n  send packets with spoofed IP addresses.\n\nThis is caused by the missing VTAG verification for the received chunks\nand the incorrect vtag for the ABORT used to reply to these invalid\nchunks.\n\nThis patchset is to go over all processing functions for the received\nchunks and do:\n\n1. Make sure sctp_vtag_verify() is called firstly to verify the vtag from\n   the received chunk and discard this chunk if it fails. With some\n   exceptions:\n\n   a. sctp_sf_do_5_1B_init()/5_2_2_dupinit()/9_2_reshutack(), processing\n      INIT chunk, as sctphdr vtag is always 0 in INIT chunk.\n\n   b. sctp_sf_do_5_2_4_dupcook(), processing dupicate COOKIE_ECHO chunk,\n      as the vtag verification will be done by sctp_tietags_compare() and\n      then it takes right actions according to the return.\n\n   c. sctp_sf_shut_8_4_5(), processing SHUTDOWN_ACK chunk for cookie_wait\n      and cookie_echoed state, as RFC demand sending a SHUTDOWN_COMPLETE\n      even if the vtag verification failed.\n\n   d. sctp_sf_ootb(), called in many types of chunks for closed state or\n      no asoc, as the same reason to c.\n\n2. Always use the vtag from the received INIT chunk to make the response\n   ABORT in sctp_ootb_pkt_new().\n\n3. Fix the order for some checks and add some missing checks for the\n   received chunk.\n\nThis patch series has been tested with SCTP TAHI testing to make sure no\nregression caused on protocol conformance.\n====================\n\nLink: https://lore.kernel.org/r/cover.1634730082.git.lucien.xin@gmail.com\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "Merge branch 'sctp-enhancements-for-the-verification-tag'\n\nXin Long says:\n\n====================\nsctp: enhancements for the verification tag\n\nThis patchset is to address CVE-2021-3772:\n\n  A flaw was found in the Linux SCTP stack. A blind attacker may be able to\n  kill an existing SCTP association through invalid chunks if the attacker\n  knows the IP-addresses and port numbers being used and the attacker can\n  send packets with spoofed IP addresses.\n\nThis is caused by the missing VTAG verification for the received chunks\nand the incorrect vtag for the ABORT used to reply to these invalid\nchunks.\n\nThis patchset is to go over all processing functions for the received\nchunks and do:\n\n1. Make sure sctp_vtag_verify() is called firstly to verify the vtag from\n   the received chunk and discard this chunk if it fails. With some\n   exceptions:\n\n   a. sctp_sf_do_5_1B_init()/5_2_2_dupinit()/9_2_reshutack(), processing\n      INIT chunk, as sctphdr vtag is always 0 in INIT chunk.\n\n   b. sctp_sf_do_5_2_4_dupcook(), processing dupicate COOKIE_ECHO chunk,\n      as the vtag verification will be done by sctp_tietags_compare() and\n      then it takes right actions according to the return.\n\n   c. sctp_sf_shut_8_4_5(), processing SHUTDOWN_ACK chunk for cookie_wait\n      and cookie_echoed state, as RFC demand sending a SHUTDOWN_COMPLETE\n      even if the vtag verification failed.\n\n   d. sctp_sf_ootb(), called in many types of chunks for closed state or\n      no asoc, as the same reason to c.\n\n2. Always use the vtag from the received INIT chunk to make the response\n   ABORT in sctp_ootb_pkt_new().\n\n3. Fix the order for some checks and add some missing checks for the\n   received chunk.\n\nThis patch series has been tested with SCTP TAHI testing to make sure no\nregression caused on protocol conformance.\n====================\n\nLink: https://lore.kernel.org/r/cover.1634730082.git.lucien.xin@gmail.com\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Jakub Kicinski",
  "author_email": "kuba@kernel.org",
  "author_date": "Fri Oct 22 12:36:47 2021 -0700",
  "author_date_iso": "2021-10-22T12:36:47-07:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Fri Oct 22 12:36:47 2021 -0700",
  "committer_date_iso": "2021-10-22T12:36:47-07:00",
  "files_changed": [],
  "files_changed_count": 0,
  "stats": [
    {
      "file": "net/sctp/sm_statefuns.c",
      "insertions": 85,
      "deletions": 54
    }
  ],
  "total_insertions": 85,
  "total_deletions": 54,
  "total_changes": 139,
  "parents": [
    "7f678def99d29c520418607509bb19c7fc96a6db",
    "9d02831e517aa36ee6bdb453a0eb47bd49923fe3"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [
      "CVE-2021-3772"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": []
}