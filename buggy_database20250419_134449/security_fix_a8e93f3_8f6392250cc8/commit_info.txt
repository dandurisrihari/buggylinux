Commit Hash: a8e93f3dccc066cd6dd1e9db1e35942914fc57d1
Subject: firewire: cdev: check write quadlet request length to avoid buffer overflow


Security Keywords:
- exploit

Full commit message:
firewire: cdev: check write quadlet request length to avoid buffer overflow

Check that the data length of a write quadlet request actually is large
enough for a quadlet.  Otherwise, fw_fill_request could access the four
bytes after the end of the outbound_transaction_event structure.

Signed-off-by: Clemens Ladisch <clemens@ladisch.de>

Modification of Clemens' change:  Consolidate the check into
init_request() which is used by the affected ioctl_send_request() and
ioctl_send_broadcast_request() and the unaffected
ioctl_send_stream_packet(), to save a few lines of code.

Note, since struct outbound_transaction_event *e is slab-allocated, such
an out-of-bounds access won't hit unallocated memory but may result in a
(virtually impossible to exploit) information disclosure.

Signed-off-by: Stefan Richter <stefanr@s5r6.in-berlin.de>

Metadata:
Author: Clemens Ladisch <clemens@ladisch.de>
Author Date: Wed Jul 7 14:37:30 2010 +0200
Committer: Stefan Richter <stefanr@s5r6.in-berlin.de>
Commit Date: Tue Jul 13 09:47:47 2010 +0200

Files Changed: 1
Lines Added: 4
Lines Removed: 0
Total Changes: 4
