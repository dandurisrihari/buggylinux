{
  "hash": "2570a4f5428bcdb1077622342181755741e7fa60",
  "hash_short": "2570a4f5",
  "subject": "ipv6: skb_dst() can be NULL in ipv6_hop_jumbo().",
  "body": "This fixes CERT-FI FICORA #341748\n\nDiscovered by Olli Jarva and Tuomo Untinen from the CROSS\nproject at Codenomicon Ltd.\n\nJust like in CVE-2007-4567, we can't rely upon skb_dst() being\nnon-NULL at this point.  We fixed that in commit\ne76b2b2567b83448c2ee85a896433b96150c92e6 (\"[IPV6]: Do no rely on\nskb->dst before it is assigned.\")\n\nHowever commit 483a47d2fe794328d29950fe00ce26dd405d9437 (\"ipv6: added\nnet argument to IP6_INC_STATS_BH\") put a new version of the same bug\ninto this function.\n\nComplicating analysis further, this bug can only trigger when network\nnamespaces are enabled in the build.  When namespaces are turned off,\nthe dev_net() does not evaluate it's argument, so the dereference\nwould not occur.\n\nSo, for a long time, namespaces couldn't be turned on unless SYSFS was\ndisabled.  Therefore, this code has largely been disabled except by\npeople turning it on explicitly for namespace development.\n\nWith help from Eugene Teo <eugene@redhat.com>\n\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "ipv6: skb_dst() can be NULL in ipv6_hop_jumbo().\n\nThis fixes CERT-FI FICORA #341748\n\nDiscovered by Olli Jarva and Tuomo Untinen from the CROSS\nproject at Codenomicon Ltd.\n\nJust like in CVE-2007-4567, we can't rely upon skb_dst() being\nnon-NULL at this point.  We fixed that in commit\ne76b2b2567b83448c2ee85a896433b96150c92e6 (\"[IPV6]: Do no rely on\nskb->dst before it is assigned.\")\n\nHowever commit 483a47d2fe794328d29950fe00ce26dd405d9437 (\"ipv6: added\nnet argument to IP6_INC_STATS_BH\") put a new version of the same bug\ninto this function.\n\nComplicating analysis further, this bug can only trigger when network\nnamespaces are enabled in the build.  When namespaces are turned off,\nthe dev_net() does not evaluate it's argument, so the dereference\nwould not occur.\n\nSo, for a long time, namespaces couldn't be turned on unless SYSFS was\ndisabled.  Therefore, this code has largely been disabled except by\npeople turning it on explicitly for namespace development.\n\nWith help from Eugene Teo <eugene@redhat.com>\n\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "David S. Miller",
  "author_email": "davem@davemloft.net",
  "author_date": "Wed Jan 13 17:27:37 2010 -0800",
  "author_date_iso": "2010-01-13T17:27:37-08:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Wed Jan 13 17:27:37 2010 -0800",
  "committer_date_iso": "2010-01-13T17:27:37-08:00",
  "files_changed": [
    "net/ipv6/exthdrs.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/ipv6/exthdrs.c",
      "insertions": 6,
      "deletions": 1
    }
  ],
  "total_insertions": 6,
  "total_deletions": 1,
  "total_changes": 7,
  "parents": [
    "ba5b0bfa06b6fbee03c6889046e9adcefa5d2c20"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.33",
    "v2.6.33-rc5",
    "v2.6.33-rc6",
    "v2.6.33-rc7",
    "v2.6.33-rc8",
    "v2.6.34",
    "v2.6.34-rc1",
    "v2.6.34-rc2",
    "v2.6.34-rc3",
    "v2.6.34-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2007-4567"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/ipv6/exthdrs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}