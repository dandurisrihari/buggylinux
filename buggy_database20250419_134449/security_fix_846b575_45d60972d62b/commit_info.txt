Commit Hash: 846b5756d7632523b5bfce78c163aa883aa9d587
Subject: SUNRPC: Add an XDR decoding helper for struct opaque_auth


Security Keywords:
- hardening
- authentication

Full commit message:
SUNRPC: Add an XDR decoding helper for struct opaque_auth

RFC 5531 defines the body of an RPC Call message like this:

	struct call_body {
		unsigned int rpcvers;
		unsigned int prog;
		unsigned int vers;
		unsigned int proc;
		opaque_auth cred;
		opaque_auth verf;
		/* procedure-specific parameters start here */
	};

In the current server code, decoding a struct opaque_auth type is
open-coded in several places, and is thus difficult to harden
everywhere.

Introduce a helper for decoding an opaque_auth within the context
of a xdr_stream. This helper can be shared with all authentication
flavor implemenations, even on the client-side.

Done as part of hardening the server-side RPC header decoding paths.

Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>

Metadata:
Author: Chuck Lever <chuck.lever@oracle.com>
Author Date: Mon Jan 2 12:05:43 2023 -0500
Committer: Chuck Lever <chuck.lever@oracle.com>
Commit Date: Mon Feb 20 09:20:09 2023 -0500

Files Changed: 2
Lines Added: 31
Lines Removed: 0
Total Changes: 31
