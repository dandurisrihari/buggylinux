Commit Hash: 9fbc590860e75785bdaf8b83e48fabfe4d4f7d58
Subject: [CIFS] Fix ntlmv2 auth with ntlmssp


Security Keywords:
- auth

Full commit message:
[CIFS] Fix ntlmv2 auth with ntlmssp

Make ntlmv2 as an authentication mechanism within ntlmssp
instead of ntlmv1.
Parse type 2 response in ntlmssp negotiation to pluck
AV pairs and use them to calculate ntlmv2 response token.
Also, assign domain name from the sever response in type 2
packet of ntlmssp and use that (netbios) domain name in
calculation of response.

Enable cifs/smb signing using rc4 and md5.

Changed name of the structure mac_key to session_key to reflect
the type of key it holds.

Use kernel crypto_shash_* APIs instead of the equivalent cifs functions.

Signed-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Acked-by: Herbert Xu <herbert@gondor.apana.org.au>
Signed-off-by: Steve French <sfrench@us.ibm.com>

Metadata:
Author: Steve French <sfrench@us.ibm.com>
Author Date: Fri Aug 20 20:42:26 2010 +0000
Committer: Steve French <sfrench@us.ibm.com>
Commit Date: Fri Aug 20 20:42:26 2010 +0000

Files Changed: 11
Lines Added: 452
Lines Removed: 172
Total Changes: 624
