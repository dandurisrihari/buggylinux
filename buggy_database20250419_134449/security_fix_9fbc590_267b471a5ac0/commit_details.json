{
  "hash": "9fbc590860e75785bdaf8b83e48fabfe4d4f7d58",
  "hash_short": "9fbc5908",
  "subject": "[CIFS] Fix ntlmv2 auth with ntlmssp",
  "body": "Make ntlmv2 as an authentication mechanism within ntlmssp\ninstead of ntlmv1.\nParse type 2 response in ntlmssp negotiation to pluck\nAV pairs and use them to calculate ntlmv2 response token.\nAlso, assign domain name from the sever response in type 2\npacket of ntlmssp and use that (netbios) domain name in\ncalculation of response.\n\nEnable cifs/smb signing using rc4 and md5.\n\nChanged name of the structure mac_key to session_key to reflect\nthe type of key it holds.\n\nUse kernel crypto_shash_* APIs instead of the equivalent cifs functions.\n\nSigned-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>\nAcked-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: Steve French <sfrench@us.ibm.com>",
  "full_message": "[CIFS] Fix ntlmv2 auth with ntlmssp\n\nMake ntlmv2 as an authentication mechanism within ntlmssp\ninstead of ntlmv1.\nParse type 2 response in ntlmssp negotiation to pluck\nAV pairs and use them to calculate ntlmv2 response token.\nAlso, assign domain name from the sever response in type 2\npacket of ntlmssp and use that (netbios) domain name in\ncalculation of response.\n\nEnable cifs/smb signing using rc4 and md5.\n\nChanged name of the structure mac_key to session_key to reflect\nthe type of key it holds.\n\nUse kernel crypto_shash_* APIs instead of the equivalent cifs functions.\n\nSigned-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>\nAcked-by: Herbert Xu <herbert@gondor.apana.org.au>\nSigned-off-by: Steve French <sfrench@us.ibm.com>",
  "author_name": "Steve French",
  "author_email": "sfrench@us.ibm.com",
  "author_date": "Fri Aug 20 20:42:26 2010 +0000",
  "author_date_iso": "2010-08-20T20:42:26+00:00",
  "committer_name": "Steve French",
  "committer_email": "sfrench@us.ibm.com",
  "committer_date": "Fri Aug 20 20:42:26 2010 +0000",
  "committer_date_iso": "2010-08-20T20:42:26+00:00",
  "files_changed": [
    "fs/cifs/Kconfig",
    "fs/cifs/asn1.c",
    "fs/cifs/cifsencrypt.c",
    "fs/cifs/cifsglob.h",
    "fs/cifs/cifspdu.h",
    "fs/cifs/cifsproto.h",
    "fs/cifs/cifssmb.c",
    "fs/cifs/connect.c",
    "fs/cifs/ntlmssp.h",
    "fs/cifs/sess.c",
    "fs/cifs/transport.c"
  ],
  "files_changed_count": 11,
  "stats": [
    {
      "file": "fs/cifs/Kconfig",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "fs/cifs/asn1.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "fs/cifs/cifsencrypt.c",
      "insertions": 294,
      "deletions": 122
    },
    {
      "file": "fs/cifs/cifsglob.h",
      "insertions": 16,
      "deletions": 2
    },
    {
      "file": "fs/cifs/cifspdu.h",
      "insertions": 6,
      "deletions": 1
    },
    {
      "file": "fs/cifs/cifsproto.h",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "fs/cifs/cifssmb.c",
      "insertions": 8,
      "deletions": 5
    },
    {
      "file": "fs/cifs/connect.c",
      "insertions": 12,
      "deletions": 1
    },
    {
      "file": "fs/cifs/ntlmssp.h",
      "insertions": 13,
      "deletions": 0
    },
    {
      "file": "fs/cifs/sess.c",
      "insertions": 89,
      "deletions": 29
    },
    {
      "file": "fs/cifs/transport.c",
      "insertions": 3,
      "deletions": 3
    }
  ],
  "total_insertions": 452,
  "total_deletions": 172,
  "total_changes": 624,
  "parents": [
    "bf4f12113812ac5be76c5590c6f50c8346f784a4"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.36",
    "v2.6.36-rc3",
    "v2.6.36-rc4",
    "v2.6.36-rc5",
    "v2.6.36-rc6",
    "v2.6.36-rc7",
    "v2.6.36-rc8",
    "v2.6.37",
    "v2.6.37-rc1",
    "v2.6.37-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "auth"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/cifs/cifsencrypt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/asn1.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/cifsglob.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/cifspdu.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/cifssmb.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/cifsproto.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/ntlmssp.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/sess.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/connect.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/cifs/transport.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}