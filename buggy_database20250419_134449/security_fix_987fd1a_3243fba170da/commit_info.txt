Commit Hash: 987fd1a4bad6cd0c5daf422bc65621c70c88087d
Subject: crypto: qat - optimize allocations for fw authentication


Security Keywords:
- authentication

Full commit message:
crypto: qat - optimize allocations for fw authentication

The memory requested to hold the image data for authentication will
never exceed `ICP_QAT_CSS_RSA4K_MAX_IMAGE_LEN`. Therefore, we can
simplify the allocation by always requesting the maximum size needed for
any image.

Also introduce the following checks:
 * Ensure the allocated memory is 8-byte aligned to meet the
   requirements of the authentication firmware.
 * Prevent overflow when constructing the authentication descriptor.

Signed-off-by: Jack Xu <jack.xu@intel.com>
Reviewed-by: Ahsan Atta <ahsan.atta@intel.com>
Reviewed-by: Giovanni Cabiddu <giovanni.cabiddu@intel.com>
Reviewed-by: Andy Shevchenko <andriy.shevchenko@linux.intel.com>
Signed-off-by: Giovanni Cabiddu <giovanni.cabiddu@intel.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

Metadata:
Author: Jack Xu <jack.xu@intel.com>
Author Date: Fri Mar 14 12:57:54 2025 +0000
Committer: Herbert Xu <herbert@gondor.apana.org.au>
Commit Date: Fri Mar 21 17:33:39 2025 +0800

Files Changed: 2
Lines Added: 19
Lines Removed: 14
Total Changes: 33
