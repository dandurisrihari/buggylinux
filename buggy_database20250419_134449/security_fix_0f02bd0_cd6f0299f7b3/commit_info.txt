Commit Hash: 0f02bd0ade9a552492463c0159abbe26c4d92b40
Subject: KVM: nVMX: check for required but missing VMCS12 in KVM_SET_NESTED_STATE


Security Keywords:
- security issue

Full commit message:
KVM: nVMX: check for required but missing VMCS12 in KVM_SET_NESTED_STATE

A missing VMCS12 was not causing -EINVAL (it was just read with
copy_from_user, so it is not a security issue, but it is still
wrong).  Test for VMCS12 validity and reject the nested state
if a VMCS12 is required but not present.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Paolo Bonzini <pbonzini@redhat.com>
Author Date: Mon Jul 27 09:00:37 2020 -0400
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Mon Jul 27 09:04:49 2020 -0400

Files Changed: 3
Lines Added: 26
Lines Removed: 4
Total Changes: 30
