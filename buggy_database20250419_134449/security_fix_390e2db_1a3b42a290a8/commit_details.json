{
  "hash": "390e2db8248075ae2f31a7046a88eda0f9784310",
  "hash_short": "390e2db8",
  "subject": "PCI/AER: Abstract AER interrupt handling",
  "body": "The aer_inject module was directly calling aer_irq().  This required the\nAER driver export its private IRQ handler for no other reason than to\nsupport error injection.  A driver should not have to expose its private\ninterfaces, so use the IRQ subsystem to route injection to the AER driver,\nand make aer_irq() a private interface.\n\nThis provides additional benefits:\n\nFirst, directly calling the IRQ handler bypassed the IRQ subsytem so the\ninjection wasn't really synthesizing what happens if a shared AER interrupt\noccurs.\n\nThe error injection had to provide the callback data directly, which may be\nracing with a removal that is freeing that structure.  The IRQ subsystem\ncan handle that race.\n\nFinally, using the IRQ subsystem automatically reacts to threaded IRQs,\nkeeping the error injection abstracted from that implementation detail.\n\nSigned-off-by: Keith Busch <keith.busch@intel.com>\nSigned-off-by: Bjorn Helgaas <bhelgaas@google.com>",
  "full_message": "PCI/AER: Abstract AER interrupt handling\n\nThe aer_inject module was directly calling aer_irq().  This required the\nAER driver export its private IRQ handler for no other reason than to\nsupport error injection.  A driver should not have to expose its private\ninterfaces, so use the IRQ subsystem to route injection to the AER driver,\nand make aer_irq() a private interface.\n\nThis provides additional benefits:\n\nFirst, directly calling the IRQ handler bypassed the IRQ subsytem so the\ninjection wasn't really synthesizing what happens if a shared AER interrupt\noccurs.\n\nThe error injection had to provide the callback data directly, which may be\nracing with a removal that is freeing that structure.  The IRQ subsystem\ncan handle that race.\n\nFinally, using the IRQ subsystem automatically reacts to threaded IRQs,\nkeeping the error injection abstracted from that implementation detail.\n\nSigned-off-by: Keith Busch <keith.busch@intel.com>\nSigned-off-by: Bjorn Helgaas <bhelgaas@google.com>",
  "author_name": "Keith Busch",
  "author_email": "keith.busch@intel.com",
  "author_date": "Thu Oct 11 12:34:11 2018 -0600",
  "author_date_iso": "2018-10-11T12:34:11-06:00",
  "committer_name": "Bjorn Helgaas",
  "committer_email": "bhelgaas@google.com",
  "committer_date": "Thu Oct 18 19:43:09 2018 -0500",
  "committer_date_iso": "2018-10-18T19:43:09-05:00",
  "files_changed": [
    "drivers/pci/pcie/aer.c",
    "drivers/pci/pcie/aer_inject.c",
    "drivers/pci/pcie/portdrv.h"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "drivers/pci/pcie/aer.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/pci/pcie/aer_inject.c",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/pci/pcie/portdrv.h",
      "insertions": 0,
      "deletions": 4
    }
  ],
  "total_insertions": 5,
  "total_deletions": 7,
  "total_changes": 12,
  "parents": [
    "0e98db259fd8760fde556e640b447dadeceefc96"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.20",
    "v4.20-rc1",
    "v4.20-rc2",
    "v4.20-rc3",
    "v4.20-rc4",
    "v4.20-rc5",
    "v4.20-rc6",
    "v4.20-rc7",
    "v5.0",
    "v5.0-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/pci/pcie/aer.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/pcie/aer_inject.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/pcie/portdrv.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}