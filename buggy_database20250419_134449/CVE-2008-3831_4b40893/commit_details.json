{
  "hash": "4b40893918203ee1a1f6a114316c2a19c072e9bd",
  "hash_short": "4b408939",
  "subject": "drm/i915: fix ioremap of a user address for non-root (CVE-2008-3831)",
  "body": "Olaf Kirch noticed that the i915_set_status_page() function of the i915\nkernel driver calls ioremap with an address offset that is supplied by\nuserspace via ioctl. The function zeroes the mapped memory via memset\nand tells the hardware about the address. Turns out that access to that\nioctl is not restricted to root so users could probably exploit that to\ndo nasty things. We haven't tried to write actual exploit code though.\n\nIt only affects the Intel G33 series and newer.\n\nSigned-off-by: Dave Airlie <airlied@redhat.com>",
  "full_message": "drm/i915: fix ioremap of a user address for non-root (CVE-2008-3831)\n\nOlaf Kirch noticed that the i915_set_status_page() function of the i915\nkernel driver calls ioremap with an address offset that is supplied by\nuserspace via ioctl. The function zeroes the mapped memory via memset\nand tells the hardware about the address. Turns out that access to that\nioctl is not restricted to root so users could probably exploit that to\ndo nasty things. We haven't tried to write actual exploit code though.\n\nIt only affects the Intel G33 series and newer.\n\nSigned-off-by: Dave Airlie <airlied@redhat.com>",
  "author_name": "Matthias Hopf",
  "author_email": "mhopf@suse.de",
  "author_date": "Sat Oct 18 07:18:05 2008 +1000",
  "author_date_iso": "2008-10-18T07:18:05+10:00",
  "committer_name": "Dave Airlie",
  "committer_email": "airlied@linux.ie",
  "committer_date": "Sat Oct 18 07:18:05 2008 +1000",
  "committer_date_iso": "2008-10-18T07:18:05+10:00",
  "files_changed": [
    "drivers/gpu/drm/i915/i915_dma.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/i915_dma.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "9e0b97e37fddaf5419d8af24362015ab684eff7e"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.28",
    "v2.6.28-rc1",
    "v2.6.28-rc2",
    "v2.6.28-rc3",
    "v2.6.28-rc4",
    "v2.6.28-rc5",
    "v2.6.28-rc6",
    "v2.6.28-rc7",
    "v2.6.28-rc8",
    "v2.6.28-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2008-3831",
      "CVE-2008-3831"
    ],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/gpu/drm/i915/i915_dma.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}