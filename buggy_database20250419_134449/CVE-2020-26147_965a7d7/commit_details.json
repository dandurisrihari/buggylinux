{
  "hash": "965a7d72e798eb7af0aa67210e37cf7ecd1c9cad",
  "hash_short": "965a7d72",
  "subject": "mac80211: assure all fragments are encrypted",
  "body": "Do not mix plaintext and encrypted fragments in protected Wi-Fi\nnetworks. This fixes CVE-2020-26147.\n\nPreviously, an attacker was able to first forward a legitimate encrypted\nfragment towards a victim, followed by a plaintext fragment. The\nencrypted and plaintext fragment would then be reassembled. For further\ndetails see Section 6.3 and Appendix D in the paper \"Fragment and Forge:\nBreaking Wi-Fi Through Frame Aggregation and Fragmentation\".\n\nBecause of this change there are now two equivalent conditions in the\ncode to determine if a received fragment requires sequential PNs, so we\nalso move this test to a separate function to make the code easier to\nmaintain.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>\nLink: https://lore.kernel.org/r/20210511200110.30c4394bb835.I5acfdb552cc1d20c339c262315950b3eac491397@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: assure all fragments are encrypted\n\nDo not mix plaintext and encrypted fragments in protected Wi-Fi\nnetworks. This fixes CVE-2020-26147.\n\nPreviously, an attacker was able to first forward a legitimate encrypted\nfragment towards a victim, followed by a plaintext fragment. The\nencrypted and plaintext fragment would then be reassembled. For further\ndetails see Section 6.3 and Appendix D in the paper \"Fragment and Forge:\nBreaking Wi-Fi Through Frame Aggregation and Fragmentation\".\n\nBecause of this change there are now two equivalent conditions in the\ncode to determine if a received fragment requires sequential PNs, so we\nalso move this test to a separate function to make the code easier to\nmaintain.\n\nCc: stable@vger.kernel.org\nSigned-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>\nLink: https://lore.kernel.org/r/20210511200110.30c4394bb835.I5acfdb552cc1d20c339c262315950b3eac491397@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Mathy Vanhoef",
  "author_email": "Mathy.Vanhoef@kuleuven.be",
  "author_date": "Tue May 11 20:02:42 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:42+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:12:36 2021 +0200",
  "committer_date_iso": "2021-05-11T20:12:36+02:00",
  "files_changed": [
    "net/mac80211/rx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/rx.c",
      "insertions": 12,
      "deletions": 11
    }
  ],
  "total_insertions": 12,
  "total_deletions": 11,
  "total_changes": 23,
  "parents": [
    "297c4de6f780b63b6d2af75a730720483bf1904a"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-26147"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/rx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}