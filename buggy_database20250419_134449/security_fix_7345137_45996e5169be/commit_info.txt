Commit Hash: 7345137930907ba747781636c60112f7c2789aa8
Subject: [PATCH] wireless/atmel: fix Open System authentication process bugs


Security Keywords:
- authentication

Full commit message:
[PATCH] wireless/atmel: fix Open System authentication process bugs

This patch fixes a number of bugs in the authentication process:

1) When falling back to Shared Key authentication mode from Open System,
a missing 'return' would cause the auth request to be sent, but would
drop the card into Management Error state.  When falling back, the
driver should also indicate that it is switching to Shared Key mode by
setting exclude_unencrypted.

2) Initial authentication modes were apparently wrong in some cases,
causing the driver to attempt Shared Key authentication mode when in
fact the access point didn't support that mode or even had WEP disabled.
The driver should set the correct initial authentication mode based on
wep_is_on and exclude_unencrypted.

3) Authentication response packets from the access point in Open System
mode were getting ignored because the driver was expecting the sequence
number of a Shared Key mode response.  The patch separates the OS and SK
mode handling to provide the correct behavior.

Signed-off-by: Dan Williams <dcbw@redhat.com>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Dan Williams <dcbw@redhat.com>
Author Date: Sun Feb 5 17:55:16 2006 -0500
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Fri Feb 17 08:12:57 2006 -0500

Files Changed: 1
Lines Added: 27
Lines Removed: 10
Total Changes: 37
