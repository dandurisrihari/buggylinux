Commit Hash: 059f90b323c0f5d34656ab7e0548d7d033c2a51a
Subject: NFS: Fix auth flavor len accounting


Security Keywords:
- auth

Full commit message:
NFS: Fix auth flavor len accounting

Previous logic in the NFS mount parsing code path assumed
auth_flavor_len was set to zero for simple authentication flavors
(like AUTH_UNIX), and 1 for compound flavors (like AUTH_GSS).

At some earlier point (maybe even before the option parsers were
merged?) specific checks for auth_flavor_len being zero were removed
from the functions that validate the mount option that sets the mount
point's authentication flavor.

Since we are populating an array for authentication flavors, the
auth_flavor_len should always be set to the number of flavors.  Let's
eliminate some cleverness here, and prepare for new logic that needs
to know the number of flavors in the auth_flavors[] array.

(auth_flavors[] is an array because at some point we want to allow a
list of acceptable authentication flavors to be specified via the sec=
mount option.  For now it remains a single element array).

Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>

Metadata:
Author: Chuck Lever <chuck.lever@oracle.com>
Author Date: Sun Aug 9 15:09:31 2009 -0400
Committer: Trond Myklebust <Trond.Myklebust@netapp.com>
Commit Date: Sun Aug 9 15:09:31 2009 -0400

Files Changed: 1
Lines Added: 3
Lines Removed: 14
Total Changes: 17
