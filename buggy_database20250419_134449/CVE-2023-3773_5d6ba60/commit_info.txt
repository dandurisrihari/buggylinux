Commit Hash: 5d6ba607d6cb5c58a4ddf33381e18c83dbb4098f
Subject: vdpa: Add max vqp attr to vdpa_nl_policy for nlattr length check

CVE Identifiers:
- CVE-2023-3773

Full commit message:
vdpa: Add max vqp attr to vdpa_nl_policy for nlattr length check

The vdpa_nl_policy structure is used to validate the nlattr when parsing
the incoming nlmsg. It will ensure the attribute being described produces
a valid nlattr pointer in info->attrs before entering into each handler
in vdpa_nl_ops.

That is to say, the missing part in vdpa_nl_policy may lead to illegal
nlattr after parsing, which could lead to OOB read just like CVE-2023-3773.

This patch adds the missing nla_policy for vdpa max vqp attr to avoid
such bugs.

Fixes: ad69dd0bf26b ("vdpa: Introduce query of device config layout")
Signed-off-by: Lin Ma <linma@zju.edu.cn>
Cc: stable@vger.kernel.org
Message-Id: <20230727175757.73988-7-dtatulea@nvidia.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>

Metadata:
Author: Lin Ma <linma@zju.edu.cn>
Author Date: Thu Jul 27 20:57:52 2023 +0300
Committer: Michael S. Tsirkin <mst@redhat.com>
Commit Date: Thu Aug 10 15:24:28 2023 -0400

Files Changed: 1
Lines Added: 1
Lines Removed: 0
Total Changes: 1
