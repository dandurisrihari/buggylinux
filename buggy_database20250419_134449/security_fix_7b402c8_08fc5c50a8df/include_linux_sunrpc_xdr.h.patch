commit 7b402c8db66414abb4001d0c2676553baa619a2b
Author: Chuck Lever <chuck.lever@oracle.com>
Date:   Sun Jan 8 11:29:38 2023 -0500

    SUNRPC: Add XDR encoding helper for opaque_auth
    
    RFC 5531 defines an MSG_ACCEPTED Reply message like this:
    
            struct accepted_reply {
                    opaque_auth verf;
                    union switch (accept_stat stat) {
                    case SUCCESS:
                       ...
    
    In the current server code, struct opaque_auth encoding is open-
    coded. Introduce a helper that encodes an opaque_auth data item
    within the context of a xdr_stream.
    
    Done as part of hardening the server-side RPC header decoding and
    encoding paths.
    
    Reviewed-by: Jeff Layton <jlayton@kernel.org>
    Signed-off-by: Chuck Lever <chuck.lever@oracle.com>

diff --git a/include/linux/sunrpc/xdr.h b/include/linux/sunrpc/xdr.h
index 884df67009f4..f3b6eb9accd7 100644
--- a/include/linux/sunrpc/xdr.h
+++ b/include/linux/sunrpc/xdr.h
@@ -348,6 +348,8 @@ ssize_t xdr_stream_decode_string_dup(struct xdr_stream *xdr, char **str,
 		size_t maxlen, gfp_t gfp_flags);
 ssize_t xdr_stream_decode_opaque_auth(struct xdr_stream *xdr, u32 *flavor,
 		void **body, unsigned int *body_len);
+ssize_t xdr_stream_encode_opaque_auth(struct xdr_stream *xdr, u32 flavor,
+		void *body, unsigned int body_len);
 
 /**
  * xdr_align_size - Calculate padded size of an object