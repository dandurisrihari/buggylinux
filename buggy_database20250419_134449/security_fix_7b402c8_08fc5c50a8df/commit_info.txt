Commit Hash: 7b402c8db66414abb4001d0c2676553baa619a2b
Subject: SUNRPC: Add XDR encoding helper for opaque_auth


Security Keywords:
- hardening

Full commit message:
SUNRPC: Add XDR encoding helper for opaque_auth

RFC 5531 defines an MSG_ACCEPTED Reply message like this:

	struct accepted_reply {
		opaque_auth verf;
		union switch (accept_stat stat) {
		case SUCCESS:
		   ...

In the current server code, struct opaque_auth encoding is open-
coded. Introduce a helper that encodes an opaque_auth data item
within the context of a xdr_stream.

Done as part of hardening the server-side RPC header decoding and
encoding paths.

Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>

Metadata:
Author: Chuck Lever <chuck.lever@oracle.com>
Author Date: Sun Jan 8 11:29:38 2023 -0500
Committer: Chuck Lever <chuck.lever@oracle.com>
Commit Date: Mon Feb 20 09:20:27 2023 -0500

Files Changed: 2
Lines Added: 31
Lines Removed: 0
Total Changes: 31
