{
  "hash": "39d170b3cb62ba98567f5c4f40c27b5864b304e5",
  "hash_short": "39d170b3",
  "subject": "ath6kl: fix a NULL-ptr-deref bug in ath6kl_usb_alloc_urb_from_pipe()",
  "body": "The `ar_usb` field of `ath6kl_usb_pipe_usb_pipe` objects\nare initialized to point to the containing `ath6kl_usb` object\naccording to endpoint descriptors read from the device side, as shown\nbelow in `ath6kl_usb_setup_pipe_resources`:\n\nfor (i = 0; i < iface_desc->desc.bNumEndpoints; ++i) {\n\tendpoint = &iface_desc->endpoint[i].desc;\n\n\t// get the address from endpoint descriptor\n\tpipe_num = ath6kl_usb_get_logical_pipe_num(ar_usb,\n\t\t\t\t\t\tendpoint->bEndpointAddress,\n\t\t\t\t\t\t&urbcount);\n\t......\n\t// select the pipe object\n\tpipe = &ar_usb->pipes[pipe_num];\n\n\t// initialize the ar_usb field\n\tpipe->ar_usb = ar_usb;\n}\n\nThe driver assumes that the addresses reported in endpoint\ndescriptors from device side  to be complete. If a device is\nmalicious and does not report complete addresses, it may trigger\nNULL-ptr-deref `ath6kl_usb_alloc_urb_from_pipe` and\n`ath6kl_usb_free_urb_to_pipe`.\n\nThis patch fixes the bug by preventing potential NULL-ptr-deref\n(CVE-2019-15098).\n\nSigned-off-by: Hui Peng <benquike@gmail.com>\nReported-by: Hui Peng <benquike@gmail.com>\nReported-by: Mathias Payer <mathias.payer@nebelwelt.net>\nReviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nSigned-off-by: Kalle Valo <kvalo@codeaurora.org>",
  "full_message": "ath6kl: fix a NULL-ptr-deref bug in ath6kl_usb_alloc_urb_from_pipe()\n\nThe `ar_usb` field of `ath6kl_usb_pipe_usb_pipe` objects\nare initialized to point to the containing `ath6kl_usb` object\naccording to endpoint descriptors read from the device side, as shown\nbelow in `ath6kl_usb_setup_pipe_resources`:\n\nfor (i = 0; i < iface_desc->desc.bNumEndpoints; ++i) {\n\tendpoint = &iface_desc->endpoint[i].desc;\n\n\t// get the address from endpoint descriptor\n\tpipe_num = ath6kl_usb_get_logical_pipe_num(ar_usb,\n\t\t\t\t\t\tendpoint->bEndpointAddress,\n\t\t\t\t\t\t&urbcount);\n\t......\n\t// select the pipe object\n\tpipe = &ar_usb->pipes[pipe_num];\n\n\t// initialize the ar_usb field\n\tpipe->ar_usb = ar_usb;\n}\n\nThe driver assumes that the addresses reported in endpoint\ndescriptors from device side  to be complete. If a device is\nmalicious and does not report complete addresses, it may trigger\nNULL-ptr-deref `ath6kl_usb_alloc_urb_from_pipe` and\n`ath6kl_usb_free_urb_to_pipe`.\n\nThis patch fixes the bug by preventing potential NULL-ptr-deref\n(CVE-2019-15098).\n\nSigned-off-by: Hui Peng <benquike@gmail.com>\nReported-by: Hui Peng <benquike@gmail.com>\nReported-by: Mathias Payer <mathias.payer@nebelwelt.net>\nReviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nSigned-off-by: Kalle Valo <kvalo@codeaurora.org>",
  "author_name": "Hui Peng",
  "author_email": "benquike@gmail.com",
  "author_date": "Sat Aug 3 20:29:04 2019 -0400",
  "author_date_iso": "2019-08-03T20:29:04-04:00",
  "committer_name": "Kalle Valo",
  "committer_email": "kvalo@codeaurora.org",
  "committer_date": "Wed Sep 4 09:23:26 2019 +0300",
  "committer_date_iso": "2019-09-04T09:23:26+03:00",
  "files_changed": [
    "drivers/net/wireless/ath/ath6kl/usb.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/wireless/ath/ath6kl/usb.c",
      "insertions": 8,
      "deletions": 0
    }
  ],
  "total_insertions": 8,
  "total_deletions": 0,
  "total_changes": 8,
  "parents": [
    "355cf31912014e6ff1bb1019ae4858cad12c68cf"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.4",
    "v5.4-rc1",
    "v5.4-rc2",
    "v5.4-rc3",
    "v5.4-rc4",
    "v5.4-rc5",
    "v5.4-rc6",
    "v5.4-rc7",
    "v5.4-rc8",
    "v5.5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2019-15098"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/wireless/ath/ath6kl/usb.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}