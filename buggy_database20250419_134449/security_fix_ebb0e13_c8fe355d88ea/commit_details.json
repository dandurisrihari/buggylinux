{
  "hash": "ebb0e13ead2ddc186a80b1b0235deeefc5a1a667",
  "hash_short": "ebb0e13e",
  "subject": "powerpc/ptrace: Mitigate potential Spectre v1",
  "body": "'regno' is directly controlled by user space, hence leading to a potential\nexploitation of the Spectre variant 1 vulnerability.\n\nOn PTRACE_SETREGS and PTRACE_GETREGS requests, user space passes the\nregister number that would be read or written. This register number is\ncalled 'regno' which is part of the 'addr' syscall parameter.\n\nThis 'regno' value is checked against the maximum pt_regs structure size,\nand then used to dereference it, which matches the initial part of a\nSpectre v1 (and Spectre v1.1) attack. The dereferenced value, then,\nis returned to userspace in the GETREGS case.\n\nThis patch sanitizes 'regno' before using it to dereference pt_reg.\n\nNotice that given that speculation windows are large, the policy is\nto kill the speculation on the first load and not worry if it can be\ncompleted with a dependent load/store [1].\n\n[1] https://marc.info/?l=linux-kernel&m=152449131114778&w=2\n\nSigned-off-by: Breno Leitao <leitao@debian.org>\nAcked-by: Gustavo A. R. Silva <gustavo@embeddedor.com>\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>",
  "full_message": "powerpc/ptrace: Mitigate potential Spectre v1\n\n'regno' is directly controlled by user space, hence leading to a potential\nexploitation of the Spectre variant 1 vulnerability.\n\nOn PTRACE_SETREGS and PTRACE_GETREGS requests, user space passes the\nregister number that would be read or written. This register number is\ncalled 'regno' which is part of the 'addr' syscall parameter.\n\nThis 'regno' value is checked against the maximum pt_regs structure size,\nand then used to dereference it, which matches the initial part of a\nSpectre v1 (and Spectre v1.1) attack. The dereferenced value, then,\nis returned to userspace in the GETREGS case.\n\nThis patch sanitizes 'regno' before using it to dereference pt_reg.\n\nNotice that given that speculation windows are large, the policy is\nto kill the speculation on the first load and not worry if it can be\ncompleted with a dependent load/store [1].\n\n[1] https://marc.info/?l=linux-kernel&m=152449131114778&w=2\n\nSigned-off-by: Breno Leitao <leitao@debian.org>\nAcked-by: Gustavo A. R. Silva <gustavo@embeddedor.com>\nSigned-off-by: Michael Ellerman <mpe@ellerman.id.au>",
  "author_name": "Breno Leitao",
  "author_email": "leitao@debian.org",
  "author_date": "Wed Jan 30 10:46:00 2019 -0200",
  "author_date_iso": "2019-01-30T10:46:00-02:00",
  "committer_name": "Michael Ellerman",
  "committer_email": "mpe@ellerman.id.au",
  "committer_date": "Thu Feb 7 00:29:20 2019 +1100",
  "committer_date_iso": "2019-02-07T00:29:20+11:00",
  "files_changed": [
    "arch/powerpc/kernel/ptrace.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/powerpc/kernel/ptrace.c",
      "insertions": 7,
      "deletions": 1
    }
  ],
  "total_insertions": 7,
  "total_deletions": 1,
  "total_changes": 8,
  "parents": [
    "98ecc6768e8fdba95da1fc1efa0ef2d769e7fe1c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.1",
    "v5.1-rc1",
    "v5.1-rc2",
    "v5.1-rc3",
    "v5.1-rc4",
    "v5.1-rc5",
    "v5.1-rc6",
    "v5.1-rc7",
    "v5.2",
    "v5.2-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/powerpc/kernel/ptrace.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}