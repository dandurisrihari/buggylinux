{
  "hash": "801a0caa627b3b2aa5933b66f0e4a83c4f85143e",
  "hash_short": "801a0caa",
  "subject": "drm/i915/huc: make \"support huc\" reflect HW capabilities",
  "body": "We currently initialize HuC support based on GuC being enabled in\nmodparam; this means that huc_is_supported() can return false on HW that\ndoes have a HuC when enable_guc=0. The rationale for this behavior is\nthat HuC requires GuC for authentication and therefore is not supported\nby itself. However, we do not allow defining HuC fw wthout GuC fw and\nselecting HuC in modparam implicitly selects GuC as well, so we can't\nactually hit a scenario where HuC is selected alone. Therefore, we can\nflip the support check to reflect the HW capabilities and fw\navailability, which is more intuitive and will make it cleaner to log\nHuC the difference between not supported in HW and not selected.\n\nRemoving the difference between GuC and HuC also allows us to simplify\nthe init_early, since we don't need to differentiate the support based\non the type of uC.\n\nSigned-off-by: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>\nCc: Michal Wajdeczko <michal.wajdeczko@intel.com>\nCc: John Harrison <John.C.Harrison@Intel.com>\nCc: Matthew Brost <matthew.brost@intel.com>\nReviewed-by: Andi Shyti <andi.shyti@intel.com>\nReviewed-by: John Harrison <John.C.Harrison@Intel.com>\nSigned-off-by: Chris Wilson <chris@chris-wilson.co.uk>\nLink: https://patchwork.freedesktop.org/patch/msgid/20200326181121.16869-4-daniele.ceraolospurio@intel.com",
  "full_message": "drm/i915/huc: make \"support huc\" reflect HW capabilities\n\nWe currently initialize HuC support based on GuC being enabled in\nmodparam; this means that huc_is_supported() can return false on HW that\ndoes have a HuC when enable_guc=0. The rationale for this behavior is\nthat HuC requires GuC for authentication and therefore is not supported\nby itself. However, we do not allow defining HuC fw wthout GuC fw and\nselecting HuC in modparam implicitly selects GuC as well, so we can't\nactually hit a scenario where HuC is selected alone. Therefore, we can\nflip the support check to reflect the HW capabilities and fw\navailability, which is more intuitive and will make it cleaner to log\nHuC the difference between not supported in HW and not selected.\n\nRemoving the difference between GuC and HuC also allows us to simplify\nthe init_early, since we don't need to differentiate the support based\non the type of uC.\n\nSigned-off-by: Daniele Ceraolo Spurio <daniele.ceraolospurio@intel.com>\nCc: Michal Wajdeczko <michal.wajdeczko@intel.com>\nCc: John Harrison <John.C.Harrison@Intel.com>\nCc: Matthew Brost <matthew.brost@intel.com>\nReviewed-by: Andi Shyti <andi.shyti@intel.com>\nReviewed-by: John Harrison <John.C.Harrison@Intel.com>\nSigned-off-by: Chris Wilson <chris@chris-wilson.co.uk>\nLink: https://patchwork.freedesktop.org/patch/msgid/20200326181121.16869-4-daniele.ceraolospurio@intel.com",
  "author_name": "Daniele Ceraolo Spurio",
  "author_email": "daniele.ceraolospurio@intel.com",
  "author_date": "Thu Mar 26 11:11:18 2020 -0700",
  "author_date_iso": "2020-03-26T11:11:18-07:00",
  "committer_name": "Chris Wilson",
  "committer_email": "chris@chris-wilson.co.uk",
  "committer_date": "Thu Mar 26 21:22:01 2020 +0000",
  "committer_date_iso": "2020-03-26T21:22:01+00:00",
  "files_changed": [
    "drivers/gpu/drm/i915/gt/uc/intel_guc.c",
    "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.c",
    "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.h",
    "drivers/gpu/drm/i915/gt/uc/intel_huc.c",
    "drivers/gpu/drm/i915/gt/uc/intel_huc_fw.c",
    "drivers/gpu/drm/i915/gt/uc/intel_huc_fw.h",
    "drivers/gpu/drm/i915/gt/uc/intel_uc_fw.c",
    "drivers/gpu/drm/i915/gt/uc/intel_uc_fw.h"
  ],
  "files_changed_count": 8,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.c",
      "insertions": 0,
      "deletions": 14
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc_fw.c",
      "insertions": 0,
      "deletions": 17
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc_fw.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_uc_fw.c",
      "insertions": 17,
      "deletions": 8
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_uc_fw.h",
      "insertions": 1,
      "deletions": 2
    }
  ],
  "total_insertions": 20,
  "total_deletions": 45,
  "total_changes": 65,
  "parents": [
    "708249a6eba1e1b9c1abfdb400a19f1eb8aaf4d7"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc_fw.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc_fw.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_guc_fw.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_huc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_uc_fw.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gt/uc/intel_uc_fw.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}