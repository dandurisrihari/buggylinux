Commit Hash: 99d24edeb6abc6ca3a0d0fbdb83c664c04403c8c
Subject: [NETFILTER]: {ip, nf}_conntrack_sctp: fix remotely triggerable NULL ptr dereference (CVE-2007-2876)

CVE Identifiers:
- CVE-2007-2876
- CVE-2007-2876

Full commit message:
[NETFILTER]: {ip, nf}_conntrack_sctp: fix remotely triggerable NULL ptr dereference (CVE-2007-2876)

When creating a new connection by sending an unknown chunk type, we
don't transition to a valid state, causing a NULL pointer dereference
in sctp_packet when accessing sctp_timeouts[SCTP_CONNTRACK_NONE].

Fix by don't creating new conntrack entry if initial state is invalid.

Noticed by Vilmos Nebehaj <vilmos.nebehaj@ramsys.hu>

Signed-off-by: Patrick McHardy <kaber@trash.net>
Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>
Signed-off-by: Chris Wright <chrisw@sous-sol.org>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Patrick McHardy <kaber@trash.net>
Author Date: Tue Jul 10 23:24:52 2007 -0700
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Tue Jul 10 23:24:52 2007 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
