Commit Hash: 908f24270d9ccbe120b91e7029b372f3dcd18290
Subject: crypto: qat - add check to validate firmware images


Security Keywords:
- authentication

Full commit message:
crypto: qat - add check to validate firmware images

The function qat_uclo_check_image() validates the MMP and AE firmware
images. If the QAT device supports firmware authentication (indicated
by the handle to firmware loader), the input signed binary MMP and AE
images are validated by parsing the following information:
- Header length
- Full size of the binary
- Type of binary image (MMP or AE Firmware)

Firmware binaries use RSA3K for signing and verification.
The header length for the RSA3k is 0x384 bytes.

All the size field values in the binary are quantified
as DWORDS (1 DWORD = 4bytes).

On an invalid value the function prints an error message and returns
with an error code "EINVAL".

Signed-off-by: Srinivas Kerekare <srinivas.kerekare@intel.com>
Reviewed-by: Giovanni Cabiddu <giovanni.cabiddu@intel.com>
Reviewed-by: Wojciech Ziemba <wojciech.ziemba@intel.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

Metadata:
Author: Srinivas Kerekare <srinivas.kerekare@intel.com>
Author Date: Mon Jul 25 11:40:09 2022 +0100
Committer: Herbert Xu <herbert@gondor.apana.org.au>
Commit Date: Fri Aug 19 18:39:33 2022 +0800

Files Changed: 2
Lines Added: 57
Lines Removed: 2
Total Changes: 59
