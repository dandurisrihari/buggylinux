commit 908f24270d9ccbe120b91e7029b372f3dcd18290
Author: Srinivas Kerekare <srinivas.kerekare@intel.com>
Date:   Mon Jul 25 11:40:09 2022 +0100

    crypto: qat - add check to validate firmware images
    
    The function qat_uclo_check_image() validates the MMP and AE firmware
    images. If the QAT device supports firmware authentication (indicated
    by the handle to firmware loader), the input signed binary MMP and AE
    images are validated by parsing the following information:
    - Header length
    - Full size of the binary
    - Type of binary image (MMP or AE Firmware)
    
    Firmware binaries use RSA3K for signing and verification.
    The header length for the RSA3k is 0x384 bytes.
    
    All the size field values in the binary are quantified
    as DWORDS (1 DWORD = 4bytes).
    
    On an invalid value the function prints an error message and returns
    with an error code "EINVAL".
    
    Signed-off-by: Srinivas Kerekare <srinivas.kerekare@intel.com>
    Reviewed-by: Giovanni Cabiddu <giovanni.cabiddu@intel.com>
    Reviewed-by: Wojciech Ziemba <wojciech.ziemba@intel.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/drivers/crypto/qat/qat_common/icp_qat_uclo.h b/drivers/crypto/qat/qat_common/icp_qat_uclo.h
index 4b36869bf460..69482abdb8b9 100644
--- a/drivers/crypto/qat/qat_common/icp_qat_uclo.h
+++ b/drivers/crypto/qat/qat_common/icp_qat_uclo.h
@@ -86,7 +86,8 @@
 					ICP_QAT_CSS_FWSK_MODULUS_LEN(handle) + \
 					ICP_QAT_CSS_FWSK_EXPONENT_LEN(handle) + \
 					ICP_QAT_CSS_SIGNATURE_LEN(handle))
-#define ICP_QAT_CSS_MAX_IMAGE_LEN   0x40000
+#define ICP_QAT_CSS_RSA4K_MAX_IMAGE_LEN    0x40000
+#define ICP_QAT_CSS_RSA3K_MAX_IMAGE_LEN    0x30000
 
 #define ICP_QAT_CTX_MODE(ae_mode) ((ae_mode) & 0xf)
 #define ICP_QAT_NN_MODE(ae_mode) (((ae_mode) >> 0x4) & 0xf)