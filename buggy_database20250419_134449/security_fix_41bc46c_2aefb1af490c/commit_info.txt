Commit Hash: 41bc46c12a8053a1b3279a379bd6b5e87b045b85
Subject: bpf: Add override check to kprobe multi link attach


Security Keywords:
- injection

Full commit message:
bpf: Add override check to kprobe multi link attach

Currently the multi_kprobe link attach does not check error
injection list for programs with bpf_override_return helper
and allows them to attach anywhere. Adding the missing check.

Fixes: 0dcac2725406 ("bpf: Add multi kprobe link")
Signed-off-by: Jiri Olsa <jolsa@kernel.org>
Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
Reviewed-by: Alan Maguire <alan.maguire@oracle.com>
Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/bpf/20230907200652.926951-1-jolsa@kernel.org

Metadata:
Author: Jiri Olsa <jolsa@kernel.org>
Author Date: Thu Sep 7 22:06:51 2023 +0200
Committer: Andrii Nakryiko <andrii@kernel.org>
Commit Date: Fri Sep 8 16:53:10 2023 -0700

Files Changed: 1
Lines Added: 16
Lines Removed: 0
Total Changes: 16
