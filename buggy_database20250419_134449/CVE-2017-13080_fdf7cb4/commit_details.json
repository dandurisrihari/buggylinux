{
  "hash": "fdf7cb4185b60c68e1a75e61691c4afdc15dea0e",
  "hash_short": "fdf7cb41",
  "subject": "mac80211: accept key reinstall without changing anything",
  "body": "When a key is reinstalled we can reset the replay counters\netc. which can lead to nonce reuse and/or replay detection\nbeing impossible, breaking security properties, as described\nin the \"KRACK attacks\".\n\nIn particular, CVE-2017-13080 applies to GTK rekeying that\nhappened in firmware while the host is in D3, with the second\npart of the attack being done after the host wakes up. In\nthis case, the wpa_supplicant mitigation isn't sufficient\nsince wpa_supplicant doesn't know the GTK material.\n\nIn case this happens, simply silently accept the new key\ncoming from userspace but don't take any action on it since\nit's the same key; this keeps the PN replay counters intact.\n\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: accept key reinstall without changing anything\n\nWhen a key is reinstalled we can reset the replay counters\netc. which can lead to nonce reuse and/or replay detection\nbeing impossible, breaking security properties, as described\nin the \"KRACK attacks\".\n\nIn particular, CVE-2017-13080 applies to GTK rekeying that\nhappened in firmware while the host is in D3, with the second\npart of the attack being done after the host wakes up. In\nthis case, the wpa_supplicant mitigation isn't sufficient\nsince wpa_supplicant doesn't know the GTK material.\n\nIn case this happens, simply silently accept the new key\ncoming from userspace but don't take any action on it since\nit's the same key; this keeps the PN replay counters intact.\n\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Tue Sep 5 14:54:54 2017 +0200",
  "author_date_iso": "2017-09-05T14:54:54+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Mon Oct 16 13:02:03 2017 +0200",
  "committer_date_iso": "2017-10-16T13:02:03+02:00",
  "files_changed": [
    "net/mac80211/key.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/key.c",
      "insertions": 17,
      "deletions": 4
    }
  ],
  "total_insertions": 17,
  "total_deletions": 4,
  "total_changes": 21,
  "parents": [
    "c0576e3975084d4699b7bfef578613fb8e1144f6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.14",
    "v4.14-rc6",
    "v4.14-rc7",
    "v4.14-rc8",
    "v4.15",
    "v4.15-rc1",
    "v4.15-rc2",
    "v4.15-rc3",
    "v4.15-rc4",
    "v4.15-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2017-13080"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/key.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}