Commit Hash: c9c3a0604614344f7c73523176b6d0a85cba6eab
Subject: mac80211: verify deauthentication and return error on failure


Security Keywords:
- authentication

Full commit message:
mac80211: verify deauthentication and return error on failure

When still authenticating the mac80211 code handling a deauthentication
requests from userspace doesn't verify that the request is valid in any
way, fix that. Additionally, it never returns an error, even if there's
no connection or authentication attempt, fix that as well.

While at it, move the message to not print a message in the error case
and to distinguish between the two cases.

Also simplify the code by duplicating the cfg80211 call.

Reviewed-by: Luciano Coelho <luciano.coelho@intel.com>
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Wed Mar 19 09:11:19 2014 +0100
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Wed Mar 19 21:29:53 2014 +0100

Files Changed: 1
Lines Added: 17
Lines Removed: 13
Total Changes: 30
