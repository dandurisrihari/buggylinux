Commit Hash: b8f3e48834fe8c86b4f21739c6effd160e2c2c19
Subject: powerpc/rtas: block error injection when locked down


Security Keywords:
- injection

Full commit message:
powerpc/rtas: block error injection when locked down

The error injection facility on pseries VMs allows corruption of
arbitrary guest memory, potentially enabling a sufficiently privileged
user to disable lockdown or perform other modifications of the running
kernel via the rtas syscall.

Block the PAPR error injection facility from being opened or called
when locked down.

Signed-off-by: Nathan Lynch <nathanl@linux.ibm.com>
Acked-by: Paul Moore <paul@paul-moore.com> (LSM)
Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>
Link: https://lore.kernel.org/r/20220926131643.146502-3-nathanl@linux.ibm.com

Metadata:
Author: Nathan Lynch <nathanl@linux.ibm.com>
Author Date: Mon Sep 26 08:16:43 2022 -0500
Committer: Michael Ellerman <mpe@ellerman.id.au>
Commit Date: Wed Sep 28 19:22:14 2022 +1000

Files Changed: 3
Lines Added: 26
Lines Removed: 1
Total Changes: 27
