Commit Hash: dab6cf55f81a6e16b8147aed9a843e1691dcd318
Subject: s390/ptrace: fix PSW mask check

CVE Identifiers:
- CVE-2014-3534

Full commit message:
s390/ptrace: fix PSW mask check

The PSW mask check of the PTRACE_POKEUSR_AREA command is incorrect.
The PSW_MASK_USER define contains the PSW_MASK_ASC bits, the ptrace
interface accepts all combinations for the address-space-control
bits. To protect the kernel space the PSW mask check in ptrace needs
to reject the address-space-control bit combination for home space.

Fixes CVE-2014-3534

Cc: stable@vger.kernel.org
Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>

Metadata:
Author: Martin Schwidefsky <schwidefsky@de.ibm.com>
Author Date: Mon Jun 23 15:29:40 2014 +0200
Committer: Martin Schwidefsky <schwidefsky@de.ibm.com>
Commit Date: Wed Jul 16 10:48:11 2014 +0200

Files Changed: 1
Lines Added: 10
Lines Removed: 2
Total Changes: 12
