{
  "hash": "d049f74f2dbe71354d43d393ac3a188947811348",
  "hash_short": "d049f74f",
  "subject": "exec/ptrace: fix get_dumpable() incorrect tests",
  "body": "The get_dumpable() return value is not boolean.  Most users of the\nfunction actually want to be testing for non-SUID_DUMP_USER(1) rather than\nSUID_DUMP_DISABLE(0).  The SUID_DUMP_ROOT(2) is also considered a\nprotected state.  Almost all places did this correctly, excepting the two\nplaces fixed in this patch.\n\nWrong logic:\n    if (dumpable == SUID_DUMP_DISABLE) { /* be protective */ }\n        or\n    if (dumpable == 0) { /* be protective */ }\n        or\n    if (!dumpable) { /* be protective */ }\n\nCorrect logic:\n    if (dumpable != SUID_DUMP_USER) { /* be protective */ }\n        or\n    if (dumpable != 1) { /* be protective */ }\n\nWithout this patch, if the system had set the sysctl fs/suid_dumpable=2, a\nuser was able to ptrace attach to processes that had dropped privileges to\nthat user.  (This may have been partially mitigated if Yama was enabled.)\n\nThe macros have been moved into the file that declares get/set_dumpable(),\nwhich means things like the ia64 code can see them too.\n\nCVE-2013-2929\n\nReported-by: Vasily Kulikov <segoon@openwall.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: \"Luck, Tony\" <tony.luck@intel.com>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: \"Eric W. Biederman\" <ebiederm@xmission.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "exec/ptrace: fix get_dumpable() incorrect tests\n\nThe get_dumpable() return value is not boolean.  Most users of the\nfunction actually want to be testing for non-SUID_DUMP_USER(1) rather than\nSUID_DUMP_DISABLE(0).  The SUID_DUMP_ROOT(2) is also considered a\nprotected state.  Almost all places did this correctly, excepting the two\nplaces fixed in this patch.\n\nWrong logic:\n    if (dumpable == SUID_DUMP_DISABLE) { /* be protective */ }\n        or\n    if (dumpable == 0) { /* be protective */ }\n        or\n    if (!dumpable) { /* be protective */ }\n\nCorrect logic:\n    if (dumpable != SUID_DUMP_USER) { /* be protective */ }\n        or\n    if (dumpable != 1) { /* be protective */ }\n\nWithout this patch, if the system had set the sysctl fs/suid_dumpable=2, a\nuser was able to ptrace attach to processes that had dropped privileges to\nthat user.  (This may have been partially mitigated if Yama was enabled.)\n\nThe macros have been moved into the file that declares get/set_dumpable(),\nwhich means things like the ia64 code can see them too.\n\nCVE-2013-2929\n\nReported-by: Vasily Kulikov <segoon@openwall.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nCc: \"Luck, Tony\" <tony.luck@intel.com>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: \"Eric W. Biederman\" <ebiederm@xmission.com>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Kees Cook",
  "author_email": "keescook@chromium.org",
  "author_date": "Tue Nov 12 15:11:17 2013 -0800",
  "author_date_iso": "2013-11-12T15:11:17-08:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Wed Nov 13 12:09:33 2013 +0900",
  "committer_date_iso": "2013-11-13T12:09:33+09:00",
  "files_changed": [
    "arch/ia64/include/asm/processor.h",
    "fs/exec.c",
    "include/linux/binfmts.h",
    "include/linux/sched.h",
    "kernel/ptrace.c"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "arch/ia64/include/asm/processor.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/exec.c",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "include/linux/binfmts.h",
      "insertions": 0,
      "deletions": 3
    },
    {
      "file": "include/linux/sched.h",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "kernel/ptrace.c",
      "insertions": 2,
      "deletions": 1
    }
  ],
  "total_insertions": 13,
  "total_deletions": 5,
  "total_changes": 18,
  "parents": [
    "1c3fc3e5cc8a81d21b199cb739d5d9c51f3688f4"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.13",
    "v3.13-rc1",
    "v3.13-rc2",
    "v3.13-rc3",
    "v3.13-rc4",
    "v3.13-rc5",
    "v3.13-rc6",
    "v3.13-rc7",
    "v3.13-rc8",
    "v3.14"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2013-2929"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "arch/ia64/include/asm/processor.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/exec.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/binfmts.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/sched.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/ptrace.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}