Commit Hash: 78c7d49f55d8631b67c09f9bfbe8155211a9ea06
Subject: ubifs: journal: Make sure to not dirty twice for auth nodes


Security Keywords:
- auth

Full commit message:
ubifs: journal: Make sure to not dirty twice for auth nodes

When removing the last reference of an inode the size of an auth node
is already part of write_len. So we must not call ubifs_add_auth_dirt().
Call it only when needed.

Cc: <stable@vger.kernel.org>
Cc: Sascha Hauer <s.hauer@pengutronix.de>
Cc: Kristof Havasi <havasiefr@gmail.com>
Fixes: 6a98bc4614de ("ubifs: Add authentication nodes to journal")
Reported-and-tested-by: Kristof Havasi <havasiefr@gmail.com>
Reviewed-by: Sascha Hauer <s.hauer@pengutronix.de>
Signed-off-by: Richard Weinberger <richard@nod.at>

Metadata:
Author: Richard Weinberger <richard@nod.at>
Author Date: Mon Sep 28 20:58:59 2020 +0200
Committer: Richard Weinberger <richard@nod.at>
Commit Date: Tue Sep 29 10:43:05 2020 +0200

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
