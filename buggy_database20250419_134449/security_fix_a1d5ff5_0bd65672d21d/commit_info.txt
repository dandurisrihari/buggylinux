Commit Hash: a1d5ff5651ea592c67054233b14b30bf4452999c
Subject: mac80211: properly handle A-MSDUs that start with an RFC 1042 header


Security Keywords:
- injection

Full commit message:
mac80211: properly handle A-MSDUs that start with an RFC 1042 header

Properly parse A-MSDUs whose first 6 bytes happen to equal a rfc1042
header. This can occur in practice when the destination MAC address
equals AA:AA:03:00:00:00. More importantly, this simplifies the next
patch to mitigate A-MSDU injection attacks.

Cc: stable@vger.kernel.org
Signed-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>
Link: https://lore.kernel.org/r/20210511200110.0b2b886492f0.I23dd5d685fe16d3b0ec8106e8f01b59f499dffed@changeid
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>
Author Date: Tue May 11 20:02:44 2021 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Tue May 11 20:13:03 2021 +0200

Files Changed: 3
Lines Added: 5
Lines Removed: 5
Total Changes: 10
