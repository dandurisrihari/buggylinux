{
  "hash": "7d06015d936c861160803e020f68f413b5c3cd9d",
  "hash_short": "7d06015d",
  "subject": "Merge tag 'pci-v6.15-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/pci/pci",
  "body": "Pull pci updates from Bjorn Helgaas:\n \"Enumeration:\n\n   - Enable Configuration RRS SV, which makes device readiness visible,\n     early instead of during child bus scanning (Bjorn Helgaas)\n\n   - Log debug messages about reset methods being used (Bjorn Helgaas)\n\n   - Avoid reset when it has been disabled via sysfs (Nishanth\n     Aravamudan)\n\n   - Add common pci-ep-bus.yaml schema for exporting several peripherals\n     of a single PCI function via devicetree (Andrea della Porta)\n\n   - Create DT nodes for PCI host bridges to enable loading device tree\n     overlays to create platform devices for PCI devices that have\n     several features that require multiple drivers (Herve Codina)\n\n  Resource management:\n\n   - Enlarge devres table[] to accommodate bridge windows, ROM, IOV\n     BARs, etc., and validate BAR index in devres interfaces (Philipp\n     Stanner)\n\n   - Fix typo that repeatedly distributed resources to a bridge instead\n     of iterating over subordinate bridges, which resulted in too little\n     space to assign some BARs (Kai-Heng Feng)\n\n   - Relax bridge window tail sizing for optional resources, e.g., IOV\n     BARs, to avoid failures when removing and re-adding devices (Ilpo\n     J\u00e4rvinen)\n\n   - Allow drivers to enable devices even if we haven't assigned\n     optional IOV resources to them (Ilpo J\u00e4rvinen)\n\n   - Rework handling of optional resources (IOV BARs, ROMs) to reduce\n     failures if we can't allocate them (Ilpo J\u00e4rvinen)\n\n   - Fix a NULL dereference in the SR-IOV VF creation error path (Shay\n     Drory)\n\n   - Fix s390 mmio_read/write syscalls, which didn't cause page faults\n     in some cases, which broke vfio-pci lazy mapping on first access\n     (Niklas Schnelle)\n\n   - Add pdev->non_mappable_bars to replace CONFIG_VFIO_PCI_MMAP, which\n     was disabled only for s390 (Niklas Schnelle)\n\n   - Support mmap of PCI resources on s390 except for ISM devices\n     (Niklas Schnelle)\n\n  ASPM:\n\n   - Delay pcie_link_state deallocation to avoid dangling pointers that\n     cause invalid references during hot-unplug (Daniel Stodden)\n\n  Power management:\n\n   - Allow PCI bridges to go to D3Hot when suspending on all non-x86\n     systems (Manivannan Sadhasivam)\n\n  Power control:\n\n   - Create pwrctrl devices in pci_scan_device() to make it more\n     symmetric with pci_pwrctrl_unregister() and make pwrctrl devices\n     for PCI bridges possible (Manivannan Sadhasivam)\n\n   - Unregister pwrctrl devices in pci_destroy_dev() so DOE, ASPM, etc.\n     can still access devices after pci_stop_dev() (Manivannan\n     Sadhasivam)\n\n   - If there's a pwrctrl device for a PCI device, skip scanning it\n     because the pwrctrl core will rescan the bus after the device is\n     powered on (Manivannan Sadhasivam)\n\n   - Add a pwrctrl driver for PCI slots based on voltage regulators\n     described via devicetree (Manivannan Sadhasivam)\n\n  Bandwidth control:\n\n   - Add set_pcie_speed.sh to TEST_PROGS to fix issue when executing the\n     set_pcie_cooling_state.sh test case (Yi Lai)\n\n   - Avoid a NULL pointer dereference when we run out of bus numbers to\n     assign for a bridge secondary bus (Lukas Wunner)\n\n  Hotplug:\n\n   - Drop superfluous pci_hotplug_slot_list, try_module_get() calls, and\n     NULL pointer checks (Lukas Wunner)\n\n   - Drop shpchp module init/exit logging, replace shpchp dbg() with\n     ctrl_dbg(), and remove unused dbg(), err(), info(), warn() wrappers\n     (Ilpo J\u00e4rvinen)\n\n   - Drop 'shpchp_debug' module parameter in favor of standard dynamic\n     debugging (Ilpo J\u00e4rvinen)\n\n   - Drop unused cpcihp .get_power(), .set_power() function pointers\n     (Guilherme Giacomo Simoes)\n\n   - Disable hotplug interrupts in portdrv only when pciehp is not\n     enabled to avoid issuing two hotplug commands too close together\n     (Feng Tang)\n\n   - Skip pciehp 'device replaced' check if the device has been removed\n     to address a deadlock when resuming after a device was removed\n     during system sleep (Lukas Wunner)\n\n   - Don't enable pciehp hotplug interupt when resuming in poll mode\n     (Ilpo J\u00e4rvinen)\n\n  Virtualization:\n\n   - Fix bugs in 'pci=config_acs=' kernel command line parameter (Tushar\n     Dave)\n\n  DOE:\n\n   - Expose supported DOE features via sysfs (Alistair Francis)\n\n   - Allow DOE support to be enabled even if CXL isn't enabled (Alistair\n     Francis)\n\n  Endpoint framework:\n\n   - Convert PCI device data so pci-epf-test works correctly on\n     big-endian endpoint systems (Niklas Cassel)\n\n   - Add BAR_RESIZABLE type to endpoint framework and add DWC core\n     support for EPF drivers to set BAR_RESIZABLE type and size (Niklas\n     Cassel)\n\n   - Fix pci-epf-test double free that causes an oops if the host\n     reboots and PERST# deassertion restarts endpoint BAR allocation\n     (Christian Bruel)\n\n   - Fix endpoint BAR testing so tests can skip disabled BARs instead of\n     reporting them as failures (Niklas Cassel)\n\n   - Widen endpoint test BAR size variable to accommodate BARs larger\n     than INT_MAX (Niklas Cassel)\n\n   - Remove unused tools 'pci' build target left over after moving tests\n     to tools/testing/selftests/pci_endpoint (Jianfeng Liu)\n\n  Altera PCIe controller driver:\n\n   - Add DT binding and driver support for Agilex family (P-Tile,\n     F-Tile, R-Tile) (Matthew Gerlach and D M, Sharath Kumar)\n\n  AMD MDB PCIe controller driver:\n\n   - Add DT binding and driver for AMD MDB (Multimedia DMA Bridge)\n     (Thippeswamy Havalige)\n\n  Broadcom STB PCIe controller driver:\n\n   - Add BCM2712 MSI-X DT binding and interrupt controller drivers and\n     add softdep on irq_bcm2712_mip driver to ensure that it is loaded\n     first (Stanimir Varbanov)\n\n   - Expand inbound window map to 64GB so it can accommodate BCM2712\n     (Stanimir Varbanov)\n\n   - Add BCM2712 support and DT updates (Stanimir Varbanov)\n\n   - Apply link speed restriction before bringing link up, not after\n     (Jim Quinlan)\n\n   - Update Max Link Speed in Link Capabilities via the internal\n     writable register, not the read-only config register (Jim Quinlan)\n\n   - Handle regulator_bulk_get() error to avoid panic when we call\n     regulator_bulk_free() later (Jim Quinlan)\n\n   - Disable regulators only when removing the bus immediately below a\n     Root Port because we don't support regulators deeper in the\n     hierarchy (Jim Quinlan)\n\n   - Make const read-only arrays static (Colin Ian King)\n\n  Cadence PCIe endpoint driver:\n\n   - Correct MSG TLP generation so endpoints can generate INTx messages\n     (Hans Zhang)\n\n  Freescale i.MX6 PCIe controller driver:\n\n   - Identify the second controller on i.MX8MQ based on devicetree\n     'linux,pci-domain' instead of DBI 'reg' address (Richard Zhu)\n\n   - Remove imx_pcie_cpu_addr_fixup() since dwc core can now derive the\n     ATU input address (using parent_bus_offset) from devicetree (Frank\n     Li)\n\n  Freescale Layerscape PCIe controller driver:\n\n   - Drop deprecated 'num-ib-windows' and 'num-ob-windows' and\n     unnecessary 'status' from example (Krzysztof Kozlowski)\n\n   - Correct the syscon_regmap_lookup_by_phandle_args(\"fsl,pcie-scfg\")\n     arg_count to fix probe failure on LS1043A (Ioana Ciornei)\n\n  HiSilicon STB PCIe controller driver:\n\n   - Call phy_exit() to clean up if histb_pcie_probe() fails (Christophe\n     JAILLET)\n\n  Intel Gateway PCIe controller driver:\n\n   - Remove intel_pcie_cpu_addr() since dwc core can now derive the ATU\n     input address (using parent_bus_offset) from devicetree (Frank Li)\n\n  Intel VMD host bridge driver:\n\n   - Convert vmd_dev.cfg_lock from spinlock_t to raw_spinlock_t so\n     pci_ops.read() will never sleep, even on PREEMPT_RT where\n     spinlock_t becomes a sleepable lock, to avoid calling a sleeping\n     function from invalid context (Ryo Takakura)\n\n  MediaTek PCIe Gen3 controller driver:\n\n   - Remove leftover mac_reset assert for Airoha EN7581 SoC (Lorenzo\n     Bianconi)\n\n   - Add EN7581 PBUS controller 'mediatek,pbus-csr' DT property and\n     program host bridge memory aperture to this syscon node (Lorenzo\n     Bianconi)\n\n  Qualcomm PCIe controller driver:\n\n   - Add qcom,pcie-ipq5332 binding (Varadarajan Narayanan)\n\n   - Add qcom i.MX8QM and i.MX8QXP/DXP optional DMA interrupt (Alexander\n     Stein)\n\n   - Add optional dma-coherent DT property for Qualcomm SA8775P (Dmitry\n     Baryshkov)\n\n   - Make DT iommu property required for SA8775P and prohibited for\n     SDX55 (Dmitry Baryshkov)\n\n   - Add DT IOMMU and DMA-related properties for Qualcomm SM8450 (Dmitry\n     Baryshkov)\n\n   - Add endpoint DT properties for SAR2130P and enable endpoint mode in\n     driver (Dmitry Baryshkov)\n\n   - Describe endpoint BAR0 and BAR2 as 64-bit only and BAR1 and BAR3 as\n     RESERVED (Manivannan Sadhasivam)\n\n  Rockchip DesignWare PCIe controller driver:\n\n   - Describe rk3568 and rk3588 BARs as Resizable, not Fixed (Niklas\n     Cassel)\n\n  Synopsys DesignWare PCIe controller driver:\n\n   - Add debugfs-based Silicon Debug, Error Injection, Statistical\n     Counter support for DWC (Shradha Todi)\n\n   - Add debugfs property to expose LTSSM status of DWC PCIe link (Hans\n     Zhang)\n\n   - Add Rockchip support for DWC debugfs features (Niklas Cassel)\n\n   - Add dw_pcie_parent_bus_offset() to look up the parent bus address\n     of a specified 'reg' property and return the offset from the CPU\n     physical address (Frank Li)\n\n   - Use dw_pcie_parent_bus_offset() to derive CPU -> ATU addr offset\n     via 'reg[config]' for host controllers and 'reg[addr_space]' for\n     endpoint controllers (Frank Li)\n\n   - Apply struct dw_pcie.parent_bus_offset in ATU users to remove use\n     of .cpu_addr_fixup() when programming ATU (Frank Li)\n\n  TI J721E PCIe driver:\n\n   - Correct the 'link down' interrupt bit for J784S4 (Siddharth\n     Vadapalli)\n\n  TI Keystone PCIe controller driver:\n\n   - Describe AM65x BARs 2 and 5 as Resizable (not Fixed) and reduce\n     alignment requirement from 1MB to 64KB (Niklas Cassel)\n\n  Xilinx Versal CPM PCIe controller driver:\n\n   - Free IRQ domain in probe error path to avoid leaking it\n     (Thippeswamy Havalige)\n\n   - Add DT .compatible \"xlnx,versal-cpm5nc-host\" and driver support for\n     Versal Net CPM5NC Root Port controller (Thippeswamy Havalige)\n\n   - Add driver support for CPM5_HOST1 (Thippeswamy Havalige)\n\n  Miscellaneous:\n\n   - Convert fsl,mpc83xx-pcie binding to YAML (J. Neusch\u00e4fer)\n\n   - Use for_each_available_child_of_node_scoped() to simplify apple,\n     kirin, mediatek, mt7621, tegra drivers (Zhang Zekun)\"\n\n* tag 'pci-v6.15-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/pci/pci: (197 commits)\n  PCI: layerscape: Fix arg_count to syscon_regmap_lookup_by_phandle_args()\n  PCI: j721e: Fix the value of .linkdown_irq_regfield for J784S4\n  misc: pci_endpoint_test: Add support for PCITEST_IRQ_TYPE_AUTO\n  PCI: endpoint: pci-epf-test: Expose supported IRQ types in CAPS register\n  PCI: dw-rockchip: Endpoint mode cannot raise INTx interrupts\n  PCI: endpoint: Add intx_capable to epc_features struct\n  dt-bindings: PCI: Add common schema for devices accessible through PCI BARs\n  PCI: intel-gw: Remove intel_pcie_cpu_addr()\n  PCI: imx6: Remove imx_pcie_cpu_addr_fixup()\n  PCI: dwc: Use parent_bus_offset to remove need for .cpu_addr_fixup()\n  PCI: dwc: ep: Ensure proper iteration over outbound map windows\n  PCI: dwc: ep: Use devicetree 'reg[addr_space]' to derive CPU -> ATU addr offset\n  PCI: dwc: ep: Consolidate devicetree handling in dw_pcie_ep_get_resources()\n  PCI: dwc: ep: Call epc_create() early in dw_pcie_ep_init()\n  PCI: dwc: Use devicetree 'reg[config]' to derive CPU -> ATU addr offset\n  PCI: dwc: Add dw_pcie_parent_bus_offset() checking and debug\n  PCI: dwc: Add dw_pcie_parent_bus_offset()\n  PCI/bwctrl: Fix NULL pointer dereference on bus number exhaustion\n  PCI: xilinx-cpm: Add cpm_csr register mapping for CPM5_HOST1 variant\n  PCI: brcmstb: Make const read-only arrays static\n  ...",
  "full_message": "Merge tag 'pci-v6.15-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/pci/pci\n\nPull pci updates from Bjorn Helgaas:\n \"Enumeration:\n\n   - Enable Configuration RRS SV, which makes device readiness visible,\n     early instead of during child bus scanning (Bjorn Helgaas)\n\n   - Log debug messages about reset methods being used (Bjorn Helgaas)\n\n   - Avoid reset when it has been disabled via sysfs (Nishanth\n     Aravamudan)\n\n   - Add common pci-ep-bus.yaml schema for exporting several peripherals\n     of a single PCI function via devicetree (Andrea della Porta)\n\n   - Create DT nodes for PCI host bridges to enable loading device tree\n     overlays to create platform devices for PCI devices that have\n     several features that require multiple drivers (Herve Codina)\n\n  Resource management:\n\n   - Enlarge devres table[] to accommodate bridge windows, ROM, IOV\n     BARs, etc., and validate BAR index in devres interfaces (Philipp\n     Stanner)\n\n   - Fix typo that repeatedly distributed resources to a bridge instead\n     of iterating over subordinate bridges, which resulted in too little\n     space to assign some BARs (Kai-Heng Feng)\n\n   - Relax bridge window tail sizing for optional resources, e.g., IOV\n     BARs, to avoid failures when removing and re-adding devices (Ilpo\n     J\u00e4rvinen)\n\n   - Allow drivers to enable devices even if we haven't assigned\n     optional IOV resources to them (Ilpo J\u00e4rvinen)\n\n   - Rework handling of optional resources (IOV BARs, ROMs) to reduce\n     failures if we can't allocate them (Ilpo J\u00e4rvinen)\n\n   - Fix a NULL dereference in the SR-IOV VF creation error path (Shay\n     Drory)\n\n   - Fix s390 mmio_read/write syscalls, which didn't cause page faults\n     in some cases, which broke vfio-pci lazy mapping on first access\n     (Niklas Schnelle)\n\n   - Add pdev->non_mappable_bars to replace CONFIG_VFIO_PCI_MMAP, which\n     was disabled only for s390 (Niklas Schnelle)\n\n   - Support mmap of PCI resources on s390 except for ISM devices\n     (Niklas Schnelle)\n\n  ASPM:\n\n   - Delay pcie_link_state deallocation to avoid dangling pointers that\n     cause invalid references during hot-unplug (Daniel Stodden)\n\n  Power management:\n\n   - Allow PCI bridges to go to D3Hot when suspending on all non-x86\n     systems (Manivannan Sadhasivam)\n\n  Power control:\n\n   - Create pwrctrl devices in pci_scan_device() to make it more\n     symmetric with pci_pwrctrl_unregister() and make pwrctrl devices\n     for PCI bridges possible (Manivannan Sadhasivam)\n\n   - Unregister pwrctrl devices in pci_destroy_dev() so DOE, ASPM, etc.\n     can still access devices after pci_stop_dev() (Manivannan\n     Sadhasivam)\n\n   - If there's a pwrctrl device for a PCI device, skip scanning it\n     because the pwrctrl core will rescan the bus after the device is\n     powered on (Manivannan Sadhasivam)\n\n   - Add a pwrctrl driver for PCI slots based on voltage regulators\n     described via devicetree (Manivannan Sadhasivam)\n\n  Bandwidth control:\n\n   - Add set_pcie_speed.sh to TEST_PROGS to fix issue when executing the\n     set_pcie_cooling_state.sh test case (Yi Lai)\n\n   - Avoid a NULL pointer dereference when we run out of bus numbers to\n     assign for a bridge secondary bus (Lukas Wunner)\n\n  Hotplug:\n\n   - Drop superfluous pci_hotplug_slot_list, try_module_get() calls, and\n     NULL pointer checks (Lukas Wunner)\n\n   - Drop shpchp module init/exit logging, replace shpchp dbg() with\n     ctrl_dbg(), and remove unused dbg(), err(), info(), warn() wrappers\n     (Ilpo J\u00e4rvinen)\n\n   - Drop 'shpchp_debug' module parameter in favor of standard dynamic\n     debugging (Ilpo J\u00e4rvinen)\n\n   - Drop unused cpcihp .get_power(), .set_power() function pointers\n     (Guilherme Giacomo Simoes)\n\n   - Disable hotplug interrupts in portdrv only when pciehp is not\n     enabled to avoid issuing two hotplug commands too close together\n     (Feng Tang)\n\n   - Skip pciehp 'device replaced' check if the device has been removed\n     to address a deadlock when resuming after a device was removed\n     during system sleep (Lukas Wunner)\n\n   - Don't enable pciehp hotplug interupt when resuming in poll mode\n     (Ilpo J\u00e4rvinen)\n\n  Virtualization:\n\n   - Fix bugs in 'pci=config_acs=' kernel command line parameter (Tushar\n     Dave)\n\n  DOE:\n\n   - Expose supported DOE features via sysfs (Alistair Francis)\n\n   - Allow DOE support to be enabled even if CXL isn't enabled (Alistair\n     Francis)\n\n  Endpoint framework:\n\n   - Convert PCI device data so pci-epf-test works correctly on\n     big-endian endpoint systems (Niklas Cassel)\n\n   - Add BAR_RESIZABLE type to endpoint framework and add DWC core\n     support for EPF drivers to set BAR_RESIZABLE type and size (Niklas\n     Cassel)\n\n   - Fix pci-epf-test double free that causes an oops if the host\n     reboots and PERST# deassertion restarts endpoint BAR allocation\n     (Christian Bruel)\n\n   - Fix endpoint BAR testing so tests can skip disabled BARs instead of\n     reporting them as failures (Niklas Cassel)\n\n   - Widen endpoint test BAR size variable to accommodate BARs larger\n     than INT_MAX (Niklas Cassel)\n\n   - Remove unused tools 'pci' build target left over after moving tests\n     to tools/testing/selftests/pci_endpoint (Jianfeng Liu)\n\n  Altera PCIe controller driver:\n\n   - Add DT binding and driver support for Agilex family (P-Tile,\n     F-Tile, R-Tile) (Matthew Gerlach and D M, Sharath Kumar)\n\n  AMD MDB PCIe controller driver:\n\n   - Add DT binding and driver for AMD MDB (Multimedia DMA Bridge)\n     (Thippeswamy Havalige)\n\n  Broadcom STB PCIe controller driver:\n\n   - Add BCM2712 MSI-X DT binding and interrupt controller drivers and\n     add softdep on irq_bcm2712_mip driver to ensure that it is loaded\n     first (Stanimir Varbanov)\n\n   - Expand inbound window map to 64GB so it can accommodate BCM2712\n     (Stanimir Varbanov)\n\n   - Add BCM2712 support and DT updates (Stanimir Varbanov)\n\n   - Apply link speed restriction before bringing link up, not after\n     (Jim Quinlan)\n\n   - Update Max Link Speed in Link Capabilities via the internal\n     writable register, not the read-only config register (Jim Quinlan)\n\n   - Handle regulator_bulk_get() error to avoid panic when we call\n     regulator_bulk_free() later (Jim Quinlan)\n\n   - Disable regulators only when removing the bus immediately below a\n     Root Port because we don't support regulators deeper in the\n     hierarchy (Jim Quinlan)\n\n   - Make const read-only arrays static (Colin Ian King)\n\n  Cadence PCIe endpoint driver:\n\n   - Correct MSG TLP generation so endpoints can generate INTx messages\n     (Hans Zhang)\n\n  Freescale i.MX6 PCIe controller driver:\n\n   - Identify the second controller on i.MX8MQ based on devicetree\n     'linux,pci-domain' instead of DBI 'reg' address (Richard Zhu)\n\n   - Remove imx_pcie_cpu_addr_fixup() since dwc core can now derive the\n     ATU input address (using parent_bus_offset) from devicetree (Frank\n     Li)\n\n  Freescale Layerscape PCIe controller driver:\n\n   - Drop deprecated 'num-ib-windows' and 'num-ob-windows' and\n     unnecessary 'status' from example (Krzysztof Kozlowski)\n\n   - Correct the syscon_regmap_lookup_by_phandle_args(\"fsl,pcie-scfg\")\n     arg_count to fix probe failure on LS1043A (Ioana Ciornei)\n\n  HiSilicon STB PCIe controller driver:\n\n   - Call phy_exit() to clean up if histb_pcie_probe() fails (Christophe\n     JAILLET)\n\n  Intel Gateway PCIe controller driver:\n\n   - Remove intel_pcie_cpu_addr() since dwc core can now derive the ATU\n     input address (using parent_bus_offset) from devicetree (Frank Li)\n\n  Intel VMD host bridge driver:\n\n   - Convert vmd_dev.cfg_lock from spinlock_t to raw_spinlock_t so\n     pci_ops.read() will never sleep, even on PREEMPT_RT where\n     spinlock_t becomes a sleepable lock, to avoid calling a sleeping\n     function from invalid context (Ryo Takakura)\n\n  MediaTek PCIe Gen3 controller driver:\n\n   - Remove leftover mac_reset assert for Airoha EN7581 SoC (Lorenzo\n     Bianconi)\n\n   - Add EN7581 PBUS controller 'mediatek,pbus-csr' DT property and\n     program host bridge memory aperture to this syscon node (Lorenzo\n     Bianconi)\n\n  Qualcomm PCIe controller driver:\n\n   - Add qcom,pcie-ipq5332 binding (Varadarajan Narayanan)\n\n   - Add qcom i.MX8QM and i.MX8QXP/DXP optional DMA interrupt (Alexander\n     Stein)\n\n   - Add optional dma-coherent DT property for Qualcomm SA8775P (Dmitry\n     Baryshkov)\n\n   - Make DT iommu property required for SA8775P and prohibited for\n     SDX55 (Dmitry Baryshkov)\n\n   - Add DT IOMMU and DMA-related properties for Qualcomm SM8450 (Dmitry\n     Baryshkov)\n\n   - Add endpoint DT properties for SAR2130P and enable endpoint mode in\n     driver (Dmitry Baryshkov)\n\n   - Describe endpoint BAR0 and BAR2 as 64-bit only and BAR1 and BAR3 as\n     RESERVED (Manivannan Sadhasivam)\n\n  Rockchip DesignWare PCIe controller driver:\n\n   - Describe rk3568 and rk3588 BARs as Resizable, not Fixed (Niklas\n     Cassel)\n\n  Synopsys DesignWare PCIe controller driver:\n\n   - Add debugfs-based Silicon Debug, Error Injection, Statistical\n     Counter support for DWC (Shradha Todi)\n\n   - Add debugfs property to expose LTSSM status of DWC PCIe link (Hans\n     Zhang)\n\n   - Add Rockchip support for DWC debugfs features (Niklas Cassel)\n\n   - Add dw_pcie_parent_bus_offset() to look up the parent bus address\n     of a specified 'reg' property and return the offset from the CPU\n     physical address (Frank Li)\n\n   - Use dw_pcie_parent_bus_offset() to derive CPU -> ATU addr offset\n     via 'reg[config]' for host controllers and 'reg[addr_space]' for\n     endpoint controllers (Frank Li)\n\n   - Apply struct dw_pcie.parent_bus_offset in ATU users to remove use\n     of .cpu_addr_fixup() when programming ATU (Frank Li)\n\n  TI J721E PCIe driver:\n\n   - Correct the 'link down' interrupt bit for J784S4 (Siddharth\n     Vadapalli)\n\n  TI Keystone PCIe controller driver:\n\n   - Describe AM65x BARs 2 and 5 as Resizable (not Fixed) and reduce\n     alignment requirement from 1MB to 64KB (Niklas Cassel)\n\n  Xilinx Versal CPM PCIe controller driver:\n\n   - Free IRQ domain in probe error path to avoid leaking it\n     (Thippeswamy Havalige)\n\n   - Add DT .compatible \"xlnx,versal-cpm5nc-host\" and driver support for\n     Versal Net CPM5NC Root Port controller (Thippeswamy Havalige)\n\n   - Add driver support for CPM5_HOST1 (Thippeswamy Havalige)\n\n  Miscellaneous:\n\n   - Convert fsl,mpc83xx-pcie binding to YAML (J. Neusch\u00e4fer)\n\n   - Use for_each_available_child_of_node_scoped() to simplify apple,\n     kirin, mediatek, mt7621, tegra drivers (Zhang Zekun)\"\n\n* tag 'pci-v6.15-changes' of git://git.kernel.org/pub/scm/linux/kernel/git/pci/pci: (197 commits)\n  PCI: layerscape: Fix arg_count to syscon_regmap_lookup_by_phandle_args()\n  PCI: j721e: Fix the value of .linkdown_irq_regfield for J784S4\n  misc: pci_endpoint_test: Add support for PCITEST_IRQ_TYPE_AUTO\n  PCI: endpoint: pci-epf-test: Expose supported IRQ types in CAPS register\n  PCI: dw-rockchip: Endpoint mode cannot raise INTx interrupts\n  PCI: endpoint: Add intx_capable to epc_features struct\n  dt-bindings: PCI: Add common schema for devices accessible through PCI BARs\n  PCI: intel-gw: Remove intel_pcie_cpu_addr()\n  PCI: imx6: Remove imx_pcie_cpu_addr_fixup()\n  PCI: dwc: Use parent_bus_offset to remove need for .cpu_addr_fixup()\n  PCI: dwc: ep: Ensure proper iteration over outbound map windows\n  PCI: dwc: ep: Use devicetree 'reg[addr_space]' to derive CPU -> ATU addr offset\n  PCI: dwc: ep: Consolidate devicetree handling in dw_pcie_ep_get_resources()\n  PCI: dwc: ep: Call epc_create() early in dw_pcie_ep_init()\n  PCI: dwc: Use devicetree 'reg[config]' to derive CPU -> ATU addr offset\n  PCI: dwc: Add dw_pcie_parent_bus_offset() checking and debug\n  PCI: dwc: Add dw_pcie_parent_bus_offset()\n  PCI/bwctrl: Fix NULL pointer dereference on bus number exhaustion\n  PCI: xilinx-cpm: Add cpm_csr register mapping for CPM5_HOST1 variant\n  PCI: brcmstb: Make const read-only arrays static\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Fri Mar 28 19:36:53 2025 -0700",
  "author_date_iso": "2025-03-28T19:36:53-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Fri Mar 28 19:36:53 2025 -0700",
  "committer_date_iso": "2025-03-28T19:36:53-07:00",
  "files_changed": [
    "Documentation/devicetree/bindings/vendor-prefixes.yaml",
    "MAINTAINERS",
    "arch/s390/Kconfig",
    "arch/s390/include/asm/pci.h",
    "drivers/base/core.c",
    "drivers/irqchip/Kconfig",
    "drivers/irqchip/Makefile",
    "drivers/pci/Kconfig",
    "drivers/pci/controller/pci-hyperv.c",
    "drivers/pci/controller/vmd.c",
    "drivers/pci/pcie/aspm.c",
    "drivers/pci/probe.c",
    "drivers/pci/quirks.c",
    "drivers/perf/dwc_pcie_pmu.c",
    "drivers/s390/net/ism_drv.c",
    "include/linux/device.h",
    "include/linux/pci_ids.h"
  ],
  "files_changed_count": 17,
  "stats": [
    {
      "file": "Documentation/ABI/testing/debugfs-dwc-pcie",
      "insertions": 157,
      "deletions": 0
    },
    {
      "file": "Documentation/ABI/testing/sysfs-bus-pci",
      "insertions": 29,
      "deletions": 0
    },
    {
      "file": "Documentation/PCI/endpoint/pci-endpoint.rst",
      "insertions": 3,
      "deletions": 4
    },
    {
      "file": "Documentation/devicetree/bindings/interrupt-controller/brcm,bcm2712-msix.yaml",
      "insertions": 60,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/altr,pcie-root-port.yaml",
      "insertions": 10,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/amd,versal2-mdb-host.yaml",
      "insertions": 121,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/brcm,stb-pcie.yaml",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "Documentation/devicetree/bindings/pci/fsl,imx6q-pcie.yaml",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/fsl,layerscape-pcie-ep.yaml",
      "insertions": 0,
      "deletions": 3
    },
    {
      "file": "Documentation/devicetree/bindings/pci/fsl,mpc8xxx-pci.yaml",
      "insertions": 113,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/fsl,pci.txt",
      "insertions": 0,
      "deletions": 27
    },
    {
      "file": "Documentation/devicetree/bindings/pci/mediatek-pcie-gen3.yaml",
      "insertions": 17,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/pci-ep-bus.yaml",
      "insertions": 58,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/qcom,pcie-ep.yaml",
      "insertions": 74,
      "deletions": 26
    },
    {
      "file": "Documentation/devicetree/bindings/pci/qcom,pcie.yaml",
      "insertions": 6,
      "deletions": 2
    },
    {
      "file": "Documentation/devicetree/bindings/pci/snps,dw-pcie.yaml",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/pci/xilinx-versal-cpm.yaml",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "Documentation/devicetree/bindings/vendor-prefixes.yaml",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "MAINTAINERS",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/s390/Kconfig",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "arch/s390/include/asm/pci.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "arch/s390/pci/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "arch/s390/pci/pci_fixup.c",
      "insertions": 23,
      "deletions": 0
    },
    {
      "file": "arch/s390/pci/pci_mmio.c",
      "insertions": 13,
      "deletions": 5
    },
    {
      "file": "drivers/base/core.c",
      "insertions": 61,
      "deletions": 0
    },
    {
      "file": "drivers/irqchip/Kconfig",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "drivers/irqchip/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/irqchip/irq-bcm2712-mip.c",
      "insertions": 292,
      "deletions": 0
    },
    {
      "file": "drivers/misc/pci_endpoint_test.c",
      "insertions": 70,
      "deletions": 61
    },
    {
      "file": "drivers/pci/Kconfig",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/pci/bus.c",
      "insertions": 0,
      "deletions": 43
    },
    {
      "file": "drivers/pci/controller/cadence/pci-j721e.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/pci/controller/cadence/pcie-cadence-ep.c",
      "insertions": 5,
      "deletions": 6
    },
    {
      "file": "drivers/pci/controller/cadence/pcie-cadence.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/dwc/Kconfig",
      "insertions": 21,
      "deletions": 0
    },
    {
      "file": "drivers/pci/controller/dwc/Makefile",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/pci/controller/dwc/pci-imx6.c",
      "insertions": 20,
      "deletions": 86
    },
    {
      "file": "drivers/pci/controller/dwc/pci-keystone.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "drivers/pci/controller/dwc/pci-layerscape.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-amd-mdb.c",
      "insertions": 476,
      "deletions": 0
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-designware-debugfs.c",
      "insertions": 677,
      "deletions": 0
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-designware-ep.c",
      "insertions": 260,
      "deletions": 61
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-designware-host.c",
      "insertions": 42,
      "deletions": 19
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-designware.c",
      "insertions": 123,
      "deletions": 19
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-designware.h",
      "insertions": 79,
      "deletions": 3
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-dw-rockchip.c",
      "insertions": 42,
      "deletions": 11
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-histb.c",
      "insertions": 8,
      "deletions": 4
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-intel-gw.c",
      "insertions": 1,
      "deletions": 7
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-kirin.c",
      "insertions": 18,
      "deletions": 32
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-qcom-ep.c",
      "insertions": 11,
      "deletions": 6
    },
    {
      "file": "drivers/pci/controller/dwc/pcie-qcom.c",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "drivers/pci/controller/pci-hyperv.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/pci-mvebu.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/pci-tegra.c",
      "insertions": 28,
      "deletions": 52
    },
    {
      "file": "drivers/pci/controller/pci-thunder-ecam.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/pci-xgene-msi.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/pcie-altera.c",
      "insertions": 247,
      "deletions": 10
    },
    {
      "file": "drivers/pci/controller/pcie-apple.c",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "drivers/pci/controller/pcie-brcmstb.c",
      "insertions": 134,
      "deletions": 68
    },
    {
      "file": "drivers/pci/controller/pcie-mediatek-gen3.c",
      "insertions": 49,
      "deletions": 15
    },
    {
      "file": "drivers/pci/controller/pcie-mediatek.c",
      "insertions": 5,
      "deletions": 10
    },
    {
      "file": "drivers/pci/controller/pcie-mt7621.c",
      "insertions": 5,
      "deletions": 10
    },
    {
      "file": "drivers/pci/controller/pcie-rcar-host.c",
      "insertions": 6,
      "deletions": 4
    },
    {
      "file": "drivers/pci/controller/pcie-rockchip-host.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/pcie-rockchip.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/pci/controller/pcie-xilinx-cpm.c",
      "insertions": 37,
      "deletions": 16
    },
    {
      "file": "drivers/pci/controller/vmd.c",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "drivers/pci/devres.c",
      "insertions": 15,
      "deletions": 3
    },
    {
      "file": "drivers/pci/doe.c",
      "insertions": 200,
      "deletions": 47
    },
    {
      "file": "drivers/pci/endpoint/Kconfig",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/endpoint/functions/pci-epf-mhi.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/endpoint/functions/pci-epf-test.c",
      "insertions": 88,
      "deletions": 54
    },
    {
      "file": "drivers/pci/endpoint/pci-epc-core.c",
      "insertions": 31,
      "deletions": 25
    },
    {
      "file": "drivers/pci/endpoint/pci-epf-core.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "drivers/pci/hotplug/Kconfig",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/hotplug/cpci_hotplug.h",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "drivers/pci/hotplug/cpci_hotplug_core.c",
      "insertions": 2,
      "deletions": 15
    },
    {
      "file": "drivers/pci/hotplug/pci_hotplug_core.c",
      "insertions": 41,
      "deletions": 101
    },
    {
      "file": "drivers/pci/hotplug/pciehp_core.c",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/pci/hotplug/pciehp_hpc.c",
      "insertions": 7,
      "deletions": 4
    },
    {
      "file": "drivers/pci/hotplug/shpchp.h",
      "insertions": 1,
      "deletions": 17
    },
    {
      "file": "drivers/pci/hotplug/shpchp_core.c",
      "insertions": 1,
      "deletions": 12
    },
    {
      "file": "drivers/pci/hotplug/shpchp_hpc.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/iomap.c",
      "insertions": 21,
      "deletions": 8
    },
    {
      "file": "drivers/pci/iov.c",
      "insertions": 35,
      "deletions": 15
    },
    {
      "file": "drivers/pci/msi/api.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/of.c",
      "insertions": 121,
      "deletions": 6
    },
    {
      "file": "drivers/pci/of_property.c",
      "insertions": 111,
      "deletions": 4
    },
    {
      "file": "drivers/pci/pci-sysfs.c",
      "insertions": 9,
      "deletions": 2
    },
    {
      "file": "drivers/pci/pci.c",
      "insertions": 52,
      "deletions": 20
    },
    {
      "file": "drivers/pci/pci.h",
      "insertions": 82,
      "deletions": 7
    },
    {
      "file": "drivers/pci/pcie/aer.c",
      "insertions": 42,
      "deletions": 37
    },
    {
      "file": "drivers/pci/pcie/aspm.c",
      "insertions": 9,
      "deletions": 8
    },
    {
      "file": "drivers/pci/pcie/bwctrl.c",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "drivers/pci/pcie/dpc.c",
      "insertions": 15,
      "deletions": 3
    },
    {
      "file": "drivers/pci/pcie/portdrv.c",
      "insertions": 5,
      "deletions": 3
    },
    {
      "file": "drivers/pci/pcie/tlp.c",
      "insertions": 38,
      "deletions": 18
    },
    {
      "file": "drivers/pci/probe.c",
      "insertions": 67,
      "deletions": 11
    },
    {
      "file": "drivers/pci/proc.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "drivers/pci/pwrctrl/Kconfig",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "drivers/pci/pwrctrl/Makefile",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/pci/pwrctrl/core.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/pci/pwrctrl/slot.c",
      "insertions": 93,
      "deletions": 0
    },
    {
      "file": "drivers/pci/quirks.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/pci/remove.c",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/pci/setup-bus.c",
      "insertions": 327,
      "deletions": 248
    },
    {
      "file": "drivers/pci/setup-res.c",
      "insertions": 10,
      "deletions": 14
    },
    {
      "file": "drivers/pci/slot.c",
      "insertions": 0,
      "deletions": 44
    },
    {
      "file": "drivers/perf/dwc_pcie_pmu.c",
      "insertions": 3,
      "deletions": 22
    },
    {
      "file": "drivers/s390/net/ism_drv.c",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/vfio/pci/Kconfig",
      "insertions": 0,
      "deletions": 4
    },
    {
      "file": "drivers/vfio/pci/vfio_pci_core.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/aer.h",
      "insertions": 10,
      "deletions": 2
    },
    {
      "file": "include/linux/device.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "include/linux/pci-epc.h",
      "insertions": 7,
      "deletions": 1
    },
    {
      "file": "include/linux/pci-epf.h",
      "insertions": 9,
      "deletions": 8
    },
    {
      "file": "include/linux/pci.h",
      "insertions": 3,
      "deletions": 11
    },
    {
      "file": "include/linux/pci_hotplug.h",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "include/linux/pci_ids.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "include/linux/pcie-dwc.h",
      "insertions": 38,
      "deletions": 0
    },
    {
      "file": "include/ras/ras_event.h",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "include/uapi/linux/pci_regs.h",
      "insertions": 10,
      "deletions": 3
    },
    {
      "file": "include/uapi/linux/pcitest.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "tools/Makefile",
      "insertions": 6,
      "deletions": 7
    },
    {
      "file": "tools/testing/selftests/pci_endpoint/pci_endpoint_test.c",
      "insertions": 21,
      "deletions": 10
    },
    {
      "file": "tools/testing/selftests/pcie_bwctrl/Makefile",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 5061,
  "total_deletions": 1463,
  "total_changes": 6524,
  "parents": [
    "0c86b42439b6c11d758b3392a21117934fef00c1",
    "dea140198b846f7432d78566b7b0b83979c72c2b"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/s390/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/base/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/s390/include/asm/pci.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/irqchip/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "Documentation/devicetree/bindings/vendor-prefixes.yaml",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/irqchip/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/controller/pci-hyperv.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/controller/vmd.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/probe.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/quirks.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/pci/pcie/aspm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/s390/net/ism_drv.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/perf/dwc_pcie_pmu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/device.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/pci_ids.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "MAINTAINERS",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}