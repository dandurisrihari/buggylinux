Commit Hash: ea49d10eee5a220b717dbf2ee429c9e3d59c978c
Subject: selinux: normalize input to /sys/fs/selinux/enforce


Security Keywords:
- security issue

Full commit message:
selinux: normalize input to /sys/fs/selinux/enforce

At present, one can write any signed integer value to
/sys/fs/selinux/enforce and it will be stored,
e.g. echo -1 > /sys/fs/selinux/enforce or echo 2 >
/sys/fs/selinux/enforce. This makes no real difference
to the kernel, since it only ever cares if it is zero or non-zero,
but some userspace code compares it with 1 to decide if SELinux
is enforcing, and this could confuse it. Only a process that is
already root and is allowed the setenforce permission in SELinux
policy can write to /sys/fs/selinux/enforce, so this is not considered
to be a security issue, but it should be fixed.

Signed-off-by: Stephen Smalley <sds@tycho.nsa.gov>
Signed-off-by: Paul Moore <paul@paul-moore.com>

Metadata:
Author: Stephen Smalley <sds@tycho.nsa.gov>
Author Date: Fri Nov 18 09:30:38 2016 -0500
Committer: Paul Moore <paul@paul-moore.com>
Commit Date: Sun Nov 20 17:13:19 2016 -0500

Files Changed: 1
Lines Added: 2
Lines Removed: 0
Total Changes: 2
