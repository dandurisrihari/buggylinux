Commit Hash: 6f550484a15ea1b468665cdf59f020bf08ccb292
Subject: KVM: Fix load_guest_segment_descriptor() to inject page fault


Security Keywords:
- inject

Full commit message:
KVM: Fix load_guest_segment_descriptor() to inject page fault

This patch injects page fault when reading descriptor in
load_guest_segment_descriptor() fails with FAULT.

Effects of this injection: This function is used by
kvm_load_segment_descriptor() which is necessary for the
following instructions:

 - mov seg,r/m16
 - jmp far
 - pop ?s

This patch makes it possible to emulate the page faults
generated by these instructions. But be sure that unless
we change the kvm_load_segment_descriptor()'s ret value
propagation this patch has no effect.

Signed-off-by: Takuya Yoshikawa <yoshikawa.takuya@oss.ntt.co.jp>
Signed-off-by: Gleb Natapov <gleb@redhat.com>
Signed-off-by: Avi Kivity <avi@redhat.com>

Metadata:
Author: Takuya Yoshikawa <yoshikawa.takuya@oss.ntt.co.jp>
Author Date: Thu Feb 18 12:15:00 2010 +0200
Committer: Marcelo Tosatti <mtosatti@redhat.com>
Commit Date: Mon Mar 1 12:36:13 2010 -0300

Files Changed: 1
Lines Added: 10
Lines Removed: 3
Total Changes: 13
