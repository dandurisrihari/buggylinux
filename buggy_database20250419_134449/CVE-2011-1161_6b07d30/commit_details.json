{
  "hash": "6b07d30aca7e52f2881b8c8c20c8a2cd28e8b3d3",
  "hash_short": "6b07d30a",
  "subject": "TPM: Call tpm_transmit with correct size",
  "body": "This patch changes the call of tpm_transmit by supplying the size of the\nuserspace buffer instead of TPM_BUFSIZE.\n\nThis got assigned CVE-2011-1161.\n\n[The first hunk didn't make sense given one could expect\n way less data than TPM_BUFSIZE, so added tpm_transmit boundary\n check over bufsiz instead\n The last parameter of tpm_transmit() reflects the amount\n of data expected from the device, and not the buffer size\n being supplied to it. It isn't ideal to parse it directly,\n so we just set it to the maximum the input buffer can handle\n and let the userspace API to do such job.]\n\nSigned-off-by: Rajiv Andrade <srajiv@linux.vnet.ibm.com>\nCc: Stable Kernel <stable@kernel.org>\nSigned-off-by: James Morris <jmorris@namei.org>",
  "full_message": "TPM: Call tpm_transmit with correct size\n\nThis patch changes the call of tpm_transmit by supplying the size of the\nuserspace buffer instead of TPM_BUFSIZE.\n\nThis got assigned CVE-2011-1161.\n\n[The first hunk didn't make sense given one could expect\n way less data than TPM_BUFSIZE, so added tpm_transmit boundary\n check over bufsiz instead\n The last parameter of tpm_transmit() reflects the amount\n of data expected from the device, and not the buffer size\n being supplied to it. It isn't ideal to parse it directly,\n so we just set it to the maximum the input buffer can handle\n and let the userspace API to do such job.]\n\nSigned-off-by: Rajiv Andrade <srajiv@linux.vnet.ibm.com>\nCc: Stable Kernel <stable@kernel.org>\nSigned-off-by: James Morris <jmorris@namei.org>",
  "author_name": "Peter Huewe",
  "author_email": "huewe.external.infineon@googlemail.com",
  "author_date": "Thu Sep 15 14:37:43 2011 -0300",
  "author_date_iso": "2011-09-15T14:37:43-03:00",
  "committer_name": "James Morris",
  "committer_email": "jmorris@namei.org",
  "committer_date": "Fri Sep 23 09:46:29 2011 +1000",
  "committer_date_iso": "2011-09-23T09:46:29+10:00",
  "files_changed": [
    "drivers/char/tpm/tpm.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/char/tpm/tpm.c",
      "insertions": 3,
      "deletions": 0
    }
  ],
  "total_insertions": 3,
  "total_deletions": 0,
  "total_changes": 3,
  "parents": [
    "de69113ec1896443c732e8b812e8005fb44eeeeb"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.1",
    "v3.1-rc10",
    "v3.1-rc8",
    "v3.1-rc9",
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2011-1161"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/char/tpm/tpm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}