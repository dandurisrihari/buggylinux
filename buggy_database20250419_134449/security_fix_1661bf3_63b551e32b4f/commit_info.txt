Commit Hash: 1661bf364ae9c506bc8795fef70d1532931be1e8
Subject: net: heap overflow in __audit_sockaddr()


Security Keywords:
- exploit

Full commit message:
net: heap overflow in __audit_sockaddr()

We need to cap ->msg_namelen or it leads to a buffer overflow when we
to the memcpy() in __audit_sockaddr().  It requires CAP_AUDIT_CONTROL to
exploit this bug.

The call tree is:
___sys_recvmsg()
  move_addr_to_user()
    audit_sockaddr()
      __audit_sockaddr()

Reported-by: JÃ¼ri Aedla <juri.aedla@gmail.com>
Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Dan Carpenter <dan.carpenter@oracle.com>
Author Date: Thu Oct 3 00:27:20 2013 +0300
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Thu Oct 3 16:05:14 2013 -0400

Files Changed: 2
Lines Added: 22
Lines Removed: 4
Total Changes: 26
