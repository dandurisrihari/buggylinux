Commit Hash: fdac1e0697356ac212259f2147aa60c72e334861
Subject: irda: prevent integer underflow in IRLMP_ENUMDEVICES


Security Keywords:
- security issue

Full commit message:
irda: prevent integer underflow in IRLMP_ENUMDEVICES

If the user-provided len is less than the expected offset, the
IRLMP_ENUMDEVICES getsockopt will do a copy_to_user() with a very large
size value.  While this isn't be a security issue on x86 because it will
get caught by the access_ok() check, it may leak large amounts of kernel
heap on other architectures.  In any event, this patch fixes it.

Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Dan Rosenberg <drosenberg@vsecurity.com>
Author Date: Wed Dec 22 13:58:27 2010 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Thu Dec 23 10:09:43 2010 -0800

Files Changed: 1
Lines Added: 11
Lines Removed: 7
Total Changes: 18
