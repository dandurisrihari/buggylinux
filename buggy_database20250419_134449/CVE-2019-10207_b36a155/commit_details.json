{
  "hash": "b36a1552d7319bbfd5cf7f08726c23c5c66d4f73",
  "hash_short": "b36a1552",
  "subject": "Bluetooth: hci_uart: check for missing tty operations",
  "body": "Certain ttys operations (pty_unix98_ops) lack tiocmget() and tiocmset()\nfunctions which are called by the certain HCI UART protocols (hci_ath,\nhci_bcm, hci_intel, hci_mrvl, hci_qca) via hci_uart_set_flow_control()\nor directly. This leads to an execution at NULL and can be triggered by\nan unprivileged user. Fix this by adding a helper function and a check\nfor the missing tty operations in the protocols code.\n\nThis fixes CVE-2019-10207. The Fixes: lines list commits where calls to\ntiocm[gs]et() or hci_uart_set_flow_control() were added to the HCI UART\nprotocols.\n\nLink: https://syzkaller.appspot.com/bug?id=1b42faa2848963564a5b1b7f8c837ea7b55ffa50\nReported-by: syzbot+79337b501d6aa974d0f6@syzkaller.appspotmail.com\nCc: stable@vger.kernel.org # v2.6.36+\nFixes: b3190df62861 (\"Bluetooth: Support for Atheros AR300x serial chip\")\nFixes: 118612fb9165 (\"Bluetooth: hci_bcm: Add suspend/resume PM functions\")\nFixes: ff2895592f0f (\"Bluetooth: hci_intel: Add Intel baudrate configuration support\")\nFixes: 162f812f23ba (\"Bluetooth: hci_uart: Add Marvell support\")\nFixes: fa9ad876b8e0 (\"Bluetooth: hci_qca: Add support for Qualcomm Bluetooth chip wcn3990\")\nSigned-off-by: Vladis Dronov <vdronov@redhat.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nReviewed-by: Yu-Chen, Cho <acho@suse.com>\nTested-by: Yu-Chen, Cho <acho@suse.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "Bluetooth: hci_uart: check for missing tty operations\n\nCertain ttys operations (pty_unix98_ops) lack tiocmget() and tiocmset()\nfunctions which are called by the certain HCI UART protocols (hci_ath,\nhci_bcm, hci_intel, hci_mrvl, hci_qca) via hci_uart_set_flow_control()\nor directly. This leads to an execution at NULL and can be triggered by\nan unprivileged user. Fix this by adding a helper function and a check\nfor the missing tty operations in the protocols code.\n\nThis fixes CVE-2019-10207. The Fixes: lines list commits where calls to\ntiocm[gs]et() or hci_uart_set_flow_control() were added to the HCI UART\nprotocols.\n\nLink: https://syzkaller.appspot.com/bug?id=1b42faa2848963564a5b1b7f8c837ea7b55ffa50\nReported-by: syzbot+79337b501d6aa974d0f6@syzkaller.appspotmail.com\nCc: stable@vger.kernel.org # v2.6.36+\nFixes: b3190df62861 (\"Bluetooth: Support for Atheros AR300x serial chip\")\nFixes: 118612fb9165 (\"Bluetooth: hci_bcm: Add suspend/resume PM functions\")\nFixes: ff2895592f0f (\"Bluetooth: hci_intel: Add Intel baudrate configuration support\")\nFixes: 162f812f23ba (\"Bluetooth: hci_uart: Add Marvell support\")\nFixes: fa9ad876b8e0 (\"Bluetooth: hci_qca: Add support for Qualcomm Bluetooth chip wcn3990\")\nSigned-off-by: Vladis Dronov <vdronov@redhat.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>\nReviewed-by: Yu-Chen, Cho <acho@suse.com>\nTested-by: Yu-Chen, Cho <acho@suse.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Vladis Dronov",
  "author_email": "vdronov@redhat.com",
  "author_date": "Tue Jul 30 11:33:45 2019 +0200",
  "author_date_iso": "2019-07-30T11:33:45+02:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Wed Jul 31 13:17:33 2019 -0700",
  "committer_date_iso": "2019-07-31T13:17:33-07:00",
  "files_changed": [
    "drivers/bluetooth/hci_ath.c",
    "drivers/bluetooth/hci_bcm.c",
    "drivers/bluetooth/hci_intel.c",
    "drivers/bluetooth/hci_ldisc.c",
    "drivers/bluetooth/hci_mrvl.c",
    "drivers/bluetooth/hci_qca.c",
    "drivers/bluetooth/hci_uart.h"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "drivers/bluetooth/hci_ath.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/bluetooth/hci_bcm.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/bluetooth/hci_intel.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/bluetooth/hci_ldisc.c",
      "insertions": 13,
      "deletions": 0
    },
    {
      "file": "drivers/bluetooth/hci_mrvl.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/bluetooth/hci_qca.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/bluetooth/hci_uart.h",
      "insertions": 1,
      "deletions": 0
    }
  ],
  "total_insertions": 29,
  "total_deletions": 0,
  "total_changes": 29,
  "parents": [
    "1b7e816fc80e668f0ccc8542cec20b9259abace1"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.3",
    "v5.3-rc3",
    "v5.3-rc4",
    "v5.3-rc5",
    "v5.3-rc6",
    "v5.3-rc7",
    "v5.3-rc8",
    "v5.4",
    "v5.4-rc1",
    "v5.4-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2019-10207"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/bluetooth/hci_qca.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/bluetooth/hci_bcm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/bluetooth/hci_ldisc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/bluetooth/hci_ath.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/bluetooth/hci_uart.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/bluetooth/hci_intel.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/bluetooth/hci_mrvl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}