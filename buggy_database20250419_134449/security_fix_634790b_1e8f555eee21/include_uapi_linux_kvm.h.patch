commit 634790b82759c98ee57c80966d859083fa2fcd8c
Author: David Hildenbrand <dahi@linux.vnet.ibm.com>
Date:   Wed Nov 4 16:33:33 2015 +0100

    KVM: s390: migration / injection of prog irq ilc
    
    We have to migrate the program irq ilc and someday we will have to
    specify the ilc without KVM trying to autodetect the value.
    
    Let's reuse one of the spare fields in our program irq that should
    always be set to 0 by user space. Because we also want to make use
    of 0 ilcs ("not available"), we need a validity indicator.
    
    If no valid ilc is given, we try to autodetect the ilc via the current
    icptcode and icptstatus + parameter and store the valid ilc in the
    irq structure.
    
    This has a nice effect: QEMU's making use of KVM_S390_IRQ /
    KVM_S390_SET_IRQ_STATE / KVM_S390_GET_IRQ_STATE for migration will
    directly migrate the ilc without any changes.
    
    Please note that we use bit 0 as validity and bit 1,2 for the ilc, so
    by applying the ilc mask we directly get the ilen which is usually what
    we work with.
    
    Reviewed-by: Christian Borntraeger <borntraeger@de.ibm.com>
    Signed-off-by: David Hildenbrand <dahi@linux.vnet.ibm.com>
    Signed-off-by: Christian Borntraeger <borntraeger@de.ibm.com>

diff --git a/include/uapi/linux/kvm.h b/include/uapi/linux/kvm.h
index 9da905157cee..4e20a40bb10f 100644
--- a/include/uapi/linux/kvm.h
+++ b/include/uapi/linux/kvm.h
@@ -541,7 +541,12 @@ struct kvm_s390_pgm_info {
 	__u8 exc_access_id;
 	__u8 per_access_id;
 	__u8 op_access_id;
-	__u8 pad[3];
+#define KVM_S390_PGM_FLAGS_ILC_VALID	0x01
+#define KVM_S390_PGM_FLAGS_ILC_0	0x02
+#define KVM_S390_PGM_FLAGS_ILC_1	0x04
+#define KVM_S390_PGM_FLAGS_ILC_MASK	0x06
+	__u8 flags;
+	__u8 pad[2];
 };
 
 struct kvm_s390_prefix_info {