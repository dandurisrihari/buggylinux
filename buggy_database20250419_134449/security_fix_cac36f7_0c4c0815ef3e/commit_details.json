{
  "hash": "cac36f707119b792b2396aed371d6b5cdc194890",
  "hash_short": "cac36f70",
  "subject": "reiserfs: fix permissions on .reiserfs_priv",
  "body": "Commit 677c9b2e393a0cd203bd54e9c18b012b2c73305a (\"reiserfs: remove\nprivroot hiding in lookup\") removed the magic from the lookup code to hide\nthe .reiserfs_priv directory since it was getting loaded at mount-time\ninstead.  The intent was that the entry would be hidden from the user via\na poisoned d_compare, but this was faulty.\n\nThis introduced a security issue where unprivileged users could access and\nmodify extended attributes or ACLs belonging to other users, including\nroot.\n\nThis patch resolves the issue by properly hiding .reiserfs_priv.  This was\nthe intent of the xattr poisoning code, but it appears to have never\nworked as expected.  This is fixed by using d_revalidate instead of\nd_compare.\n\nThis patch makes -oexpose_privroot a no-op.  I'm fine leaving it this way.\nThe effort involved in working out the corner cases wrt permissions and\ncaching outweigh the benefit of the feature.\n\nSigned-off-by: Jeff Mahoney <jeffm@suse.com>\nAcked-by: Edward Shishkin <edward.shishkin@gmail.com>\nReported-by: Matt McCutchen <matt@mattmccutchen.net>\nTested-by: Matt McCutchen <matt@mattmccutchen.net>\nCc: Frederic Weisbecker <fweisbec@gmail.com>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: <stable@kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "reiserfs: fix permissions on .reiserfs_priv\n\nCommit 677c9b2e393a0cd203bd54e9c18b012b2c73305a (\"reiserfs: remove\nprivroot hiding in lookup\") removed the magic from the lookup code to hide\nthe .reiserfs_priv directory since it was getting loaded at mount-time\ninstead.  The intent was that the entry would be hidden from the user via\na poisoned d_compare, but this was faulty.\n\nThis introduced a security issue where unprivileged users could access and\nmodify extended attributes or ACLs belonging to other users, including\nroot.\n\nThis patch resolves the issue by properly hiding .reiserfs_priv.  This was\nthe intent of the xattr poisoning code, but it appears to have never\nworked as expected.  This is fixed by using d_revalidate instead of\nd_compare.\n\nThis patch makes -oexpose_privroot a no-op.  I'm fine leaving it this way.\nThe effort involved in working out the corner cases wrt permissions and\ncaching outweigh the benefit of the feature.\n\nSigned-off-by: Jeff Mahoney <jeffm@suse.com>\nAcked-by: Edward Shishkin <edward.shishkin@gmail.com>\nReported-by: Matt McCutchen <matt@mattmccutchen.net>\nTested-by: Matt McCutchen <matt@mattmccutchen.net>\nCc: Frederic Weisbecker <fweisbec@gmail.com>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: <stable@kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Jeff Mahoney",
  "author_email": "jeffm@suse.com",
  "author_date": "Fri Apr 23 13:17:37 2010 -0400",
  "author_date_iso": "2010-04-23T13:17:37-04:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Sat Apr 24 11:31:24 2010 -0700",
  "committer_date_iso": "2010-04-24T11:31:24-07:00",
  "files_changed": [
    "fs/reiserfs/dir.c",
    "fs/reiserfs/xattr.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "fs/reiserfs/dir.c",
      "insertions": 0,
      "deletions": 2
    },
    {
      "file": "fs/reiserfs/xattr.c",
      "insertions": 4,
      "deletions": 13
    }
  ],
  "total_insertions": 4,
  "total_deletions": 15,
  "total_changes": 19,
  "parents": [
    "33eaf788345c0311ab48ae62673c05f59fb09bb3"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.34",
    "v2.6.34-rc6",
    "v2.6.34-rc7",
    "v2.6.35",
    "v2.6.35-rc1",
    "v2.6.35-rc2",
    "v2.6.35-rc3",
    "v2.6.35-rc4",
    "v2.6.35-rc5",
    "v2.6.35-rc6"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security issue"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/reiserfs/dir.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/reiserfs/xattr.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}