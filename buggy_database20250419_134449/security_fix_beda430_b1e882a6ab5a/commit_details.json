{
  "hash": "beda430177f56656e7980dcce93456ffaa35676b",
  "hash_short": "beda4301",
  "subject": "KVM: x86: Ensure deadline timer has truly expired before posting its IRQ",
  "body": "When posting a deadline timer interrupt, open code the checks guarding\n__kvm_wait_lapic_expire() in order to skip the lapic_timer_int_injected()\ncheck in kvm_wait_lapic_expire().  The injection check will always fail\nsince the interrupt has not yet be injected.  Moving the call after\ninjection would also be wrong as that wouldn't actually delay delivery\nof the IRQ if it is indeed sent via posted interrupt.\n\nFixes: 010fd37fddf6 (\"KVM: LAPIC: Reduce world switch latency caused by timer_advance_ns\")\nCc: stable@vger.kernel.org\nSigned-off-by: Sean Christopherson <seanjc@google.com>\nMessage-Id: <20210305021808.3769732-1-seanjc@google.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "KVM: x86: Ensure deadline timer has truly expired before posting its IRQ\n\nWhen posting a deadline timer interrupt, open code the checks guarding\n__kvm_wait_lapic_expire() in order to skip the lapic_timer_int_injected()\ncheck in kvm_wait_lapic_expire().  The injection check will always fail\nsince the interrupt has not yet be injected.  Moving the call after\ninjection would also be wrong as that wouldn't actually delay delivery\nof the IRQ if it is indeed sent via posted interrupt.\n\nFixes: 010fd37fddf6 (\"KVM: LAPIC: Reduce world switch latency caused by timer_advance_ns\")\nCc: stable@vger.kernel.org\nSigned-off-by: Sean Christopherson <seanjc@google.com>\nMessage-Id: <20210305021808.3769732-1-seanjc@google.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Sean Christopherson",
  "author_email": "seanjc@google.com",
  "author_date": "Thu Mar 4 18:18:08 2021 -0800",
  "author_date_iso": "2021-03-04T18:18:08-08:00",
  "committer_name": "Paolo Bonzini",
  "committer_email": "pbonzini@redhat.com",
  "committer_date": "Fri Mar 5 08:30:21 2021 -0500",
  "committer_date_iso": "2021-03-05T08:30:21-05:00",
  "files_changed": [
    "arch/x86/kvm/lapic.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/x86/kvm/lapic.c",
      "insertions": 10,
      "deletions": 1
    }
  ],
  "total_insertions": 10,
  "total_deletions": 1,
  "total_changes": 11,
  "parents": [
    "9e46f6c6c959d9bb45445c2e8f04a75324a0dfd0"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/kvm/lapic.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}