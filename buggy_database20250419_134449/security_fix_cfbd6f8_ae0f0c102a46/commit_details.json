{
  "hash": "cfbd6f84c2e26c13ded16b6bb0871edb7d75974f",
  "hash_short": "cfbd6f84",
  "subject": "cifs: Fix broken sec=ntlmv2/i sec option (try #2)",
  "body": "Fix sec=ntlmv2/i authentication option during mount of Samba shares.\n\ncifs client was coding ntlmv2 response incorrectly.\nAll that is needed in temp as specified in MS-NLMP seciton 3.3.2\n\n\"Define ComputeResponse(NegFlg, ResponseKeyNT, ResponseKeyLM,\nCHALLENGE_MESSAGE.ServerChallenge, ClientChallenge, Time, ServerName)\n\nas\nSet temp to ConcatenationOf(Responserversion, HiResponserversion,\nZ(6), Time, ClientChallenge, Z(4), ServerName, Z(4)\"\n\nis MsvAvNbDomainName.\n\nFor sec=ntlmsspi, build_av_pair is not used, a blob is plucked from\ntype 2 response sent by the server to use in authentication.\n\nI tested sec=ntlmv2/i and sec=ntlmssp/i mount options against\nSamba (3.6) and Windows - XP, 2003 Server and 7.\nThey all worked.\n\nSigned-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>\nSigned-off-by: Steve French <sfrench@us.ibm.com>",
  "full_message": "cifs: Fix broken sec=ntlmv2/i sec option (try #2)\n\nFix sec=ntlmv2/i authentication option during mount of Samba shares.\n\ncifs client was coding ntlmv2 response incorrectly.\nAll that is needed in temp as specified in MS-NLMP seciton 3.3.2\n\n\"Define ComputeResponse(NegFlg, ResponseKeyNT, ResponseKeyLM,\nCHALLENGE_MESSAGE.ServerChallenge, ClientChallenge, Time, ServerName)\n\nas\nSet temp to ConcatenationOf(Responserversion, HiResponserversion,\nZ(6), Time, ClientChallenge, Z(4), ServerName, Z(4)\"\n\nis MsvAvNbDomainName.\n\nFor sec=ntlmsspi, build_av_pair is not used, a blob is plucked from\ntype 2 response sent by the server to use in authentication.\n\nI tested sec=ntlmv2/i and sec=ntlmssp/i mount options against\nSamba (3.6) and Windows - XP, 2003 Server and 7.\nThey all worked.\n\nSigned-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>\nSigned-off-by: Steve French <sfrench@us.ibm.com>",
  "author_name": "Shirish Pargaonkar",
  "author_email": "shirishpargaonkar@gmail.com",
  "author_date": "Wed Aug 24 23:05:46 2011 -0500",
  "author_date_iso": "2011-08-24T23:05:46-05:00",
  "committer_name": "Steve French",
  "committer_email": "sfrench@us.ibm.com",
  "committer_date": "Mon Sep 19 21:16:58 2011 -0500",
  "committer_date_iso": "2011-09-19T21:16:58-05:00",
  "files_changed": [
    "fs/cifs/cifsencrypt.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/cifs/cifsencrypt.c",
      "insertions": 11,
      "deletions": 43
    }
  ],
  "total_insertions": 11,
  "total_deletions": 43,
  "total_changes": 54,
  "parents": [
    "c9c7fa0064f4afe1d040e72f24c2256dd8ac402d"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.1",
    "v3.1-rc10",
    "v3.1-rc7",
    "v3.1-rc8",
    "v3.1-rc9",
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/cifs/cifsencrypt.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}