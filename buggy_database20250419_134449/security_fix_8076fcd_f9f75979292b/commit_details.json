{
  "hash": "8076fcde016c9c0e0660543e67bff86cb48a7c9c",
  "hash_short": "8076fcde",
  "subject": "x86/rfds: Mitigate Register File Data Sampling (RFDS)",
  "body": "RFDS is a CPU vulnerability that may allow userspace to infer kernel\nstale data previously used in floating point registers, vector registers\nand integer registers. RFDS only affects certain Intel Atom processors.\n\nIntel released a microcode update that uses VERW instruction to clear\nthe affected CPU buffers. Unlike MDS, none of the affected cores support\nSMT.\n\nAdd RFDS bug infrastructure and enable the VERW based mitigation by\ndefault, that clears the affected buffers just before exiting to\nuserspace. Also add sysfs reporting and cmdline parameter\n\"reg_file_data_sampling\" to control the mitigation.\n\nFor details see:\nDocumentation/admin-guide/hw-vuln/reg-file-data-sampling.rst\n\nSigned-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>\nSigned-off-by: Dave Hansen <dave.hansen@linux.intel.com>\nReviewed-by: Thomas Gleixner <tglx@linutronix.de>\nAcked-by: Josh Poimboeuf <jpoimboe@kernel.org>",
  "full_message": "x86/rfds: Mitigate Register File Data Sampling (RFDS)\n\nRFDS is a CPU vulnerability that may allow userspace to infer kernel\nstale data previously used in floating point registers, vector registers\nand integer registers. RFDS only affects certain Intel Atom processors.\n\nIntel released a microcode update that uses VERW instruction to clear\nthe affected CPU buffers. Unlike MDS, none of the affected cores support\nSMT.\n\nAdd RFDS bug infrastructure and enable the VERW based mitigation by\ndefault, that clears the affected buffers just before exiting to\nuserspace. Also add sysfs reporting and cmdline parameter\n\"reg_file_data_sampling\" to control the mitigation.\n\nFor details see:\nDocumentation/admin-guide/hw-vuln/reg-file-data-sampling.rst\n\nSigned-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>\nSigned-off-by: Dave Hansen <dave.hansen@linux.intel.com>\nReviewed-by: Thomas Gleixner <tglx@linutronix.de>\nAcked-by: Josh Poimboeuf <jpoimboe@kernel.org>",
  "author_name": "Pawan Gupta",
  "author_email": "pawan.kumar.gupta@linux.intel.com",
  "author_date": "Mon Mar 11 12:29:43 2024 -0700",
  "author_date_iso": "2024-03-11T12:29:43-07:00",
  "committer_name": "Dave Hansen",
  "committer_email": "dave.hansen@linux.intel.com",
  "committer_date": "Mon Mar 11 13:13:48 2024 -0700",
  "committer_date_iso": "2024-03-11T13:13:48-07:00",
  "files_changed": [
    "Documentation/ABI/testing/sysfs-devices-system-cpu",
    "Documentation/admin-guide/kernel-parameters.txt",
    "arch/x86/Kconfig",
    "arch/x86/include/asm/cpufeatures.h",
    "arch/x86/include/asm/msr-index.h",
    "arch/x86/kernel/cpu/bugs.c",
    "arch/x86/kernel/cpu/common.c",
    "drivers/base/cpu.c",
    "include/linux/cpu.h"
  ],
  "files_changed_count": 9,
  "stats": [
    {
      "file": "Documentation/ABI/testing/sysfs-devices-system-cpu",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "Documentation/admin-guide/kernel-parameters.txt",
      "insertions": 21,
      "deletions": 0
    },
    {
      "file": "arch/x86/Kconfig",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "arch/x86/include/asm/cpufeatures.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "arch/x86/include/asm/msr-index.h",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "arch/x86/kernel/cpu/bugs.c",
      "insertions": 75,
      "deletions": 3
    },
    {
      "file": "arch/x86/kernel/cpu/common.c",
      "insertions": 35,
      "deletions": 3
    },
    {
      "file": "drivers/base/cpu.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "include/linux/cpu.h",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 157,
  "total_deletions": 6,
  "total_changes": 163,
  "parents": [
    "4e42765d1be01111df0c0275bbaf1db1acef346e"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "Documentation/ABI/testing/sysfs-devices-system-cpu",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "Documentation/admin-guide/kernel-parameters.txt",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kernel/cpu/common.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/include/asm/cpufeatures.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/include/asm/msr-index.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/base/cpu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kernel/cpu/bugs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/cpu.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}