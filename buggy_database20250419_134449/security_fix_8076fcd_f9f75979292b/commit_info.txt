Commit Hash: 8076fcde016c9c0e0660543e67bff86cb48a7c9c
Subject: x86/rfds: Mitigate Register File Data Sampling (RFDS)


Security Keywords:
- vulnerability

Full commit message:
x86/rfds: Mitigate Register File Data Sampling (RFDS)

RFDS is a CPU vulnerability that may allow userspace to infer kernel
stale data previously used in floating point registers, vector registers
and integer registers. RFDS only affects certain Intel Atom processors.

Intel released a microcode update that uses VERW instruction to clear
the affected CPU buffers. Unlike MDS, none of the affected cores support
SMT.

Add RFDS bug infrastructure and enable the VERW based mitigation by
default, that clears the affected buffers just before exiting to
userspace. Also add sysfs reporting and cmdline parameter
"reg_file_data_sampling" to control the mitigation.

For details see:
Documentation/admin-guide/hw-vuln/reg-file-data-sampling.rst

Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Reviewed-by: Thomas Gleixner <tglx@linutronix.de>
Acked-by: Josh Poimboeuf <jpoimboe@kernel.org>

Metadata:
Author: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Author Date: Mon Mar 11 12:29:43 2024 -0700
Committer: Dave Hansen <dave.hansen@linux.intel.com>
Commit Date: Mon Mar 11 13:13:48 2024 -0700

Files Changed: 9
Lines Added: 157
Lines Removed: 6
Total Changes: 163
