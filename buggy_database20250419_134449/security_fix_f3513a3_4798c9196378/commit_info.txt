Commit Hash: f3513a335e71296a1851167b4e3b0e2bf09fc5f1
Subject: KVM: selftests: Assert that STI blocking isn't set after event injection


Security Keywords:
- injection

Full commit message:
KVM: selftests: Assert that STI blocking isn't set after event injection

Add an L1 (guest) assert to the nested exceptions test to verify that KVM
doesn't put VMRUN in an STI shadow (AMD CPUs bleed the shadow into the
guest's int_state if a #VMEXIT occurs before VMRUN fully completes).

Add a similar assert to the VMX side as well, because why not.

Reviewed-by: Jim Mattson <jmattson@google.com>
Link: https://lore.kernel.org/r/20250224165442.2338294-3-seanjc@google.com
Signed-off-by: Sean Christopherson <seanjc@google.com>

Metadata:
Author: Sean Christopherson <seanjc@google.com>
Author Date: Mon Feb 24 08:54:42 2025 -0800
Committer: Sean Christopherson <seanjc@google.com>
Commit Date: Fri Feb 28 09:15:23 2025 -0800

Files Changed: 1
Lines Added: 2
Lines Removed: 0
Total Changes: 2
