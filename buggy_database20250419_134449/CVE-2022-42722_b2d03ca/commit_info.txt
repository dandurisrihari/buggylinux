Commit Hash: b2d03cabe2b2e150ff5a381731ea0355459be09f
Subject: wifi: mac80211: fix crash in beacon protection for P2P-device

CVE Identifiers:
- CVE-2022-42722

Full commit message:
wifi: mac80211: fix crash in beacon protection for P2P-device

If beacon protection is active but the beacon cannot be
decrypted or is otherwise malformed, we call the cfg80211
API to report this to userspace, but that uses a netdev
pointer, which isn't present for P2P-Device. Fix this to
call it only conditionally to ensure cfg80211 won't crash
in the case of P2P-Device.

This fixes CVE-2022-42722.

Reported-by: SÃ¶nke Huster <shuster@seemoo.tu-darmstadt.de>
Fixes: 9eaf183af741 ("mac80211: Report beacon protection failures to user space")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Wed Oct 5 21:24:10 2022 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Mon Oct 10 09:51:25 2022 +0200

Files Changed: 1
Lines Added: 7
Lines Removed: 5
Total Changes: 12
