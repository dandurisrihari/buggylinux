{
  "hash": "b2d03cabe2b2e150ff5a381731ea0355459be09f",
  "hash_short": "b2d03cab",
  "subject": "wifi: mac80211: fix crash in beacon protection for P2P-device",
  "body": "If beacon protection is active but the beacon cannot be\ndecrypted or is otherwise malformed, we call the cfg80211\nAPI to report this to userspace, but that uses a netdev\npointer, which isn't present for P2P-Device. Fix this to\ncall it only conditionally to ensure cfg80211 won't crash\nin the case of P2P-Device.\n\nThis fixes CVE-2022-42722.\n\nReported-by: S\u00f6nke Huster <shuster@seemoo.tu-darmstadt.de>\nFixes: 9eaf183af741 (\"mac80211: Report beacon protection failures to user space\")\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: mac80211: fix crash in beacon protection for P2P-device\n\nIf beacon protection is active but the beacon cannot be\ndecrypted or is otherwise malformed, we call the cfg80211\nAPI to report this to userspace, but that uses a netdev\npointer, which isn't present for P2P-Device. Fix this to\ncall it only conditionally to ensure cfg80211 won't crash\nin the case of P2P-Device.\n\nThis fixes CVE-2022-42722.\n\nReported-by: S\u00f6nke Huster <shuster@seemoo.tu-darmstadt.de>\nFixes: 9eaf183af741 (\"mac80211: Report beacon protection failures to user space\")\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Wed Oct 5 21:24:10 2022 +0200",
  "author_date_iso": "2022-10-05T21:24:10+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Mon Oct 10 09:51:25 2022 +0200",
  "committer_date_iso": "2022-10-10T09:51:25+02:00",
  "files_changed": [
    "net/mac80211/rx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/rx.c",
      "insertions": 7,
      "deletions": 5
    }
  ],
  "total_insertions": 7,
  "total_deletions": 5,
  "total_changes": 12,
  "parents": [
    "1833b6f46d7e2830251a063935ab464256defe22"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-42722"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/rx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}