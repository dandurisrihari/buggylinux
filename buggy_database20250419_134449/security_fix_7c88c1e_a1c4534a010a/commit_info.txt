Commit Hash: 7c88c1e0ab1704bacb751341ee6431c3be34b834
Subject: ksmbd: Fix user namespace mapping


Security Keywords:
- security fix
- bypass

Full commit message:
ksmbd: Fix user namespace mapping

A kernel daemon should not rely on the current thread, which is unknown
and might be malicious.  Before this security fix,
ksmbd_override_fsids() didn't correctly override FS UID/GID which means
that arbitrary user space threads could trick the kernel to impersonate
arbitrary users or groups for file system access checks, leading to
file system access bypass.

This was found while investigating truncate support for Landlock:
https://lore.kernel.org/r/CAKYAXd8fpMJ7guizOjHgxEyyjoUwPsx3jLOPZP=wPYcbhkVXqA@mail.gmail.com

Fixes: e2f34481b24d ("cifsd: add server-side procedures for SMB3")
Cc: Hyunchul Lee <hyc.lee@gmail.com>
Cc: Steve French <smfrench@gmail.com>
Cc: stable@vger.kernel.org
Signed-off-by: Mickaël Salaün <mic@digikod.net>
Link: https://lore.kernel.org/r/20220929100447.108468-1-mic@digikod.net
Acked-by: Christian Brauner (Microsoft) <brauner@kernel.org>
Acked-by: Namjae Jeon <linkinjeon@kernel.org>
Signed-off-by: Steve French <stfrench@microsoft.com>

Metadata:
Author: Mickaël Salaün <mic@digikod.net>
Author Date: Thu Sep 29 12:04:47 2022 +0200
Committer: Steve French <stfrench@microsoft.com>
Commit Date: Wed Oct 5 01:15:44 2022 -0500

Files Changed: 1
Lines Added: 4
Lines Removed: 2
Total Changes: 6
