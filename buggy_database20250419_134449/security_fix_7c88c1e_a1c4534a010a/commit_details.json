{
  "hash": "7c88c1e0ab1704bacb751341ee6431c3be34b834",
  "hash_short": "7c88c1e0",
  "subject": "ksmbd: Fix user namespace mapping",
  "body": "A kernel daemon should not rely on the current thread, which is unknown\nand might be malicious.  Before this security fix,\nksmbd_override_fsids() didn't correctly override FS UID/GID which means\nthat arbitrary user space threads could trick the kernel to impersonate\narbitrary users or groups for file system access checks, leading to\nfile system access bypass.\n\nThis was found while investigating truncate support for Landlock:\nhttps://lore.kernel.org/r/CAKYAXd8fpMJ7guizOjHgxEyyjoUwPsx3jLOPZP=wPYcbhkVXqA@mail.gmail.com\n\nFixes: e2f34481b24d (\"cifsd: add server-side procedures for SMB3\")\nCc: Hyunchul Lee <hyc.lee@gmail.com>\nCc: Steve French <smfrench@gmail.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Micka\u00ebl Sala\u00fcn <mic@digikod.net>\nLink: https://lore.kernel.org/r/20220929100447.108468-1-mic@digikod.net\nAcked-by: Christian Brauner (Microsoft) <brauner@kernel.org>\nAcked-by: Namjae Jeon <linkinjeon@kernel.org>\nSigned-off-by: Steve French <stfrench@microsoft.com>",
  "full_message": "ksmbd: Fix user namespace mapping\n\nA kernel daemon should not rely on the current thread, which is unknown\nand might be malicious.  Before this security fix,\nksmbd_override_fsids() didn't correctly override FS UID/GID which means\nthat arbitrary user space threads could trick the kernel to impersonate\narbitrary users or groups for file system access checks, leading to\nfile system access bypass.\n\nThis was found while investigating truncate support for Landlock:\nhttps://lore.kernel.org/r/CAKYAXd8fpMJ7guizOjHgxEyyjoUwPsx3jLOPZP=wPYcbhkVXqA@mail.gmail.com\n\nFixes: e2f34481b24d (\"cifsd: add server-side procedures for SMB3\")\nCc: Hyunchul Lee <hyc.lee@gmail.com>\nCc: Steve French <smfrench@gmail.com>\nCc: stable@vger.kernel.org\nSigned-off-by: Micka\u00ebl Sala\u00fcn <mic@digikod.net>\nLink: https://lore.kernel.org/r/20220929100447.108468-1-mic@digikod.net\nAcked-by: Christian Brauner (Microsoft) <brauner@kernel.org>\nAcked-by: Namjae Jeon <linkinjeon@kernel.org>\nSigned-off-by: Steve French <stfrench@microsoft.com>",
  "author_name": "Micka\u00ebl Sala\u00fcn",
  "author_email": "mic@digikod.net",
  "author_date": "Thu Sep 29 12:04:47 2022 +0200",
  "author_date_iso": "2022-09-29T12:04:47+02:00",
  "committer_name": "Steve French",
  "committer_email": "stfrench@microsoft.com",
  "committer_date": "Wed Oct 5 01:15:44 2022 -0500",
  "committer_date_iso": "2022-10-05T01:15:44-05:00",
  "files_changed": [
    "fs/ksmbd/smb_common.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/ksmbd/smb_common.c",
      "insertions": 4,
      "deletions": 2
    }
  ],
  "total_insertions": 4,
  "total_deletions": 2,
  "total_changes": 6,
  "parents": [
    "5876e99611a91dfb2fb1f7af9d1ae5c017c8331c"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security fix",
      "bypass"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/ksmbd/smb_common.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}