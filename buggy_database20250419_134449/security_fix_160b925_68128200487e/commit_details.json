{
  "hash": "160b925163c0aabc2c2fbb7d58a75e38b7cd6a17",
  "hash_short": "160b9251",
  "subject": "Bluetooth: Add Authentication Failed reason to Disconnected Mgmt event",
  "body": "If link is disconnected due to Authentication Failure (PIN or Key\nMissing status) userspace will be notified about this with proper error\ncode. Many LE profiles define \"PIN or Key Missing\" status as indication\nof remote lost bond so this allows userspace to take action on this.\n\n@ Device Connected: 88:63:DF:88:0E:83 (1) flags 0x0000\n        02 01 1a 05 03 0a 18 0d 18 0b 09 48 65 61 72 74  ...........Heart\n        20 52 61 74 65                                    Rate\n> HCI Event: Command Status (0x0f) plen 4\n      LE Read Remote Used Features (0x08|0x0016) ncmd 1\n        Status: Success (0x00)\n> ACL Data RX: Handle 3585 flags 0x02 dlen 11\n      ATT: Read By Group Type Request (0x10) len 6\n        Handle range: 0x0001-0xffff\n        Attribute group type: Primary Service (0x2800)\n> HCI Event: LE Meta Event (0x3e) plen 12\n      LE Read Remote Used Features (0x04)\n        Status: Success (0x00)\n        Handle: 3585\n        Features: 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n          LE Encryption\n< HCI Command: LE Start Encryption (0x08|0x0019) plen 28\n        Handle: 3585\n        Random number: 0x0000000000000000\n        Encrypted diversifier: 0x0000\n        Long term key: 26201cd479a0921b6f949f0b1fa8dc82\n> HCI Event: Command Status (0x0f) plen 4\n      LE Start Encryption (0x08|0x0019) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Encryption Change (0x08) plen 4\n        Status: PIN or Key Missing (0x06)\n        Handle: 3585\n        Encryption: Disabled (0x00)\n< HCI Command: Disconnect (0x01|0x0006) plen 3\n        Handle: 3585\n        Reason: Authentication Failure (0x05)\n> HCI Event: Command Status (0x0f) plen 4\n      Disconnect (0x01|0x0006) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Disconnect Complete (0x05) plen 4\n        Status: Success (0x00)\n        Handle: 3585\n        Reason: Connection Terminated By Local Host (0x16)\n@ Device Disconnected: 88:63:DF:88:0E:83 (1) reason 4\n\n@ Device Connected: C4:43:8F:A3:4D:83 (0) flags 0x0000\n        08 09 4e 65 78 75 73 20 35                       ..Nexus 5\n> HCI Event: Command Status (0x0f) plen 4\n      Authentication Requested (0x01|0x0011) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Link Key Request (0x17) plen 6\n        Address: C4:43:8F:A3:4D:83 (LG Electronics)\n< HCI Command: Link Key Request Reply (0x01|0x000b) plen 22\n        Address: C4:43:8F:A3:4D:83 (LG Electronics)\n        Link key: 080812e4aa97a863d11826f71f65a933\n> HCI Event: Command Complete (0x0e) plen 10\n      Link Key Request Reply (0x01|0x000b) ncmd 1\n        Status: Success (0x00)\n        Address: C4:43:8F:A3:4D:83 (LG Electronics)\n> HCI Event: Auth Complete (0x06) plen 3\n        Status: PIN or Key Missing (0x06)\n        Handle: 75\n@ Authentication Failed: C4:43:8F:A3:4D:83 (0) status 0x05\n< HCI Command: Disconnect (0x01|0x0006) plen 3\n        Handle: 75\n        Reason: Remote User Terminated Connection (0x13)\n> HCI Event: Command Status (0x0f) plen 4\n      Disconnect (0x01|0x0006) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Disconnect Complete (0x05) plen 4\n        Status: Success (0x00)\n        Handle: 75\n        Reason: Connection Terminated By Local Host (0x16)\n@ Device Disconnected: C4:43:8F:A3:4D:83 (0) reason 4\n\nSigned-off-by: Szymon Janc <szymon.janc@codecoup.pl>\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>",
  "full_message": "Bluetooth: Add Authentication Failed reason to Disconnected Mgmt event\n\nIf link is disconnected due to Authentication Failure (PIN or Key\nMissing status) userspace will be notified about this with proper error\ncode. Many LE profiles define \"PIN or Key Missing\" status as indication\nof remote lost bond so this allows userspace to take action on this.\n\n@ Device Connected: 88:63:DF:88:0E:83 (1) flags 0x0000\n        02 01 1a 05 03 0a 18 0d 18 0b 09 48 65 61 72 74  ...........Heart\n        20 52 61 74 65                                    Rate\n> HCI Event: Command Status (0x0f) plen 4\n      LE Read Remote Used Features (0x08|0x0016) ncmd 1\n        Status: Success (0x00)\n> ACL Data RX: Handle 3585 flags 0x02 dlen 11\n      ATT: Read By Group Type Request (0x10) len 6\n        Handle range: 0x0001-0xffff\n        Attribute group type: Primary Service (0x2800)\n> HCI Event: LE Meta Event (0x3e) plen 12\n      LE Read Remote Used Features (0x04)\n        Status: Success (0x00)\n        Handle: 3585\n        Features: 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n          LE Encryption\n< HCI Command: LE Start Encryption (0x08|0x0019) plen 28\n        Handle: 3585\n        Random number: 0x0000000000000000\n        Encrypted diversifier: 0x0000\n        Long term key: 26201cd479a0921b6f949f0b1fa8dc82\n> HCI Event: Command Status (0x0f) plen 4\n      LE Start Encryption (0x08|0x0019) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Encryption Change (0x08) plen 4\n        Status: PIN or Key Missing (0x06)\n        Handle: 3585\n        Encryption: Disabled (0x00)\n< HCI Command: Disconnect (0x01|0x0006) plen 3\n        Handle: 3585\n        Reason: Authentication Failure (0x05)\n> HCI Event: Command Status (0x0f) plen 4\n      Disconnect (0x01|0x0006) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Disconnect Complete (0x05) plen 4\n        Status: Success (0x00)\n        Handle: 3585\n        Reason: Connection Terminated By Local Host (0x16)\n@ Device Disconnected: 88:63:DF:88:0E:83 (1) reason 4\n\n@ Device Connected: C4:43:8F:A3:4D:83 (0) flags 0x0000\n        08 09 4e 65 78 75 73 20 35                       ..Nexus 5\n> HCI Event: Command Status (0x0f) plen 4\n      Authentication Requested (0x01|0x0011) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Link Key Request (0x17) plen 6\n        Address: C4:43:8F:A3:4D:83 (LG Electronics)\n< HCI Command: Link Key Request Reply (0x01|0x000b) plen 22\n        Address: C4:43:8F:A3:4D:83 (LG Electronics)\n        Link key: 080812e4aa97a863d11826f71f65a933\n> HCI Event: Command Complete (0x0e) plen 10\n      Link Key Request Reply (0x01|0x000b) ncmd 1\n        Status: Success (0x00)\n        Address: C4:43:8F:A3:4D:83 (LG Electronics)\n> HCI Event: Auth Complete (0x06) plen 3\n        Status: PIN or Key Missing (0x06)\n        Handle: 75\n@ Authentication Failed: C4:43:8F:A3:4D:83 (0) status 0x05\n< HCI Command: Disconnect (0x01|0x0006) plen 3\n        Handle: 75\n        Reason: Remote User Terminated Connection (0x13)\n> HCI Event: Command Status (0x0f) plen 4\n      Disconnect (0x01|0x0006) ncmd 1\n        Status: Success (0x00)\n> HCI Event: Disconnect Complete (0x05) plen 4\n        Status: Success (0x00)\n        Handle: 75\n        Reason: Connection Terminated By Local Host (0x16)\n@ Device Disconnected: C4:43:8F:A3:4D:83 (0) reason 4\n\nSigned-off-by: Szymon Janc <szymon.janc@codecoup.pl>\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>",
  "author_name": "Szymon Janc",
  "author_email": "szymon.janc@codecoup.pl",
  "author_date": "Tue Jul 12 02:12:16 2016 +0200",
  "author_date_iso": "2016-07-12T02:12:16+02:00",
  "committer_name": "Johan Hedberg",
  "committer_email": "johan.hedberg@intel.com",
  "committer_date": "Wed Jul 13 08:32:12 2016 +0300",
  "committer_date_iso": "2016-07-13T08:32:12+03:00",
  "files_changed": [
    "include/net/bluetooth/hci.h",
    "include/net/bluetooth/hci_core.h",
    "include/net/bluetooth/mgmt.h",
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "include/net/bluetooth/hci.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/net/bluetooth/hci_core.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/net/bluetooth/mgmt.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 15,
      "deletions": 1
    }
  ],
  "total_insertions": 18,
  "total_deletions": 1,
  "total_changes": 19,
  "parents": [
    "3faf56437239326113a3c4b99ab8204e2b09c2e4"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/bluetooth/hci.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/net/bluetooth/hci_core.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/net/bluetooth/mgmt.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}