{
  "hash": "be24dd486d45a1846866615bd4ec5f5192ea5de4",
  "hash_short": "be24dd48",
  "subject": "Merge tag 'misc-habanalabs-next-2021-10-18' of https://git.kernel.org/pub/scm/linux/kernel/git/ogabbay/linux into char-misc-next",
  "body": "Oded writes:\n\nThis tag contains habanalabs driver changes for v5.16:\n\n- Add a new uAPI (under the memory ioctl) to request from the driver\n  to export a DMA-BUF object that represents a memory region on\n  the device's DRAM. This is needed to enable peer-to-peer over PCIe\n  between habana device and an RDMA adapter (e.g. mlnx5 or efa\n  rdma adapter).\n\n- Add debugfs node to dynamically configure CS timeout. Up until now,\n  it was only configurable through kernel module parameter.\n\n- Fetch more comprehensive power information from the firmware.\n\n- Always take timestamp when waiting for user interrupt, as the user\n  needs that information to optimize the graph runtime compilation.\n\n- Modify user interrupt to look on 64-bit user value as fence, instead\n  of 32-bit.\n\n- Bypass reset in case of repeated h/w error event after device reset.\n  This is to prevent endless loop of resets to the device.\n\n- Fix several bugs in multi CS completion code.\n\n- Fix race condition in fd close/open.\n\n- Update to latest firmware headers\n\n- Add select CRC32 in kconfig\n\n- Small fixes, cosmetics\n\n* tag 'misc-habanalabs-next-2021-10-18' of https://git.kernel.org/pub/scm/linux/kernel/git/ogabbay/linux: (25 commits)\n  habanalabs: refactor fence handling in hl_cs_poll_fences\n  habanalabs: context cleanup cosmetics\n  habanalabs: simplify wait for interrupt with timestamp flow\n  habanalabs: initialize hpriv fields before adding new node\n  habanalabs: Unify frequency set/get functionality\n  habanalabs: select CRC32\n  habanalabs: add support for dma-buf exporter\n  habanalabs: define uAPI to export FD for DMA-BUF\n  habanalabs: fix NULL pointer dereference\n  habanalabs: fix race condition in multi CS completion\n  habanalabs: use only u32\n  habanalabs: update firmware files\n  habanalabs: bypass reset for continuous h/w error event\n  habanalabs: take timestamp on wait for interrupt\n  habanalabs: prevent race between fd close/open\n  habanalabs: refactor reset log message\n  habanalabs: define soft-reset as inference op\n  habanalabs: fix debugfs device memory MMU VA translation\n  habanalabs: add support for a long interrupt target value\n  habanalabs: remove redundant cs validity checks\n  ...",
  "full_message": "Merge tag 'misc-habanalabs-next-2021-10-18' of https://git.kernel.org/pub/scm/linux/kernel/git/ogabbay/linux into char-misc-next\n\nOded writes:\n\nThis tag contains habanalabs driver changes for v5.16:\n\n- Add a new uAPI (under the memory ioctl) to request from the driver\n  to export a DMA-BUF object that represents a memory region on\n  the device's DRAM. This is needed to enable peer-to-peer over PCIe\n  between habana device and an RDMA adapter (e.g. mlnx5 or efa\n  rdma adapter).\n\n- Add debugfs node to dynamically configure CS timeout. Up until now,\n  it was only configurable through kernel module parameter.\n\n- Fetch more comprehensive power information from the firmware.\n\n- Always take timestamp when waiting for user interrupt, as the user\n  needs that information to optimize the graph runtime compilation.\n\n- Modify user interrupt to look on 64-bit user value as fence, instead\n  of 32-bit.\n\n- Bypass reset in case of repeated h/w error event after device reset.\n  This is to prevent endless loop of resets to the device.\n\n- Fix several bugs in multi CS completion code.\n\n- Fix race condition in fd close/open.\n\n- Update to latest firmware headers\n\n- Add select CRC32 in kconfig\n\n- Small fixes, cosmetics\n\n* tag 'misc-habanalabs-next-2021-10-18' of https://git.kernel.org/pub/scm/linux/kernel/git/ogabbay/linux: (25 commits)\n  habanalabs: refactor fence handling in hl_cs_poll_fences\n  habanalabs: context cleanup cosmetics\n  habanalabs: simplify wait for interrupt with timestamp flow\n  habanalabs: initialize hpriv fields before adding new node\n  habanalabs: Unify frequency set/get functionality\n  habanalabs: select CRC32\n  habanalabs: add support for dma-buf exporter\n  habanalabs: define uAPI to export FD for DMA-BUF\n  habanalabs: fix NULL pointer dereference\n  habanalabs: fix race condition in multi CS completion\n  habanalabs: use only u32\n  habanalabs: update firmware files\n  habanalabs: bypass reset for continuous h/w error event\n  habanalabs: take timestamp on wait for interrupt\n  habanalabs: prevent race between fd close/open\n  habanalabs: refactor reset log message\n  habanalabs: define soft-reset as inference op\n  habanalabs: fix debugfs device memory MMU VA translation\n  habanalabs: add support for a long interrupt target value\n  habanalabs: remove redundant cs validity checks\n  ...",
  "author_name": "Greg Kroah-Hartman",
  "author_email": "gregkh@linuxfoundation.org",
  "author_date": "Tue Oct 19 09:37:59 2021 +0200",
  "author_date_iso": "2021-10-19T09:37:59+02:00",
  "committer_name": "Greg Kroah-Hartman",
  "committer_email": "gregkh@linuxfoundation.org",
  "committer_date": "Tue Oct 19 09:37:59 2021 +0200",
  "committer_date_iso": "2021-10-19T09:37:59+02:00",
  "files_changed": [],
  "files_changed_count": 0,
  "stats": [
    {
      "file": "Documentation/ABI/testing/debugfs-driver-habanalabs",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "drivers/misc/habanalabs/Kconfig",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/misc/habanalabs/common/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/misc/habanalabs/common/command_submission.c",
      "insertions": 72,
      "deletions": 33
    },
    {
      "file": "drivers/misc/habanalabs/common/context.c",
      "insertions": 1,
      "deletions": 7
    },
    {
      "file": "drivers/misc/habanalabs/common/debugfs.c",
      "insertions": 51,
      "deletions": 0
    },
    {
      "file": "drivers/misc/habanalabs/common/device.c",
      "insertions": 116,
      "deletions": 43
    },
    {
      "file": "drivers/misc/habanalabs/common/firmware_if.c",
      "insertions": 18,
      "deletions": 10
    },
    {
      "file": "drivers/misc/habanalabs/common/habanalabs.h",
      "insertions": 61,
      "deletions": 3
    },
    {
      "file": "drivers/misc/habanalabs/common/habanalabs_drv.c",
      "insertions": 16,
      "deletions": 8
    },
    {
      "file": "drivers/misc/habanalabs/{gaudi/gaudi_hwmgr.c => common/hwmgr.c}",
      "insertions": 17,
      "deletions": 21
    },
    {
      "file": "drivers/misc/habanalabs/common/hwmon.c",
      "insertions": 185,
      "deletions": 9
    },
    {
      "file": "drivers/misc/habanalabs/common/irq.c",
      "insertions": 4,
      "deletions": 1
    },
    {
      "file": "drivers/misc/habanalabs/common/memory.c",
      "insertions": 510,
      "deletions": 3
    },
    {
      "file": "drivers/misc/habanalabs/common/mmu/mmu.c",
      "insertions": 16,
      "deletions": 14
    },
    {
      "file": "drivers/misc/habanalabs/common/sysfs.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "drivers/misc/habanalabs/gaudi/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/misc/habanalabs/gaudi/gaudi.c",
      "insertions": 14,
      "deletions": 8
    },
    {
      "file": "drivers/misc/habanalabs/gaudi/gaudiP.h",
      "insertions": 0,
      "deletions": 4
    },
    {
      "file": "drivers/misc/habanalabs/goya/goya.c",
      "insertions": 11,
      "deletions": 2
    },
    {
      "file": "drivers/misc/habanalabs/goya/goyaP.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/misc/habanalabs/goya/goya_hwmgr.c",
      "insertions": 0,
      "deletions": 31
    },
    {
      "file": "drivers/misc/habanalabs/include/common/cpucp_if.h",
      "insertions": 21,
      "deletions": 1
    },
    {
      "file": "drivers/misc/habanalabs/include/common/hl_boot_if.h",
      "insertions": 119,
      "deletions": 70
    },
    {
      "file": "drivers/misc/habanalabs/include/gaudi/gaudi_fw_if.h",
      "insertions": 4,
      "deletions": 6
    },
    {
      "file": "drivers/misc/habanalabs/include/gaudi/gaudi_reg_map.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/uapi/misc/habanalabs.h",
      "insertions": 59,
      "deletions": 25
    }
  ],
  "total_insertions": 1309,
  "total_deletions": 305,
  "total_changes": 1614,
  "parents": [
    "2b74240be3fb406f6faf41971ef7379e9fce0e8d",
    "b2faac3887df87a6e4bc3356280ea35dc7459c0b"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Bypass"
    ]
  },
  "fix_type": "security",
  "file_results": []
}