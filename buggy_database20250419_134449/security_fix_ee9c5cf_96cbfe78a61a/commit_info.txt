Commit Hash: ee9c5cfad29c8a13199962614b9b16f1c4137ac9
Subject: niu: Fix kernel buffer overflow for ETHTOOL_GRXCLSRLALL


Security Keywords:
- vulnerability

Full commit message:
niu: Fix kernel buffer overflow for ETHTOOL_GRXCLSRLALL

niu_get_ethtool_tcam_all() assumes that its output buffer is the right
size, and warns before returning if it is not.  However, the output
buffer size is under user control and ETHTOOL_GRXCLSRLALL is an
unprivileged ethtool command.  Therefore this is at least a local
denial-of-service vulnerability.

Change it to check before writing each entry and to return an error if
the buffer is already full.

Compile-tested only.

Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Ben Hutchings <bhutchings@solarflare.com>
Author Date: Tue Sep 7 04:35:19 2010 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Wed Sep 8 14:01:52 2010 -0700

Files Changed: 1
Lines Added: 6
Lines Removed: 10
Total Changes: 16
