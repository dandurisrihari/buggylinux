{
  "hash": "4b08a8f1bd8cb4541c93ec170027b4d0782dab52",
  "hash_short": "4b08a8f1",
  "subject": "ipv6: remove max_addresses check from ipv6_create_tempaddr",
  "body": "Because of the max_addresses check attackers were able to disable privacy\nextensions on an interface by creating enough autoconfigured addresses:\n\n<http://seclists.org/oss-sec/2012/q4/292>\n\nBut the check is not actually needed: max_addresses protects the\nkernel to install too many ipv6 addresses on an interface and guards\naddrconf_prefix_rcv to install further addresses as soon as this limit\nis reached. We only generate temporary addresses in direct response of\na new address showing up. As soon as we filled up the maximum number of\naddresses of an interface, we stop installing more addresses and thus\nalso stop generating more temp addresses.\n\nEven if the attacker tries to generate a lot of temporary addresses\nby announcing a prefix and removing it again (lifetime == 0) we won't\ninstall more temp addresses, because the temporary addresses do count\nto the maximum number of addresses, thus we would stop installing new\nautoconfigured addresses when the limit is reached.\n\nThis patch fixes CVE-2013-0343 (but other layer-2 attacks are still\npossible).\n\nThanks to Ding Tianhong to bring this topic up again.\n\nCc: Ding Tianhong <dingtianhong@huawei.com>\nCc: George Kargiotakis <kargig@void.gr>\nCc: P J P <ppandit@redhat.com>\nCc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nAcked-by: Ding Tianhong <dingtianhong@huawei.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "ipv6: remove max_addresses check from ipv6_create_tempaddr\n\nBecause of the max_addresses check attackers were able to disable privacy\nextensions on an interface by creating enough autoconfigured addresses:\n\n<http://seclists.org/oss-sec/2012/q4/292>\n\nBut the check is not actually needed: max_addresses protects the\nkernel to install too many ipv6 addresses on an interface and guards\naddrconf_prefix_rcv to install further addresses as soon as this limit\nis reached. We only generate temporary addresses in direct response of\na new address showing up. As soon as we filled up the maximum number of\naddresses of an interface, we stop installing more addresses and thus\nalso stop generating more temp addresses.\n\nEven if the attacker tries to generate a lot of temporary addresses\nby announcing a prefix and removing it again (lifetime == 0) we won't\ninstall more temp addresses, because the temporary addresses do count\nto the maximum number of addresses, thus we would stop installing new\nautoconfigured addresses when the limit is reached.\n\nThis patch fixes CVE-2013-0343 (but other layer-2 attacks are still\npossible).\n\nThanks to Ding Tianhong to bring this topic up again.\n\nCc: Ding Tianhong <dingtianhong@huawei.com>\nCc: George Kargiotakis <kargig@void.gr>\nCc: P J P <ppandit@redhat.com>\nCc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org>\nSigned-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nAcked-by: Ding Tianhong <dingtianhong@huawei.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Hannes Frederic Sowa",
  "author_email": "hannes@stressinduktion.org",
  "author_date": "Fri Aug 16 13:02:27 2013 +0200",
  "author_date_iso": "2013-08-16T13:02:27+02:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Aug 20 00:11:24 2013 -0700",
  "committer_date_iso": "2013-08-20T00:11:24-07:00",
  "files_changed": [
    "net/ipv6/addrconf.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/ipv6/addrconf.c",
      "insertions": 4,
      "deletions": 6
    }
  ],
  "total_insertions": 4,
  "total_deletions": 6,
  "total_changes": 10,
  "parents": [
    "fd3930f70c8d14008f3377d51ce039806dfc542e"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.11",
    "v3.11-rc7",
    "v3.12",
    "v3.12-rc1",
    "v3.12-rc2",
    "v3.12-rc3",
    "v3.12-rc4",
    "v3.12-rc5",
    "v3.12-rc6",
    "v3.12-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2013-0343"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/ipv6/addrconf.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}