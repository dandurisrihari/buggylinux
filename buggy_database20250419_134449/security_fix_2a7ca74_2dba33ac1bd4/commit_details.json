{
  "hash": "2a7ca7459d905febf519163bd9e3eed894de6bb7",
  "hash_short": "2a7ca745",
  "subject": "Bluetooth: cmtp: fix possible panic when cmtp_init_sockets() fails",
  "body": "I got a kernel BUG report when doing fault injection test:\n\n------------[ cut here ]------------\nkernel BUG at lib/list_debug.c:45!\n...\nRIP: 0010:__list_del_entry_valid.cold+0x12/0x4d\n...\nCall Trace:\n proto_unregister+0x83/0x220\n cmtp_cleanup_sockets+0x37/0x40 [cmtp]\n cmtp_exit+0xe/0x1f [cmtp]\n do_syscall_64+0x35/0xb0\n entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nIf cmtp_init_sockets() in cmtp_init() fails, cmtp_init() still returns\nsuccess. This will cause a kernel bug when accessing uncreated ctmp\nrelated data when the module exits.\n\nFixes: 1da177e4c3f4 (\"Linux-2.6.12-rc2\")\nReported-by: Hulk Robot <hulkci@huawei.com>\nSigned-off-by: Wang Hai <wanghai38@huawei.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "Bluetooth: cmtp: fix possible panic when cmtp_init_sockets() fails\n\nI got a kernel BUG report when doing fault injection test:\n\n------------[ cut here ]------------\nkernel BUG at lib/list_debug.c:45!\n...\nRIP: 0010:__list_del_entry_valid.cold+0x12/0x4d\n...\nCall Trace:\n proto_unregister+0x83/0x220\n cmtp_cleanup_sockets+0x37/0x40 [cmtp]\n cmtp_exit+0xe/0x1f [cmtp]\n do_syscall_64+0x35/0xb0\n entry_SYSCALL_64_after_hwframe+0x44/0xae\n\nIf cmtp_init_sockets() in cmtp_init() fails, cmtp_init() still returns\nsuccess. This will cause a kernel bug when accessing uncreated ctmp\nrelated data when the module exits.\n\nFixes: 1da177e4c3f4 (\"Linux-2.6.12-rc2\")\nReported-by: Hulk Robot <hulkci@huawei.com>\nSigned-off-by: Wang Hai <wanghai38@huawei.com>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Wang Hai",
  "author_email": "wanghai38@huawei.com",
  "author_date": "Mon Oct 25 21:10:12 2021 +0800",
  "author_date_iso": "2021-10-25T21:10:12+08:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Mon Oct 25 15:02:04 2021 +0200",
  "committer_date_iso": "2021-10-25T15:02:04+02:00",
  "files_changed": [
    "net/bluetooth/cmtp/core.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/cmtp/core.c",
      "insertions": 1,
      "deletions": 3
    }
  ],
  "total_insertions": 1,
  "total_deletions": 3,
  "total_changes": 4,
  "parents": [
    "f33b0068cdaf2b9998fa3662585858ef30bc4b9e"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/cmtp/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}