{
  "hash": "829ee279aed43faa5cb1e4d65c0cad52f2426c53",
  "hash_short": "829ee279",
  "subject": "KVM: MMU: always terminate page walks at level 1",
  "body": "is_last_gpte() is not equivalent to the pseudo-code given in commit\n6bb69c9b69c31 (\"KVM: MMU: simplify last_pte_bitmap\") because an incorrect\nvalue of last_nonleaf_level may override the result even if level == 1.\n\nIt is critical for is_last_gpte() to return true on level == 1 to\nterminate page walks. Otherwise memory corruption may occur as level\nis used as an index to various data structures throughout the page\nwalking code.  Even though the actual bug would be wherever the MMU is\ninitialized (as in the previous patch), be defensive and ensure here\nthat is_last_gpte() returns the correct value.\n\nThis patch is also enough to fix CVE-2017-12188.\n\nFixes: 6bb69c9b69c315200ddc2bc79aee14c0184cf5b2\nCc: stable@vger.kernel.org\nCc: Andy Honig <ahonig@google.com>\nSigned-off-by: Ladi Prosek <lprosek@redhat.com>\n[Panic if walk_addr_generic gets an incorrect level; this is a serious\n bug and it's not worth a WARN_ON where the recovery path might hide\n further exploitable issues; suggested by Andrew Honig. - Paolo]\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "KVM: MMU: always terminate page walks at level 1\n\nis_last_gpte() is not equivalent to the pseudo-code given in commit\n6bb69c9b69c31 (\"KVM: MMU: simplify last_pte_bitmap\") because an incorrect\nvalue of last_nonleaf_level may override the result even if level == 1.\n\nIt is critical for is_last_gpte() to return true on level == 1 to\nterminate page walks. Otherwise memory corruption may occur as level\nis used as an index to various data structures throughout the page\nwalking code.  Even though the actual bug would be wherever the MMU is\ninitialized (as in the previous patch), be defensive and ensure here\nthat is_last_gpte() returns the correct value.\n\nThis patch is also enough to fix CVE-2017-12188.\n\nFixes: 6bb69c9b69c315200ddc2bc79aee14c0184cf5b2\nCc: stable@vger.kernel.org\nCc: Andy Honig <ahonig@google.com>\nSigned-off-by: Ladi Prosek <lprosek@redhat.com>\n[Panic if walk_addr_generic gets an incorrect level; this is a serious\n bug and it's not worth a WARN_ON where the recovery path might hide\n further exploitable issues; suggested by Andrew Honig. - Paolo]\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Ladi Prosek",
  "author_email": "lprosek@redhat.com",
  "author_date": "Thu Oct 5 11:10:23 2017 +0200",
  "author_date_iso": "2017-10-05T11:10:23+02:00",
  "committer_name": "Paolo Bonzini",
  "committer_email": "pbonzini@redhat.com",
  "committer_date": "Tue Oct 10 15:31:28 2017 +0200",
  "committer_date_iso": "2017-10-10T15:31:28+02:00",
  "files_changed": [
    "arch/x86/kvm/mmu.c",
    "arch/x86/kvm/paging_tmpl.h"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "arch/x86/kvm/mmu.c",
      "insertions": 7,
      "deletions": 7
    },
    {
      "file": "arch/x86/kvm/paging_tmpl.h",
      "insertions": 2,
      "deletions": 1
    }
  ],
  "total_insertions": 9,
  "total_deletions": 8,
  "total_changes": 17,
  "parents": [
    "fd19d3b45164466a4adce7cbff448ba9189e1427"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.14",
    "v4.14-rc5",
    "v4.14-rc6",
    "v4.14-rc7",
    "v4.14-rc8",
    "v4.15",
    "v4.15-rc1",
    "v4.15-rc2",
    "v4.15-rc3",
    "v4.15-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2017-12188"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "arch/x86/kvm/mmu.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/paging_tmpl.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}