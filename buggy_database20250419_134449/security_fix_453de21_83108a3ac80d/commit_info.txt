Commit Hash: 453de21c2b8281228173a7b689120b92929743d6
Subject: scsi: storvsc: Use vmbus_requestor to generate transaction IDs for VMBus hardening


Security Keywords:
- hardening

Full commit message:
scsi: storvsc: Use vmbus_requestor to generate transaction IDs for VMBus hardening

Currently, pointers to guest memory are passed to Hyper-V as
transaction IDs in storvsc. In the face of errors or malicious
behavior in Hyper-V, storvsc should not expose or trust the transaction
IDs returned by Hyper-V to be valid guest memory addresses. Instead,
use small integers generated by vmbus_requestor as requests
(transaction) IDs.

Signed-off-by: Andres Beltran <lkmlabelt@gmail.com>
Co-developed-by: Andrea Parri (Microsoft) <parri.andrea@gmail.com>
Signed-off-by: Andrea Parri (Microsoft) <parri.andrea@gmail.com>
Reviewed-by: Michael Kelley <mikelley@microsoft.com>
Cc: "James E.J. Bottomley" <jejb@linux.ibm.com>
Cc: "Martin K. Petersen" <martin.petersen@oracle.com>
Cc: linux-scsi@vger.kernel.org
Link: https://lore.kernel.org/r/20201109100402.8946-3-parri.andrea@gmail.com
Acked-by: Martin K. Petersen <martin.petersen@oracle.com>
Reviewed-by: Wei Liu <wei.liu@kernel.org>
Signed-off-by: Wei Liu <wei.liu@kernel.org>

Metadata:
Author: Andres Beltran <lkmlabelt@gmail.com>
Author Date: Mon Nov 9 11:04:01 2020 +0100
Committer: Wei Liu <wei.liu@kernel.org>
Commit Date: Tue Nov 17 10:54:06 2020 +0000

Files Changed: 1
Lines Added: 23
Lines Removed: 3
Total Changes: 26
