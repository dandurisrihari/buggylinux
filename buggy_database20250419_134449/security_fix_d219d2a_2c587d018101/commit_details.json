{
  "hash": "d219d2a9a92e39aa92799efe8f2aa21259b6dd82",
  "hash_short": "d219d2a9",
  "subject": "overflow: Allow mixed type arguments",
  "body": "When the check_[op]_overflow() helpers were introduced, all arguments\nwere required to be the same type to make the fallback macros simpler.\nHowever, now that the fallback macros have been removed[1], it is fine\nto allow mixed types, which makes using the helpers much more useful,\nas they can be used to test for type-based overflows (e.g. adding two\nlarge ints but storing into a u8), as would be handy in the drm core[2].\n\nRemove the restriction, and add additional self-tests that exercise\nsome of the mixed-type overflow cases, and double-check for accidental\nmacro side-effects.\n\n[1] https://git.kernel.org/linus/4eb6bd55cfb22ffc20652732340c4962f3ac9a91\n[2] https://lore.kernel.org/lkml/20220824084514.2261614-2-gwan-gyeong.mun@intel.com\n\nCc: Rasmus Villemoes <linux@rasmusvillemoes.dk>\nCc: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>\nCc: \"Gustavo A. R. Silva\" <gustavoars@kernel.org>\nCc: Nick Desaulniers <ndesaulniers@google.com>\nCc: linux-hardening@vger.kernel.org\nReviewed-by: Andrzej Hajda <andrzej.hajda@intel.com>\nReviewed-by: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>\nTested-by: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "full_message": "overflow: Allow mixed type arguments\n\nWhen the check_[op]_overflow() helpers were introduced, all arguments\nwere required to be the same type to make the fallback macros simpler.\nHowever, now that the fallback macros have been removed[1], it is fine\nto allow mixed types, which makes using the helpers much more useful,\nas they can be used to test for type-based overflows (e.g. adding two\nlarge ints but storing into a u8), as would be handy in the drm core[2].\n\nRemove the restriction, and add additional self-tests that exercise\nsome of the mixed-type overflow cases, and double-check for accidental\nmacro side-effects.\n\n[1] https://git.kernel.org/linus/4eb6bd55cfb22ffc20652732340c4962f3ac9a91\n[2] https://lore.kernel.org/lkml/20220824084514.2261614-2-gwan-gyeong.mun@intel.com\n\nCc: Rasmus Villemoes <linux@rasmusvillemoes.dk>\nCc: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>\nCc: \"Gustavo A. R. Silva\" <gustavoars@kernel.org>\nCc: Nick Desaulniers <ndesaulniers@google.com>\nCc: linux-hardening@vger.kernel.org\nReviewed-by: Andrzej Hajda <andrzej.hajda@intel.com>\nReviewed-by: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>\nTested-by: Gwan-gyeong Mun <gwan-gyeong.mun@intel.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "author_name": "Kees Cook",
  "author_email": "keescook@chromium.org",
  "author_date": "Mon Aug 29 13:37:17 2022 -0700",
  "author_date_iso": "2022-08-29T13:37:17-07:00",
  "committer_name": "Kees Cook",
  "committer_email": "keescook@chromium.org",
  "committer_date": "Wed Sep 7 16:37:14 2022 -0700",
  "committer_date_iso": "2022-09-07T16:37:14-07:00",
  "files_changed": [
    "include/linux/overflow.h",
    "lib/overflow_kunit.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "include/linux/overflow.h",
      "insertions": 41,
      "deletions": 31
    },
    {
      "file": "lib/overflow_kunit.c",
      "insertions": 72,
      "deletions": 29
    }
  ],
  "total_insertions": 113,
  "total_deletions": 60,
  "total_changes": 173,
  "parents": [
    "92d23c6e94157739b997cacce151586a0d07bb8a"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/linux/overflow.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/overflow_kunit.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}