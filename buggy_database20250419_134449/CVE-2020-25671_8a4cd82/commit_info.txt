Commit Hash: 8a4cd82d62b5ec7e5482333a72b58a4eea4979f0
Subject: nfc: fix refcount leak in llcp_sock_connect()

CVE Identifiers:
- CVE-2020-25671

Full commit message:
nfc: fix refcount leak in llcp_sock_connect()

nfc_llcp_local_get() is invoked in llcp_sock_connect(),
but nfc_llcp_local_put() is not invoked in subsequent failure branches.
As a result, refcount leakage occurs.
To fix it, add calling nfc_llcp_local_put().

fix CVE-2020-25671
Fixes: c7aa12252f51 ("NFC: Take a reference on the LLCP local pointer when creating a socket")
Reported-by: "kiyin(尹亮)" <kiyin@tencent.com>
Link: https://www.openwall.com/lists/oss-security/2020/11/01/1
Cc: <stable@vger.kernel.org> #v3.6
Signed-off-by: Xiaoming Ni <nixiaoming@huawei.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Xiaoming Ni <nixiaoming@huawei.com>
Author Date: Thu Mar 25 11:51:11 2021 +0800
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Thu Mar 25 17:02:01 2021 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 0
Total Changes: 2
