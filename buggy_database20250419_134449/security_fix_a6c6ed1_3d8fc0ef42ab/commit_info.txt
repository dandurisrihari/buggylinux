Commit Hash: a6c6ed1e81060e110258dbc7118fda07e9971e48
Subject: KVM: x86: Don't attempt VMWare emulation on #GP with non-zero error code


Security Keywords:
- injection

Full commit message:
KVM: x86: Don't attempt VMWare emulation on #GP with non-zero error code

The VMware backdoor hooks #GP faults on IN{S}, OUT{S}, and RDPMC, none
of which generate a non-zero error code for their #GP.  Re-injecting #GP
instead of attempting emulation on a non-zero error code will allow a
future patch to move #GP injection (for emulation failure) into
kvm_emulate_instruction() without having to plumb in the error code.

Reviewed-and-tested-by: Vitaly Kuznetsov <vkuznets@redhat.com>
Reviewed-by: Liran Alon <liran.alon@oracle.com>
Signed-off-by: Sean Christopherson <sean.j.christopherson@intel.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Sean Christopherson <sean.j.christopherson@intel.com>
Author Date: Tue Aug 27 14:40:30 2019 -0700
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Tue Sep 24 14:30:42 2019 +0200

Files Changed: 2
Lines Added: 20
Lines Removed: 2
Total Changes: 22
