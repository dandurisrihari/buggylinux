{
  "hash": "75fbef0a8b6b4bb19b9a91b5214f846c2dc5139e",
  "hash_short": "75fbef0a",
  "subject": "x86/mm: Fix NX bit clearing issue in kernel_map_pages_in_pgd",
  "body": "The following commit:\n\n  15f003d20782 (\"x86/mm/pat: Don't implicitly allow _PAGE_RW in kernel_map_pages_in_pgd()\")\n\nmodified kernel_map_pages_in_pgd() to manage writable permissions\nof memory mappings in the EFI page table in a different way, but\nin the process, it removed the ability to clear NX attributes from\nread-only mappings, by clobbering the clear mask if _PAGE_RW is not\nbeing requested.\n\nFailure to remove the NX attribute from read-only mappings is\nunlikely to be a security issue, but it does prevent us from\ntightening the permissions in the EFI page tables going forward,\nso let's fix it now.\n\nFixes: 15f003d20782 (\"x86/mm/pat: Don't implicitly allow _PAGE_RW in kernel_map_pages_in_pgd()\nSigned-off-by: Ard Biesheuvel <ardb@kernel.org>\nSigned-off-by: Ingo Molnar <mingo@kernel.org>\nLink: https://lore.kernel.org/r/20200113172245.27925-5-ardb@kernel.org",
  "full_message": "x86/mm: Fix NX bit clearing issue in kernel_map_pages_in_pgd\n\nThe following commit:\n\n  15f003d20782 (\"x86/mm/pat: Don't implicitly allow _PAGE_RW in kernel_map_pages_in_pgd()\")\n\nmodified kernel_map_pages_in_pgd() to manage writable permissions\nof memory mappings in the EFI page table in a different way, but\nin the process, it removed the ability to clear NX attributes from\nread-only mappings, by clobbering the clear mask if _PAGE_RW is not\nbeing requested.\n\nFailure to remove the NX attribute from read-only mappings is\nunlikely to be a security issue, but it does prevent us from\ntightening the permissions in the EFI page tables going forward,\nso let's fix it now.\n\nFixes: 15f003d20782 (\"x86/mm/pat: Don't implicitly allow _PAGE_RW in kernel_map_pages_in_pgd()\nSigned-off-by: Ard Biesheuvel <ardb@kernel.org>\nSigned-off-by: Ingo Molnar <mingo@kernel.org>\nLink: https://lore.kernel.org/r/20200113172245.27925-5-ardb@kernel.org",
  "author_name": "Ard Biesheuvel",
  "author_email": "ardb@kernel.org",
  "author_date": "Mon Jan 13 18:22:36 2020 +0100",
  "author_date_iso": "2020-01-13T18:22:36+01:00",
  "committer_name": "Ingo Molnar",
  "committer_email": "mingo@kernel.org",
  "committer_date": "Mon Jan 20 08:13:00 2020 +0100",
  "committer_date_iso": "2020-01-20T08:13:00+01:00",
  "files_changed": [
    "arch/x86/mm/pat/set_memory.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/x86/mm/pat/set_memory.c",
      "insertions": 1,
      "deletions": 7
    }
  ],
  "total_insertions": 1,
  "total_deletions": 7,
  "total_changes": 8,
  "parents": [
    "bd1d7093a8086df37d260bd1f1d896c0922d34ef"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.6",
    "v5.6-rc1",
    "v5.6-rc2",
    "v5.6-rc3",
    "v5.6-rc4",
    "v5.6-rc5",
    "v5.6-rc6",
    "v5.6-rc7",
    "v5.7-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security issue"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/mm/pat/set_memory.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}