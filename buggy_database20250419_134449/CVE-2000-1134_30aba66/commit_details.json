{
  "hash": "30aba6656f61ed44cba445a3c0d38b296fa9e8f5",
  "hash_short": "30aba665",
  "subject": "namei: allow restricted O_CREAT of FIFOs and regular files",
  "body": "Disallows open of FIFOs or regular files not owned by the user in world\nwritable sticky directories, unless the owner is the same as that of the\ndirectory or the file is opened without the O_CREAT flag.  The purpose\nis to make data spoofing attacks harder.  This protection can be turned\non and off separately for FIFOs and regular files via sysctl, just like\nthe symlinks/hardlinks protection.  This patch is based on Openwall's\n\"HARDEN_FIFO\" feature by Solar Designer.\n\nThis is a brief list of old vulnerabilities that could have been prevented\nby this feature, some of them even allow for privilege escalation:\n\nCVE-2000-1134\nCVE-2007-3852\nCVE-2008-0525\nCVE-2009-0416\nCVE-2011-4834\nCVE-2015-1838\nCVE-2015-7442\nCVE-2016-7489\n\nThis list is not meant to be complete.  It's difficult to track down all\nvulnerabilities of this kind because they were often reported without any\nmention of this particular attack vector.  In fact, before\nhardlinks/symlinks restrictions, fifos/regular files weren't the favorite\nvehicle to exploit them.\n\n[s.mesoraca16@gmail.com: fix bug reported by Dan Carpenter]\n  Link: https://lkml.kernel.org/r/20180426081456.GA7060@mwanda\n  Link: http://lkml.kernel.org/r/1524829819-11275-1-git-send-email-s.mesoraca16@gmail.com\n[keescook@chromium.org: drop pr_warn_ratelimited() in favor of audit changes in the future]\n[keescook@chromium.org: adjust commit subjet]\nLink: http://lkml.kernel.org/r/20180416175918.GA13494@beast\nSigned-off-by: Salvatore Mesoraca <s.mesoraca16@gmail.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nSuggested-by: Solar Designer <solar@openwall.com>\nSuggested-by: Kees Cook <keescook@chromium.org>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: Dan Carpenter <dan.carpenter@oracle.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "namei: allow restricted O_CREAT of FIFOs and regular files\n\nDisallows open of FIFOs or regular files not owned by the user in world\nwritable sticky directories, unless the owner is the same as that of the\ndirectory or the file is opened without the O_CREAT flag.  The purpose\nis to make data spoofing attacks harder.  This protection can be turned\non and off separately for FIFOs and regular files via sysctl, just like\nthe symlinks/hardlinks protection.  This patch is based on Openwall's\n\"HARDEN_FIFO\" feature by Solar Designer.\n\nThis is a brief list of old vulnerabilities that could have been prevented\nby this feature, some of them even allow for privilege escalation:\n\nCVE-2000-1134\nCVE-2007-3852\nCVE-2008-0525\nCVE-2009-0416\nCVE-2011-4834\nCVE-2015-1838\nCVE-2015-7442\nCVE-2016-7489\n\nThis list is not meant to be complete.  It's difficult to track down all\nvulnerabilities of this kind because they were often reported without any\nmention of this particular attack vector.  In fact, before\nhardlinks/symlinks restrictions, fifos/regular files weren't the favorite\nvehicle to exploit them.\n\n[s.mesoraca16@gmail.com: fix bug reported by Dan Carpenter]\n  Link: https://lkml.kernel.org/r/20180426081456.GA7060@mwanda\n  Link: http://lkml.kernel.org/r/1524829819-11275-1-git-send-email-s.mesoraca16@gmail.com\n[keescook@chromium.org: drop pr_warn_ratelimited() in favor of audit changes in the future]\n[keescook@chromium.org: adjust commit subjet]\nLink: http://lkml.kernel.org/r/20180416175918.GA13494@beast\nSigned-off-by: Salvatore Mesoraca <s.mesoraca16@gmail.com>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nSuggested-by: Solar Designer <solar@openwall.com>\nSuggested-by: Kees Cook <keescook@chromium.org>\nCc: Al Viro <viro@zeniv.linux.org.uk>\nCc: Dan Carpenter <dan.carpenter@oracle.com>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Salvatore Mesoraca",
  "author_email": "s.mesoraca16@gmail.com",
  "author_date": "Thu Aug 23 17:00:35 2018 -0700",
  "author_date_iso": "2018-08-23T17:00:35-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Thu Aug 23 18:48:43 2018 -0700",
  "committer_date_iso": "2018-08-23T18:48:43-07:00",
  "files_changed": [
    "Documentation/sysctl/fs.txt",
    "fs/namei.c",
    "include/linux/fs.h",
    "kernel/sysctl.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "Documentation/sysctl/fs.txt",
      "insertions": 36,
      "deletions": 0
    },
    {
      "file": "fs/namei.c",
      "insertions": 50,
      "deletions": 3
    },
    {
      "file": "include/linux/fs.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "kernel/sysctl.c",
      "insertions": 18,
      "deletions": 0
    }
  ],
  "total_insertions": 106,
  "total_deletions": 3,
  "total_changes": 109,
  "parents": [
    "dc2572791d3a41bab94400af2b6bca9d71ccd303"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc1",
    "v4.19-rc2",
    "v4.19-rc3",
    "v4.19-rc4",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2000-1134",
      "CVE-2007-3852",
      "CVE-2008-0525",
      "CVE-2009-0416",
      "CVE-2011-4834",
      "CVE-2015-1838",
      "CVE-2015-7442",
      "CVE-2016-7489"
    ],
    "security_keywords": [
      "privilege escalation",
      "exploit"
    ]
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "Documentation/sysctl/fs.txt",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/namei.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/fs.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/sysctl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}