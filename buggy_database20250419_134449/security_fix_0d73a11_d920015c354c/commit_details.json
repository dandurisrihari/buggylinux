{
  "hash": "0d73a11c62642a25b688d09ae04b3b1f1b58ebb9",
  "hash_short": "0d73a11c",
  "subject": "btrfs: ref-verify: pass down tree block level when building refs",
  "body": "I noticed that sometimes I would have the wrong level printed out with\nref-verify while testing some error injection related problems.  This is\nbecause we only get the level from the main extent item, but our\nreferences could go off the current leaf into another, and at that point\nwe lose our level.\n\nFix this by keeping track of the last tree block level that we found,\nthe same way we keep track of our bytenr and num_bytes, in case we\nhappen to wander into another leaf while still processing the references\nfor a bytenr.\n\nSigned-off-by: Josef Bacik <josef@toxicpanda.com>\nReviewed-by: David Sterba <dsterba@suse.com>\nSigned-off-by: David Sterba <dsterba@suse.com>",
  "full_message": "btrfs: ref-verify: pass down tree block level when building refs\n\nI noticed that sometimes I would have the wrong level printed out with\nref-verify while testing some error injection related problems.  This is\nbecause we only get the level from the main extent item, but our\nreferences could go off the current leaf into another, and at that point\nwe lose our level.\n\nFix this by keeping track of the last tree block level that we found,\nthe same way we keep track of our bytenr and num_bytes, in case we\nhappen to wander into another leaf while still processing the references\nfor a bytenr.\n\nSigned-off-by: Josef Bacik <josef@toxicpanda.com>\nReviewed-by: David Sterba <dsterba@suse.com>\nSigned-off-by: David Sterba <dsterba@suse.com>",
  "author_name": "Josef Bacik",
  "author_email": "josef@toxicpanda.com",
  "author_date": "Wed Dec 16 11:18:46 2020 -0500",
  "author_date_iso": "2020-12-16T11:18:46-05:00",
  "committer_name": "David Sterba",
  "committer_email": "dsterba@suse.com",
  "committer_date": "Mon Feb 8 22:58:50 2021 +0100",
  "committer_date_iso": "2021-02-08T22:58:50+01:00",
  "files_changed": [
    "fs/btrfs/ref-verify.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/btrfs/ref-verify.c",
      "insertions": 12,
      "deletions": 8
    }
  ],
  "total_insertions": 12,
  "total_deletions": 8,
  "total_changes": 20,
  "parents": [
    "1fec12a560033ebe8fa6857dd3cbf9677371fbee"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/btrfs/ref-verify.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}