commit 74aaf96feaca80285912cc6f19575b3e97177918
Author: Chuck Lever <chuck.lever@oracle.com>
Date:   Tue Feb 22 13:10:52 2022 -0500

    SUNRPC: Teach server to recognize RPC_AUTH_TLS
    
    Initial support for the RPC_AUTH_TLS authentication flavor enables
    NFSD to eventually accept an RPC_AUTH_TLS probe from clients. This
    patch simply prevents NFSD from rejecting these probes completely.
    
    In the meantime, graft this support in now so that RPC_AUTH_TLS
    support keeps up with generic code and API changes in the RPC
    server.
    
    Down the road, server-side transport implementations will populate
    xpo_start_tls when they can support RPC-with-TLS. For example, TCP
    will eventually populate it, but RDMA won't.
    
    Signed-off-by: Chuck Lever <chuck.lever@oracle.com>

diff --git a/net/sunrpc/svcauth.c b/net/sunrpc/svcauth.c
index 5a8b8e03fdd4..e72ba2f13f6c 100644
--- a/net/sunrpc/svcauth.c
+++ b/net/sunrpc/svcauth.c
@@ -31,10 +31,12 @@
  */
 extern struct auth_ops svcauth_null;
 extern struct auth_ops svcauth_unix;
+extern struct auth_ops svcauth_tls;
 
 static struct auth_ops __rcu *authtab[RPC_AUTH_MAXFLAVOR] = {
 	[RPC_AUTH_NULL] = (struct auth_ops __force __rcu *)&svcauth_null,
 	[RPC_AUTH_UNIX] = (struct auth_ops __force __rcu *)&svcauth_unix,
+	[RPC_AUTH_TLS]  = (struct auth_ops __force __rcu *)&svcauth_tls,
 };
 
 static struct auth_ops *