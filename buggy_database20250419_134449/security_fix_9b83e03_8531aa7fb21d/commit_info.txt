Commit Hash: 9b83e0319840eca758ef586776a427284ff767bf
Subject: ipv4: Don't pass IP fragments to upper layer GRO handlers.


Security Keywords:
- authentication

Full commit message:
ipv4: Don't pass IP fragments to upper layer GRO handlers.

Upper layer GRO handlers can not handle IP fragments, so
exit GRO processing in this case.

This fixes ESP GRO because the packet must be reassembled
before we can decapsulate, otherwise we get authentication
failures.

It also aligns IPv4 to IPv6 where packets with fragmentation
headers are not passed to upper layer GRO handlers.

Fixes: 7785bba299a8 ("esp: Add a software GRO codepath")
Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Steffen Klassert <steffen.klassert@secunet.com>
Author Date: Fri Apr 28 10:54:32 2017 +0200
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Fri Apr 28 16:00:38 2017 -0400

Files Changed: 1
Lines Added: 3
Lines Removed: 0
Total Changes: 3
