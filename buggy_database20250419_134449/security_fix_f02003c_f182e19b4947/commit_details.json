{
  "hash": "f02003c860d921171be4a27e2893766eb3bc6871",
  "hash_short": "f02003c8",
  "subject": "hardening: Avoid harmless Clang option under CONFIG_INIT_STACK_ALL_ZERO",
  "body": "Currently under Clang, CC_HAS_AUTO_VAR_INIT_ZERO requires an extra\n-enable flag compared to CC_HAS_AUTO_VAR_INIT_PATTERN. GCC 12[1] will\nnot, and will happily ignore the Clang-specific flag. However, its\npresence on the command-line is both cumbersome and confusing. Due to\nGCC's tolerant behavior, though, we can continue to use a single Kconfig\ncc-option test for the feature on both compilers, but then drop the\nClang-specific option in the Makefile.\n\nIn other words, this patch does not change anything other than making the\ncompiler command line shorter once GCC supports -ftrivial-auto-var-init=zero.\n\n[1] https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9\n\nCc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nCc: Masahiro Yamada <masahiroy@kernel.org>\nCc: llvm@lists.linux.dev\nFixes: dcb7c0b9461c (\"hardening: Clarify Kconfig text for auto-var-init\")\nSuggested-by: Will Deacon <will@kernel.org>\nLink: https://lore.kernel.org/lkml/20210914102837.6172-1-will@kernel.org/\nReviewed-by: Nick Desaulniers <ndesaulniers@google.com>\nReviewed-by: Nathan Chancellor <nathan@kernel.org>\nAcked-by: Will Deacon <will@kernel.org>\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "full_message": "hardening: Avoid harmless Clang option under CONFIG_INIT_STACK_ALL_ZERO\n\nCurrently under Clang, CC_HAS_AUTO_VAR_INIT_ZERO requires an extra\n-enable flag compared to CC_HAS_AUTO_VAR_INIT_PATTERN. GCC 12[1] will\nnot, and will happily ignore the Clang-specific flag. However, its\npresence on the command-line is both cumbersome and confusing. Due to\nGCC's tolerant behavior, though, we can continue to use a single Kconfig\ncc-option test for the feature on both compilers, but then drop the\nClang-specific option in the Makefile.\n\nIn other words, this patch does not change anything other than making the\ncompiler command line shorter once GCC supports -ftrivial-auto-var-init=zero.\n\n[1] https://gcc.gnu.org/git/?p=gcc.git;a=commitdiff;h=a25e0b5e6ac8a77a71c229e0a7b744603365b0e9\n\nCc: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nCc: Masahiro Yamada <masahiroy@kernel.org>\nCc: llvm@lists.linux.dev\nFixes: dcb7c0b9461c (\"hardening: Clarify Kconfig text for auto-var-init\")\nSuggested-by: Will Deacon <will@kernel.org>\nLink: https://lore.kernel.org/lkml/20210914102837.6172-1-will@kernel.org/\nReviewed-by: Nick Desaulniers <ndesaulniers@google.com>\nReviewed-by: Nathan Chancellor <nathan@kernel.org>\nAcked-by: Will Deacon <will@kernel.org>\nSigned-off-by: Kees Cook <keescook@chromium.org>",
  "author_name": "Kees Cook",
  "author_email": "keescook@chromium.org",
  "author_date": "Tue Sep 14 12:49:03 2021 -0700",
  "author_date_iso": "2021-09-14T12:49:03-07:00",
  "committer_name": "Kees Cook",
  "committer_email": "keescook@chromium.org",
  "committer_date": "Sat Sep 25 08:22:59 2021 -0700",
  "committer_date_iso": "2021-09-25T08:22:59-07:00",
  "files_changed": [
    "Makefile",
    "security/Kconfig.hardening"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "Makefile",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "security/Kconfig.hardening",
      "insertions": 4,
      "deletions": 1
    }
  ],
  "total_insertions": 7,
  "total_deletions": 4,
  "total_changes": 11,
  "parents": [
    "e4e737bb5c170df6135a127739a9e6148ee3da82"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "Makefile",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/Kconfig.hardening",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}