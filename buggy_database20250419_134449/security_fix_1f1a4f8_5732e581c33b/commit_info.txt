Commit Hash: 1f1a4f89562d3b33b6ca4fc8a4f3bd4cd35ab4ea
Subject: nvme-tcp: stop auth work after tearing down queues in error recovery


Security Keywords:
- auth

Full commit message:
nvme-tcp: stop auth work after tearing down queues in error recovery

when starting error recovery there might be a authentication work
running, and it involves I/O commands. Given the controller is tearing
down there is no chance for the I/O to complete other than timing out
which may unnecessarily take a full io timeout.

So first tear down the queues, fail/cancel all inflight I/O (including
potentially authentication) and only then stop authentication. This
ensures that failover is not stalled due to blocked authentication I/O.

Signed-off-by: Sagi Grimberg <sagi@grimberg.me>
Reviewed-by: Chaitanya Kulkarni <kch@nvidia.com>
Signed-off-by: Christoph Hellwig <hch@lst.de>

Metadata:
Author: Sagi Grimberg <sagi@grimberg.me>
Author Date: Sun Nov 13 13:24:23 2022 +0200
Committer: Christoph Hellwig <hch@lst.de>
Commit Date: Wed Nov 16 08:36:37 2022 +0100

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
