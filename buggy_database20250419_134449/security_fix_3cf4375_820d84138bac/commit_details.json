{
  "hash": "3cf4375a090473d240281a0d2b04a3a5aaeac34b",
  "hash_short": "3cf4375a",
  "subject": "tipc: do not write skb_shinfo frags when doing decrytion",
  "body": "One skb's skb_shinfo frags are not writable, and they can be shared with\nother skbs' like by pskb_copy(). To write the frags may cause other skb's\ndata crash.\n\nSo before doing en/decryption, skb_cow_data() should always be called for\na cloned or nonlinear skb if req dst is using the same sg as req src.\nWhile at it, the likely branch can be removed, as it will be covered\nby skb_cow_data().\n\nNote that esp_input() has the same issue, and I will fix it in another\npatch. tipc_aead_encrypt() doesn't have this issue, as it only processes\nlinear data in the unlikely branch.\n\nFixes: fc1b6d6de220 (\"tipc: introduce TIPC encryption & authentication\")\nReported-by: Shuang Li <shuali@redhat.com>\nSigned-off-by: Xin Long <lucien.xin@gmail.com>\nAcked-by: Jon Maloy <jmaloy@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "tipc: do not write skb_shinfo frags when doing decrytion\n\nOne skb's skb_shinfo frags are not writable, and they can be shared with\nother skbs' like by pskb_copy(). To write the frags may cause other skb's\ndata crash.\n\nSo before doing en/decryption, skb_cow_data() should always be called for\na cloned or nonlinear skb if req dst is using the same sg as req src.\nWhile at it, the likely branch can be removed, as it will be covered\nby skb_cow_data().\n\nNote that esp_input() has the same issue, and I will fix it in another\npatch. tipc_aead_encrypt() doesn't have this issue, as it only processes\nlinear data in the unlikely branch.\n\nFixes: fc1b6d6de220 (\"tipc: introduce TIPC encryption & authentication\")\nReported-by: Shuang Li <shuali@redhat.com>\nSigned-off-by: Xin Long <lucien.xin@gmail.com>\nAcked-by: Jon Maloy <jmaloy@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Xin Long",
  "author_email": "lucien.xin@gmail.com",
  "author_date": "Fri Jul 23 18:46:01 2021 -0400",
  "author_date_iso": "2021-07-23T18:46:01-04:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Sat Jul 24 19:38:21 2021 +0100",
  "committer_date_iso": "2021-07-24T19:38:21+01:00",
  "files_changed": [
    "net/tipc/crypto.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/tipc/crypto.c",
      "insertions": 4,
      "deletions": 10
    }
  ],
  "total_insertions": 4,
  "total_deletions": 10,
  "total_changes": 14,
  "parents": [
    "e394f1e3b13946b200935310ebdd5583cf374bba"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/tipc/crypto.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}