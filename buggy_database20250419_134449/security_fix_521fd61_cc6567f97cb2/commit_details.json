{
  "hash": "521fd61c84a19b31dfbaa8dde3d2577e4e115d12",
  "hash_short": "521fd61c",
  "subject": "security/keys: rewrite big_key crypto to use library interface",
  "body": "A while back, I noticed that the crypto and crypto API usage in big_keys\nwere entirely broken in multiple ways, so I rewrote it. Now, I'm\nrewriting it again, but this time using the simpler ChaCha20Poly1305\nlibrary function. This makes the file considerably more simple; the\ndiffstat alone should justify this commit. It also should be faster,\nsince it no longer requires a mutex around the \"aead api object\" (nor\nallocations), allowing us to encrypt multiple items in parallel. We also\nbenefit from being able to pass any type of pointer, so we can get rid\nof the ridiculously complex custom page allocator that big_key really\ndoesn't need.\n\n[DH: Change the select CRYPTO_LIB_CHACHA20POLY1305 to a depends on as\n select doesn't propagate and the build can end up with an =y dependending\n on some =m pieces.\n\n The depends on CRYPTO also had to be removed otherwise the configurator\n complains about a recursive dependency.]\n\nCc: Andy Lutomirski <luto@kernel.org>\nCc: Greg KH <gregkh@linuxfoundation.org>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: kernel-hardening@lists.openwall.com\nReviewed-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: Jason A. Donenfeld <Jason@zx2c4.com>\nSigned-off-by: David Howells <dhowells@redhat.com>",
  "full_message": "security/keys: rewrite big_key crypto to use library interface\n\nA while back, I noticed that the crypto and crypto API usage in big_keys\nwere entirely broken in multiple ways, so I rewrote it. Now, I'm\nrewriting it again, but this time using the simpler ChaCha20Poly1305\nlibrary function. This makes the file considerably more simple; the\ndiffstat alone should justify this commit. It also should be faster,\nsince it no longer requires a mutex around the \"aead api object\" (nor\nallocations), allowing us to encrypt multiple items in parallel. We also\nbenefit from being able to pass any type of pointer, so we can get rid\nof the ridiculously complex custom page allocator that big_key really\ndoesn't need.\n\n[DH: Change the select CRYPTO_LIB_CHACHA20POLY1305 to a depends on as\n select doesn't propagate and the build can end up with an =y dependending\n on some =m pieces.\n\n The depends on CRYPTO also had to be removed otherwise the configurator\n complains about a recursive dependency.]\n\nCc: Andy Lutomirski <luto@kernel.org>\nCc: Greg KH <gregkh@linuxfoundation.org>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: kernel-hardening@lists.openwall.com\nReviewed-by: Eric Biggers <ebiggers@google.com>\nSigned-off-by: Jason A. Donenfeld <Jason@zx2c4.com>\nSigned-off-by: David Howells <dhowells@redhat.com>",
  "author_name": "Jason A. Donenfeld",
  "author_email": "Jason@zx2c4.com",
  "author_date": "Mon May 11 15:51:01 2020 -0600",
  "author_date_iso": "2020-05-11T15:51:01-06:00",
  "committer_name": "David Howells",
  "committer_email": "dhowells@redhat.com",
  "committer_date": "Tue Jun 2 17:22:31 2020 +0100",
  "committer_date_iso": "2020-06-02T17:22:31+01:00",
  "files_changed": [
    "security/keys/Kconfig",
    "security/keys/big_key.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "security/keys/Kconfig",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "security/keys/big_key.c",
      "insertions": 34,
      "deletions": 206
    }
  ],
  "total_insertions": 35,
  "total_deletions": 209,
  "total_changes": 244,
  "parents": [
    "2ce113fa525faf62fc308a10d1e5af07456b7460"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "security/keys/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/keys/big_key.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}