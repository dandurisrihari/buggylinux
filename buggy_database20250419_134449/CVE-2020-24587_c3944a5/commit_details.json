{
  "hash": "c3944a5621026c176001493d48ee66ff94e1a39a",
  "hash_short": "c3944a56",
  "subject": "ath11k: Clear the fragment cache during key install",
  "body": "Currently the fragment cache setup during peer assoc is\ncleared only during peer delete. In case a key reinstallation\nhappens with the same peer, the same fragment cache with old\nfragments added before key installation could be clubbed\nwith fragments received after. This might be exploited\nto mix fragments of different data resulting in a proper\nunintended reassembled packet to be passed up the stack.\n\nHence flush the fragment cache on every key installation to prevent\npotential attacks (CVE-2020-24587).\n\nTested-on: IPQ8074 hw2.0 AHB WLAN.HK.2.4.0.1-01734-QCAHKSWPL_SILICONZ-1 v2\n\nCc: stable@vger.kernel.org\nSigned-off-by: Sriram R <srirrama@codeaurora.org>\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nLink: https://lore.kernel.org/r/20210511200110.218dc777836f.I9af6fc76215a35936c4152552018afb5079c5d8c@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "ath11k: Clear the fragment cache during key install\n\nCurrently the fragment cache setup during peer assoc is\ncleared only during peer delete. In case a key reinstallation\nhappens with the same peer, the same fragment cache with old\nfragments added before key installation could be clubbed\nwith fragments received after. This might be exploited\nto mix fragments of different data resulting in a proper\nunintended reassembled packet to be passed up the stack.\n\nHence flush the fragment cache on every key installation to prevent\npotential attacks (CVE-2020-24587).\n\nTested-on: IPQ8074 hw2.0 AHB WLAN.HK.2.4.0.1-01734-QCAHKSWPL_SILICONZ-1 v2\n\nCc: stable@vger.kernel.org\nSigned-off-by: Sriram R <srirrama@codeaurora.org>\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nLink: https://lore.kernel.org/r/20210511200110.218dc777836f.I9af6fc76215a35936c4152552018afb5079c5d8c@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Sriram R",
  "author_email": "srirrama@codeaurora.org",
  "author_date": "Tue May 11 20:02:58 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:58+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:16:21 2021 +0200",
  "committer_date_iso": "2021-05-11T20:16:21+02:00",
  "files_changed": [
    "drivers/net/wireless/ath/ath11k/dp_rx.c",
    "drivers/net/wireless/ath/ath11k/dp_rx.h",
    "drivers/net/wireless/ath/ath11k/mac.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "drivers/net/wireless/ath/ath11k/dp_rx.c",
      "insertions": 18,
      "deletions": 0
    },
    {
      "file": "drivers/net/wireless/ath/ath11k/dp_rx.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/net/wireless/ath/ath11k/mac.c",
      "insertions": 6,
      "deletions": 0
    }
  ],
  "total_insertions": 25,
  "total_deletions": 0,
  "total_changes": 25,
  "parents": [
    "62a8ff67eba52dae9b107e1fb8827054ed00a265"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-24587"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/wireless/ath/ath11k/dp_rx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/ath/ath11k/dp_rx.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/ath/ath11k/mac.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}