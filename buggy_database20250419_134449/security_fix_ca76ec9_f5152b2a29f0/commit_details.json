{
  "hash": "ca76ec9ca871e67d8cd0b6caba24aca3d3ac4546",
  "hash_short": "ca76ec9c",
  "subject": "KVM: s390: Fix skey emulation permission check",
  "body": "All skey functions call skey_check_enable at their start, which checks\nif we are in the PSTATE and injects a privileged operation exception\nif we are.\n\nUnfortunately they continue processing afterwards and perform the\noperation anyhow as skey_check_enable does not deliver an error if the\nexception injection was successful.\n\nLet's move the PSTATE check into the skey functions and exit them on\nsuch an occasion, also we now do not enable skey handling anymore in\nsuch a case.\n\nSigned-off-by: Janosch Frank <frankja@linux.vnet.ibm.com>\nReviewed-by: Christian Borntraeger <borntraeger@de.ibm.com>\nFixes: a7e19ab (\"KVM: s390: handle missing storage-key facility\")\nCc: <stable@vger.kernel.org> # v4.8+\nReviewed-by: Cornelia Huck <cohuck@redhat.com>\nReviewed-by: Thomas Huth <thuth@redhat.com>\nSigned-off-by: Christian Borntraeger <borntraeger@de.ibm.com>",
  "full_message": "KVM: s390: Fix skey emulation permission check\n\nAll skey functions call skey_check_enable at their start, which checks\nif we are in the PSTATE and injects a privileged operation exception\nif we are.\n\nUnfortunately they continue processing afterwards and perform the\noperation anyhow as skey_check_enable does not deliver an error if the\nexception injection was successful.\n\nLet's move the PSTATE check into the skey functions and exit them on\nsuch an occasion, also we now do not enable skey handling anymore in\nsuch a case.\n\nSigned-off-by: Janosch Frank <frankja@linux.vnet.ibm.com>\nReviewed-by: Christian Borntraeger <borntraeger@de.ibm.com>\nFixes: a7e19ab (\"KVM: s390: handle missing storage-key facility\")\nCc: <stable@vger.kernel.org> # v4.8+\nReviewed-by: Cornelia Huck <cohuck@redhat.com>\nReviewed-by: Thomas Huth <thuth@redhat.com>\nSigned-off-by: Christian Borntraeger <borntraeger@de.ibm.com>",
  "author_name": "Janosch Frank",
  "author_email": "frankja@linux.vnet.ibm.com",
  "author_date": "Mon Dec 4 12:19:11 2017 +0100",
  "author_date_iso": "2017-12-04T12:19:11+01:00",
  "committer_name": "Christian Borntraeger",
  "committer_email": "borntraeger@de.ibm.com",
  "committer_date": "Wed Dec 6 09:18:43 2017 +0100",
  "committer_date_iso": "2017-12-06T09:18:43+01:00",
  "files_changed": [
    "arch/s390/kvm/priv.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/s390/kvm/priv.c",
      "insertions": 9,
      "deletions": 2
    }
  ],
  "total_insertions": 9,
  "total_deletions": 2,
  "total_changes": 11,
  "parents": [
    "bb64da9aba89765fee74b395967b18a7d6c364e9"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.15",
    "v4.15-rc3",
    "v4.15-rc4",
    "v4.15-rc5",
    "v4.15-rc6",
    "v4.15-rc7",
    "v4.15-rc8",
    "v4.15-rc9",
    "v4.16",
    "v4.16-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/s390/kvm/priv.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}