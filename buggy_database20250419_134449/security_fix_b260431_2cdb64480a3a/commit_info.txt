Commit Hash: b2604315e87a3fa3c35561e1c37836f915c4e3d8
Subject: afs: Make afs_init_request() get a key if not given a file


Security Keywords:
- authentication

Full commit message:
afs: Make afs_init_request() get a key if not given a file

In a future patch, AFS directory caching will go through netfslib and this
will involve, at times, running on behalf of ->lookup(), which doesn't
provide us with a file from which we can get an authentication key.

If a file isn't provided, make afs_init_request() get a key from the
process's keyrings instead when setting up a read.

Signed-off-by: David Howells <dhowells@redhat.com>
Link: https://lore.kernel.org/r/20241216204124.3752367-21-dhowells@redhat.com
cc: Marc Dionne <marc.dionne@auristor.com>
cc: linux-afs@lists.infradead.org
Signed-off-by: Christian Brauner <brauner@kernel.org>

Metadata:
Author: David Howells <dhowells@redhat.com>
Author Date: Mon Dec 16 20:41:10 2024 +0000
Committer: Christian Brauner <brauner@kernel.org>
Commit Date: Fri Dec 20 22:34:06 2024 +0100

Files Changed: 1
Lines Added: 16
Lines Removed: 0
Total Changes: 16
