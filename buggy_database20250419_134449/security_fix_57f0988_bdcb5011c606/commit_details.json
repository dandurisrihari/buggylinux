{
  "hash": "57f0988706fec1b8dbc3fe00965828a47e2235a1",
  "hash_short": "57f09887",
  "subject": "iommufd: Add a selftest",
  "body": "Cover the essential functionality of the iommufd with a directed test from\nuserspace. This aims to achieve reasonable functional coverage using the\nin-kernel self test framework.\n\nA second test does a failure injection sweep of the success paths to study\nerror unwind behaviors.\n\nThis allows achieving high coverage of the corner cases in pages.c.\n\nThe selftest requires CONFIG_IOMMUFD_TEST to be enabled, and several huge\npages which may require:\n\n  echo 4 > /proc/sys/vm/nr_hugepages\n\nLink: https://lore.kernel.org/r/19-v6-a196d26f289e+11787-iommufd_jgg@nvidia.com\nTested-by: Nicolin Chen <nicolinc@nvidia.com>\nTested-by: Matthew Rosato <mjrosato@linux.ibm.com> # s390\nTested-by: Yi Liu <yi.l.liu@intel.com>\nTested-by: Eric Auger <eric.auger@redhat.com> # aarch64\nSigned-off-by: Nicolin Chen <nicolinc@nvidia.com>\nSigned-off-by: Yi Liu <yi.l.liu@intel.com>\nSigned-off-by: Jason Gunthorpe <jgg@nvidia.com>",
  "full_message": "iommufd: Add a selftest\n\nCover the essential functionality of the iommufd with a directed test from\nuserspace. This aims to achieve reasonable functional coverage using the\nin-kernel self test framework.\n\nA second test does a failure injection sweep of the success paths to study\nerror unwind behaviors.\n\nThis allows achieving high coverage of the corner cases in pages.c.\n\nThe selftest requires CONFIG_IOMMUFD_TEST to be enabled, and several huge\npages which may require:\n\n  echo 4 > /proc/sys/vm/nr_hugepages\n\nLink: https://lore.kernel.org/r/19-v6-a196d26f289e+11787-iommufd_jgg@nvidia.com\nTested-by: Nicolin Chen <nicolinc@nvidia.com>\nTested-by: Matthew Rosato <mjrosato@linux.ibm.com> # s390\nTested-by: Yi Liu <yi.l.liu@intel.com>\nTested-by: Eric Auger <eric.auger@redhat.com> # aarch64\nSigned-off-by: Nicolin Chen <nicolinc@nvidia.com>\nSigned-off-by: Yi Liu <yi.l.liu@intel.com>\nSigned-off-by: Jason Gunthorpe <jgg@nvidia.com>",
  "author_name": "Jason Gunthorpe",
  "author_email": "jgg@nvidia.com",
  "author_date": "Tue Nov 29 16:29:42 2022 -0400",
  "author_date_iso": "2022-11-29T16:29:42-04:00",
  "committer_name": "Jason Gunthorpe",
  "committer_email": "jgg@nvidia.com",
  "committer_date": "Wed Nov 30 20:16:49 2022 -0400",
  "committer_date_iso": "2022-11-30T20:16:49-04:00",
  "files_changed": [
    "tools/testing/selftests/Makefile",
    "tools/testing/selftests/iommu/.gitignore",
    "tools/testing/selftests/iommu/Makefile",
    "tools/testing/selftests/iommu/config",
    "tools/testing/selftests/iommu/iommufd.c",
    "tools/testing/selftests/iommu/iommufd_fail_nth.c",
    "tools/testing/selftests/iommu/iommufd_utils.h"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "tools/testing/selftests/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "tools/testing/selftests/iommu/.gitignore",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "tools/testing/selftests/iommu/Makefile",
      "insertions": 12,
      "deletions": 0
    },
    {
      "file": "tools/testing/selftests/iommu/config",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "tools/testing/selftests/iommu/iommufd.c",
      "insertions": 1654,
      "deletions": 0
    },
    {
      "file": "tools/testing/selftests/iommu/iommufd_fail_nth.c",
      "insertions": 580,
      "deletions": 0
    },
    {
      "file": "tools/testing/selftests/iommu/iommufd_utils.h",
      "insertions": 278,
      "deletions": 0
    }
  ],
  "total_insertions": 2530,
  "total_deletions": 0,
  "total_changes": 2530,
  "parents": [
    "52f528583bb395495f7dd35e6e4d548bccbf8a73"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "tools/testing/selftests/iommu/.gitignore",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/selftests/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/selftests/iommu/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/selftests/iommu/config",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/selftests/iommu/iommufd_fail_nth.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/selftests/iommu/iommufd.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/testing/selftests/iommu/iommufd_utils.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}