Commit Hash: 71afaba4a2e98bb7bdeba5078370ab43d46e67a1
Subject: KVM: ARM: vgic: plug irq injection race


Security Keywords:
- injection

Full commit message:
KVM: ARM: vgic: plug irq injection race

As it stands, nothing prevents userspace from injecting an interrupt
before the guest's GIC is actually initialized.

This goes unnoticed so far (as everything is pretty much statically
allocated), but ends up exploding in a spectacular way once we switch
to a more dynamic allocation (the GIC data structure isn't there yet).

The fix is to test for the "ready" flag in the VGIC distributor before
trying to inject the interrupt. Note that in order to avoid breaking
userspace, we have to ignore what is essentially an error.

Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>
Acked-by: Christoffer Dall <christoffer.dall@linaro.org>

Metadata:
Author: Marc Zyngier <marc.zyngier@arm.com>
Author Date: Tue Jul 8 12:09:00 2014 +0100
Committer: Christoffer Dall <christoffer.dall@linaro.org>
Commit Date: Thu Sep 18 18:45:06 2014 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
