{
  "hash": "f9f83202b7263ac371d616d6894a2c9ed79158ef",
  "hash_short": "f9f83202",
  "subject": "ice: Allow all LLDP packets from PF to Tx",
  "body": "Currently in the ice driver, the check whether to\nallow a LLDP packet to egress the interface from the\nPF_VSI is being based on the SKB's priority field.\nIt checks to see if the packets priority is equal to\nTC_PRIO_CONTROL.  Injected LLDP packets do not always\nmeet this condition.\n\nSCAPY defaults to a sk_buff->protocol value of ETH_P_ALL\n(0x0003) and does not set the priority field.  There will\nbe other injection methods (even ones used by end users)\nthat will not correctly configure the socket so that\nSKB fields are correctly populated.\n\nThen ethernet header has to have to correct value for\nthe protocol though.\n\nAdd a check to also allow packets whose ethhdr->h_proto\nmatches ETH_P_LLDP (0x88CC).\n\nFixes: 0c3a6101ff2d (\"ice: Allow egress control packets from PF_VSI\")\nSigned-off-by: Dave Ertman <david.m.ertman@intel.com>\nTested-by: Tony Brelinski <tonyx.brelinski@intel.com>\nSigned-off-by: Tony Nguyen <anthony.l.nguyen@intel.com>",
  "full_message": "ice: Allow all LLDP packets from PF to Tx\n\nCurrently in the ice driver, the check whether to\nallow a LLDP packet to egress the interface from the\nPF_VSI is being based on the SKB's priority field.\nIt checks to see if the packets priority is equal to\nTC_PRIO_CONTROL.  Injected LLDP packets do not always\nmeet this condition.\n\nSCAPY defaults to a sk_buff->protocol value of ETH_P_ALL\n(0x0003) and does not set the priority field.  There will\nbe other injection methods (even ones used by end users)\nthat will not correctly configure the socket so that\nSKB fields are correctly populated.\n\nThen ethernet header has to have to correct value for\nthe protocol though.\n\nAdd a check to also allow packets whose ethhdr->h_proto\nmatches ETH_P_LLDP (0x88CC).\n\nFixes: 0c3a6101ff2d (\"ice: Allow egress control packets from PF_VSI\")\nSigned-off-by: Dave Ertman <david.m.ertman@intel.com>\nTested-by: Tony Brelinski <tonyx.brelinski@intel.com>\nSigned-off-by: Tony Nguyen <anthony.l.nguyen@intel.com>",
  "author_name": "Dave Ertman",
  "author_email": "david.m.ertman@intel.com",
  "author_date": "Wed May 5 14:17:59 2021 -0700",
  "author_date_iso": "2021-05-05T14:17:59-07:00",
  "committer_name": "Tony Nguyen",
  "committer_email": "anthony.l.nguyen@intel.com",
  "committer_date": "Fri Jun 4 07:37:48 2021 -0700",
  "committer_date_iso": "2021-06-04T07:37:48-07:00",
  "files_changed": [
    "drivers/net/ethernet/intel/ice/ice_txrx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/ethernet/intel/ice/ice_txrx.c",
      "insertions": 4,
      "deletions": 1
    }
  ],
  "total_insertions": 4,
  "total_deletions": 1,
  "total_changes": 5,
  "parents": [
    "5cd349c349d6ec52862e550d3576893d35ab8ac2"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/ethernet/intel/ice/ice_txrx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}