{
  "hash": "0b7c6075022ccff529318597dc6b165dd6a25c8f",
  "hash_short": "0b7c6075",
  "subject": "soc: samsung: exynos-pmu: Add regmap support for SoCs that protect PMU regs",
  "body": "Some Exynos based SoCs like Tensor gs101 protect the PMU registers for\nsecurity hardening reasons so that they are only write accessible in el3\nvia an SMC call.\n\nAs most Exynos drivers that need to write PMU registers currently obtain a\nregmap via syscon (phys, pinctrl, watchdog). Support for the above usecase\nis implemented in this driver using a custom regmap similar to syscon to\nhandle the SMC call. Platforms that don't secure PMU registers, get a mmio\nregmap like before. As regmaps abstract out the underlying register access\nchanges to the leaf drivers are minimal.\n\nA new API exynos_get_pmu_regmap_by_phandle() is provided for leaf drivers\nthat currently use syscon_regmap_lookup_by_phandle(). This also handles\ndeferred probing.\n\nTested-by: Sam Protsenko <semen.protsenko@linaro.org>\nTested-by: Alexey Klimov <alexey.klimov@linaro.org>\nReviewed-by: Sam Protsenko <semen.protsenko@linaro.org>\nSigned-off-by: Peter Griffin <peter.griffin@linaro.org>\nLink: https://lore.kernel.org/r/20240220220613.797068-2-peter.griffin@linaro.org\nSigned-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>",
  "full_message": "soc: samsung: exynos-pmu: Add regmap support for SoCs that protect PMU regs\n\nSome Exynos based SoCs like Tensor gs101 protect the PMU registers for\nsecurity hardening reasons so that they are only write accessible in el3\nvia an SMC call.\n\nAs most Exynos drivers that need to write PMU registers currently obtain a\nregmap via syscon (phys, pinctrl, watchdog). Support for the above usecase\nis implemented in this driver using a custom regmap similar to syscon to\nhandle the SMC call. Platforms that don't secure PMU registers, get a mmio\nregmap like before. As regmaps abstract out the underlying register access\nchanges to the leaf drivers are minimal.\n\nA new API exynos_get_pmu_regmap_by_phandle() is provided for leaf drivers\nthat currently use syscon_regmap_lookup_by_phandle(). This also handles\ndeferred probing.\n\nTested-by: Sam Protsenko <semen.protsenko@linaro.org>\nTested-by: Alexey Klimov <alexey.klimov@linaro.org>\nReviewed-by: Sam Protsenko <semen.protsenko@linaro.org>\nSigned-off-by: Peter Griffin <peter.griffin@linaro.org>\nLink: https://lore.kernel.org/r/20240220220613.797068-2-peter.griffin@linaro.org\nSigned-off-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>",
  "author_name": "Peter Griffin",
  "author_email": "peter.griffin@linaro.org",
  "author_date": "Tue Feb 20 22:06:12 2024 +0000",
  "author_date_iso": "2024-02-20T22:06:12+00:00",
  "committer_name": "Krzysztof Kozlowski",
  "committer_email": "krzysztof.kozlowski@linaro.org",
  "committer_date": "Sun Feb 25 11:39:23 2024 +0100",
  "committer_date_iso": "2024-02-25T11:39:23+01:00",
  "files_changed": [
    "drivers/soc/samsung/Kconfig",
    "drivers/soc/samsung/exynos-pmu.c",
    "drivers/soc/samsung/exynos-pmu.h",
    "include/linux/soc/samsung/exynos-pmu.h"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "drivers/soc/samsung/Kconfig",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/soc/samsung/exynos-pmu.c",
      "insertions": 233,
      "deletions": 2
    },
    {
      "file": "drivers/soc/samsung/exynos-pmu.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/linux/soc/samsung/exynos-pmu.h",
      "insertions": 10,
      "deletions": 1
    }
  ],
  "total_insertions": 245,
  "total_deletions": 3,
  "total_changes": 248,
  "parents": [
    "9690b9de81d1ad40a70b3d34b9d7e26486a5e83a"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/soc/samsung/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/soc/samsung/exynos-pmu.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/soc/samsung/exynos-pmu.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/soc/samsung/exynos-pmu.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}