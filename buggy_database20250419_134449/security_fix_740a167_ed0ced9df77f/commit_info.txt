Commit Hash: 740a16782750a5b6c7d1609a9c09641ce6753ea6
Subject: namei: allow set_root() to produce errors


Security Keywords:
- hardening

Full commit message:
namei: allow set_root() to produce errors

For LOOKUP_BENEATH and LOOKUP_IN_ROOT it is necessary to ensure that
set_root() is never called, and thus (for hardening purposes) it should
return an error rather than permit a breakout from the root. In
addition, move all of the repetitive set_root() calls to nd_jump_root().

Signed-off-by: Aleksa Sarai <cyphar@cyphar.com>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

Metadata:
Author: Aleksa Sarai <cyphar@cyphar.com>
Author Date: Sat Dec 7 01:13:29 2019 +1100
Committer: Al Viro <viro@zeniv.linux.org.uk>
Commit Date: Sun Dec 8 19:09:39 2019 -0500

Files Changed: 1
Lines Added: 24
Lines Removed: 11
Total Changes: 35
