{
  "hash": "8f3f6500c74935bfe5a9067e3106b806f336facf",
  "hash_short": "8f3f6500",
  "subject": "Merge branch 'TC-refactor-act_mirred-packets-re-injection'",
  "body": "Paolo Abeni says:\n\n====================\nTC: refactor act_mirred packets re-injection\n\nThis series is aimed at improving the act_mirred redirect performances.\nSuch action is used by OVS to represent TC S/W flows, and it's current largest\nbottle-neck is the need for a skb_clone() for each packet.\n\nThe first 2 patches introduce some cleanup and safeguards to allow extending\ntca_result - we will use it to store RCU protected redirect information - and\nintroduce a clear separation between user-space accessible tcfa_action\nvalues and internal values accessible only by the kernel.\nThen a new tcfa_action value is introduced: TC_ACT_REINJECT, similar to\nTC_ACT_REDIRECT, but preserving the mirred semantic. Such value is not\naccessible from user-space.\nThe last patch exploits the newly introduced infrastructure in the act_mirred\naction, to avoid a skb_clone, when possible.\n\nOverall this the above gives a ~10% performance improvement in forwarding tput,\nwhen using the TC S/W datapath.\n\nv1 -> v2:\n - preserve the rcu lock in act_bpf\n - add and use a new action value to reinject the packets, preserving the mirred\n   semantic\n\nv2 -> v3:\n - renamed to new action as TC_ACT_REINJECT\n - TC_ACT_REINJECT is not exposed to user-space\n\nv3 -> v4:\n - dropped the TC_ACT_REDIRECT patch\n - report failure via extack, too\n - rename the new action as TC_ACT_REINSERT\n - skip clone only if the control action don't touch tcf_result\n\nv4 -> v5:\n - fix a couple of build issue reported by kbuild bot\n - dont split messages\n====================\n\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "Merge branch 'TC-refactor-act_mirred-packets-re-injection'\n\nPaolo Abeni says:\n\n====================\nTC: refactor act_mirred packets re-injection\n\nThis series is aimed at improving the act_mirred redirect performances.\nSuch action is used by OVS to represent TC S/W flows, and it's current largest\nbottle-neck is the need for a skb_clone() for each packet.\n\nThe first 2 patches introduce some cleanup and safeguards to allow extending\ntca_result - we will use it to store RCU protected redirect information - and\nintroduce a clear separation between user-space accessible tcfa_action\nvalues and internal values accessible only by the kernel.\nThen a new tcfa_action value is introduced: TC_ACT_REINJECT, similar to\nTC_ACT_REDIRECT, but preserving the mirred semantic. Such value is not\naccessible from user-space.\nThe last patch exploits the newly introduced infrastructure in the act_mirred\naction, to avoid a skb_clone, when possible.\n\nOverall this the above gives a ~10% performance improvement in forwarding tput,\nwhen using the TC S/W datapath.\n\nv1 -> v2:\n - preserve the rcu lock in act_bpf\n - add and use a new action value to reinject the packets, preserving the mirred\n   semantic\n\nv2 -> v3:\n - renamed to new action as TC_ACT_REINJECT\n - TC_ACT_REINJECT is not exposed to user-space\n\nv3 -> v4:\n - dropped the TC_ACT_REDIRECT patch\n - report failure via extack, too\n - rename the new action as TC_ACT_REINSERT\n - skip clone only if the control action don't touch tcf_result\n\nv4 -> v5:\n - fix a couple of build issue reported by kbuild bot\n - dont split messages\n====================\n\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "David S. Miller",
  "author_email": "davem@davemloft.net",
  "author_date": "Mon Jul 30 09:31:14 2018 -0700",
  "author_date_iso": "2018-07-30T09:31:14-07:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Mon Jul 30 09:31:14 2018 -0700",
  "committer_date_iso": "2018-07-30T09:31:14-07:00",
  "files_changed": [],
  "files_changed_count": 0,
  "stats": [
    {
      "file": "include/net/act_api.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/net/pkt_cls.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "include/net/sch_generic.h",
      "insertions": 30,
      "deletions": 0
    },
    {
      "file": "include/uapi/linux/pkt_cls.h",
      "insertions": 4,
      "deletions": 2
    },
    {
      "file": "net/core/dev.c",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "net/sched/act_api.c",
      "insertions": 14,
      "deletions": 0
    },
    {
      "file": "net/sched/act_csum.c",
      "insertions": 3,
      "deletions": 9
    },
    {
      "file": "net/sched/act_ife.c",
      "insertions": 1,
      "deletions": 4
    },
    {
      "file": "net/sched/act_mirred.c",
      "insertions": 44,
      "deletions": 13
    },
    {
      "file": "net/sched/act_sample.c",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "net/sched/act_skbedit.c",
      "insertions": 3,
      "deletions": 7
    },
    {
      "file": "net/sched/act_skbmod.c",
      "insertions": 9,
      "deletions": 12
    },
    {
      "file": "net/sched/act_tunnel_key.c",
      "insertions": 1,
      "deletions": 5
    },
    {
      "file": "net/sched/act_vlan.c",
      "insertions": 7,
      "deletions": 12
    }
  ],
  "total_insertions": 126,
  "total_deletions": 69,
  "total_changes": 195,
  "parents": [
    "c87fffc57adf7b772b3778a9521c3f2ff744ae82",
    "e5cf1baf92cb785b90390db1c624948e70c8b8bd"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc1",
    "v4.19-rc2",
    "v4.19-rc3",
    "v4.19-rc4",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20"
  ],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": []
}