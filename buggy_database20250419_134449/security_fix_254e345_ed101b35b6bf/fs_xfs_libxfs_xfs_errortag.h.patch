commit 254e3459285cbf2174350bbc0051e475e1bc5196
Author: Darrick J. Wong <djwong@kernel.org>
Date:   Mon Nov 28 17:24:36 2022 -0800

    xfs: add debug knob to slow down write for fun
    
    Add a new error injection knob so that we can arbitrarily slow down
    pagecache writes to test for race conditions and aberrant reclaim
    behavior if the writeback mechanisms are slow to issue writeback.  This
    will enable functional testing for the ifork sequence counters
    introduced in commit 304a68b9c63b ("xfs: use iomap_valid method to
    detect stale cached iomaps") that fixes write racing with reclaim
    writeback.
    
    Signed-off-by: Darrick J. Wong <djwong@kernel.org>
    Reviewed-by: Dave Chinner <dchinner@redhat.com>

diff --git a/fs/xfs/libxfs/xfs_errortag.h b/fs/xfs/libxfs/xfs_errortag.h
index f5f629174eca..01a9e86b3037 100644
--- a/fs/xfs/libxfs/xfs_errortag.h
+++ b/fs/xfs/libxfs/xfs_errortag.h
@@ -62,7 +62,8 @@
 #define XFS_ERRTAG_DA_LEAF_SPLIT			40
 #define XFS_ERRTAG_ATTR_LEAF_TO_NODE			41
 #define XFS_ERRTAG_WB_DELAY_MS				42
-#define XFS_ERRTAG_MAX					43
+#define XFS_ERRTAG_WRITE_DELAY_MS			43
+#define XFS_ERRTAG_MAX					44
 
 /*
  * Random factors for above tags, 1 means always, 2 means 1/2 time, etc.
@@ -109,5 +110,6 @@
 #define XFS_RANDOM_DA_LEAF_SPLIT			1
 #define XFS_RANDOM_ATTR_LEAF_TO_NODE			1
 #define XFS_RANDOM_WB_DELAY_MS				3000
+#define XFS_RANDOM_WRITE_DELAY_MS			3000
 
 #endif /* __XFS_ERRORTAG_H_ */