Commit Hash: bb6705c3f93bed2af03d43691743d4c43e3c8e6f
Subject: bpf: add check for invalid name in btf_name_valid_section()


Security Keywords:
- vulnerability

Full commit message:
bpf: add check for invalid name in btf_name_valid_section()

If the length of the name string is 1 and the value of name[0] is NULL
byte, an OOB vulnerability occurs in btf_name_valid_section() and the
return value is true, so the invalid name passes the check.

To solve this, you need to check if the first position is NULL byte and
if the first character is printable.

Suggested-by: Eduard Zingerman <eddyz87@gmail.com>
Fixes: bd70a8fb7ca4 ("bpf: Allow all printable characters in BTF DATASEC names")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Link: https://lore.kernel.org/r/20240831054702.364455-1-aha310510@gmail.com
Signed-off-by: Alexei Starovoitov <ast@kernel.org>
Acked-by: Eduard Zingerman <eddyz87@gmail.com>

Metadata:
Author: Jeongjun Park <aha310510@gmail.com>
Author Date: Sat Aug 31 14:47:02 2024 +0900
Committer: Alexei Starovoitov <ast@kernel.org>
Commit Date: Wed Sep 4 11:56:34 2024 -0700

Files Changed: 1
Lines Added: 3
Lines Removed: 1
Total Changes: 4
