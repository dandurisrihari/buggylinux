commit 575c1bd549ff6bc097b3669b086e54e01169379f
Author: Vakul Garg <vakul@freescale.com>
Date:   Tue Mar 12 13:55:21 2013 +0530

    crypto: caam - set RDB bit in security configuration register
    
    This change is required for post SEC-5.0 devices which have RNG4.
    Setting RDB in security configuration register allows CAAM to use the
    "Random Data Buffer" to be filled by a single request. The Random Data
    Buffer is large enough for ten packets to get their IVs from a single
    request. If the Random Data Buffer is not enabled, then each IV causes a
    separate request, and RNG4 hardware cannot keep up resulting in lower
    IPSEC throughput if random IVs are used.
    
    Signed-off-by: Vakul Garg <vakul@freescale.com>
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

diff --git a/drivers/crypto/caam/ctrl.c b/drivers/crypto/caam/ctrl.c
index 1c56f63524f2..19faea2c31d1 100644
--- a/drivers/crypto/caam/ctrl.c
+++ b/drivers/crypto/caam/ctrl.c
@@ -304,6 +304,9 @@ static int caam_probe(struct platform_device *pdev)
 			caam_remove(pdev);
 			return ret;
 		}
+
+		/* Enable RDB bit so that RNG works faster */
+		setbits32(&topregs->ctrl.scfgr, SCFGR_RDBENABLE);
 	}
 
 	/* NOTE: RTIC detection ought to go here, around Si time */