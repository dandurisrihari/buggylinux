{
  "hash": "bd49e16e3339f052fae05fb3e955c5db0c9c6445",
  "hash_short": "bd49e16e",
  "subject": "x86/vsyscall: Add a new vsyscall=xonly mode",
  "body": "With vsyscall emulation on, a readable vsyscall page is still exposed that\ncontains syscall instructions that validly implement the vsyscalls.\n\nThis is required because certain dynamic binary instrumentation tools\nattempt to read the call targets of call instructions in the instrumented\ncode.  If the instrumented code uses vsyscalls, then the vsyscall page needs\nto contain readable code.\n\nUnfortunately, leaving readable memory at a deterministic address can be\nused to help various ASLR bypasses, so some hardening value can be gained\nby disallowing vsyscall reads.\n\nGiven how rarely the vsyscall page needs to be readable, add a mechanism to\nmake the vsyscall page be execute only.\n\nSigned-off-by: Andy Lutomirski <luto@kernel.org>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nReviewed-by: Kees Cook <keescook@chromium.org>\nCc: Florian Weimer <fweimer@redhat.com>\nCc: Jann Horn <jannh@google.com>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Kernel Hardening <kernel-hardening@lists.openwall.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nLink: https://lkml.kernel.org/r/d17655777c21bc09a7af1bbcf74e6f2b69a51152.1561610354.git.luto@kernel.org",
  "full_message": "x86/vsyscall: Add a new vsyscall=xonly mode\n\nWith vsyscall emulation on, a readable vsyscall page is still exposed that\ncontains syscall instructions that validly implement the vsyscalls.\n\nThis is required because certain dynamic binary instrumentation tools\nattempt to read the call targets of call instructions in the instrumented\ncode.  If the instrumented code uses vsyscalls, then the vsyscall page needs\nto contain readable code.\n\nUnfortunately, leaving readable memory at a deterministic address can be\nused to help various ASLR bypasses, so some hardening value can be gained\nby disallowing vsyscall reads.\n\nGiven how rarely the vsyscall page needs to be readable, add a mechanism to\nmake the vsyscall page be execute only.\n\nSigned-off-by: Andy Lutomirski <luto@kernel.org>\nSigned-off-by: Thomas Gleixner <tglx@linutronix.de>\nReviewed-by: Kees Cook <keescook@chromium.org>\nCc: Florian Weimer <fweimer@redhat.com>\nCc: Jann Horn <jannh@google.com>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Kernel Hardening <kernel-hardening@lists.openwall.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nLink: https://lkml.kernel.org/r/d17655777c21bc09a7af1bbcf74e6f2b69a51152.1561610354.git.luto@kernel.org",
  "author_name": "Andy Lutomirski",
  "author_email": "luto@kernel.org",
  "author_date": "Wed Jun 26 21:45:03 2019 -0700",
  "author_date_iso": "2019-06-26T21:45:03-07:00",
  "committer_name": "Thomas Gleixner",
  "committer_email": "tglx@linutronix.de",
  "committer_date": "Fri Jun 28 00:04:38 2019 +0200",
  "committer_date_iso": "2019-06-28T00:04:38+02:00",
  "files_changed": [
    "Documentation/admin-guide/kernel-parameters.txt",
    "arch/x86/Kconfig",
    "arch/x86/entry/vsyscall/vsyscall_64.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "Documentation/admin-guide/kernel-parameters.txt",
      "insertions": 6,
      "deletions": 1
    },
    {
      "file": "arch/x86/Kconfig",
      "insertions": 24,
      "deletions": 9
    },
    {
      "file": "arch/x86/entry/vsyscall/vsyscall_64.c",
      "insertions": 14,
      "deletions": 2
    }
  ],
  "total_insertions": 44,
  "total_deletions": 12,
  "total_changes": 56,
  "parents": [
    "d974ffcfb7447db5f29a4b662a3eaf99a4e1109e"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.3",
    "v5.3-rc1",
    "v5.3-rc2",
    "v5.3-rc3",
    "v5.3-rc4",
    "v5.3-rc5",
    "v5.3-rc6",
    "v5.3-rc7",
    "v5.3-rc8",
    "v5.4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "Documentation/admin-guide/kernel-parameters.txt",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/entry/vsyscall/vsyscall_64.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}