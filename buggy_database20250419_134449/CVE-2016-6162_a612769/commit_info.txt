Commit Hash: a612769774a30e4fc143c4cb6395c12573415660
Subject: udp: prevent bugcheck if filter truncates packet too much

CVE Identifiers:
- CVE-2016-6162

Full commit message:
udp: prevent bugcheck if filter truncates packet too much

If socket filter truncates an udp packet below the length of UDP header
in udpv6_queue_rcv_skb() or udp_queue_rcv_skb(), it will trigger a
BUG_ON in skb_pull_rcsum(). This BUG_ON (and therefore a system crash if
kernel is configured that way) can be easily enforced by an unprivileged
user which was reported as CVE-2016-6162. For a reproducer, see
http://seclists.org/oss-sec/2016/q3/8

Fixes: e6afc8ace6dd ("udp: remove headers from UDP packets before queueing")
Reported-by: Marco Grassi <marco.gra@gmail.com>
Signed-off-by: Michal Kubecek <mkubecek@suse.cz>
Acked-by: Eric Dumazet <edumazet@google.com>
Acked-by: Willem de Bruijn <willemb@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Michal Kubeƒçek <mkubecek@suse.cz>
Author Date: Fri Jul 8 17:52:33 2016 +0200
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Jul 11 12:43:15 2016 -0700

Files Changed: 2
Lines Added: 4
Lines Removed: 0
Total Changes: 4
