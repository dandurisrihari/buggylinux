Commit Hash: b23316aabffa835ecc516cb81daeef5b9155e8a5
Subject: selftests/bpf: Add missing trampoline program type to trampoline_count test


Security Keywords:
- injection

Full commit message:
selftests/bpf: Add missing trampoline program type to trampoline_count test

Currently the trampoline_count test doesn't include any fmod_ret bpf
programs, fix it to make the test cover all possible trampoline program
types.

Since fmod_ret bpf programs can't be attached to __set_task_comm function,
as it's neither whitelisted for error injection nor a security hook, change
it to bpf_modify_return_test.

This patch also does some other cleanups such as removing duplicate code,
dropping inconsistent comments, etc.

Signed-off-by: Yuntao Wang <ytcoode@gmail.com>
Signed-off-by: Andrii Nakryiko <andrii@kernel.org>
Acked-by: Yonghong Song <yhs@fb.com>
Link: https://lore.kernel.org/bpf/20220519150610.601313-1-ytcoode@gmail.com

Metadata:
Author: Yuntao Wang <ytcoode@gmail.com>
Author Date: Thu May 19 23:06:10 2022 +0800
Committer: Andrii Nakryiko <andrii@kernel.org>
Commit Date: Fri May 20 16:12:14 2022 -0700

Files Changed: 3
Lines Added: 61
Lines Removed: 91
Total Changes: 152
