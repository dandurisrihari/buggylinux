Commit Hash: 7dff3125534c1d035a910052335a3a39fbb31aa7
Subject: mac80211: Fix frame injection using non-AP vif


Security Keywords:
- injection

Full commit message:
mac80211: Fix frame injection using non-AP vif

In order for frame injection to work properly for some use cases
(e.g., finding the station entry and keys for encryption), mac80211
needs to find the correct sdata entry. This works when the main vif
is in AP mode, but commit a2c1e3dad516618cb0fbfb1a62c36d0b0744573a
broke this particular use case for station main vif. While this type of
injection is quite unusual operation, it has some uses and we should fix
it. Do this by changing the monitor vif sdata selection to allow station
vif to be selected instead of limiting it to just AP vifs. We still need
to skip some iftypes to avoid selecting unsuitable vif for injection.

Signed-off-by: Jouni Malinen <jouni.malinen@atheros.com>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Jouni Malinen <jouni.malinen@atheros.com>
Author Date: Fri Nov 26 20:41:55 2010 +0200
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Mon Nov 29 14:41:28 2010 -0500

Files Changed: 1
Lines Added: 6
Lines Removed: 1
Total Changes: 7
