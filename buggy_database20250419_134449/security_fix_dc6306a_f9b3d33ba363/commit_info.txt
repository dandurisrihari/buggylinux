Commit Hash: dc6306ad5b0dda040baf1fde3cfd458e6abfc4da
Subject: x86/srso: Fix vulnerability reporting for missing microcode


Security Keywords:
- vulnerability

Full commit message:
x86/srso: Fix vulnerability reporting for missing microcode

The SRSO default safe-ret mitigation is reported as "mitigated" even if
microcode hasn't been updated.  That's wrong because userspace may still
be vulnerable to SRSO attacks due to IBPB not flushing branch type
predictions.

Report the safe-ret + !microcode case as vulnerable.

Also report the microcode-only case as vulnerable as it leaves the
kernel open to attacks.

Fixes: fb3bd914b3ec ("x86/srso: Add a Speculative RAS Overflow mitigation")
Signed-off-by: Josh Poimboeuf <jpoimboe@kernel.org>
Signed-off-by: Ingo Molnar <mingo@kernel.org>
Signed-off-by: Borislav Petkov (AMD) <bp@alien8.de>
Acked-by: Borislav Petkov (AMD) <bp@alien8.de>
Link: https://lore.kernel.org/r/a8a14f97d1b0e03ec255c81637afdf4cf0ae9c99.1693889988.git.jpoimboe@kernel.org

Metadata:
Author: Josh Poimboeuf <jpoimboe@kernel.org>
Author Date: Mon Sep 4 22:04:52 2023 -0700
Committer: Borislav Petkov (AMD) <bp@alien8.de>
Commit Date: Fri Oct 20 11:46:09 2023 +0200

Files Changed: 2
Lines Added: 39
Lines Removed: 21
Total Changes: 60
