Commit Hash: 2ebc3464781ad24474abcbd2274e6254689853b5
Subject: Btrfs: fix checks in BTRFS_IOC_CLONE_RANGE


Security Keywords:
- exploit

Full commit message:
Btrfs: fix checks in BTRFS_IOC_CLONE_RANGE

1.  The BTRFS_IOC_CLONE and BTRFS_IOC_CLONE_RANGE ioctls should check
whether the donor file is append-only before writing to it.

2.  The BTRFS_IOC_CLONE_RANGE ioctl appears to have an integer
overflow that allows a user to specify an out-of-bounds range to copy
from the source file (if off + len wraps around).  I haven't been able
to successfully exploit this, but I'd imagine that a clever attacker
could use this to read things he shouldn't.  Even if it's not
exploitable, it couldn't hurt to be safe.

Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com>
cc: stable@kernel.org
Signed-off-by: Chris Mason <chris.mason@oracle.com>

Metadata:
Author: Dan Rosenberg <dan.j.rosenberg@gmail.com>
Author Date: Mon Jul 19 16:58:20 2010 -0400
Committer: Chris Mason <chris.mason@oracle.com>
Commit Date: Mon Jul 19 16:58:20 2010 -0400

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
