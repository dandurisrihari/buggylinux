{
  "hash": "65eea8edc315589d6c993cf12dbb5d0e9ef1fe4e",
  "hash_short": "65eea8ed",
  "subject": "floppy: Do not copy a kernel pointer to user memory in FDGETPRM ioctl",
  "body": "The final field of a floppy_struct is the field \"name\", which is a pointer\nto a string in kernel memory.  The kernel pointer should not be copied to\nuser memory.  The FDGETPRM ioctl copies a floppy_struct to user memory,\nincluding this \"name\" field.  This pointer cannot be used by the user\nand it will leak a kernel address to user-space, which will reveal the\nlocation of kernel code and data and undermine KASLR protection.\n\nModel this code after the compat ioctl which copies the returned data\nto a previously cleared temporary structure on the stack (excluding the\nname pointer) and copy out to userspace from there.  As we already have\nan inparam union with an appropriate member and that memory is already\ncleared even for read only calls make use of that as a temporary store.\n\nBased on an initial patch by Brian Belleville.\n\nCVE-2018-7755\nSigned-off-by: Andy Whitcroft <apw@canonical.com>\n\nBroke up long line.\n\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
  "full_message": "floppy: Do not copy a kernel pointer to user memory in FDGETPRM ioctl\n\nThe final field of a floppy_struct is the field \"name\", which is a pointer\nto a string in kernel memory.  The kernel pointer should not be copied to\nuser memory.  The FDGETPRM ioctl copies a floppy_struct to user memory,\nincluding this \"name\" field.  This pointer cannot be used by the user\nand it will leak a kernel address to user-space, which will reveal the\nlocation of kernel code and data and undermine KASLR protection.\n\nModel this code after the compat ioctl which copies the returned data\nto a previously cleared temporary structure on the stack (excluding the\nname pointer) and copy out to userspace from there.  As we already have\nan inparam union with an appropriate member and that memory is already\ncleared even for read only calls make use of that as a temporary store.\n\nBased on an initial patch by Brian Belleville.\n\nCVE-2018-7755\nSigned-off-by: Andy Whitcroft <apw@canonical.com>\n\nBroke up long line.\n\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
  "author_name": "Andy Whitcroft",
  "author_email": "apw@canonical.com",
  "author_date": "Thu Sep 20 09:09:48 2018 -0600",
  "author_date_iso": "2018-09-20T09:09:48-06:00",
  "committer_name": "Jens Axboe",
  "committer_email": "axboe@kernel.dk",
  "committer_date": "Thu Sep 20 09:09:48 2018 -0600",
  "committer_date_iso": "2018-09-20T09:09:48-06:00",
  "files_changed": [
    "drivers/block/floppy.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/block/floppy.c",
      "insertions": 3,
      "deletions": 0
    }
  ],
  "total_insertions": 3,
  "total_deletions": 0,
  "total_changes": 3,
  "parents": [
    "7ce5c8cd753f9afa8e79e9ec40351998e354f239"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20",
    "v4.20-rc1",
    "v4.20-rc2",
    "v4.20-rc3",
    "v4.20-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2018-7755"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/block/floppy.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}