{
  "hash": "4f704dc03297406ea5d53b85c4666c60f69000bf",
  "hash_short": "4f704dc0",
  "subject": "[SCSI] libiscsi: fix login/text checks in pdu injection code",
  "body": "For some reason we used to check for the the immediate bit\nset and the opcocde in many places instead of just masking\nthe opcode. In the passthrough code this is a problem\nbecause userspace may or may not have set the immediate bit\nand it does not have to. This fixes up the opcode checks\nin the passthrough code, so we mask off the opcode then\ncheck against the iscsi proto definition like is done in\nother places.\n\nSigned-off-by: Mike Christie <michaelc@cs.wisc.edu>\nSigned-off-by: James Bottomley <James.Bottomley@suse.de>",
  "full_message": "[SCSI] libiscsi: fix login/text checks in pdu injection code\n\nFor some reason we used to check for the the immediate bit\nset and the opcocde in many places instead of just masking\nthe opcode. In the passthrough code this is a problem\nbecause userspace may or may not have set the immediate bit\nand it does not have to. This fixes up the opcode checks\nin the passthrough code, so we mask off the opcode then\ncheck against the iscsi proto definition like is done in\nother places.\n\nSigned-off-by: Mike Christie <michaelc@cs.wisc.edu>\nSigned-off-by: James Bottomley <James.Bottomley@suse.de>",
  "author_name": "Mike Christie",
  "author_email": "michaelc@cs.wisc.edu",
  "author_date": "Wed Nov 11 16:34:31 2009 -0600",
  "author_date_iso": "2009-11-11T16:34:31-06:00",
  "committer_name": "James Bottomley",
  "committer_email": "James.Bottomley@suse.de",
  "committer_date": "Fri Dec 4 12:01:35 2009 -0600",
  "committer_date_iso": "2009-12-04T12:01:35-06:00",
  "files_changed": [
    "drivers/scsi/libiscsi.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/scsi/libiscsi.c",
      "insertions": 15,
      "deletions": 6
    }
  ],
  "total_insertions": 15,
  "total_deletions": 6,
  "total_changes": 21,
  "parents": [
    "24246de77503978cfcd7e76f06404e60e399992f"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.33",
    "v2.6.33-rc1",
    "v2.6.33-rc2",
    "v2.6.33-rc3",
    "v2.6.33-rc4",
    "v2.6.33-rc5",
    "v2.6.33-rc6",
    "v2.6.33-rc7",
    "v2.6.33-rc8",
    "v2.6.34"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/scsi/libiscsi.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}