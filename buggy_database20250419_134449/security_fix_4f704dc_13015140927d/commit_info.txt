Commit Hash: 4f704dc03297406ea5d53b85c4666c60f69000bf
Subject: [SCSI] libiscsi: fix login/text checks in pdu injection code


Security Keywords:
- injection

Full commit message:
[SCSI] libiscsi: fix login/text checks in pdu injection code

For some reason we used to check for the the immediate bit
set and the opcocde in many places instead of just masking
the opcode. In the passthrough code this is a problem
because userspace may or may not have set the immediate bit
and it does not have to. This fixes up the opcode checks
in the passthrough code, so we mask off the opcode then
check against the iscsi proto definition like is done in
other places.

Signed-off-by: Mike Christie <michaelc@cs.wisc.edu>
Signed-off-by: James Bottomley <James.Bottomley@suse.de>

Metadata:
Author: Mike Christie <michaelc@cs.wisc.edu>
Author Date: Wed Nov 11 16:34:31 2009 -0600
Committer: James Bottomley <James.Bottomley@suse.de>
Commit Date: Fri Dec 4 12:01:35 2009 -0600

Files Changed: 1
Lines Added: 15
Lines Removed: 6
Total Changes: 21
