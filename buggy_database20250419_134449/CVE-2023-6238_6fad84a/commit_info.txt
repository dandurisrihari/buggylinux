Commit Hash: 6fad84a4d624c300d03ebba457cc641765050c43
Subject: nvme-pci: use sgls for all user requests if possible

CVE Identifiers:
- CVE-2023-6238

Full commit message:
nvme-pci: use sgls for all user requests if possible

If the device supports SGLs, use these for all user requests. This
format encodes the expected transfer length so it can catch short buffer
errors in a user command, whether it occurred accidently or maliciously.

For controllers that support SGL data mode, this is a viable mitigation
to CVE-2023-6238. For controllers that don't support SGLs, log a warning
in the passthrough path since not having the capability can corrupt
data if the interface is not used correctly.

Reviewed-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Keith Busch <kbusch@kernel.org>

Metadata:
Author: Keith Busch <kbusch@kernel.org>
Author Date: Fri Nov 8 15:41:08 2024 -0800
Committer: Keith Busch <kbusch@kernel.org>
Commit Date: Mon Nov 18 09:27:47 2024 -0800

Files Changed: 2
Lines Added: 13
Lines Removed: 4
Total Changes: 17
