Commit Hash: a07e9345615fb7e7dd4fd5d88d5aaf49085739d0
Subject: KVM: arm64: Constraint PAuth support to consistent implementations


Security Keywords:
- authentication

Full commit message:
KVM: arm64: Constraint PAuth support to consistent implementations

PAuth comes it two parts: address authentication, and generic
authentication. So far, KVM mandates that both are implemented.

PAuth also comes in three flavours: Q5, Q3, and IMPDEF. Only one
can be implemented for any of address and generic authentication.

Crucially, the architecture doesn't mandate that address and generic
authentication implement the *same* flavour. This would make
implementing ERETAx very difficult for NV, something we are not
terribly keen on.

So only allow PAuth support for KVM on systems that are not totally
insane. Which is so far 100% of the known HW.

Reviewed-by: Oliver Upton <oliver.upton@linux.dev>
Link: https://lore.kernel.org/r/20240419102935.1935571-4-maz@kernel.org
Signed-off-by: Marc Zyngier <maz@kernel.org>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Fri Apr 19 11:29:23 2024 +0100
Committer: Marc Zyngier <maz@kernel.org>
Commit Date: Sat Apr 20 12:42:50 2024 +0100

Files Changed: 1
Lines Added: 36
Lines Removed: 2
Total Changes: 38
