Commit Hash: 3968523f855050b8195134da951b87c20bd66130
Subject: mpls, nospec: Sanitize array index in mpls_label_ok()


Security Keywords:
- Sanitize
- vulnerability

Full commit message:
mpls, nospec: Sanitize array index in mpls_label_ok()

mpls_label_ok() validates that the 'platform_label' array index from a
userspace netlink message payload is valid. Under speculation the
mpls_label_ok() result may not resolve in the CPU pipeline until after
the index is used to access an array element. Sanitize the index to zero
to prevent userspace-controlled arbitrary out-of-bounds speculation, a
precursor for a speculative execution side channel vulnerability.

Cc: <stable@vger.kernel.org>
Cc: "David S. Miller" <davem@davemloft.net>
Cc: Eric W. Biederman <ebiederm@xmission.com>
Signed-off-by: Dan Williams <dan.j.williams@intel.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Dan Williams <dan.j.williams@intel.com>
Author Date: Wed Feb 7 22:34:24 2018 -0800
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Thu Feb 8 15:24:12 2018 -0500

Files Changed: 1
Lines Added: 14
Lines Removed: 10
Total Changes: 24
