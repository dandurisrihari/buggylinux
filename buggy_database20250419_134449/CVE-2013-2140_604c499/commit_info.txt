Commit Hash: 604c499cbbcc3d5fe5fb8d53306aa0fae1990109
Subject: xen/blkback: Check device permissions before allowing OP_DISCARD

CVE Identifiers:
- CVE-2013-2140

Full commit message:
xen/blkback: Check device permissions before allowing OP_DISCARD

We need to make sure that the device is not RO or that
the request is not past the number of sectors we want to
issue the DISCARD operation for.

This fixes CVE-2013-2140.

Cc: stable@vger.kernel.org
Acked-by: Jan Beulich <JBeulich@suse.com>
Acked-by: Ian Campbell <Ian.Campbell@citrix.com>
[v1: Made it pr_warn instead of pr_debug]
Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>

Metadata:
Author: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
Author Date: Wed Jan 16 11:33:52 2013 -0500
Committer: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
Commit Date: Fri Jun 7 17:05:55 2013 -0400

Files Changed: 1
Lines Added: 12
Lines Removed: 1
Total Changes: 13
