commit 4340ba80bd3a310d8eb9011df2e63c6371e28113
Author: Marc Zyngier <maz@kernel.org>
Date:   Wed Mar 14 13:28:50 2018 +0000

    arm64: KVM: Move BP hardening vectors into .hyp.text section
    
    There is no reason why the BP hardening vectors shouldn't be part
    of the HYP text at compile time, rather than being mapped at runtime.
    
    Also introduce a new config symbol that controls the compilation
    of bpi.S.
    
    Acked-by: Catalin Marinas <catalin.marinas@arm.com>
    Reviewed-by: Andrew Jones <drjones@redhat.com>
    Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

diff --git a/arch/arm64/kvm/Kconfig b/arch/arm64/kvm/Kconfig
index 2257dfcc44cc..bd8cc03d7522 100644
--- a/arch/arm64/kvm/Kconfig
+++ b/arch/arm64/kvm/Kconfig
@@ -57,6 +57,9 @@ config KVM_ARM_PMU
 	  Adds support for a virtual Performance Monitoring Unit (PMU) in
 	  virtual machines.
 
+config KVM_INDIRECT_VECTORS
+       def_bool KVM && HARDEN_BRANCH_PREDICTOR
+
 source drivers/vhost/Kconfig
 
 endif # VIRTUALIZATION