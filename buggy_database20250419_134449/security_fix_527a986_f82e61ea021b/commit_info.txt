Commit Hash: 527a9867af29ff89f278d037db704e0ed50fb666
Subject: random: do not split fast init input in add_hwgenerator_randomness()


Security Keywords:
- injection

Full commit message:
random: do not split fast init input in add_hwgenerator_randomness()

add_hwgenerator_randomness() tries to only use the required amount of input
for fast init, but credits all the entropy, rather than a fraction of
it. Since it's hard to determine how much entropy is left over out of a
non-unformly random sample, either give it all to fast init or credit
it, but don't attempt to do both. In the process, we can clean up the
injection code to no longer need to return a value.

Signed-off-by: Jan Varho <jan.varho@gmail.com>
[Jason: expanded commit message]
Fixes: 73c7733f122e ("random: do not throw away excess input to crng_fast_load")
Cc: stable@vger.kernel.org # 5.17+, requires af704c856e88
Signed-off-by: Jason A. Donenfeld <Jason@zx2c4.com>

Metadata:
Author: Jan Varho <jan.varho@gmail.com>
Author Date: Mon Apr 4 19:42:30 2022 +0300
Committer: Jason A. Donenfeld <Jason@zx2c4.com>
Commit Date: Mon Apr 4 19:34:49 2022 +0200

Files Changed: 1
Lines Added: 6
Lines Removed: 17
Total Changes: 23
