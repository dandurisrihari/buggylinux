{
  "hash": "6daca13d2e72bedaaacfc08f873114c9307d5aea",
  "hash_short": "6daca13d",
  "subject": "libceph: add authorizer challenge",
  "body": "When a client authenticates with a service, an authorizer is sent with\na nonce to the service (ceph_x_authorize_[ab]) and the service responds\nwith a mutation of that nonce (ceph_x_authorize_reply).  This lets the\nclient verify the service is who it says it is but it doesn't protect\nagainst a replay: someone can trivially capture the exchange and reuse\nthe same authorizer to authenticate themselves.\n\nAllow the service to reject an initial authorizer with a random\nchallenge (ceph_x_authorize_challenge).  The client then has to respond\nwith an updated authorizer proving they are able to decrypt the\nservice's challenge and that the new authorizer was produced for this\nspecific connection instance.\n\nThe accepting side requires this challenge and response unconditionally\nif the client side advertises they have CEPHX_V2 feature bit.\n\nThis addresses CVE-2018-1128.\n\nLink: http://tracker.ceph.com/issues/24836\nSigned-off-by: Ilya Dryomov <idryomov@gmail.com>\nReviewed-by: Sage Weil <sage@redhat.com>",
  "full_message": "libceph: add authorizer challenge\n\nWhen a client authenticates with a service, an authorizer is sent with\na nonce to the service (ceph_x_authorize_[ab]) and the service responds\nwith a mutation of that nonce (ceph_x_authorize_reply).  This lets the\nclient verify the service is who it says it is but it doesn't protect\nagainst a replay: someone can trivially capture the exchange and reuse\nthe same authorizer to authenticate themselves.\n\nAllow the service to reject an initial authorizer with a random\nchallenge (ceph_x_authorize_challenge).  The client then has to respond\nwith an updated authorizer proving they are able to decrypt the\nservice's challenge and that the new authorizer was produced for this\nspecific connection instance.\n\nThe accepting side requires this challenge and response unconditionally\nif the client side advertises they have CEPHX_V2 feature bit.\n\nThis addresses CVE-2018-1128.\n\nLink: http://tracker.ceph.com/issues/24836\nSigned-off-by: Ilya Dryomov <idryomov@gmail.com>\nReviewed-by: Sage Weil <sage@redhat.com>",
  "author_name": "Ilya Dryomov",
  "author_email": "idryomov@gmail.com",
  "author_date": "Fri Jul 27 19:18:34 2018 +0200",
  "author_date_iso": "2018-07-27T19:18:34+02:00",
  "committer_name": "Ilya Dryomov",
  "committer_email": "idryomov@gmail.com",
  "committer_date": "Thu Aug 2 21:33:24 2018 +0200",
  "committer_date_iso": "2018-08-02T21:33:24+02:00",
  "files_changed": [
    "fs/ceph/mds_client.c",
    "include/linux/ceph/auth.h",
    "include/linux/ceph/messenger.h",
    "include/linux/ceph/msgr.h",
    "net/ceph/auth.c",
    "net/ceph/auth_x.c",
    "net/ceph/auth_x_protocol.h",
    "net/ceph/messenger.c",
    "net/ceph/osd_client.c"
  ],
  "files_changed_count": 9,
  "stats": [
    {
      "file": "fs/ceph/mds_client.c",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "include/linux/ceph/auth.h",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "include/linux/ceph/messenger.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "include/linux/ceph/msgr.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/ceph/auth.c",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "net/ceph/auth_x.c",
      "insertions": 67,
      "deletions": 5
    },
    {
      "file": "net/ceph/auth_x_protocol.h",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "net/ceph/messenger.c",
      "insertions": 16,
      "deletions": 1
    },
    {
      "file": "net/ceph/osd_client.c",
      "insertions": 11,
      "deletions": 0
    }
  ],
  "total_insertions": 140,
  "total_deletions": 7,
  "total_changes": 147,
  "parents": [
    "149cac4a50b0b4081b38b2f38de6ef71c27eaa85"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc1",
    "v4.19-rc2",
    "v4.19-rc3",
    "v4.19-rc4",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2018-1128"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "include/linux/ceph/auth.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/ceph/msgr.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/ceph/messenger.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/ceph/mds_client.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ceph/auth.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ceph/auth_x.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ceph/messenger.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ceph/osd_client.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ceph/auth_x_protocol.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}