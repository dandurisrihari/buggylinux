{
  "hash": "c8407f2e560c53c4c73e77cb5604c8a408dbe7f7",
  "hash_short": "c8407f2e",
  "subject": "NFS: Add an \"xprtsec=\" NFS mount option",
  "body": "After some discussion, we decided that controlling transport layer\nsecurity policy should be separate from the setting for the user\nauthentication flavor. To accomplish this, add a new NFS mount\noption to select a transport layer security policy for RPC\noperations associated with the mount point.\n\n  xprtsec=none     - Transport layer security is forced off.\n\n  xprtsec=tls      - Establish an encryption-only TLS session. If\n                     the initial handshake fails, the mount fails.\n                     If TLS is not available on a reconnect, drop\n                     the connection and try again.\n\n  xprtsec=mtls     - Both sides authenticate and an encrypted\n                     session is created. If the initial handshake\n                     fails, the mount fails. If TLS is not available\n                     on a reconnect, drop the connection and try\n                     again.\n\nTo support client peer authentication (mtls), the handshake daemon\nwill have configurable default authentication material (certificate\nor pre-shared key). In the future, mount options can be added that\ncan provide this material on a per-mount basis.\n\nUpdates to mount.nfs (to support xprtsec=auto) and nfs(5) will be\nsent under separate cover.\n\nSigned-off-by: Chuck Lever <chuck.lever@oracle.com>\nSigned-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>",
  "full_message": "NFS: Add an \"xprtsec=\" NFS mount option\n\nAfter some discussion, we decided that controlling transport layer\nsecurity policy should be separate from the setting for the user\nauthentication flavor. To accomplish this, add a new NFS mount\noption to select a transport layer security policy for RPC\noperations associated with the mount point.\n\n  xprtsec=none     - Transport layer security is forced off.\n\n  xprtsec=tls      - Establish an encryption-only TLS session. If\n                     the initial handshake fails, the mount fails.\n                     If TLS is not available on a reconnect, drop\n                     the connection and try again.\n\n  xprtsec=mtls     - Both sides authenticate and an encrypted\n                     session is created. If the initial handshake\n                     fails, the mount fails. If TLS is not available\n                     on a reconnect, drop the connection and try\n                     again.\n\nTo support client peer authentication (mtls), the handshake daemon\nwill have configurable default authentication material (certificate\nor pre-shared key). In the future, mount options can be added that\ncan provide this material on a per-mount basis.\n\nUpdates to mount.nfs (to support xprtsec=auto) and nfs(5) will be\nsent under separate cover.\n\nSigned-off-by: Chuck Lever <chuck.lever@oracle.com>\nSigned-off-by: Trond Myklebust <trond.myklebust@hammerspace.com>",
  "author_name": "Chuck Lever",
  "author_email": "chuck.lever@oracle.com",
  "author_date": "Wed Jun 7 10:00:09 2023 -0400",
  "author_date_iso": "2023-06-07T10:00:09-04:00",
  "committer_name": "Trond Myklebust",
  "committer_email": "trond.myklebust@hammerspace.com",
  "committer_date": "Mon Jun 19 12:30:17 2023 -0400",
  "committer_date_iso": "2023-06-19T12:30:17-04:00",
  "files_changed": [
    "fs/nfs/client.c",
    "fs/nfs/fs_context.c",
    "fs/nfs/internal.h",
    "fs/nfs/nfs3client.c",
    "fs/nfs/nfs4client.c",
    "fs/nfs/super.c"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "fs/nfs/client.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "fs/nfs/fs_context.c",
      "insertions": 62,
      "deletions": 0
    },
    {
      "file": "fs/nfs/internal.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "fs/nfs/nfs3client.c",
      "insertions": 6,
      "deletions": 2
    },
    {
      "file": "fs/nfs/nfs4client.c",
      "insertions": 18,
      "deletions": 10
    },
    {
      "file": "fs/nfs/super.c",
      "insertions": 12,
      "deletions": 0
    }
  ],
  "total_insertions": 102,
  "total_deletions": 15,
  "total_changes": 117,
  "parents": [
    "6c0a8c5fcf7158e889dbdd077f67c81984704710"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/nfs/internal.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/nfs/fs_context.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/nfs/nfs4client.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/nfs/nfs3client.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/nfs/super.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/nfs/client.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}