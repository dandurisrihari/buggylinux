Commit Hash: 10d5ea5a436da8d60cdb5845f454d595accdbce0
Subject: wifi: nl80211: Split memcpy() of struct nl80211_wowlan_tcp_data_token flexible array


Security Keywords:
- hardening

Full commit message:
wifi: nl80211: Split memcpy() of struct nl80211_wowlan_tcp_data_token flexible array

To work around a misbehavior of the compiler's ability to see into
composite flexible array structs (as detailed in the coming memcpy()
hardening series[1]), split the memcpy() of the header and the payload
so no false positive run-time overflow warning will be generated.

[1] https://lore.kernel.org/linux-hardening/20220901065914.1417829-2-keescook@chromium.org/

Signed-off-by: Kees Cook <keescook@chromium.org>
Reviewed-by: Gustavo A. R. Silva <gustavoars@kernel.org>
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Mon Sep 26 19:29:23 2022 -0700
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Fri Oct 7 15:19:06 2022 +0200

Files Changed: 1
Lines Added: 3
Lines Removed: 1
Total Changes: 4
