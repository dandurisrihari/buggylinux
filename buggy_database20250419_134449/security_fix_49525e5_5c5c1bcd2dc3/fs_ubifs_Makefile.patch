commit 49525e5eecca5e1b4a83ac217868e8d8b843539f
Author: Sascha Hauer <s.hauer@pengutronix.de>
Date:   Fri Sep 7 14:36:32 2018 +0200

    ubifs: Add helper functions for authentication support
    
    This patch adds the various helper functions needed for authentication
    support. We need functions to hash nodes, to embed HMACs into a node and
    to compare hashes and HMACs. Most functions first check if this
    filesystem is authenticated and bail out early if not, which makes the
    functions safe to be called with disabled authentication.
    
    Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
    Signed-off-by: Richard Weinberger <richard@nod.at>

diff --git a/fs/ubifs/Makefile b/fs/ubifs/Makefile
index 6197d7e539e4..5f838319c8d5 100644
--- a/fs/ubifs/Makefile
+++ b/fs/ubifs/Makefile
@@ -8,3 +8,4 @@ ubifs-y += recovery.o ioctl.o lpt_commit.o tnc_misc.o debug.o
 ubifs-y += misc.o
 ubifs-$(CONFIG_UBIFS_FS_ENCRYPTION) += crypto.o
 ubifs-$(CONFIG_UBIFS_FS_XATTR) += xattr.o
+ubifs-$(CONFIG_UBIFS_FS_AUTHENTICATION) += auth.o