Commit Hash: 0f4a837615ff925ba62648d280a861adf1582df7
Subject: x86/bhi: Define SPEC_CTRL_BHI_DIS_S


Security Keywords:
- Injection

Full commit message:
x86/bhi: Define SPEC_CTRL_BHI_DIS_S

Newer processors supports a hardware control BHI_DIS_S to mitigate
Branch History Injection (BHI). Setting BHI_DIS_S protects the kernel
from userspace BHI attacks without having to manually overwrite the
branch history.

Define MSR_SPEC_CTRL bit BHI_DIS_S and its enumeration CPUID.BHI_CTRL.
Mitigation is enabled later.

Signed-off-by: Daniel Sneddon <daniel.sneddon@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Daniel Sneddon <daniel.sneddon@linux.intel.com>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Reviewed-by: Alexandre Chartre <alexandre.chartre@oracle.com>
Reviewed-by: Josh Poimboeuf <jpoimboe@kernel.org>

Metadata:
Author: Daniel Sneddon <daniel.sneddon@linux.intel.com>
Author Date: Wed Mar 13 09:47:57 2024 -0700
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Mon Apr 8 19:27:05 2024 +0200

Files Changed: 4
Lines Added: 8
Lines Removed: 2
Total Changes: 10
