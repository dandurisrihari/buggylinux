Commit Hash: 339f4f4eab80caa6cf0d39fb057ad6ddb84ba91e
Subject: [SCSI] zfcp: Trigger logging in the FCP channel on qdio error conditions


Security Keywords:
- Exploit

Full commit message:
[SCSI] zfcp: Trigger logging in the FCP channel on qdio error conditions

Exploit the cio siosl function to trigger logging in the FCP channel
on qdio error conditions. Add a helper function in zfcp_qdio to ensure
that tracing is only triggered once before calling qdio_shutdown.

Trigger in zfcp for hardware logs are:
 - timeout for FSF requests to the FCP channel
 - "no recommendation" status from FCP channel
 - invalid FSF protocol status
 - stalled outbound queue
 - unknown request id on inbound queue
 - QDIO_ERROR_SLSB_STATE

All of the above triggers run from the Linux qdio softirq context, so
no additional synchronization is necessary for the handling of the
ZFCP_STATUS_ADAPTER_SIOSL_ISSUED flag.

Reviewed-by: Swen Schillig <swen@vnet.ibm.com>
Signed-off-by: Christof Schmitt <christof.schmitt@de.ibm.com>
Signed-off-by: James Bottomley <James.Bottomley@suse.de>

Metadata:
Author: Christof Schmitt <christof.schmitt@de.ibm.com>
Author Date: Fri Jul 16 15:37:43 2010 +0200
Committer: James Bottomley <James.Bottomley@suse.de>
Commit Date: Wed Jul 28 09:48:58 2010 -0500

Files Changed: 4
Lines Added: 40
Lines Removed: 4
Total Changes: 44
