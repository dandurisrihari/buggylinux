{
  "hash": "c1de45ca831acee9b72c9320dde447edafadb43f",
  "hash_short": "c1de45ca",
  "subject": "sched/idle: Add support for tasks that inject idle",
  "body": "Idle injection drivers such as Intel powerclamp and ACPI PAD drivers use\nrealtime tasks to take control of CPU then inject idle. There are two\nissues with this approach:\n\n 1. Low efficiency: injected idle task is treated as busy so sched ticks\n    do not stop during injected idle period, the result of these\n    unwanted wakeups can be ~20% loss in power savings.\n\n 2. Idle accounting: injected idle time is presented to user as busy.\n\nThis patch addresses the issues by introducing a new PF_IDLE flag which\nallows any given task to be treated as idle task while the flag is set.\nTherefore, idle injection tasks can run through the normal flow of NOHZ\nidle enter/exit to get the correct accounting as well as tick stop when\npossible.\n\nThe implication is that idle task is then no longer limited to PID == 0.\n\nAcked-by: Ingo Molnar <mingo@kernel.org>\nSigned-off-by: Peter Zijlstra <peterz@infradead.org>\nSigned-off-by: Jacob Pan <jacob.jun.pan@linux.intel.com>\nSigned-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>",
  "full_message": "sched/idle: Add support for tasks that inject idle\n\nIdle injection drivers such as Intel powerclamp and ACPI PAD drivers use\nrealtime tasks to take control of CPU then inject idle. There are two\nissues with this approach:\n\n 1. Low efficiency: injected idle task is treated as busy so sched ticks\n    do not stop during injected idle period, the result of these\n    unwanted wakeups can be ~20% loss in power savings.\n\n 2. Idle accounting: injected idle time is presented to user as busy.\n\nThis patch addresses the issues by introducing a new PF_IDLE flag which\nallows any given task to be treated as idle task while the flag is set.\nTherefore, idle injection tasks can run through the normal flow of NOHZ\nidle enter/exit to get the correct accounting as well as tick stop when\npossible.\n\nThe implication is that idle task is then no longer limited to PID == 0.\n\nAcked-by: Ingo Molnar <mingo@kernel.org>\nSigned-off-by: Peter Zijlstra <peterz@infradead.org>\nSigned-off-by: Jacob Pan <jacob.jun.pan@linux.intel.com>\nSigned-off-by: Rafael J. Wysocki <rafael.j.wysocki@intel.com>",
  "author_name": "Peter Zijlstra",
  "author_email": "peterz@infradead.org",
  "author_date": "Mon Nov 28 23:03:05 2016 -0800",
  "author_date_iso": "2016-11-28T23:03:05-08:00",
  "committer_name": "Rafael J. Wysocki",
  "committer_email": "rafael.j.wysocki@intel.com",
  "committer_date": "Tue Nov 29 14:02:21 2016 +0100",
  "committer_date_iso": "2016-11-29T14:02:21+01:00",
  "files_changed": [
    "include/linux/cpu.h",
    "include/linux/sched.h",
    "kernel/fork.c",
    "kernel/sched/core.c",
    "kernel/sched/idle.c"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "include/linux/cpu.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "include/linux/sched.h",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "kernel/fork.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "kernel/sched/core.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "kernel/sched/idle.c",
      "insertions": 101,
      "deletions": 61
    }
  ],
  "total_insertions": 107,
  "total_deletions": 63,
  "total_changes": 170,
  "parents": [
    "bb8313b603eb8fd52de48a079bfcd72dcab2ef1e"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/linux/cpu.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/sched.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/fork.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/sched/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/sched/idle.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}