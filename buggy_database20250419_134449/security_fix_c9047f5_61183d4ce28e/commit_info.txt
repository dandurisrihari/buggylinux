Commit Hash: c9047f533373e934b96d19d6a3d313ca2132fbe5
Subject: KVM: Handle guest page faults when emulating mmio


Security Keywords:
- injection

Full commit message:
KVM: Handle guest page faults when emulating mmio

Usually, guest page faults are detected by the kvm page fault handler,
which detects if they are shadow faults, mmio faults, pagetable faults,
or normal guest page faults.

However, in ceratin circumstances, we can detect a page fault much later.
One of these events is the following combination:

- A two memory operand instruction (e.g. movsb) is executed.
- The first operand is in mmio space (which is the fault reported to kvm)
- The second operand is in an ummaped address (e.g. a guest page fault)

The Windows 2000 installer does such an access, an promptly hangs.  Fix
by adding the missing page fault injection on that path.

Signed-off-by: Avi Kivity <avi@qumranet.com>

Metadata:
Author: Avi Kivity <avi@qumranet.com>
Author Date: Tue Apr 17 10:53:22 2007 +0300
Committer: Avi Kivity <avi@qumranet.com>
Commit Date: Thu May 3 10:52:29 2007 +0300

Files Changed: 1
Lines Added: 3
Lines Removed: 1
Total Changes: 4
