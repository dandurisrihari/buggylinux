{
  "hash": "3edc6b0d6c061a70d8ca3c3c72eb1f58ce29bfb1",
  "hash_short": "3edc6b0d",
  "subject": "mac80211: extend protection against mixed key and fragment cache attacks",
  "body": "For some chips/drivers, e.g., QCA6174 with ath10k, the decryption is\ndone by the hardware, and the Protected bit in the Frame Control field\nis cleared in the lower level driver before the frame is passed to\nmac80211. In such cases, the condition for ieee80211_has_protected() is\nnot met in ieee80211_rx_h_defragment() of mac80211 and the new security\nvalidation steps are not executed.\n\nExtend mac80211 to cover the case where the Protected bit has been\ncleared, but the frame is indicated as having been decrypted by the\nhardware. This extends protection against mixed key and fragment cache\nattack for additional drivers/chips. This fixes CVE-2020-24586 and\nCVE-2020-24587 for such cases.\n\nTested-on: QCA6174 hw3.2 PCI WLAN.RM.4.4.1-00110-QCARMSWP-1\n\nCc: stable@vger.kernel.org\nSigned-off-by: Wen Gong <wgong@codeaurora.org>\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nLink: https://lore.kernel.org/r/20210511200110.037aa5ca0390.I7bb888e2965a0db02a67075fcb5deb50eb7408aa@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: extend protection against mixed key and fragment cache attacks\n\nFor some chips/drivers, e.g., QCA6174 with ath10k, the decryption is\ndone by the hardware, and the Protected bit in the Frame Control field\nis cleared in the lower level driver before the frame is passed to\nmac80211. In such cases, the condition for ieee80211_has_protected() is\nnot met in ieee80211_rx_h_defragment() of mac80211 and the new security\nvalidation steps are not executed.\n\nExtend mac80211 to cover the case where the Protected bit has been\ncleared, but the frame is indicated as having been decrypted by the\nhardware. This extends protection against mixed key and fragment cache\nattack for additional drivers/chips. This fixes CVE-2020-24586 and\nCVE-2020-24587 for such cases.\n\nTested-on: QCA6174 hw3.2 PCI WLAN.RM.4.4.1-00110-QCARMSWP-1\n\nCc: stable@vger.kernel.org\nSigned-off-by: Wen Gong <wgong@codeaurora.org>\nSigned-off-by: Jouni Malinen <jouni@codeaurora.org>\nLink: https://lore.kernel.org/r/20210511200110.037aa5ca0390.I7bb888e2965a0db02a67075fcb5deb50eb7408aa@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Wen Gong",
  "author_email": "wgong@codeaurora.org",
  "author_date": "Tue May 11 20:02:51 2021 +0200",
  "author_date_iso": "2021-05-11T20:02:51+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue May 11 20:14:50 2021 +0200",
  "committer_date_iso": "2021-05-11T20:14:50+02:00",
  "files_changed": [
    "net/mac80211/rx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/rx.c",
      "insertions": 11,
      "deletions": 2
    }
  ],
  "total_insertions": 11,
  "total_deletions": 2,
  "total_changes": 13,
  "parents": [
    "a8c4d76a8dd4fb9666fc8919a703d85fb8f44ed8"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2020-24586",
      "CVE-2020-24587"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/rx.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}