Commit Hash: 9eca9a8e81928685b4de00ecef83a7c13c340fc9
Subject: b43legacy: drop packets we are not able to encrypt


Security Keywords:
- security fix

Full commit message:
b43legacy: drop packets we are not able to encrypt

We must drop any packets we are not able to encrypt.
We must not send them unencrypted or with an all-zero-key (which
basically is the same as unencrypted, from a security point of view).

This might only trigger shortly after resume before mac80211 reassociated
and reconfigured the keys.

It is safe to drop these packets, as the association they belong to
is not guaranteed anymore anyway.
This is a security fix in the sense that it prevents information leakage.

This patch by Michael Buesch has been ported to b43legacy.

Cc: Michael Buesch <mb@bu3sch.de>
Signed-off-by: Stefano Brivio <stefano.brivio@polimi.it>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Stefano Brivio <stefano.brivio@polimi.it>
Author Date: Sat Feb 2 19:16:01 2008 +0100
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Tue Feb 5 14:35:46 2008 -0500

Files Changed: 4
Lines Added: 38
Lines Removed: 8
Total Changes: 46
