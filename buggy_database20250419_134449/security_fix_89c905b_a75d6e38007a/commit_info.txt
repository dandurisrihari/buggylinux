Commit Hash: 89c905beccbbafa88490c8c4c35eaec5ce4c1329
Subject: nfsd: allow forced expiration of NFSv4 clients


Security Keywords:
- injection

Full commit message:
nfsd: allow forced expiration of NFSv4 clients

NFSv4 clients are automatically expired and all their locks removed if
they don't contact the server for a certain amount of time (the lease
period, 90 seconds by default).

There can still be situations where that's not enough, so allow
userspace to force expiry by writing "expire\n" to the new
nfsd/client/#/ctl file.

(The generic "ctl" name is because I expect we may want to allow other
operations on clients in the future.)

The write will not return until the client is expired and all of its
locks and other state removed.

The fault injection code also provides a way of expiring clients, but it
fails if there are any in-progress RPC's referencing the client.  Also,
its method of selecting a client to expire is a little more
primitive--it uses an IP address, which can't always uniquely specify an
NFSv4 client.

Signed-off-by: J. Bruce Fields <bfields@redhat.com>

Metadata:
Author: J. Bruce Fields <bfields@redhat.com>
Author Date: Wed Jun 19 12:43:11 2019 -0400
Committer: J. Bruce Fields <bfields@redhat.com>
Commit Date: Wed Jul 3 17:52:50 2019 -0400

Files Changed: 1
Lines Added: 69
Lines Removed: 1
Total Changes: 70
