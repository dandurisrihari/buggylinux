{
  "hash": "7561d27e90fa0df0aac2a1d6b49c2a28eaae7026",
  "hash_short": "7561d27e",
  "subject": "xfs: buffer lru reference count error injection tag",
  "body": "XFS uses a fixed reference count for certain types of buffers in the\ninternal LRU cache. These reference counts dictate how aggressively\ncertain buffers are reclaimed vs. others. While the reference counts\nimplements priority across different buffer types, all buffers\n(other than uncached buffers) are typically cached for at least one\nreclaim cycle.\n\nWe've had at least one bug recently that has been hidden by a\nreleased buffer sitting around in the LRU. Users hitting the problem\nwere able to reproduce under enough memory pressure to cause\naggressive reclaim in a particular window of time.\n\nTo support future xfstests cases, add an error injection tag to\nhardcode the buffer reference count to zero. When enabled, this\nbypasses caching of associated buffers and facilitates test cases\nthat depend on this behavior.\n\nSigned-off-by: Brian Foster <bfoster@redhat.com>\nReviewed-by: Darrick J. Wong <darrick.wong@oracle.com>\nSigned-off-by: Darrick J. Wong <darrick.wong@oracle.com>",
  "full_message": "xfs: buffer lru reference count error injection tag\n\nXFS uses a fixed reference count for certain types of buffers in the\ninternal LRU cache. These reference counts dictate how aggressively\ncertain buffers are reclaimed vs. others. While the reference counts\nimplements priority across different buffer types, all buffers\n(other than uncached buffers) are typically cached for at least one\nreclaim cycle.\n\nWe've had at least one bug recently that has been hidden by a\nreleased buffer sitting around in the LRU. Users hitting the problem\nwere able to reproduce under enough memory pressure to cause\naggressive reclaim in a particular window of time.\n\nTo support future xfstests cases, add an error injection tag to\nhardcode the buffer reference count to zero. When enabled, this\nbypasses caching of associated buffers and facilitates test cases\nthat depend on this behavior.\n\nSigned-off-by: Brian Foster <bfoster@redhat.com>\nReviewed-by: Darrick J. Wong <darrick.wong@oracle.com>\nSigned-off-by: Darrick J. Wong <darrick.wong@oracle.com>",
  "author_name": "Brian Foster",
  "author_email": "bfoster@redhat.com",
  "author_date": "Tue Oct 17 14:16:29 2017 -0700",
  "author_date_iso": "2017-10-17T14:16:29-07:00",
  "committer_name": "Darrick J. Wong",
  "committer_email": "darrick.wong@oracle.com",
  "committer_date": "Thu Oct 26 15:38:23 2017 -0700",
  "committer_date_iso": "2017-10-26T15:38:23-07:00",
  "files_changed": [
    "fs/xfs/xfs_buf.c",
    "fs/xfs/xfs_buf.h",
    "fs/xfs/xfs_error.c",
    "fs/xfs/xfs_error.h"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "fs/xfs/xfs_buf.c",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "fs/xfs/xfs_buf.h",
      "insertions": 1,
      "deletions": 4
    },
    {
      "file": "fs/xfs/xfs_error.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "fs/xfs/xfs_error.h",
      "insertions": 3,
      "deletions": 1
    }
  ],
  "total_insertions": 23,
  "total_deletions": 5,
  "total_changes": 28,
  "parents": [
    "a53efbd5c6802e07b64aa767bb932da6913470c8"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.15",
    "v4.15-rc1",
    "v4.15-rc2",
    "v4.15-rc3",
    "v4.15-rc4",
    "v4.15-rc5",
    "v4.15-rc6",
    "v4.15-rc7",
    "v4.15-rc8",
    "v4.15-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/xfs/xfs_buf.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/xfs/xfs_buf.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/xfs/xfs_error.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/xfs/xfs_error.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}