Commit Hash: 993773d11d45c90cb1c6481c2638c3d9f092ea5b
Subject: x86/tls: Fix possible spectre-v1 in do_get_thread_area()


Security Keywords:
- vulnerability
- sanitizing

Full commit message:
x86/tls: Fix possible spectre-v1 in do_get_thread_area()

The index to access the threads tls array is controlled by userspace
via syscall: sys_ptrace(), hence leading to a potential exploitation
of the Spectre variant 1 vulnerability.

The index can be controlled from:
        ptrace -> arch_ptrace -> do_get_thread_area.

Fix this by sanitizing the user supplied index before using it to access
the p->thread.tls_array.

Signed-off-by: Dianzhang Chen <dianzhangchen0@gmail.com>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Cc: bp@alien8.de
Cc: hpa@zytor.com
Cc: stable@vger.kernel.org
Link: https://lkml.kernel.org/r/1561524630-3642-1-git-send-email-dianzhangchen0@gmail.com

Metadata:
Author: Dianzhang Chen <dianzhangchen0@gmail.com>
Author Date: Wed Jun 26 12:50:30 2019 +0800
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Thu Jun 27 23:48:04 2019 +0200

Files Changed: 1
Lines Added: 7
Lines Removed: 2
Total Changes: 9
