Commit Hash: 6a8d3010b313d99adbb28f1826fac0234395bb26
Subject: Bluetooth: Fix double L2CAP connection request


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix double L2CAP connection request

If the remote L2CAP server uses authentication pending stage and
encryption is enabled it can happen that a L2CAP connection request is
sent twice due to a race condition in the connection state machine.

When the remote side indicates any kind of connection pending, then
track this state and skip sending of L2CAP commands for this period.

Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Marcel Holtmann <marcel@holtmann.org>
Author Date: Fri Feb 6 23:56:36 2009 +0100
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Fri Feb 27 06:14:41 2009 +0100

Files Changed: 2
Lines Added: 9
Lines Removed: 0
Total Changes: 9
