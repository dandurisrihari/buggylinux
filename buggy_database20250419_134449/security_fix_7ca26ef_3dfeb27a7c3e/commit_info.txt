Commit Hash: 7ca26efb09a1543fddb29308ea3b63b66cb5d3ee
Subject: vduse: Use proper spinlock for IRQ injection


Security Keywords:
- injection

Full commit message:
vduse: Use proper spinlock for IRQ injection

The IRQ injection work used spin_lock_irq() to protect the
scheduling of the softirq, but spin_lock_bh() should be
used.

With spin_lock_irq(), we noticed delay of more than 6
seconds between the time a NAPI polling work is scheduled
and the time it is executed.

Fixes: c8a6153b6c59 ("vduse: Introduce VDUSE - vDPA Device in Userspace")
Cc: xieyongji@bytedance.com

Suggested-by: Jason Wang <jasowang@redhat.com>
Signed-off-by: Maxime Coquelin <maxime.coquelin@redhat.com>
Message-Id: <20230705114505.63274-1-maxime.coquelin@redhat.com>
Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
Acked-by: Jason Wang <jasowang@redhat.com>
Reviewed-by: Xie Yongji <xieyongji@bytedance.com>

Metadata:
Author: Maxime Coquelin <maxime.coquelin@redhat.com>
Author Date: Wed Jul 5 13:45:05 2023 +0200
Committer: Michael S. Tsirkin <mst@redhat.com>
Commit Date: Thu Aug 10 15:24:28 2023 -0400

Files Changed: 1
Lines Added: 4
Lines Removed: 4
Total Changes: 8
