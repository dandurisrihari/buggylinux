Commit Hash: d00ef24fc2923b65fdd440dc6445903e965841ac
Subject: Bluetooth: Fix authentication request for L2CAP raw sockets


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix authentication request for L2CAP raw sockets

When there is an existing connection l2cap_check_security needs to be
called to ensure that the security level of the new socket is fulfilled.
Normally l2cap_do_start takes care of this, but that function doesn't
get called for SOCK_RAW type sockets. This patch adds the necessary
l2cap_check_security call to the appropriate branch in l2cap_do_connect.

Signed-off-by: Johan Hedberg <johan.hedberg@nokia.com>
Acked-by: Marcel Holtmann <marcel@holtmann.org>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

Metadata:
Author: Johan Hedberg <johan.hedberg@nokia.com>
Author Date: Wed Jan 19 12:06:51 2011 +0530
Committer: Gustavo F. Padovan <padovan@profusion.mobi>
Commit Date: Wed Jan 19 14:40:43 2011 -0200

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
