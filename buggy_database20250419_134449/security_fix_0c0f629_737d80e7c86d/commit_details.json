{
  "hash": "0c0f6299ba71faf610e311605e09e96331c45f28",
  "hash_short": "0c0f6299",
  "subject": "selftests: memory-hotplug: avoid spamming logs with dump_page(), ratio limit hot-remove error test",
  "body": "While the offline memory test obey ratio limit, the same test with\nerror injection does not and tries to offline all the hotpluggable\nmemory, spamming system logs with hundreds of thousands of dump_page()\nentries, slowing system down (to the point the test itself timesout and\ngets terminated) and excessive fs occupation:\n\n...\n[ 9784.393354] page:c00c0000007d1b40 refcount:3 mapcount:0 mapping:c0000001fc03e950 index:0xe7b\n[ 9784.393355] def_blk_aops\n[ 9784.393356] flags: 0x3ffff800002062(referenced|active|workingset|private)\n[ 9784.393358] raw: 003ffff800002062 c0000001b9343a68 c0000001b9343a68 c0000001fc03e950\n[ 9784.393359] raw: 0000000000000e7b c000000006607b18 00000003ffffffff c00000000490d000\n[ 9784.393359] page dumped because: migration failure\n[ 9784.393360] page->mem_cgroup:c00000000490d000\n[ 9784.393416] migrating pfn 1f46d failed ret:1\n...\n\n$ grep \"page dumped because: migration failure\" /var/log/kern.log | wc -l\n2405558\n\n$ ls -la /var/log/kern.log\n-rw-r----- 1 syslog adm 2256109539 Jun 30 14:19 /var/log/kern.log\n\nSigned-off-by: Paolo Pisati <paolo.pisati@canonical.com>\nAcked-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>\nSigned-off-by: Shuah Khan <skhan@linuxfoundation.org>",
  "full_message": "selftests: memory-hotplug: avoid spamming logs with dump_page(), ratio limit hot-remove error test\n\nWhile the offline memory test obey ratio limit, the same test with\nerror injection does not and tries to offline all the hotpluggable\nmemory, spamming system logs with hundreds of thousands of dump_page()\nentries, slowing system down (to the point the test itself timesout and\ngets terminated) and excessive fs occupation:\n\n...\n[ 9784.393354] page:c00c0000007d1b40 refcount:3 mapcount:0 mapping:c0000001fc03e950 index:0xe7b\n[ 9784.393355] def_blk_aops\n[ 9784.393356] flags: 0x3ffff800002062(referenced|active|workingset|private)\n[ 9784.393358] raw: 003ffff800002062 c0000001b9343a68 c0000001b9343a68 c0000001fc03e950\n[ 9784.393359] raw: 0000000000000e7b c000000006607b18 00000003ffffffff c00000000490d000\n[ 9784.393359] page dumped because: migration failure\n[ 9784.393360] page->mem_cgroup:c00000000490d000\n[ 9784.393416] migrating pfn 1f46d failed ret:1\n...\n\n$ grep \"page dumped because: migration failure\" /var/log/kern.log | wc -l\n2405558\n\n$ ls -la /var/log/kern.log\n-rw-r----- 1 syslog adm 2256109539 Jun 30 14:19 /var/log/kern.log\n\nSigned-off-by: Paolo Pisati <paolo.pisati@canonical.com>\nAcked-by: Krzysztof Kozlowski <krzysztof.kozlowski@canonical.com>\nSigned-off-by: Shuah Khan <skhan@linuxfoundation.org>",
  "author_name": "Paolo Pisati",
  "author_email": "paolo.pisati@canonical.com",
  "author_date": "Wed Jun 30 16:57:40 2021 +0200",
  "author_date_iso": "2021-06-30T16:57:40+02:00",
  "committer_name": "Shuah Khan",
  "committer_email": "skhan@linuxfoundation.org",
  "committer_date": "Mon Jul 12 14:20:01 2021 -0600",
  "committer_date_iso": "2021-07-12T14:20:01-06:00",
  "files_changed": [
    "tools/testing/selftests/memory-hotplug/mem-on-off-test.sh"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "tools/testing/selftests/memory-hotplug/mem-on-off-test.sh",
      "insertions": 3,
      "deletions": 1
    }
  ],
  "total_insertions": 3,
  "total_deletions": 1,
  "total_changes": 4,
  "parents": [
    "e73f0f0ee7541171d89f2e2491130c7771ba58d3"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "tools/testing/selftests/memory-hotplug/mem-on-off-test.sh",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}