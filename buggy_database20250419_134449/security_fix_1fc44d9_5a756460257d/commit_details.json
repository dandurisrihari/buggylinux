{
  "hash": "1fc44d9b1afb0afe46acd99bdfdf793805a850e1",
  "hash_short": "1fc44d9b",
  "subject": "drm/i915: Store a pointer to intel_context in i915_request",
  "body": "To ease the frequent and ugly pointer dance of\n&request->gem_context->engine[request->engine->id] during request\nsubmission, store that pointer as request->hw_context. One major\nadvantage that we will exploit later is that this decouples the logical\ncontext state from the engine itself.\n\nv2: Set mock_context->ops so we don't crash and burn in selftests.\n    Cleanups from Tvrtko.\n\nSigned-off-by: Chris Wilson <chris@chris-wilson.co.uk>\nCc: Tvrtko Ursulin <tvrtko.ursulin@intel.com>\nAcked-by: Zhenyu Wang <zhenyuw@linux.intel.com>\nReviewed-by: Tvrtko Ursulin <tvrtko.ursulin@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/20180517212633.24934-3-chris@chris-wilson.co.uk",
  "full_message": "drm/i915: Store a pointer to intel_context in i915_request\n\nTo ease the frequent and ugly pointer dance of\n&request->gem_context->engine[request->engine->id] during request\nsubmission, store that pointer as request->hw_context. One major\nadvantage that we will exploit later is that this decouples the logical\ncontext state from the engine itself.\n\nv2: Set mock_context->ops so we don't crash and burn in selftests.\n    Cleanups from Tvrtko.\n\nSigned-off-by: Chris Wilson <chris@chris-wilson.co.uk>\nCc: Tvrtko Ursulin <tvrtko.ursulin@intel.com>\nAcked-by: Zhenyu Wang <zhenyuw@linux.intel.com>\nReviewed-by: Tvrtko Ursulin <tvrtko.ursulin@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/20180517212633.24934-3-chris@chris-wilson.co.uk",
  "author_name": "Chris Wilson",
  "author_email": "chris@chris-wilson.co.uk",
  "author_date": "Thu May 17 22:26:32 2018 +0100",
  "author_date_iso": "2018-05-17T22:26:32+01:00",
  "committer_name": "Chris Wilson",
  "committer_email": "chris@chris-wilson.co.uk",
  "committer_date": "Fri May 18 09:35:22 2018 +0100",
  "committer_date_iso": "2018-05-18T09:35:22+01:00",
  "files_changed": [
    "drivers/gpu/drm/i915/gvt/mmio_context.c",
    "drivers/gpu/drm/i915/gvt/mmio_context.h",
    "drivers/gpu/drm/i915/gvt/scheduler.c",
    "drivers/gpu/drm/i915/gvt/scheduler.h",
    "drivers/gpu/drm/i915/i915_drv.h",
    "drivers/gpu/drm/i915/i915_gem.c",
    "drivers/gpu/drm/i915/i915_gem_context.c",
    "drivers/gpu/drm/i915/i915_gem_context.h",
    "drivers/gpu/drm/i915/i915_gpu_error.c",
    "drivers/gpu/drm/i915/i915_perf.c",
    "drivers/gpu/drm/i915/i915_request.c",
    "drivers/gpu/drm/i915/i915_request.h",
    "drivers/gpu/drm/i915/intel_engine_cs.c",
    "drivers/gpu/drm/i915/intel_guc_submission.c",
    "drivers/gpu/drm/i915/intel_lrc.c",
    "drivers/gpu/drm/i915/intel_lrc.h",
    "drivers/gpu/drm/i915/intel_ringbuffer.c",
    "drivers/gpu/drm/i915/intel_ringbuffer.h",
    "drivers/gpu/drm/i915/selftests/mock_context.c",
    "drivers/gpu/drm/i915/selftests/mock_engine.c"
  ],
  "files_changed_count": 20,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/gvt/mmio_context.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/i915/gvt/mmio_context.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/gvt/scheduler.c",
      "insertions": 52,
      "deletions": 89
    },
    {
      "file": "drivers/gpu/drm/i915/gvt/scheduler.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/i915/i915_drv.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem.c",
      "insertions": 6,
      "deletions": 6
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem_context.c",
      "insertions": 9,
      "deletions": 8
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem_context.h",
      "insertions": 13,
      "deletions": 8
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gpu_error.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/i915/i915_perf.c",
      "insertions": 11,
      "deletions": 14
    },
    {
      "file": "drivers/gpu/drm/i915/i915_request.c",
      "insertions": 17,
      "deletions": 17
    },
    {
      "file": "drivers/gpu/drm/i915/i915_request.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/intel_engine_cs.c",
      "insertions": 32,
      "deletions": 22
    },
    {
      "file": "drivers/gpu/drm/i915/intel_guc_submission.c",
      "insertions": 4,
      "deletions": 6
    },
    {
      "file": "drivers/gpu/drm/i915/intel_lrc.c",
      "insertions": 71,
      "deletions": 54
    },
    {
      "file": "drivers/gpu/drm/i915/intel_lrc.h",
      "insertions": 0,
      "deletions": 7
    },
    {
      "file": "drivers/gpu/drm/i915/intel_ringbuffer.c",
      "insertions": 61,
      "deletions": 39
    },
    {
      "file": "drivers/gpu/drm/i915/intel_ringbuffer.h",
      "insertions": 4,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/i915/selftests/mock_context.c",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/selftests/mock_engine.c",
      "insertions": 27,
      "deletions": 14
    }
  ],
  "total_insertions": 321,
  "total_deletions": 296,
  "total_changes": 617,
  "parents": [
    "01278cb143955f4b592568d1756f1baf506245c2"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc1",
    "v4.19-rc2",
    "v4.19-rc3",
    "v4.19-rc4",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/gpu/drm/i915/gvt/mmio_context.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gvt/mmio_context.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem_context.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem_context.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gvt/scheduler.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_drv.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_perf.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gem.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/gvt/scheduler.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_gpu_error.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_request.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_lrc.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/i915_request.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_lrc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_guc_submission.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_engine_cs.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_ringbuffer.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/intel_ringbuffer.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/selftests/mock_context.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/i915/selftests/mock_engine.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}