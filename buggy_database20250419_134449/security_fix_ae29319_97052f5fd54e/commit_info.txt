Commit Hash: ae29319649b80ed9d28d7b4f164e3f5f75020fc8
Subject: [Bluetooth] Update authentication status after successful encryption


Security Keywords:
- authentication

Full commit message:
[Bluetooth] Update authentication status after successful encryption

The authentication status is not communicated to both parties. This is
actually a flaw in the Bluetooth specification. Only the requesting side
really knows if the authentication was successful or not. This piece of
information is however needed on the other side to know if it has to
trigger the authentication procedure or not. Worst case is that both
sides will request authentication at different times, but this should
be avoided since it costs extra time when setting up a new connection.

For Bluetooth encryption it is required to authenticate the link first
and the encryption status is communicated to both sides. So when a link
is switched to encryption it is possible to update the authentication
status since it implies an authenticated link.

Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Marcel Holtmann <marcel@holtmann.org>
Author Date: Mon Jul 14 20:13:45 2008 +0200
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Mon Jul 14 20:13:45 2008 +0200

Files Changed: 1
Lines Added: 4
Lines Removed: 2
Total Changes: 6
