Commit Hash: c7ec4f2d684e17d69bbdd7c4324db0ef5daac26a
Subject: xen-netback: don't produce zero-size SKB frags

CVE Identifiers:
- CVE-2023-46838

Full commit message:
xen-netback: don't produce zero-size SKB frags

While frontends may submit zero-size requests (wasting a precious slot),
core networking code as of at least 3ece782693c4b ("sock: skb_copy_ubufs
support for compound pages") can't deal with SKBs when they have all
zero-size fragments. Respond to empty requests right when populating
fragments; all further processing is fragment based and hence won't
encounter these empty requests anymore.

In a way this should have been that way from the beginning: When no data
is to be transferred for a particular request, there's not even a point
in validating the respective grant ref. That's no different from e.g.
passing NULL into memcpy() when at the same time the size is 0.

This is XSA-448 / CVE-2023-46838.

Cc: stable@vger.kernel.org
Signed-off-by: Jan Beulich <jbeulich@suse.com>
Reviewed-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Paul Durrant <paul@xen.org>

Metadata:
Author: Jan Beulich <jbeulich@suse.com>
Author Date: Mon Jan 8 07:41:39 2024 +0100
Committer: Juergen Gross <jgross@suse.com>
Commit Date: Mon Jan 8 07:41:39 2024 +0100

Files Changed: 1
Lines Added: 38
Lines Removed: 6
Total Changes: 44
