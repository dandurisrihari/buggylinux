Commit Hash: e7c29cb16c833441fd2160642bb13025f4e7ac70
Subject: [Bluetooth] Reject L2CAP connections on an insecure ACL link


Security Keywords:
- authentication

Full commit message:
[Bluetooth] Reject L2CAP connections on an insecure ACL link

The Security Mode 4 of the Bluetooth 2.1 specification has strict
authentication and encryption requirements. It is the initiators job
to create a secure ACL link. However in case of malicious devices, the
acceptor has to make sure that the ACL is encrypted before allowing
any kind of L2CAP connection. The only exception here is the PSM 1 for
the service discovery protocol, because that is allowed to run on an
insecure ACL link.

Previously it was enough to reject a L2CAP connection during the
connection setup phase, but with Bluetooth 2.1 it is forbidden to
do any L2CAP protocol exchange on an insecure link (except SDP).

The new hci_conn_check_link_mode() function can be used to check the
integrity of an ACL link. This functions also takes care of the cases
where Security Mode 4 is disabled or one of the devices is based on
an older specification.

Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Marcel Holtmann <marcel@holtmann.org>
Author Date: Tue Sep 9 07:19:20 2008 +0200
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Tue Sep 9 07:19:20 2008 +0200

Files Changed: 4
Lines Added: 26
Lines Removed: 5
Total Changes: 31
