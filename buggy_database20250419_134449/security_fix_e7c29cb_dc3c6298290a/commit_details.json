{
  "hash": "e7c29cb16c833441fd2160642bb13025f4e7ac70",
  "hash_short": "e7c29cb1",
  "subject": "[Bluetooth] Reject L2CAP connections on an insecure ACL link",
  "body": "The Security Mode 4 of the Bluetooth 2.1 specification has strict\nauthentication and encryption requirements. It is the initiators job\nto create a secure ACL link. However in case of malicious devices, the\nacceptor has to make sure that the ACL is encrypted before allowing\nany kind of L2CAP connection. The only exception here is the PSM 1 for\nthe service discovery protocol, because that is allowed to run on an\ninsecure ACL link.\n\nPreviously it was enough to reject a L2CAP connection during the\nconnection setup phase, but with Bluetooth 2.1 it is forbidden to\ndo any L2CAP protocol exchange on an insecure link (except SDP).\n\nThe new hci_conn_check_link_mode() function can be used to check the\nintegrity of an ACL link. This functions also takes care of the cases\nwhere Security Mode 4 is disabled or one of the devices is based on\nan older specification.\n\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "[Bluetooth] Reject L2CAP connections on an insecure ACL link\n\nThe Security Mode 4 of the Bluetooth 2.1 specification has strict\nauthentication and encryption requirements. It is the initiators job\nto create a secure ACL link. However in case of malicious devices, the\nacceptor has to make sure that the ACL is encrypted before allowing\nany kind of L2CAP connection. The only exception here is the PSM 1 for\nthe service discovery protocol, because that is allowed to run on an\ninsecure ACL link.\n\nPreviously it was enough to reject a L2CAP connection during the\nconnection setup phase, but with Bluetooth 2.1 it is forbidden to\ndo any L2CAP protocol exchange on an insecure link (except SDP).\n\nThe new hci_conn_check_link_mode() function can be used to check the\nintegrity of an ACL link. This functions also takes care of the cases\nwhere Security Mode 4 is disabled or one of the devices is based on\nan older specification.\n\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Marcel Holtmann",
  "author_email": "marcel@holtmann.org",
  "author_date": "Tue Sep 9 07:19:20 2008 +0200",
  "author_date_iso": "2008-09-09T07:19:20+02:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Tue Sep 9 07:19:20 2008 +0200",
  "committer_date_iso": "2008-09-09T07:19:20+02:00",
  "files_changed": [
    "include/net/bluetooth/hci_core.h",
    "net/bluetooth/af_bluetooth.c",
    "net/bluetooth/hci_conn.c",
    "net/bluetooth/l2cap.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "include/net/bluetooth/hci_core.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/bluetooth/af_bluetooth.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 13,
      "deletions": 0
    },
    {
      "file": "net/bluetooth/l2cap.c",
      "insertions": 11,
      "deletions": 4
    }
  ],
  "total_insertions": 26,
  "total_deletions": 5,
  "total_changes": 31,
  "parents": [
    "09ab6f4c2376a0fc31abde1e2991513f900ea825"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.27",
    "v2.6.27-rc6",
    "v2.6.27-rc7",
    "v2.6.27-rc8",
    "v2.6.27-rc9",
    "v2.6.28",
    "v2.6.28-rc1",
    "v2.6.28-rc2",
    "v2.6.28-rc3",
    "v2.6.28-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/bluetooth/hci_core.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/af_bluetooth.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/l2cap.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}