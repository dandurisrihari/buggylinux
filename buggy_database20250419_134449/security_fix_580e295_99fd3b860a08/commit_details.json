{
  "hash": "580e295178402d14bbf598a5702f8e01fc59dbaa",
  "hash_short": "580e2951",
  "subject": "crypto: arm64/gcm-aes-ce - fix no-NEON fallback code",
  "body": "The arm64 gcm-aes-ce algorithm is failing the extra crypto self-tests\nfollowing my patches to test the !may_use_simd() code paths, which\npreviously were untested.  The problem is that in the !may_use_simd()\ncase, an odd number of AES blocks can be processed within each step of\nthe skcipher_walk.  However, the skcipher_walk is being done with a\n\"stride\" of 2 blocks and is advanced by an even number of blocks after\neach step.  This causes the encryption to produce the wrong ciphertext\nand authentication tag, and causes the decryption to incorrectly fail.\n\nFix it by only processing an even number of blocks per step.\n\nFixes: c2b24c36e0a3 (\"crypto: arm64/aes-gcm-ce - fix scatterwalk API violation\")\nFixes: 71e52c278c54 (\"crypto: arm64/aes-ce-gcm - operate on two input blocks at a time\")\nCc: <stable@vger.kernel.org> # v4.19+\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nReviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "crypto: arm64/gcm-aes-ce - fix no-NEON fallback code\n\nThe arm64 gcm-aes-ce algorithm is failing the extra crypto self-tests\nfollowing my patches to test the !may_use_simd() code paths, which\npreviously were untested.  The problem is that in the !may_use_simd()\ncase, an odd number of AES blocks can be processed within each step of\nthe skcipher_walk.  However, the skcipher_walk is being done with a\n\"stride\" of 2 blocks and is advanced by an even number of blocks after\neach step.  This causes the encryption to produce the wrong ciphertext\nand authentication tag, and causes the decryption to incorrectly fail.\n\nFix it by only processing an even number of blocks per step.\n\nFixes: c2b24c36e0a3 (\"crypto: arm64/aes-gcm-ce - fix scatterwalk API violation\")\nFixes: 71e52c278c54 (\"crypto: arm64/aes-ce-gcm - operate on two input blocks at a time\")\nCc: <stable@vger.kernel.org> # v4.19+\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nReviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Eric Biggers",
  "author_email": "ebiggers@google.com",
  "author_date": "Tue Mar 12 22:12:46 2019 -0700",
  "author_date_iso": "2019-03-12T22:12:46-07:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Fri Mar 22 20:57:27 2019 +0800",
  "committer_date_iso": "2019-03-22T20:57:27+08:00",
  "files_changed": [
    "arch/arm64/crypto/ghash-ce-glue.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/arm64/crypto/ghash-ce-glue.c",
      "insertions": 6,
      "deletions": 4
    }
  ],
  "total_insertions": 6,
  "total_deletions": 4,
  "total_changes": 10,
  "parents": [
    "7aceaaef04eaaf6019ca159bc354d800559bba1d"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.2",
    "v5.2-rc1",
    "v5.2-rc2",
    "v5.2-rc3",
    "v5.2-rc4",
    "v5.2-rc5",
    "v5.2-rc6",
    "v5.2-rc7",
    "v5.3",
    "v5.3-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/arm64/crypto/ghash-ce-glue.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}