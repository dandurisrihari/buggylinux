{
  "hash": "b96fb439774e1bfb7d027ad324fa48606167cb52",
  "hash_short": "b96fb439",
  "subject": "KVM: nVMX: fixes to nested virt interrupt injection",
  "body": "There are three issues in nested_vmx_check_exception:\n\n1) it is not taking PFEC_MATCH/PFEC_MASK into account, as reported\nby Wanpeng Li;\n\n2) it should rebuild the interruption info and exit qualification fields\nfrom scratch, as reported by Jim Mattson, because the values from the\nL2->L0 vmexit may be invalid (e.g. if an emulated instruction causes\na page fault, the EPT misconfig's exit qualification is incorrect).\n\n3) CR2 and DR6 should not be written for exception intercept vmexits\n(CR2 only for AMD).\n\nThis patch fixes the first two and adds a comment about the last,\noutlining the fix.\n\nCc: Jim Mattson <jmattson@google.com>\nCc: Wanpeng Li <wanpeng.li@hotmail.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "KVM: nVMX: fixes to nested virt interrupt injection\n\nThere are three issues in nested_vmx_check_exception:\n\n1) it is not taking PFEC_MATCH/PFEC_MASK into account, as reported\nby Wanpeng Li;\n\n2) it should rebuild the interruption info and exit qualification fields\nfrom scratch, as reported by Jim Mattson, because the values from the\nL2->L0 vmexit may be invalid (e.g. if an emulated instruction causes\na page fault, the EPT misconfig's exit qualification is incorrect).\n\n3) CR2 and DR6 should not be written for exception intercept vmexits\n(CR2 only for AMD).\n\nThis patch fixes the first two and adds a comment about the last,\noutlining the fix.\n\nCc: Jim Mattson <jmattson@google.com>\nCc: Wanpeng Li <wanpeng.li@hotmail.com>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Paolo Bonzini",
  "author_email": "pbonzini@redhat.com",
  "author_date": "Thu Jul 27 12:29:32 2017 +0200",
  "author_date_iso": "2017-07-27T12:29:32+02:00",
  "committer_name": "Radim Kr\u010dm\u00e1\u0159",
  "committer_email": "rkrcmar@redhat.com",
  "committer_date": "Tue Aug 1 22:24:17 2017 +0200",
  "committer_date_iso": "2017-08-01T22:24:17+02:00",
  "files_changed": [
    "arch/x86/kvm/svm.c",
    "arch/x86/kvm/vmx.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "arch/x86/kvm/svm.c",
      "insertions": 10,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/vmx.c",
      "insertions": 62,
      "deletions": 25
    }
  ],
  "total_insertions": 72,
  "total_deletions": 25,
  "total_changes": 97,
  "parents": [
    "7313c698050387a11c21afb0c6b4c61f21f7c042"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.13",
    "v4.13-rc4",
    "v4.13-rc5",
    "v4.13-rc6",
    "v4.13-rc7",
    "v4.14",
    "v4.14-rc1",
    "v4.14-rc2",
    "v4.14-rc3",
    "v4.14-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/kvm/svm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/vmx.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}