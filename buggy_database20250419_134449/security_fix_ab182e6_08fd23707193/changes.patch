diff --cc arch/arm64/include/asm/bug.h
index a9be1072933c,0bfe1df12b19..366448eb0fb7
--- a/arch/arm64/include/asm/bug.h
+++ b/arch/arm64/include/asm/bug.h
@@@ -45,19 -42,27 +42,26 @@@
  _BUGVERBOSE_LOCATION(__FILE__, __LINE__)		\
  		".short " #flags "\n\t"			\
  		".popsection\n"				\
- 							\
- 	"1:	brk %[imm]"				\
- 		:: [imm] "i" (BUG_BRK_IMM)		\
- )
+ 	"1:	"
+ #else
+ #define __BUG_ENTRY(flags) ""
+ #endif
+ 
+ #define __BUG_FLAGS(flags)				\
+ 	asm volatile (					\
+ 		__BUG_ENTRY(flags)			\
+ 		"brk %[imm]" :: [imm] "i" (BUG_BRK_IMM)	\
+ 	);
  
- #define BUG() do {				\
- 	_BUG_FLAGS(0);				\
- 	unreachable();				\
+ 
+ #define BUG() do {					\
+ 	__BUG_FLAGS(0);					\
+ 	unreachable();					\
  } while (0)
  
- #define __WARN_FLAGS(flags) _BUG_FLAGS(BUGFLAG_WARNING|(flags))
 -#define __WARN_TAINT(taint) 				\
 -	__BUG_FLAGS(BUGFLAG_TAINT(taint))
++#define __WARN_FLAGS(flags) __BUG_FLAGS(BUGFLAG_WARNING|(flags))
  
- #endif /* ! CONFIG_GENERIC_BUG */
+ #define HAVE_ARCH_BUG
  
  #include <asm-generic/bug.h>