Commit Hash: 7e6d06f0de3f74ca929441add094518ae332257c
Subject: sfc: Fix maximum number of TSO segments and minimum TX queue size

CVE Identifiers:
- CVE-2012-3412

Full commit message:
sfc: Fix maximum number of TSO segments and minimum TX queue size

Currently an skb requiring TSO may not fit within a minimum-size TX
queue.  The TX queue selected for the skb may stall and trigger the TX
watchdog repeatedly (since the problem skb will be retried after the
TX reset).  This issue is designated as CVE-2012-3412.

Set the maximum number of TSO segments for our devices to 100.  This
should make no difference to behaviour unless the actual MSS is less
than about 700.  Increase the minimum TX queue size accordingly to
allow for 2 worst-case skbs, so that there will definitely be space
to add an skb after we wake a queue.

To avoid invalidating existing configurations, change
efx_ethtool_set_ringparam() to fix up values that are too small rather
than returning -EINVAL.

Signed-off-by: Ben Hutchings <bhutchings@solarflare.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Ben Hutchings <bhutchings@solarflare.com>
Author Date: Mon Jul 30 15:57:44 2012 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Thu Aug 2 00:19:17 2012 -0700

Files Changed: 4
Lines Added: 46
Lines Removed: 9
Total Changes: 55
