{
  "hash": "7dce59819750d78513c70bf4a9024e265af88b23",
  "hash_short": "7dce5981",
  "subject": "crypto: dh - implement ffdheXYZ(dh) templates",
  "body": "Current work on NVME in-band authentication support ([1]) needs to invoke\nDH with the FFDHE safe-prime group parameters specified in RFC 7919.\n\nIntroduce a new CRYPTO_DH_RFC7919_GROUPS Kconfig option. If enabled, make\ndh_generic register a couple of ffdheXYZ(dh) templates, one for each group:\nffdhe2048(dh), ffdhe3072(dh), ffdhe4096(dh), ffdhe6144(dh) and\nffdhe8192(dh). Their respective ->set_secret() expects a (serialized)\nstruct dh, just like the underlying \"dh\" implementation does, but with the\nP and G values unset so that the safe-prime constants for the given group\ncan be filled in by the wrapping template.\n\nInternally, a struct dh_safe_prime instance is being defined for each of\nthe ffdheXYZ(dh) templates as appropriate. In order to prepare for future\nkey generation, fill in the maximum security strength values as specified\nby SP800-56Arev3 on the go, even though they're not needed at this point\nyet.\n\nImplement the respective ffdheXYZ(dh) crypto_template's ->create() by\nsimply forwarding any calls to the __dh_safe_prime_create() helper\nintroduced with the previous commit, passing the associated dh_safe_prime\nin addition to the received ->create() arguments.\n\n[1] https://lore.kernel.org/r/20211202152358.60116-1-hare@suse.de\n\nSigned-off-by: Nicolai Stange <nstange@suse.de>\nReviewed-by: Hannes Reinecke <hare@suse.de>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "crypto: dh - implement ffdheXYZ(dh) templates\n\nCurrent work on NVME in-band authentication support ([1]) needs to invoke\nDH with the FFDHE safe-prime group parameters specified in RFC 7919.\n\nIntroduce a new CRYPTO_DH_RFC7919_GROUPS Kconfig option. If enabled, make\ndh_generic register a couple of ffdheXYZ(dh) templates, one for each group:\nffdhe2048(dh), ffdhe3072(dh), ffdhe4096(dh), ffdhe6144(dh) and\nffdhe8192(dh). Their respective ->set_secret() expects a (serialized)\nstruct dh, just like the underlying \"dh\" implementation does, but with the\nP and G values unset so that the safe-prime constants for the given group\ncan be filled in by the wrapping template.\n\nInternally, a struct dh_safe_prime instance is being defined for each of\nthe ffdheXYZ(dh) templates as appropriate. In order to prepare for future\nkey generation, fill in the maximum security strength values as specified\nby SP800-56Arev3 on the go, even though they're not needed at this point\nyet.\n\nImplement the respective ffdheXYZ(dh) crypto_template's ->create() by\nsimply forwarding any calls to the __dh_safe_prime_create() helper\nintroduced with the previous commit, passing the associated dh_safe_prime\nin addition to the received ->create() arguments.\n\n[1] https://lore.kernel.org/r/20211202152358.60116-1-hare@suse.de\n\nSigned-off-by: Nicolai Stange <nstange@suse.de>\nReviewed-by: Hannes Reinecke <hare@suse.de>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Nicolai Stange",
  "author_email": "nstange@suse.de",
  "author_date": "Mon Feb 21 13:10:53 2022 +0100",
  "author_date_iso": "2022-02-21T13:10:53+01:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Thu Mar 3 10:47:51 2022 +1200",
  "committer_date_iso": "2022-03-03T10:47:51+12:00",
  "files_changed": [
    "crypto/Kconfig",
    "crypto/dh.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "crypto/Kconfig",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "crypto/dh.c",
      "insertions": 297,
      "deletions": 1
    }
  ],
  "total_insertions": 303,
  "total_deletions": 1,
  "total_changes": 304,
  "parents": [
    "d902981f09bf935f257953d227a7721e8e541052"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "crypto/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "crypto/dh.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}