commit eea5119fa5979c350af5783a8148eacdd4219715
Author: Steve French <stfrench@microsoft.com>
Date:   Tue Jan 28 01:04:23 2025 -0600

    smb3: add support for IAKerb
    
    There are now more servers which advertise support for IAKerb (passthrough
    Kerberos authentication via proxy).  IAKerb is a public extension industry
    standard Kerberos protocol that allows a client without line-of-sight
    to a Domain Controller to authenticate. There can be cases where we
    would fail to mount if the server only advertises the OID for IAKerb
    in SPNEGO/GSSAPI.  Add code to allow us to still upcall to userspace
    in these cases to obtain the Kerberos ticket.
    
    Signed-off-by: Steve French <stfrench@microsoft.com>

diff --git a/fs/smb/client/asn1.c b/fs/smb/client/asn1.c
index b5724ef9f182..214a44509e7b 100644
--- a/fs/smb/client/asn1.c
+++ b/fs/smb/client/asn1.c
@@ -52,6 +52,8 @@ int cifs_neg_token_init_mech_type(void *context, size_t hdrlen,
 		server->sec_kerberos = true;
 	else if (oid == OID_ntlmssp)
 		server->sec_ntlmssp = true;
+	else if (oid == OID_IAKerb)
+		server->sec_iakerb = true;
 	else {
 		char buf[50];