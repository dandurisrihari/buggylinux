commit eea5119fa5979c350af5783a8148eacdd4219715
Author: Steve French <stfrench@microsoft.com>
Date:   Tue Jan 28 01:04:23 2025 -0600

    smb3: add support for IAKerb
    
    There are now more servers which advertise support for IAKerb (passthrough
    Kerberos authentication via proxy).  IAKerb is a public extension industry
    standard Kerberos protocol that allows a client without line-of-sight
    to a Domain Controller to authenticate. There can be cases where we
    would fail to mount if the server only advertises the OID for IAKerb
    in SPNEGO/GSSAPI.  Add code to allow us to still upcall to userspace
    in these cases to obtain the Kerberos ticket.
    
    Signed-off-by: Steve French <stfrench@microsoft.com>

diff --git a/fs/smb/client/cifs_spnego.c b/fs/smb/client/cifs_spnego.c
index 28f568b5fc27..bc1c1e9b288a 100644
--- a/fs/smb/client/cifs_spnego.c
+++ b/fs/smb/client/cifs_spnego.c
@@ -138,11 +138,13 @@ cifs_get_spnego_key(struct cifs_ses *sesInfo,
 
 	dp = description + strlen(description);
 
-	/* for now, only sec=krb5 and sec=mskrb5 are valid */
+	/* for now, only sec=krb5 and sec=mskrb5 and iakerb are valid */
 	if (server->sec_kerberos)
 		sprintf(dp, ";sec=krb5");
 	else if (server->sec_mskerberos)
 		sprintf(dp, ";sec=mskrb5");
+	else if (server->sec_iakerb)
+		sprintf(dp, ";sec=iakerb");
 	else {
 		cifs_dbg(VFS, "unknown or missing server auth type, use krb5\n");
 		sprintf(dp, ";sec=krb5");