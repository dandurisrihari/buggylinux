Commit Hash: 68c228557d52616cf040651abefda9839de7086a
Subject: wifi: mac80211: mlme: fix non-inheritence element


Security Keywords:
- authentication

Full commit message:
wifi: mac80211: mlme: fix non-inheritence element

There were two bugs when creating the non-inheritence
element:
 1) 'at_extension' needs to be declared outside the loop,
    otherwise the value resets every iteration and we
    can never really switch properly
 2) 'added' never got set to true, so we always cut off
    the extension element again at the end of the function

This shows another issue that we might add a list but no
extension list, but we need to make the extension list a
zero-length one in that case.

Fix all these issues. While at it, add a comment explaining
the trim.

Fixes: 81151ce462e5 ("wifi: mac80211: support MLO authentication/association with one link")
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Gregory Greenman <gregory.greenman@intel.com>
Link: https://lore.kernel.org/r/20230604120651.3addaa5c4782.If3a78f9305997ad7ef4ba7ffc17a8234c956f613@changeid
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Johannes Berg <johannes.berg@intel.com>
Author Date: Sun Jun 4 12:11:16 2023 +0300
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Tue Jun 6 10:05:36 2023 +0200

Files Changed: 1
Lines Added: 7
Lines Removed: 1
Total Changes: 8
