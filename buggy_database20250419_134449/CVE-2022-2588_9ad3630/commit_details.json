{
  "hash": "9ad36309e2719a884f946678e0296be10f0bb4c1",
  "hash_short": "9ad36309",
  "subject": "net_sched: cls_route: remove from list when handle is 0",
  "body": "When a route filter is replaced and the old filter has a 0 handle, the old\none won't be removed from the hashtable, while it will still be freed.\n\nThe test was there since before commit 1109c00547fc (\"net: sched: RCU\ncls_route\"), when a new filter was not allocated when there was an old one.\nThe old filter was reused and the reinserting would only be necessary if an\nold filter was replaced. That was still wrong for the same case where the\nold handle was 0.\n\nRemove the old filter from the list independently from its handle value.\n\nThis fixes CVE-2022-2588, also reported as ZDI-CAN-17440.\n\nReported-by: Zhenpeng Lin <zplin@u.northwestern.edu>\nSigned-off-by: Thadeu Lima de Souza Cascardo <cascardo@canonical.com>\nReviewed-by: Kamal Mostafa <kamal@canonical.com>\nCc: <stable@vger.kernel.org>\nAcked-by: Jamal Hadi Salim <jhs@mojatatu.com>\nLink: https://lore.kernel.org/r/20220809170518.164662-1-cascardo@canonical.com\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "net_sched: cls_route: remove from list when handle is 0\n\nWhen a route filter is replaced and the old filter has a 0 handle, the old\none won't be removed from the hashtable, while it will still be freed.\n\nThe test was there since before commit 1109c00547fc (\"net: sched: RCU\ncls_route\"), when a new filter was not allocated when there was an old one.\nThe old filter was reused and the reinserting would only be necessary if an\nold filter was replaced. That was still wrong for the same case where the\nold handle was 0.\n\nRemove the old filter from the list independently from its handle value.\n\nThis fixes CVE-2022-2588, also reported as ZDI-CAN-17440.\n\nReported-by: Zhenpeng Lin <zplin@u.northwestern.edu>\nSigned-off-by: Thadeu Lima de Souza Cascardo <cascardo@canonical.com>\nReviewed-by: Kamal Mostafa <kamal@canonical.com>\nCc: <stable@vger.kernel.org>\nAcked-by: Jamal Hadi Salim <jhs@mojatatu.com>\nLink: https://lore.kernel.org/r/20220809170518.164662-1-cascardo@canonical.com\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Thadeu Lima de Souza Cascardo",
  "author_email": "cascardo@canonical.com",
  "author_date": "Tue Aug 9 14:05:18 2022 -0300",
  "author_date_iso": "2022-08-09T14:05:18-03:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Wed Aug 10 22:53:11 2022 -0700",
  "committer_date_iso": "2022-08-10T22:53:11-07:00",
  "files_changed": [
    "net/sched/cls_route.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/sched/cls_route.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "8bcfb4ae4d970b9a9724ddfbac26c387934e0e94"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-2588"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/sched/cls_route.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}