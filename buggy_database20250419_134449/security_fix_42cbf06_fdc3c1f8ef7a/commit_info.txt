Commit Hash: 42cbf06872cc44fb8d2d6665fa6494b5925eaf1c
Subject: KVM: x86: Move #GP injection for VMware into x86_emulate_instruction()


Security Keywords:
- injection

Full commit message:
KVM: x86: Move #GP injection for VMware into x86_emulate_instruction()

Immediately inject a #GP when VMware emulation fails and return
EMULATE_DONE instead of propagating EMULATE_FAIL up the stack.  This
helps pave the way for removing EMULATE_FAIL altogether.

Rename EMULTYPE_VMWARE to EMULTYPE_VMWARE_GP to document that the x86
emulator is called to handle VMware #GP interception, e.g. why a #GP
is injected on emulation failure for EMULTYPE_VMWARE_GP.

Drop EMULTYPE_NO_UD_ON_FAIL as a standalone type.  The "no #UD on fail"
is used only in the VMWare case and is obsoleted by having the emulator
itself reinject #GP.

Signed-off-by: Sean Christopherson <sean.j.christopherson@intel.com>
Reviewed-by: Liran Alon <liran.alon@oracle.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Sean Christopherson <sean.j.christopherson@intel.com>
Author Date: Tue Aug 27 14:40:31 2019 -0700
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Tue Sep 24 14:30:47 2019 +0200

Files Changed: 4
Lines Added: 14
Lines Removed: 23
Total Changes: 37
