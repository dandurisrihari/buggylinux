commit 989cf9a93892409cf8e84c30c0faaa522ac83807
Author: Anshuman Gupta <anshuman.gupta@intel.com>
Date:   Wed Mar 24 17:00:11 2021 +0530

    drm/i915/hdcp: Add DP HDCP2.2 timeout to read entire msg
    
    As documented in HDCP 2.2 DP Errata spec transmitter should abort the
    authentication protocol in case transmitter has not received the
    entire {AKE_Send_Cert, AKE_Send_H_prime, AKE_Send_Paring_Info} msg
    within {110,7,5} miliseconds.
    
    Adding above msg timeout values and aborting the HDCP authentication
    in case it timedout to read entire msg.
    
    https://www.digital-cp.com/sites/default/files/HDCP%202_2_DisplayPort_Errata_v3_0.pdf
    
    v2:
    - Removed redundant variable msg_can_timedout. [Ankit]
    
    Cc: Ramalingam C <ramalingam.c@intel.com>
    Signed-off-by: Anshuman Gupta <anshuman.gupta@intel.com>
    Reviewed-by: Ankit Nautiyal <ankit.k.nautiyal@intel.com>
    Acked-by: Maxime Ripard <mripard@kernel.org>
    Signed-off-by: Jani Nikula <jani.nikula@intel.com>
    Link: https://patchwork.freedesktop.org/patch/msgid/20210324113012.7564-2-anshuman.gupta@intel.com

diff --git a/include/drm/drm_hdcp.h b/include/drm/drm_hdcp.h
index ac22c246542a..2b165a0f434f 100644
--- a/include/drm/drm_hdcp.h
+++ b/include/drm/drm_hdcp.h
@@ -224,9 +224,12 @@ struct hdcp2_rep_stream_ready {
 
 /* HDCP2.2 TIMEOUTs in mSec */
 #define HDCP_2_2_CERT_TIMEOUT_MS		100
+#define HDCP_2_2_DP_CERT_READ_TIMEOUT_MS	110
 #define HDCP_2_2_HPRIME_NO_PAIRED_TIMEOUT_MS	1000
 #define HDCP_2_2_HPRIME_PAIRED_TIMEOUT_MS	200
+#define HDCP_2_2_DP_HPRIME_READ_TIMEOUT_MS	7
 #define HDCP_2_2_PAIRING_TIMEOUT_MS		200
+#define HDCP_2_2_DP_PAIRING_READ_TIMEOUT_MS	5
 #define	HDCP_2_2_HDMI_LPRIME_TIMEOUT_MS		20
 #define HDCP_2_2_DP_LPRIME_TIMEOUT_MS		7
 #define HDCP_2_2_RECVID_LIST_TIMEOUT_MS		3000