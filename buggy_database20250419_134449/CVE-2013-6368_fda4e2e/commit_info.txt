Commit Hash: fda4e2e85589191b123d31cdc21fd33ee70f50fd
Subject: KVM: x86: Convert vapic synchronization to _cached functions (CVE-2013-6368)

CVE Identifiers:
- CVE-2013-6368
- CVE-2013-6368

Full commit message:
KVM: x86: Convert vapic synchronization to _cached functions (CVE-2013-6368)

In kvm_lapic_sync_from_vapic and kvm_lapic_sync_to_vapic there is the
potential to corrupt kernel memory if userspace provides an address that
is at the end of a page.  This patches concerts those functions to use
kvm_write_guest_cached and kvm_read_guest_cached.  It also checks the
vapic_address specified by userspace during ioctl processing and returns
an error to userspace if the address is not a valid GPA.

This is generally not guest triggerable, because the required write is
done by firmware that runs before the guest.  Also, it only affects AMD
processors and oldish Intel that do not have the FlexPriority feature
(unless you disable FlexPriority, of course; then newer processors are
also affected).

Fixes: b93463aa59d6 ('KVM: Accelerated apic support')

Reported-by: Andrew Honig <ahonig@google.com>
Cc: stable@vger.kernel.org
Signed-off-by: Andrew Honig <ahonig@google.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Andy Honig <ahonig@google.com>
Author Date: Wed Nov 20 10:23:22 2013 -0800
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Thu Dec 12 22:39:46 2013 +0100

Files Changed: 3
Lines Added: 18
Lines Removed: 53
Total Changes: 71
