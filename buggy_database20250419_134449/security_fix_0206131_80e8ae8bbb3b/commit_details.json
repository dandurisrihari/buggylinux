{
  "hash": "0206131811fa6e4b3ed64b5f1c107e2815dcab42",
  "hash_short": "02061318",
  "subject": "perf powerpc: Rework syscall table generation",
  "body": "Commit aff850393200 (\"powerpc: add system call table generation\nsupport\") changed how systemcall table is generated for powerpc.\nIncorporate these changes into perf as well.\n\nCommitter testing:\n\n  $ podman run --entrypoint=/bin/sh --privileged -v /home/acme/git:/git --rm -ti docker.io/acmel/linux-perf-tools-build-ubuntu:18.04-x-powerpc64\n  perfbuilder@d7a7af166a80:/git/perf$ head -2 /etc/os-release\n  NAME=\"Ubuntu\"\n  VERSION=\"18.04.1 LTS (Bionic Beaver)\"\n  perfbuilder@d7a7af166a80:/git/perf$\n  perfbuilder@d7a7af166a80:/git/perf$ make ARCH=powerpc CROSS_COMPILE=powerpc64-linux-gnu- EXTRA_CFLAGS= -C /git/linux/tools/perf O=/tmp/build/perf\n  make: Entering directory '/git/linux/tools/perf'\n    BUILD:   Doing 'make -j8' parallel build\n    HOSTCC   /tmp/build/perf/fixdep.o\n    HOSTLD   /tmp/build/perf/fixdep-in.o\n    LINK     /tmp/build/perf/fixdep\n  Warning: Kernel ABI header at 'tools/include/uapi/linux/mman.h' differs from latest version at 'include/uapi/linux/mman.h'\n  diff -u tools/include/uapi/linux/mman.h include/uapi/linux/mman.h\n  sh: 1: command: Illegal option -c\n\n  Auto-detecting system features:\n  ...                         dwarf: [ on  ]\n  ...            dwarf_getlocations: [ on  ]\n  ...                         glibc: [ on  ]\n  ...                          gtk2: [ OFF ]\n  ...                      libaudit: [ OFF ]\n  ...                        libbfd: [ OFF ]\n  ...                        libelf: [ on  ]\n  ...                       libnuma: [ OFF ]\n  ...        numa_num_possible_cpus: [ OFF ]\n  ...                       libperl: [ OFF ]\n  ...                     libpython: [ OFF ]\n  ...                      libslang: [ OFF ]\n  ...                     libcrypto: [ OFF ]\n  ...                     libunwind: [ OFF ]\n  ...            libdw-dwarf-unwind: [ on  ]\n  ...                          zlib: [ on  ]\n  ...                          lzma: [ OFF ]\n  ...                     get_cpuid: [ OFF ]\n  ...                           bpf: [ on  ]\n\n  Makefile.config:445: No sys/sdt.h found, no SDT events are defined, please install systemtap-sdt-devel or systemtap-sdt-dev\n  Makefile.config:491: No libunwind found. Please install libunwind-dev[el] >= 1.1 and/or set LIBUNWIND_DIR\n  Makefile.config:583: No libcrypto.h found, disables jitted code injection, please install libssl-devel or libssl-dev\n  Makefile.config:598: slang not found, disables TUI support. Please install slang-devel, libslang-dev or libslang2-dev\n  Makefile.config:612: GTK2 not found, disables GTK2 support. Please install gtk2-devel or libgtk2.0-dev\n  Makefile.config:639: Missing perl devel files. Disabling perl scripting support, please install perl-ExtUtils-Embed/libperl-dev\n  Makefile.config:666: No python interpreter was found: disables Python support - please install python-devel/python-dev\n  Makefile.config:721: No bfd.h/libbfd found, please install binutils-dev[el]/zlib-static/libiberty-dev to gain symbol demangling\n  Makefile.config:750: No liblzma found, disables xz kernel module decompression, please install xz-devel/liblzma-dev\n  Makefile.config:763: No numa.h found, disables 'perf bench numa mem' benchmark, please install numactl-devel/libnuma-devel/libnuma-dev\n  Makefile.config:814: No libbabeltrace found, disables 'perf data' CTF format support, please install libbabeltrace-dev[el]/libbabeltrace-ctf-dev\n  Makefile.config:840: No alternatives command found, you need to set JDIR= to point to the root of your Java directory\n    GEN      /tmp/build/perf/common-cmds.h\n  <SNIP>\n    CC       /tmp/build/perf/util/syscalltbl.o\n  <SNIP>\n    LD       /tmp/build/perf/libperf-in.o\n    AR       /tmp/build/perf/libperf.a\n    LINK     /tmp/build/perf/perf\n  make: Leaving directory '/git/linux/tools/perf'\n  perfbuilder@d7a7af166a80:/git/perf$ head /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_64.c\n  static const char *syscalltbl_powerpc_64[] = {\n  \t[0] = \"restart_syscall\",\n  \t[1] = \"exit\",\n  \t[2] = \"fork\",\n  \t[3] = \"read\",\n  \t[4] = \"write\",\n  \t[5] = \"open\",\n  \t[6] = \"close\",\n  \t[7] = \"waitpid\",\n  \t[8] = \"creat\",\n  perfbuilder@d7a7af166a80:/git/perf$ tail /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_64.c\n  \t[381] = \"pwritev2\",\n  \t[382] = \"kexec_file_load\",\n  \t[383] = \"statx\",\n  \t[384] = \"pkey_alloc\",\n  \t[385] = \"pkey_free\",\n  \t[386] = \"pkey_mprotect\",\n  \t[387] = \"rseq\",\n  \t[388] = \"io_pgetevents\",\n  };\n  #define SYSCALLTBL_POWERPC_64_MAX_ID 388\n  perfbuilder@d7a7af166a80:/git/perf$ head /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_32.c\n  static const char *syscalltbl_powerpc_32[] = {\n  \t[0] = \"restart_syscall\",\n  \t[1] = \"exit\",\n  \t[2] = \"fork\",\n  \t[3] = \"read\",\n  \t[4] = \"write\",\n  \t[5] = \"open\",\n  \t[6] = \"close\",\n  \t[7] = \"waitpid\",\n  \t[8] = \"creat\",\n  perfbuilder@d7a7af166a80:/git/perf$ tail /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_32.c\n  \t[381] = \"pwritev2\",\n  \t[382] = \"kexec_file_load\",\n  \t[383] = \"statx\",\n  \t[384] = \"pkey_alloc\",\n  \t[385] = \"pkey_free\",\n  \t[386] = \"pkey_mprotect\",\n  \t[387] = \"rseq\",\n  \t[388] = \"io_pgetevents\",\n  };\n  #define SYSCALLTBL_POWERPC_32_MAX_ID 388\n  perfbuilder@d7a7af166a80:/git/perf$\n\nSigned-off-by: Ravi Bangoria <ravi.bangoria@linux.ibm.com>\nReported-by: Arnaldo Carvalho de Melo <acme@redhat.com>\nTested-by: Arnaldo Carvalho de Melo <acme@redhat.com>\nCc: Jiri Olsa <jolsa@redhat.com>\nCc: Michael Ellerman <mpe@ellerman.id.au>\nCc: Namhyung Kim <namhyung@kernel.org>\nCc: linuxppc-dev@lists.ozlabs.org\nLink: http://lkml.kernel.org/r/20190110094936.3132-1-ravi.bangoria@linux.ibm.com\nSigned-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>",
  "full_message": "perf powerpc: Rework syscall table generation\n\nCommit aff850393200 (\"powerpc: add system call table generation\nsupport\") changed how systemcall table is generated for powerpc.\nIncorporate these changes into perf as well.\n\nCommitter testing:\n\n  $ podman run --entrypoint=/bin/sh --privileged -v /home/acme/git:/git --rm -ti docker.io/acmel/linux-perf-tools-build-ubuntu:18.04-x-powerpc64\n  perfbuilder@d7a7af166a80:/git/perf$ head -2 /etc/os-release\n  NAME=\"Ubuntu\"\n  VERSION=\"18.04.1 LTS (Bionic Beaver)\"\n  perfbuilder@d7a7af166a80:/git/perf$\n  perfbuilder@d7a7af166a80:/git/perf$ make ARCH=powerpc CROSS_COMPILE=powerpc64-linux-gnu- EXTRA_CFLAGS= -C /git/linux/tools/perf O=/tmp/build/perf\n  make: Entering directory '/git/linux/tools/perf'\n    BUILD:   Doing 'make -j8' parallel build\n    HOSTCC   /tmp/build/perf/fixdep.o\n    HOSTLD   /tmp/build/perf/fixdep-in.o\n    LINK     /tmp/build/perf/fixdep\n  Warning: Kernel ABI header at 'tools/include/uapi/linux/mman.h' differs from latest version at 'include/uapi/linux/mman.h'\n  diff -u tools/include/uapi/linux/mman.h include/uapi/linux/mman.h\n  sh: 1: command: Illegal option -c\n\n  Auto-detecting system features:\n  ...                         dwarf: [ on  ]\n  ...            dwarf_getlocations: [ on  ]\n  ...                         glibc: [ on  ]\n  ...                          gtk2: [ OFF ]\n  ...                      libaudit: [ OFF ]\n  ...                        libbfd: [ OFF ]\n  ...                        libelf: [ on  ]\n  ...                       libnuma: [ OFF ]\n  ...        numa_num_possible_cpus: [ OFF ]\n  ...                       libperl: [ OFF ]\n  ...                     libpython: [ OFF ]\n  ...                      libslang: [ OFF ]\n  ...                     libcrypto: [ OFF ]\n  ...                     libunwind: [ OFF ]\n  ...            libdw-dwarf-unwind: [ on  ]\n  ...                          zlib: [ on  ]\n  ...                          lzma: [ OFF ]\n  ...                     get_cpuid: [ OFF ]\n  ...                           bpf: [ on  ]\n\n  Makefile.config:445: No sys/sdt.h found, no SDT events are defined, please install systemtap-sdt-devel or systemtap-sdt-dev\n  Makefile.config:491: No libunwind found. Please install libunwind-dev[el] >= 1.1 and/or set LIBUNWIND_DIR\n  Makefile.config:583: No libcrypto.h found, disables jitted code injection, please install libssl-devel or libssl-dev\n  Makefile.config:598: slang not found, disables TUI support. Please install slang-devel, libslang-dev or libslang2-dev\n  Makefile.config:612: GTK2 not found, disables GTK2 support. Please install gtk2-devel or libgtk2.0-dev\n  Makefile.config:639: Missing perl devel files. Disabling perl scripting support, please install perl-ExtUtils-Embed/libperl-dev\n  Makefile.config:666: No python interpreter was found: disables Python support - please install python-devel/python-dev\n  Makefile.config:721: No bfd.h/libbfd found, please install binutils-dev[el]/zlib-static/libiberty-dev to gain symbol demangling\n  Makefile.config:750: No liblzma found, disables xz kernel module decompression, please install xz-devel/liblzma-dev\n  Makefile.config:763: No numa.h found, disables 'perf bench numa mem' benchmark, please install numactl-devel/libnuma-devel/libnuma-dev\n  Makefile.config:814: No libbabeltrace found, disables 'perf data' CTF format support, please install libbabeltrace-dev[el]/libbabeltrace-ctf-dev\n  Makefile.config:840: No alternatives command found, you need to set JDIR= to point to the root of your Java directory\n    GEN      /tmp/build/perf/common-cmds.h\n  <SNIP>\n    CC       /tmp/build/perf/util/syscalltbl.o\n  <SNIP>\n    LD       /tmp/build/perf/libperf-in.o\n    AR       /tmp/build/perf/libperf.a\n    LINK     /tmp/build/perf/perf\n  make: Leaving directory '/git/linux/tools/perf'\n  perfbuilder@d7a7af166a80:/git/perf$ head /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_64.c\n  static const char *syscalltbl_powerpc_64[] = {\n  \t[0] = \"restart_syscall\",\n  \t[1] = \"exit\",\n  \t[2] = \"fork\",\n  \t[3] = \"read\",\n  \t[4] = \"write\",\n  \t[5] = \"open\",\n  \t[6] = \"close\",\n  \t[7] = \"waitpid\",\n  \t[8] = \"creat\",\n  perfbuilder@d7a7af166a80:/git/perf$ tail /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_64.c\n  \t[381] = \"pwritev2\",\n  \t[382] = \"kexec_file_load\",\n  \t[383] = \"statx\",\n  \t[384] = \"pkey_alloc\",\n  \t[385] = \"pkey_free\",\n  \t[386] = \"pkey_mprotect\",\n  \t[387] = \"rseq\",\n  \t[388] = \"io_pgetevents\",\n  };\n  #define SYSCALLTBL_POWERPC_64_MAX_ID 388\n  perfbuilder@d7a7af166a80:/git/perf$ head /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_32.c\n  static const char *syscalltbl_powerpc_32[] = {\n  \t[0] = \"restart_syscall\",\n  \t[1] = \"exit\",\n  \t[2] = \"fork\",\n  \t[3] = \"read\",\n  \t[4] = \"write\",\n  \t[5] = \"open\",\n  \t[6] = \"close\",\n  \t[7] = \"waitpid\",\n  \t[8] = \"creat\",\n  perfbuilder@d7a7af166a80:/git/perf$ tail /tmp/build/perf/arch/powerpc/include/generated/asm/syscalls_32.c\n  \t[381] = \"pwritev2\",\n  \t[382] = \"kexec_file_load\",\n  \t[383] = \"statx\",\n  \t[384] = \"pkey_alloc\",\n  \t[385] = \"pkey_free\",\n  \t[386] = \"pkey_mprotect\",\n  \t[387] = \"rseq\",\n  \t[388] = \"io_pgetevents\",\n  };\n  #define SYSCALLTBL_POWERPC_32_MAX_ID 388\n  perfbuilder@d7a7af166a80:/git/perf$\n\nSigned-off-by: Ravi Bangoria <ravi.bangoria@linux.ibm.com>\nReported-by: Arnaldo Carvalho de Melo <acme@redhat.com>\nTested-by: Arnaldo Carvalho de Melo <acme@redhat.com>\nCc: Jiri Olsa <jolsa@redhat.com>\nCc: Michael Ellerman <mpe@ellerman.id.au>\nCc: Namhyung Kim <namhyung@kernel.org>\nCc: linuxppc-dev@lists.ozlabs.org\nLink: http://lkml.kernel.org/r/20190110094936.3132-1-ravi.bangoria@linux.ibm.com\nSigned-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>",
  "author_name": "Ravi Bangoria",
  "author_email": "ravi.bangoria@linux.ibm.com",
  "author_date": "Thu Jan 10 15:19:35 2019 +0530",
  "author_date_iso": "2019-01-10T15:19:35+05:30",
  "committer_name": "Arnaldo Carvalho de Melo",
  "committer_email": "acme@redhat.com",
  "committer_date": "Thu Jan 10 10:34:52 2019 -0300",
  "committer_date_iso": "2019-01-10T10:34:52-03:00",
  "files_changed": [
    "tools/perf/arch/powerpc/Makefile",
    "tools/perf/arch/powerpc/entry/syscalls/mksyscalltbl",
    "tools/perf/arch/powerpc/entry/syscalls/syscall.tbl"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "tools/perf/arch/powerpc/Makefile",
      "insertions": 11,
      "deletions": 4
    },
    {
      "file": "tools/perf/arch/powerpc/entry/syscalls/mksyscalltbl",
      "insertions": 12,
      "deletions": 10
    },
    {
      "file": "tools/perf/arch/powerpc/entry/syscalls/syscall.tbl",
      "insertions": 427,
      "deletions": 0
    }
  ],
  "total_insertions": 450,
  "total_deletions": 14,
  "total_changes": 464,
  "parents": [
    "549aff770ccfec368aa8f0652dbce8b1e8e6715a"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.0",
    "v5.0-rc2",
    "v5.0-rc3",
    "v5.0-rc4",
    "v5.0-rc5",
    "v5.0-rc6",
    "v5.0-rc7",
    "v5.0-rc8",
    "v5.1",
    "v5.1-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "tools/perf/arch/powerpc/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/perf/arch/powerpc/entry/syscalls/mksyscalltbl",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "tools/perf/arch/powerpc/entry/syscalls/syscall.tbl",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}