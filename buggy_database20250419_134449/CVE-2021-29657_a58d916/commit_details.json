{
  "hash": "a58d9166a756a0f4a6618e4f593232593d6df134",
  "hash_short": "a58d9166",
  "subject": "KVM: SVM: load control fields from VMCB12 before checking them",
  "body": "Avoid races between check and use of the nested VMCB controls.  This\nfor example ensures that the VMRUN intercept is always reflected to the\nnested hypervisor, instead of being processed by the host.  Without this\npatch, it is possible to end up with svm->nested.hsave pointing to\nthe MSR permission bitmap for nested guests.\n\nThis bug is CVE-2021-29657.\n\nReported-by: Felix Wilhelm <fwilhelm@google.com>\nCc: stable@vger.kernel.org\nFixes: 2fcf4876ada (\"KVM: nSVM: implement on demand allocation of the nested state\")\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "full_message": "KVM: SVM: load control fields from VMCB12 before checking them\n\nAvoid races between check and use of the nested VMCB controls.  This\nfor example ensures that the VMRUN intercept is always reflected to the\nnested hypervisor, instead of being processed by the host.  Without this\npatch, it is possible to end up with svm->nested.hsave pointing to\nthe MSR permission bitmap for nested guests.\n\nThis bug is CVE-2021-29657.\n\nReported-by: Felix Wilhelm <fwilhelm@google.com>\nCc: stable@vger.kernel.org\nFixes: 2fcf4876ada (\"KVM: nSVM: implement on demand allocation of the nested state\")\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
  "author_name": "Paolo Bonzini",
  "author_email": "pbonzini@redhat.com",
  "author_date": "Wed Mar 31 06:24:43 2021 -0400",
  "author_date_iso": "2021-03-31T06:24:43-04:00",
  "committer_name": "Paolo Bonzini",
  "committer_email": "pbonzini@redhat.com",
  "committer_date": "Thu Apr 1 05:09:31 2021 -0400",
  "committer_date_iso": "2021-04-01T05:09:31-04:00",
  "files_changed": [
    "arch/x86/kvm/svm/nested.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "arch/x86/kvm/svm/nested.c",
      "insertions": 6,
      "deletions": 4
    }
  ],
  "total_insertions": 6,
  "total_deletions": 4,
  "total_changes": 10,
  "parents": [
    "2c85ebc57b3e1817b6ce1a6b703928e113a90442"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2021-29657"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "arch/x86/kvm/svm/nested.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}