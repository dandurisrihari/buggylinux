Commit Hash: 5c2465dfd457f3015eebcc3ace50570e1d896aeb
Subject: SUNRPC: Set rq_auth_stat in the pg_authenticate() callout


Security Keywords:
- authentication

Full commit message:
SUNRPC: Set rq_auth_stat in the pg_authenticate() callout

In a few moments, rq_auth_stat will need to be explicitly set to
rpc_auth_ok before execution gets to the dispatcher.

svc_authenticate() already sets it, but it often gets reset to
rpc_autherr_badcred right after that call, even when authentication
is successful. Let's ensure that the pg_authenticate callout and
svc_set_client() set it properly in every case.

Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Anna Schumaker <Anna.Schumaker@Netapp.com>

Metadata:
Author: Chuck Lever <chuck.lever@oracle.com>
Author Date: Thu Jul 15 15:52:12 2021 -0400
Committer: Anna Schumaker <Anna.Schumaker@Netapp.com>
Commit Date: Tue Aug 10 14:18:35 2021 -0400

Files Changed: 5
Lines Added: 16
Lines Removed: 4
Total Changes: 20
