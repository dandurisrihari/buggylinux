{
  "hash": "9aa422ad326634b76309e8ff342c246800621216",
  "hash_short": "9aa422ad",
  "subject": "tipc: improve size validations for received domain records",
  "body": "The function tipc_mon_rcv() allows a node to receive and process\ndomain_record structs from peer nodes to track their views of the\nnetwork topology.\n\nThis patch verifies that the number of members in a received domain\nrecord does not exceed the limit defined by MAX_MON_DOMAIN, something\nthat may otherwise lead to a stack overflow.\n\ntipc_mon_rcv() is called from the function tipc_link_proto_rcv(), where\nwe are reading a 32 bit message data length field into a uint16.  To\navert any risk of bit overflow, we add an extra sanity check for this in\nthat function.  We cannot see that happen with the current code, but\nfuture designers being unaware of this risk, may introduce it by\nallowing delivery of very large (> 64k) sk buffers from the bearer\nlayer.  This potential problem was identified by Eric Dumazet.\n\nThis fixes CVE-2022-0435\n\nReported-by: Samuel Page <samuel.page@appgate.com>\nReported-by: Eric Dumazet <edumazet@google.com>\nFixes: 35c55c9877f8 (\"tipc: add neighbor monitoring framework\")\nSigned-off-by: Jon Maloy <jmaloy@redhat.com>\nReviewed-by: Xin Long <lucien.xin@gmail.com>\nReviewed-by: Samuel Page <samuel.page@appgate.com>\nReviewed-by: Eric Dumazet <edumazet@google.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "tipc: improve size validations for received domain records\n\nThe function tipc_mon_rcv() allows a node to receive and process\ndomain_record structs from peer nodes to track their views of the\nnetwork topology.\n\nThis patch verifies that the number of members in a received domain\nrecord does not exceed the limit defined by MAX_MON_DOMAIN, something\nthat may otherwise lead to a stack overflow.\n\ntipc_mon_rcv() is called from the function tipc_link_proto_rcv(), where\nwe are reading a 32 bit message data length field into a uint16.  To\navert any risk of bit overflow, we add an extra sanity check for this in\nthat function.  We cannot see that happen with the current code, but\nfuture designers being unaware of this risk, may introduce it by\nallowing delivery of very large (> 64k) sk buffers from the bearer\nlayer.  This potential problem was identified by Eric Dumazet.\n\nThis fixes CVE-2022-0435\n\nReported-by: Samuel Page <samuel.page@appgate.com>\nReported-by: Eric Dumazet <edumazet@google.com>\nFixes: 35c55c9877f8 (\"tipc: add neighbor monitoring framework\")\nSigned-off-by: Jon Maloy <jmaloy@redhat.com>\nReviewed-by: Xin Long <lucien.xin@gmail.com>\nReviewed-by: Samuel Page <samuel.page@appgate.com>\nReviewed-by: Eric Dumazet <edumazet@google.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Jon Maloy",
  "author_email": "jmaloy@redhat.com",
  "author_date": "Sat Feb 5 14:11:18 2022 -0500",
  "author_date_iso": "2022-02-05T14:11:18-05:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Thu Feb 10 05:37:44 2022 -0800",
  "committer_date_iso": "2022-02-10T05:37:44-08:00",
  "files_changed": [
    "net/tipc/link.c",
    "net/tipc/monitor.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/tipc/link.c",
      "insertions": 7,
      "deletions": 2
    },
    {
      "file": "net/tipc/monitor.c",
      "insertions": 2,
      "deletions": 0
    }
  ],
  "total_insertions": 9,
  "total_deletions": 2,
  "total_changes": 11,
  "parents": [
    "f4bc5bbb5fef3cf421ba3485d6d383c27ec473ed"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-0435"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/tipc/link.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/tipc/monitor.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}