Commit Hash: 62e1cbfc5d795381a0f237ae7ee229a92d51cf9e
Subject: fortify: Short-circuit known-safe calls to strscpy()


Security Keywords:
- hardening

Full commit message:
fortify: Short-circuit known-safe calls to strscpy()

Replacing compile-time safe calls of strcpy()-related functions with
strscpy() was always calling the full strscpy() logic when a builtin
would be better. For example:

	char buf[16];
	strcpy(buf, "yes");

would reduce to __builtin_memcpy(buf, "yes", 4), but not if it was:

	strscpy(buf, yes, sizeof(buf));

Fix this by checking if all sizes are known at compile-time.

Cc: linux-hardening@vger.kernel.org
Tested-by: Nathan Chancellor <nathan@kernel.org>
Signed-off-by: Kees Cook <keescook@chromium.org>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Sun Oct 2 09:17:03 2022 -0700
Committer: Kees Cook <keescook@chromium.org>
Commit Date: Tue Nov 1 10:04:52 2022 -0700

Files Changed: 2
Lines Added: 23
Lines Removed: 0
Total Changes: 23
