diff --cc net/bluetooth/hidp/core.c
index 13863de433a4,d38ab1527006..bdc35a7a7fee
--- a/net/bluetooth/hidp/core.c
+++ b/net/bluetooth/hidp/core.c
@@@ -235,34 -236,13 +236,38 @@@ static int hidp_send_report(struct hidp
  	hid_output_report(report, buf);
  	hdr = HIDP_TRANS_DATA | HIDP_DATA_RTYPE_OUPUT;
  
- 	return hidp_send_intr_message(session, hdr, buf, rsize);
+ 	rsize = ((report->size - 1) >> 3) + 1 + (report->id > 0);
+ 	ret = hidp_send_intr_message(session, hdr, buf, rsize);
+ 
+ 	kfree(buf);
+ 	return ret;
  }
  
 +static int hidp_hidinput_event(struct input_dev *dev, unsigned int type,
 +			       unsigned int code, int value)
 +{
 +	struct hid_device *hid = input_get_drvdata(dev);
 +	struct hidp_session *session = hid->driver_data;
 +	struct hid_field *field;
 +	int offset;
 +
 +	BT_DBG("session %p type %d code %d value %d",
 +	       session, type, code, value);
 +
 +	if (type != EV_LED)
 +		return -1;
 +
 +	offset = hidinput_find_field(hid, type, code, &field);
 +	if (offset == -1) {
 +		hid_warn(dev, "event field not found\n");
 +		return -1;
 +	}
 +
 +	hid_set_field(field, offset, value);
 +
 +	return hidp_send_report(session, field->report);
 +}
 +
  static int hidp_get_raw_report(struct hid_device *hid,
  		unsigned char report_number,
  		unsigned char *data, size_t count,