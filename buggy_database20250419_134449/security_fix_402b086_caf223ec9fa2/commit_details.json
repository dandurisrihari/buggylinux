{
  "hash": "402b08622d9ac6e32e25289573272e0f21bb58a7",
  "hash_short": "402b0862",
  "subject": "s390: KVM preparation: provide hook to enable pgstes in user pagetable",
  "body": "The SIE instruction on s390 uses the 2nd half of the page table page to\nvirtualize the storage keys of a guest. This patch offers the s390_enable_sie\nfunction, which reorganizes the page tables of a single-threaded process to\nreserve space in the page table:\ns390_enable_sie makes sure that the process is single threaded and then uses\ndup_mm to create a new mm with reorganized page tables. The old mm is freed\nand the process has now a page status extended field after every page table.\n\nCode that wants to exploit pgstes should SELECT CONFIG_PGSTE.\n\nThis patch has a small common code hit, namely making dup_mm non-static.\n\nEdit (Carsten): I've modified Martin's patch, following Jeremy Fitzhardinge's\nreview feedback. Now we do have the prototype for dup_mm in\ninclude/linux/sched.h. Following Martin's suggestion, s390_enable_sie() does now\ncall task_lock() to prevent race against ptrace modification of mm_users.\n\nSigned-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>\nSigned-off-by: Carsten Otte <cotte@de.ibm.com>\nAcked-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Avi Kivity <avi@qumranet.com>",
  "full_message": "s390: KVM preparation: provide hook to enable pgstes in user pagetable\n\nThe SIE instruction on s390 uses the 2nd half of the page table page to\nvirtualize the storage keys of a guest. This patch offers the s390_enable_sie\nfunction, which reorganizes the page tables of a single-threaded process to\nreserve space in the page table:\ns390_enable_sie makes sure that the process is single threaded and then uses\ndup_mm to create a new mm with reorganized page tables. The old mm is freed\nand the process has now a page status extended field after every page table.\n\nCode that wants to exploit pgstes should SELECT CONFIG_PGSTE.\n\nThis patch has a small common code hit, namely making dup_mm non-static.\n\nEdit (Carsten): I've modified Martin's patch, following Jeremy Fitzhardinge's\nreview feedback. Now we do have the prototype for dup_mm in\ninclude/linux/sched.h. Following Martin's suggestion, s390_enable_sie() does now\ncall task_lock() to prevent race against ptrace modification of mm_users.\n\nSigned-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>\nSigned-off-by: Carsten Otte <cotte@de.ibm.com>\nAcked-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Avi Kivity <avi@qumranet.com>",
  "author_name": "Carsten Otte",
  "author_email": "cotte@de.ibm.com",
  "author_date": "Tue Mar 25 18:47:10 2008 +0100",
  "author_date_iso": "2008-03-25T18:47:10+01:00",
  "committer_name": "Avi Kivity",
  "committer_email": "avi@qumranet.com",
  "committer_date": "Sun Apr 27 12:00:40 2008 +0300",
  "committer_date_iso": "2008-04-27T12:00:40+03:00",
  "files_changed": [
    "arch/s390/Kconfig",
    "arch/s390/kernel/setup.c",
    "arch/s390/mm/pgtable.c",
    "include/asm-s390/mmu.h",
    "include/asm-s390/mmu_context.h",
    "include/asm-s390/pgtable.h",
    "include/linux/sched.h",
    "kernel/fork.c"
  ],
  "files_changed_count": 8,
  "stats": [
    {
      "file": "arch/s390/Kconfig",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/s390/kernel/setup.c",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/s390/mm/pgtable.c",
      "insertions": 62,
      "deletions": 3
    },
    {
      "file": "include/asm-s390/mmu.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/asm-s390/mmu_context.h",
      "insertions": 7,
      "deletions": 1
    },
    {
      "file": "include/asm-s390/pgtable.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/linux/sched.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "kernel/fork.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 82,
  "total_deletions": 5,
  "total_changes": 87,
  "parents": [
    "37817f2982d0f559f90cecc66e150dd9d2c2df05"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.26",
    "v2.6.26-rc1",
    "v2.6.26-rc2",
    "v2.6.26-rc3",
    "v2.6.26-rc4",
    "v2.6.26-rc5",
    "v2.6.26-rc6",
    "v2.6.26-rc7",
    "v2.6.26-rc8",
    "v2.6.26-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/s390/kernel/setup.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/s390/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/asm-s390/mmu_context.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/asm-s390/pgtable.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/s390/mm/pgtable.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/sched.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/asm-s390/mmu.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/fork.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}