commit aaa4dd1b47f5ff5ef477fec5dcc6c397b457f1c2
Author: Wang Kefeng <wangkefeng.wang@huawei.com>
Date:   Sun Dec 4 04:46:40 2022 +0100

    ARM: 9279/1: support function error injection
    
    This enables HAVE_FUNCTION_ERROR_INJECTION by adding necessary
    regs_set_return_value() and override_function_with_return().
    
    Simply tested according to Documentation/fault-injection/fault-injection.rst.
    
    Signed-off-by: Kefeng Wang <wangkefeng.wang@huawei.com>
    Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>

diff --git a/arch/arm/include/asm/ptrace.h b/arch/arm/include/asm/ptrace.h
index 1408a6a15d0e..483b8ddfcb82 100644
--- a/arch/arm/include/asm/ptrace.h
+++ b/arch/arm/include/asm/ptrace.h
@@ -163,6 +163,10 @@ static inline unsigned long user_stack_pointer(struct pt_regs *regs)
 		((current_stack_pointer | (THREAD_SIZE - 1)) - 7) - 1;	\
 })
 
+static inline void regs_set_return_value(struct pt_regs *regs, unsigned long rc)
+{
+	regs->ARM_r0 = rc;
+}
 
 /*
  * Update ITSTATE after normal execution of an IT block instruction.