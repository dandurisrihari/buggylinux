{
  "hash": "34459512ffa7236c849466e3bd604801389734e1",
  "hash_short": "34459512",
  "subject": "mac80211: fix TKIP replay vulnerability",
  "body": "Unlike CCMP, the presence or absence of the QoS\nfield doesn't change the encryption, only the\nTID is used. When no QoS field is present, zero\nis used as the TID value. This means that it is\npossible for an attacker to take a QoS packet\nwith TID 0 and replay it as a non-QoS packet.\n\nUnfortunately, mac80211 uses different IVs for\nchecking the validity of the packet's TKIP IV\nwhen it checks TID 0 and when it checks non-QoS\npackets. This means it is vulnerable to this\nreplay attack.\n\nTo fix this, use the same replay counter for\nTID 0 and non-QoS packets by overriding the\nrx->queue value to 0 if it is 16 (non-QoS).\n\nThis is a minimal fix for now. I caused this\nissue in\n\ncommit 1411f9b531f0a910cd1c85a337737c1e6ffbae6a\nAuthor: Johannes Berg <johannes@sipsolutions.net>\nDate:   Thu Jul 10 10:11:02 2008 +0200\n\n    mac80211: fix RX sequence number check\n\nwhile fixing a sequence number issue (there,\na separate counter needs to be used).\n\nCc: stable@kernel.org\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\nSigned-off-by: John W. Linville <linville@tuxdriver.com>",
  "full_message": "mac80211: fix TKIP replay vulnerability\n\nUnlike CCMP, the presence or absence of the QoS\nfield doesn't change the encryption, only the\nTID is used. When no QoS field is present, zero\nis used as the TID value. This means that it is\npossible for an attacker to take a QoS packet\nwith TID 0 and replay it as a non-QoS packet.\n\nUnfortunately, mac80211 uses different IVs for\nchecking the validity of the packet's TKIP IV\nwhen it checks TID 0 and when it checks non-QoS\npackets. This means it is vulnerable to this\nreplay attack.\n\nTo fix this, use the same replay counter for\nTID 0 and non-QoS packets by overriding the\nrx->queue value to 0 if it is 16 (non-QoS).\n\nThis is a minimal fix for now. I caused this\nissue in\n\ncommit 1411f9b531f0a910cd1c85a337737c1e6ffbae6a\nAuthor: Johannes Berg <johannes@sipsolutions.net>\nDate:   Thu Jul 10 10:11:02 2008 +0200\n\n    mac80211: fix RX sequence number check\n\nwhile fixing a sequence number issue (there,\na separate counter needs to be used).\n\nCc: stable@kernel.org\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\nSigned-off-by: John W. Linville <linville@tuxdriver.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Thu Jul 7 18:24:54 2011 +0200",
  "author_date_iso": "2011-07-07T18:24:54+02:00",
  "committer_name": "John W. Linville",
  "committer_email": "linville@tuxdriver.com",
  "committer_date": "Thu Jul 7 13:06:09 2011 -0400",
  "committer_date_iso": "2011-07-07T13:06:09-04:00",
  "files_changed": [
    "net/mac80211/wpa.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/wpa.c",
      "insertions": 13,
      "deletions": 3
    }
  ],
  "total_insertions": 13,
  "total_deletions": 3,
  "total_changes": 16,
  "parents": [
    "1186980dafcd14d0e257a4dd6990cefdc6f3e362"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.0",
    "v3.1",
    "v3.1-rc1",
    "v3.1-rc10",
    "v3.1-rc2",
    "v3.1-rc3",
    "v3.1-rc4",
    "v3.1-rc5",
    "v3.1-rc6",
    "v3.1-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/wpa.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}