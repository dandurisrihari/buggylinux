Commit Hash: fa35198f39571bbdae53c5b321020021eaad6bd2
Subject: fortify: Explicitly check bounds are compile-time constants


Security Keywords:
- hardening

Full commit message:
fortify: Explicitly check bounds are compile-time constants

In preparation for replacing __builtin_object_size() with
__builtin_dynamic_object_size(), all the compile-time size checks
need to check that the bounds comparisons are, in fact, known at
compile-time. Enforce what was guaranteed with __bos(). In other words,
since all uses of __bos() were constant expressions, it was not required
to test for this. When these change to __bdos(), they _may_ be constant
expressions, and the checks are only valid when the prior condition
holds. This results in no binary differences.

Cc: linux-hardening@vger.kernel.org
Link: https://lore.kernel.org/lkml/20220920192202.190793-3-keescook@chromium.org
Signed-off-by: Kees Cook <keescook@chromium.org>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Mon Sep 19 16:33:33 2022 -0700
Committer: Kees Cook <keescook@chromium.org>
Commit Date: Mon Sep 26 11:01:32 2022 -0700

Files Changed: 1
Lines Added: 30
Lines Removed: 19
Total Changes: 49
