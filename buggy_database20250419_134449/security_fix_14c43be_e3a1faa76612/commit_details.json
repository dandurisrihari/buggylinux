{
  "hash": "14c43be60166981f0b1f034ad9c59252c6f99e0d",
  "hash_short": "14c43be6",
  "subject": "efi/arm*: Drop writable mapping of the UEFI System table",
  "body": "Commit:\n\n  2eec5dedf770 (\"efi/arm-init: Use read-only early mappings\")\n\nupdated the early ARM UEFI init code to create the temporary, early\nmapping of the UEFI System table using read-only attributes, as a\nhardening measure against inadvertent modification.\n\nHowever, this still leaves the permanent, writable mapping of the UEFI\nSystem table, which is only ever referenced during invocations of UEFI\nRuntime Services, at which time the UEFI virtual mapping is available,\nwhich also covers the system table. (This is guaranteed by the fact that\nSetVirtualAddressMap(), which is a runtime service itself, converts\nvarious entries in the table to their virtual equivalents, which implies\nthat the table must be covered by a RuntimeServicesData region that has\nthe EFI_MEMORY_RUNTIME attribute.)\n\nSo instead of creating this permanent mapping, record the virtual address\nof the system table inside the UEFI virtual mapping, and dereference that\nwhen accessing the table. This protects the contents of the system table\nfrom inadvertent (or deliberate) modification when no UEFI Runtime\nServices calls are in progress.\n\nSigned-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Matt Fleming <matt@codeblueprint.co.uk>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Leif Lindholm <leif.lindholm@linaro.org>\nCc: Mark Rutland <mark.rutland@arm.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: linux-efi@vger.kernel.org\nLink: http://lkml.kernel.org/r/1461614832-17633-3-git-send-email-matt@codeblueprint.co.uk\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
  "full_message": "efi/arm*: Drop writable mapping of the UEFI System table\n\nCommit:\n\n  2eec5dedf770 (\"efi/arm-init: Use read-only early mappings\")\n\nupdated the early ARM UEFI init code to create the temporary, early\nmapping of the UEFI System table using read-only attributes, as a\nhardening measure against inadvertent modification.\n\nHowever, this still leaves the permanent, writable mapping of the UEFI\nSystem table, which is only ever referenced during invocations of UEFI\nRuntime Services, at which time the UEFI virtual mapping is available,\nwhich also covers the system table. (This is guaranteed by the fact that\nSetVirtualAddressMap(), which is a runtime service itself, converts\nvarious entries in the table to their virtual equivalents, which implies\nthat the table must be covered by a RuntimeServicesData region that has\nthe EFI_MEMORY_RUNTIME attribute.)\n\nSo instead of creating this permanent mapping, record the virtual address\nof the system table inside the UEFI virtual mapping, and dereference that\nwhen accessing the table. This protects the contents of the system table\nfrom inadvertent (or deliberate) modification when no UEFI Runtime\nServices calls are in progress.\n\nSigned-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Matt Fleming <matt@codeblueprint.co.uk>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Leif Lindholm <leif.lindholm@linaro.org>\nCc: Mark Rutland <mark.rutland@arm.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: linux-efi@vger.kernel.org\nLink: http://lkml.kernel.org/r/1461614832-17633-3-git-send-email-matt@codeblueprint.co.uk\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
  "author_name": "Ard Biesheuvel",
  "author_email": "ard.biesheuvel@linaro.org",
  "author_date": "Mon Apr 25 21:06:34 2016 +0100",
  "author_date_iso": "2016-04-25T21:06:34+01:00",
  "committer_name": "Ingo Molnar",
  "committer_email": "mingo@kernel.org",
  "committer_date": "Thu Apr 28 11:33:47 2016 +0200",
  "committer_date_iso": "2016-04-28T11:33:47+02:00",
  "files_changed": [
    "drivers/firmware/efi/arm-init.c",
    "drivers/firmware/efi/arm-runtime.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "drivers/firmware/efi/arm-init.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/firmware/efi/arm-runtime.c",
      "insertions": 16,
      "deletions": 11
    }
  ],
  "total_insertions": 18,
  "total_deletions": 11,
  "total_changes": 29,
  "parents": [
    "c5b591e96db9d99d0126acf93f24e1fb8b368343"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/firmware/efi/arm-init.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/firmware/efi/arm-runtime.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}