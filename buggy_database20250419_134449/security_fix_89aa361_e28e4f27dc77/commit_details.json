{
  "hash": "89aa3619d141d6cfb6040a561aebb6d99d3e2285",
  "hash_short": "89aa3619",
  "subject": "cipso: make cipso_v4_skbuff_delattr() fully remove the CIPSO options",
  "body": "As the comment in this function says, the code currently just clears the\nCIPSO part with IPOPT_NOP, rather than removing it completely and\ntrimming the packet. The other cipso_v4_*_delattr() functions, however,\ndo the proper removal and also calipso_skbuff_delattr() makes an effort\nto remove the CALIPSO options instead of replacing them with padding.\n\nSome routers treat IPv4 packets with anything (even NOPs) in the option\nheader as a special case and take them through a slower processing path.\nConsequently, hardening guides such as STIG recommend to configure such\nrouters to drop packets with non-empty IP option headers [1][2]. Thus,\nusers might expect NetLabel to produce packets with minimal padding (or\nat least with no padding when no actual options are present).\n\nImplement the proper option removal to address this and to be closer to\nwhat the peer functions do.\n\n[1] https://www.stigviewer.com/stig/juniper_router_rtr/2019-09-27/finding/V-90937\n[2] https://www.stigviewer.com/stig/cisco_ios_xe_router_rtr/2021-03-26/finding/V-217001\n\nSigned-off-by: Ondrej Mosnacek <omosnace@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "cipso: make cipso_v4_skbuff_delattr() fully remove the CIPSO options\n\nAs the comment in this function says, the code currently just clears the\nCIPSO part with IPOPT_NOP, rather than removing it completely and\ntrimming the packet. The other cipso_v4_*_delattr() functions, however,\ndo the proper removal and also calipso_skbuff_delattr() makes an effort\nto remove the CALIPSO options instead of replacing them with padding.\n\nSome routers treat IPv4 packets with anything (even NOPs) in the option\nheader as a special case and take them through a slower processing path.\nConsequently, hardening guides such as STIG recommend to configure such\nrouters to drop packets with non-empty IP option headers [1][2]. Thus,\nusers might expect NetLabel to produce packets with minimal padding (or\nat least with no padding when no actual options are present).\n\nImplement the proper option removal to address this and to be closer to\nwhat the peer functions do.\n\n[1] https://www.stigviewer.com/stig/juniper_router_rtr/2019-09-27/finding/V-90937\n[2] https://www.stigviewer.com/stig/cisco_ios_xe_router_rtr/2021-03-26/finding/V-217001\n\nSigned-off-by: Ondrej Mosnacek <omosnace@redhat.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Ondrej Mosnacek",
  "author_email": "omosnace@redhat.com",
  "author_date": "Fri Jun 7 18:07:53 2024 +0200",
  "author_date_iso": "2024-06-07T18:07:53+02:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Fri Jun 14 08:19:54 2024 +0100",
  "committer_date_iso": "2024-06-14T08:19:54+01:00",
  "files_changed": [
    "net/ipv4/cipso_ipv4.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/ipv4/cipso_ipv4.c",
      "insertions": 54,
      "deletions": 25
    }
  ],
  "total_insertions": 54,
  "total_deletions": 25,
  "total_changes": 79,
  "parents": [
    "9f36169912331fa035d7b73a91252d7c2512eb1a"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/ipv4/cipso_ipv4.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}