Commit Hash: 08d02364b12faa54d76dbfea2090321fd27996f2
Subject: net: mscc: fix the injection header


Security Keywords:
- injection

Full commit message:
net: mscc: fix the injection header

When injecting frames in the Ocelot switch driver an injection header
(IFH) should be used to configure various parameters related to a given
frame, such as the port onto which the frame should be departed or its
vlan id. Other parameters in the switch configuration can led to an
injected frame being sent without an IFH but this led to various issues
as the per-frame parameters are then not used. This is especially true
when using multiple ports for injection.

The IFH was injected with the wrong endianness which led to the switch
not taking it into account as the IFH_INJ_BYPASS bit was then unset.
(The bit tells the switch to use the IFH over its internal
configuration). This patch fixes it.

In addition to the endianness fix, the IFH is also fixed. As it was
(unwillingly) unused, some of its fields were not configured the right
way.

Fixes: a556c76adc05 ("net: mscc: Add initial Ocelot switch support")
Signed-off-by: Antoine Tenart <antoine.tenart@bootlin.com>
Reviewed-by: Alexandre Belloni <alexandre.belloni@bootlin.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Antoine Tenart <antoine.tenart@bootlin.com>
Author Date: Wed Jun 20 10:50:46 2018 +0200
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Thu Jun 21 10:29:46 2018 +0900

Files Changed: 1
Lines Added: 5
Lines Removed: 5
Total Changes: 10
