commit f1fe12c8bf33241e04c57a0fc5b25b16ba77ba2d
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Thu Feb 15 16:12:29 2018 +0100

    ARM: dts: Modernize the Vexpress PL111 integration
    
    The Versatile Express was submitted with the actual display
    bridges unconnected (but defined in the device tree) and
    mock "panels" encoded in the device tree node of the PL111
    controller.
    
    This doesn't even remotely describe the actual Versatile
    Express hardware. Exploit the SiI9022 bridge by connecting
    the PL111 pads to it, making it use EDID or fallback values
    to drive the monitor.
    
    The  also has to use the reserved memory through the
    CMA pool rather than by open coding a memory region and
    remapping it explicitly in the driver. To achieve this,
    a reserved-memory node must exist in the root of the
    device tree, so we need to pull that out of the
    motherboard .dtsi include files, and push it into each
    top-level device tree instead.
    
    We do the same manouver for all the Versatile Express
    boards, taking into account the different location of the
    video RAM depending on which chip select is used on
    each platform.
    
    This plays nicely with the new PL111 DRM driver and
    follows the standard ways of assigning bridges and
    memory pools for graphics.
    
    Cc: Sudeep Holla <sudeep.holla@arm.com>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Cc: Liviu Dudau <liviu.dudau@arm.com>
    Cc: Mali DP Maintainers <malidp@foss.arm.com>
    Cc: Robin Murphy <robin.murphy@arm.com>
    Tested-by: Liviu Dudau <liviu.dudau@arm.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/arch/arm64/boot/dts/arm/rtsm_ve-aemv8a.dts b/arch/arm64/boot/dts/arm/rtsm_ve-aemv8a.dts
index 602f63f72c37..fe4fda473c0a 100644
--- a/arch/arm64/boot/dts/arm/rtsm_ve-aemv8a.dts
+++ b/arch/arm64/boot/dts/arm/rtsm_ve-aemv8a.dts
@@ -78,6 +78,20 @@ memory@80000000 {
 		      <0x00000008 0x80000000 0 0x80000000>;
 	};
 
+	reserved-memory {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		ranges;
+
+		/* Chipselect 2,00000000 is physically at 0x18000000 */
+		vram: vram@18000000 {
+			/* 8 MB of designated video RAM */
+			compatible = "shared-dma-pool";
+			reg = <0x00000000 0x18000000 0 0x00800000>;
+			no-map;
+		};
+	};
+
 	gic: interrupt-controller@2c001000 {
 		compatible = "arm,cortex-a15-gic", "arm,cortex-a9-gic";
 		#interrupt-cells = <3>;
@@ -107,6 +121,15 @@ pmu {
 			     <0 63 4>;
 	};
 
+	panel {
+		compatible = "arm,rtsm-display";
+		port {
+			panel_in: endpoint {
+				remote-endpoint = <&clcd_pads>;
+			};
+		};
+	};
+
 	smb@8000000 {
 		compatible = "simple-bus";