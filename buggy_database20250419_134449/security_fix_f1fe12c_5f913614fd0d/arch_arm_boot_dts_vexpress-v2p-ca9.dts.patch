commit f1fe12c8bf33241e04c57a0fc5b25b16ba77ba2d
Author: Linus Walleij <linus.walleij@linaro.org>
Date:   Thu Feb 15 16:12:29 2018 +0100

    ARM: dts: Modernize the Vexpress PL111 integration
    
    The Versatile Express was submitted with the actual display
    bridges unconnected (but defined in the device tree) and
    mock "panels" encoded in the device tree node of the PL111
    controller.
    
    This doesn't even remotely describe the actual Versatile
    Express hardware. Exploit the SiI9022 bridge by connecting
    the PL111 pads to it, making it use EDID or fallback values
    to drive the monitor.
    
    The  also has to use the reserved memory through the
    CMA pool rather than by open coding a memory region and
    remapping it explicitly in the driver. To achieve this,
    a reserved-memory node must exist in the root of the
    device tree, so we need to pull that out of the
    motherboard .dtsi include files, and push it into each
    top-level device tree instead.
    
    We do the same manouver for all the Versatile Express
    boards, taking into account the different location of the
    video RAM depending on which chip select is used on
    each platform.
    
    This plays nicely with the new PL111 DRM driver and
    follows the standard ways of assigning bridges and
    memory pools for graphics.
    
    Cc: Sudeep Holla <sudeep.holla@arm.com>
    Cc: Lorenzo Pieralisi <lorenzo.pieralisi@arm.com>
    Cc: Liviu Dudau <liviu.dudau@arm.com>
    Cc: Mali DP Maintainers <malidp@foss.arm.com>
    Cc: Robin Murphy <robin.murphy@arm.com>
    Tested-by: Liviu Dudau <liviu.dudau@arm.com>
    Signed-off-by: Linus Walleij <linus.walleij@linaro.org>

diff --git a/arch/arm/boot/dts/vexpress-v2p-ca9.dts b/arch/arm/boot/dts/vexpress-v2p-ca9.dts
index fc43873cbdff..d796efaadbe3 100644
--- a/arch/arm/boot/dts/vexpress-v2p-ca9.dts
+++ b/arch/arm/boot/dts/vexpress-v2p-ca9.dts
@@ -69,6 +69,20 @@ memory@60000000 {
 		reg = <0x60000000 0x40000000>;
 	};
 
+	reserved-memory {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		ranges;
+
+		/* Chipselect 3 is physically at 0x4c000000 */
+		vram: vram@4c000000 {
+			/* 8 MB of designated video RAM */
+			compatible = "shared-dma-pool";
+			reg = <0x4c000000 0x00800000>;
+			no-map;
+		};
+	};
+
 	clcd@10020000 {
 		compatible = "arm,pl111", "arm,primecell";
 		reg = <0x10020000 0x1000>;
@@ -76,36 +90,15 @@ clcd@10020000 {
 		interrupts = <0 44 4>;
 		clocks = <&oscclk1>, <&oscclk2>;
 		clock-names = "clcdclk", "apb_pclk";
-		max-memory-bandwidth = <130000000>; /* 16bpp @ 63.5MHz */
+		/* 1024x768 16bpp @65MHz */
+		max-memory-bandwidth = <95000000>;
 
 		port {
-			clcd_pads: endpoint {
-				remote-endpoint = <&clcd_panel>;
+			clcd_pads_ct: endpoint {
+				remote-endpoint = <&dvi_bridge_in_ct>;
 				arm,pl11x,tft-r0g0b0-pads = <0 8 16>;
 			};
 		};
-
-		panel {
-			compatible = "panel-dpi";
-
-			port {
-				clcd_panel: endpoint {
-					remote-endpoint = <&clcd_pads>;
-				};
-			};
-
-			panel-timing {
-				clock-frequency = <63500127>;
-				hactive = <1024>;
-				hback-porch = <152>;
-				hfront-porch = <48>;
-				hsync-len = <104>;
-				vactive = <768>;
-				vback-porch = <23>;
-				vfront-porch = <3>;
-				vsync-len = <4>;
-			};
-		};
 	};
 
 	memory-controller@100e0000 {