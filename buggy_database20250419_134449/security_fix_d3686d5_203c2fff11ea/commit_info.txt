Commit Hash: d3686d54c7902a303bd65d751226aa1647319863
Subject: cifs: Cleanup and thus reduce smb session structure and fields used during authentication


Security Keywords:
- authentication

Full commit message:
cifs: Cleanup and thus reduce smb session structure and fields used during authentication

Removed following fields from smb session structure
 cryptkey, ntlmv2_hash, tilen, tiblob
and ntlmssp_auth structure is allocated dynamically only if the auth mech
in NTLMSSP.

response field within a session_key structure is used to initially store the
target info (either plucked from type 2 challenge packet in case of NTLMSSP
or fabricated in case of NTLMv2 without extended security) and then to store
Message Authentication Key (mak) (session key + client response).

Server challenge or cryptkey needed during a NTLMSSP authentication
is now part of ntlmssp_auth structure which gets allocated and freed
once authenticaiton process is done.

Signed-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Signed-off-by: Steve French <sfrench@us.ibm.com>

Metadata:
Author: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Author Date: Thu Oct 28 09:53:07 2010 -0500
Committer: Steve French <sfrench@us.ibm.com>
Commit Date: Fri Oct 29 01:47:33 2010 +0000

Files Changed: 4
Lines Added: 55
Lines Removed: 47
Total Changes: 102
