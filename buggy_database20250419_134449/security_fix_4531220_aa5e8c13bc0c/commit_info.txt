Commit Hash: 4531220b71f0399e71cda0c4cf749e7281a7416a
Subject: KVM: x86: Rework user space NMI injection as KVM_CAP_USER_NMI


Security Keywords:
- injection

Full commit message:
KVM: x86: Rework user space NMI injection as KVM_CAP_USER_NMI

There is no point in doing the ready_for_nmi_injection/
request_nmi_window dance with user space. First, we don't do this for
in-kernel irqchip anyway, while the code path is the same as for user
space irqchip mode. And second, there is nothing to loose if a pending
NMI is overwritten by another one (in contrast to IRQs where we have to
save the number). Actually, there is even the risk of raising spurious
NMIs this way because the reason for the held-back NMI might already be
handled while processing the first one.

Therefore this patch creates a simplified user space NMI injection
interface, exporting it under KVM_CAP_USER_NMI and dropping the old
KVM_CAP_NMI capability. And this time we also take care to provide the
interface only on archs supporting NMIs via KVM (right now only x86).

Signed-off-by: Jan Kiszka <jan.kiszka@siemens.com>
Signed-off-by: Avi Kivity <avi@redhat.com>

Metadata:
Author: Jan Kiszka <jan.kiszka@siemens.com>
Author Date: Thu Dec 11 16:54:54 2008 +0100
Committer: Avi Kivity <avi@redhat.com>
Commit Date: Wed Dec 31 16:55:47 2008 +0200

Files Changed: 3
Lines Added: 9
Lines Removed: 54
Total Changes: 63
