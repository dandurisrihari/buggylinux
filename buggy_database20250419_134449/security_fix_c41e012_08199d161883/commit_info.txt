Commit Hash: c41e0121a1221894a1a9c4666156db9e1def4d6c
Subject: platform/x86: think-lmi: mutex protection around multiple WMI calls


Security Keywords:
- authentication

Full commit message:
platform/x86: think-lmi: mutex protection around multiple WMI calls

When an attribute is being changed if the Admin account is enabled, or if
a password is being updated then multiple WMI calls are needed.
Add mutex protection to ensure no race conditions are introduced.

Fixes: b49f72e7f96d ("platform/x86: think-lmi: Certificate authentication support")
Signed-off-by: Mark Pearson <mpearson-lenovo@squebb.ca>
Reviewed-by: Ilpo JÃ¤rvinen <ilpo.jarvinen@linux.intel.com>
Reviewed-by: Hans de Goede <hdegoede@redhat.com>
Link: https://lore.kernel.org/r/20230601200552.4396-1-mpearson-lenovo@squebb.ca
Signed-off-by: Hans de Goede <hdegoede@redhat.com>

Metadata:
Author: Mark Pearson <mpearson-lenovo@squebb.ca>
Author Date: Thu Jun 1 16:05:45 2023 -0400
Committer: Hans de Goede <hdegoede@redhat.com>
Commit Date: Thu Jun 8 11:00:17 2023 +0200

Files Changed: 1
Lines Added: 10
Lines Removed: 0
Total Changes: 10
