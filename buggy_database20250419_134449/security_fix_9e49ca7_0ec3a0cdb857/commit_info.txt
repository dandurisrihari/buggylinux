Commit Hash: 9e49ca756d207f4313fb7af48648a67da8e4e250
Subject: tracing/string: Create and use __free(argv_free) in trace_dynevent.c


Security Keywords:
- hardening

Full commit message:
tracing/string: Create and use __free(argv_free) in trace_dynevent.c

The function dyn_event_release() uses argv_split() which must be freed via
argv_free(). It contains several error paths that do a goto out to call
argv_free() for cleanup. This makes the code complex and error prone.

Create a new __free() directive __free(argv_free) that will call
argv_free() for data allocated with argv_split(), and use it in the
dyn_event_release() function.

Cc: Kees Cook <kees@kernel.org>
Cc: Masami Hiramatsu <mhiramat@kernel.org>
Cc: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Cc: Peter Zijlstra <peterz@infradead.org>
Cc: Andy Shevchenko <andy@kernel.org>
Cc: linux-hardening@vger.kernel.org
Link: https://lore.kernel.org/20241220103313.4a74ec8e@gandalf.local.home
Signed-off-by: Steven Rostedt (Google) <rostedt@goodmis.org>

Metadata:
Author: Steven Rostedt <rostedt@goodmis.org>
Author Date: Fri Dec 20 10:33:13 2024 -0500
Committer: Steven Rostedt (Google) <rostedt@goodmis.org>
Commit Date: Thu Dec 26 10:38:37 2024 -0500

Files Changed: 2
Lines Added: 10
Lines Removed: 16
Total Changes: 26
