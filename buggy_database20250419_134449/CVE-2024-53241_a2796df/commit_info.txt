Commit Hash: a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906
Subject: x86/xen: don't do PV iret hypercall through hypercall page

CVE Identifiers:
- CVE-2024-53241

Full commit message:
x86/xen: don't do PV iret hypercall through hypercall page

Instead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.

This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.

This is part of XSA-466 / CVE-2024-53241.

Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>

Metadata:
Author: Juergen Gross <jgross@suse.com>
Author Date: Wed Oct 16 10:40:26 2024 +0200
Committer: Juergen Gross <jgross@suse.com>
Commit Date: Fri Dec 13 09:28:43 2024 +0100

Files Changed: 1
Lines Added: 18
Lines Removed: 9
Total Changes: 27
