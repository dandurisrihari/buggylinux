commit 0d5b5a0f32dfc9be3521803aba53e856759f0250
Author: Chuck Lever <chuck.lever@oracle.com>
Date:   Sun Jan 15 12:22:56 2023 -0500

    SUNRPC: Add RFC 8009 encryption and decryption functions
    
    RFC 8009 enctypes use different crypt formulae than previous
    Kerberos 5 encryption types. Section 1 of RFC 8009 explains the
    reason for this change:
    
    > The new types conform to the framework specified in [RFC3961],
    > but do not use the simplified profile, as the simplified profile
    > is not compliant with modern cryptographic best practices such as
    > calculating Message Authentication Codes (MACs) over ciphertext
    > rather than plaintext.
    
    Add new .encrypt and .decrypt functions to handle this variation.
    
    The new approach described above is referred to as Encrypt-then-MAC
    (or EtM). Hence the names of the new functions added here are
    prefixed with "krb5_etm_".
    
    A critical second difference with previous crypt formulae is that
    the cipher state is included in the computed HMAC. Note however that
    for RPCSEC, the initial cipher state is easy to compute on both
    initiator and acceptor because it is always all zeroes.
    
    Tested-by: Scott Mayhew <smayhew@redhat.com>
    Reviewed-by: Simo Sorce <simo@redhat.com>
    Signed-off-by: Chuck Lever <chuck.lever@oracle.com>

diff --git a/net/sunrpc/auth_gss/gss_krb5_internal.h b/net/sunrpc/auth_gss/gss_krb5_internal.h
index 33abf9ee9508..fd2ae11c5067 100644
--- a/net/sunrpc/auth_gss/gss_krb5_internal.h
+++ b/net/sunrpc/auth_gss/gss_krb5_internal.h
@@ -108,4 +108,10 @@ u32 gss_krb5_aes_encrypt(struct krb5_ctx *kctx, u32 offset,
 u32 gss_krb5_aes_decrypt(struct krb5_ctx *kctx, u32 offset, u32 len,
 			 struct xdr_buf *buf, u32 *plainoffset, u32 *plainlen);
 
+u32 krb5_etm_encrypt(struct krb5_ctx *kctx, u32 offset, struct xdr_buf *buf,
+		     struct page **pages);
+
+u32 krb5_etm_decrypt(struct krb5_ctx *kctx, u32 offset, u32 len,
+		     struct xdr_buf *buf, u32 *headskip, u32 *tailskip);
+
 #endif /* _NET_SUNRPC_AUTH_GSS_KRB5_INTERNAL_H */