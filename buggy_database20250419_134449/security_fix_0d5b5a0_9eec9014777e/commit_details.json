{
  "hash": "0d5b5a0f32dfc9be3521803aba53e856759f0250",
  "hash_short": "0d5b5a0f",
  "subject": "SUNRPC: Add RFC 8009 encryption and decryption functions",
  "body": "RFC 8009 enctypes use different crypt formulae than previous\nKerberos 5 encryption types. Section 1 of RFC 8009 explains the\nreason for this change:\n\n> The new types conform to the framework specified in [RFC3961],\n> but do not use the simplified profile, as the simplified profile\n> is not compliant with modern cryptographic best practices such as\n> calculating Message Authentication Codes (MACs) over ciphertext\n> rather than plaintext.\n\nAdd new .encrypt and .decrypt functions to handle this variation.\n\nThe new approach described above is referred to as Encrypt-then-MAC\n(or EtM). Hence the names of the new functions added here are\nprefixed with \"krb5_etm_\".\n\nA critical second difference with previous crypt formulae is that\nthe cipher state is included in the computed HMAC. Note however that\nfor RPCSEC, the initial cipher state is easy to compute on both\ninitiator and acceptor because it is always all zeroes.\n\nTested-by: Scott Mayhew <smayhew@redhat.com>\nReviewed-by: Simo Sorce <simo@redhat.com>\nSigned-off-by: Chuck Lever <chuck.lever@oracle.com>",
  "full_message": "SUNRPC: Add RFC 8009 encryption and decryption functions\n\nRFC 8009 enctypes use different crypt formulae than previous\nKerberos 5 encryption types. Section 1 of RFC 8009 explains the\nreason for this change:\n\n> The new types conform to the framework specified in [RFC3961],\n> but do not use the simplified profile, as the simplified profile\n> is not compliant with modern cryptographic best practices such as\n> calculating Message Authentication Codes (MACs) over ciphertext\n> rather than plaintext.\n\nAdd new .encrypt and .decrypt functions to handle this variation.\n\nThe new approach described above is referred to as Encrypt-then-MAC\n(or EtM). Hence the names of the new functions added here are\nprefixed with \"krb5_etm_\".\n\nA critical second difference with previous crypt formulae is that\nthe cipher state is included in the computed HMAC. Note however that\nfor RPCSEC, the initial cipher state is easy to compute on both\ninitiator and acceptor because it is always all zeroes.\n\nTested-by: Scott Mayhew <smayhew@redhat.com>\nReviewed-by: Simo Sorce <simo@redhat.com>\nSigned-off-by: Chuck Lever <chuck.lever@oracle.com>",
  "author_name": "Chuck Lever",
  "author_email": "chuck.lever@oracle.com",
  "author_date": "Sun Jan 15 12:22:56 2023 -0500",
  "author_date_iso": "2023-01-15T12:22:56-05:00",
  "committer_name": "Chuck Lever",
  "committer_email": "chuck.lever@oracle.com",
  "committer_date": "Mon Feb 20 09:20:43 2023 -0500",
  "committer_date_iso": "2023-02-20T09:20:43-05:00",
  "files_changed": [
    "net/sunrpc/auth_gss/gss_krb5_crypto.c",
    "net/sunrpc/auth_gss/gss_krb5_internal.h",
    "net/sunrpc/auth_gss/gss_krb5_mech.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_crypto.c",
      "insertions": 227,
      "deletions": 0
    },
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_internal.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_mech.c",
      "insertions": 4,
      "deletions": 0
    }
  ],
  "total_insertions": 237,
  "total_deletions": 0,
  "total_changes": 237,
  "parents": [
    "ae2e4d2bae0007b040e8327f123911c0a6b24d68"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_crypto.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_internal.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/sunrpc/auth_gss/gss_krb5_mech.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}