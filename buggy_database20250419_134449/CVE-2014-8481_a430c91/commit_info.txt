Commit Hash: a430c9166312e1aa3d80bce32374233bdbfeba32
Subject: KVM: emulate: avoid accessing NULL ctxt->memopp

CVE Identifiers:
- CVE-2014-8481

Full commit message:
KVM: emulate: avoid accessing NULL ctxt->memopp

A failure to decode the instruction can cause a NULL pointer access.
This is fixed simply by moving the "done" label as close as possible
to the return.

This fixes CVE-2014-8481.

Reported-by: Andy Lutomirski <luto@amacapital.net>
Cc: stable@vger.kernel.org
Fixes: 41061cdb98a0bec464278b4db8e894a3121671f5
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Paolo Bonzini <pbonzini@redhat.com>
Author Date: Thu Oct 23 14:54:14 2014 +0200
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Fri Oct 24 13:30:35 2014 +0200

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
