{
  "hash": "36a15e1cb134c0395261ba1940762703f778438c",
  "hash_short": "36a15e1c",
  "subject": "net: usb: ax88179_178a needs FLAG_SEND_ZLP",
  "body": "The extra byte inserted by usbnet.c when\n (length % dev->maxpacket == 0) is causing problems to device.\n\nThis patch sets FLAG_SEND_ZLP to avoid this.\n\nTested with: 0b95:1790 ASIX Electronics Corp. AX88179 Gigabit Ethernet\n\nProblems observed:\n======================================================================\n1) Using ssh/sshfs. The remote sshd daemon can abort with the message:\n   \"message authentication code incorrect\"\n   This happens because the tcp message sent is corrupted during the\n   USB \"Bulk out\". The device calculate the tcp checksum and send a\n   valid tcp message to the remote sshd. Then the encryption detects\n   the error and aborts.\n2) NETDEV WATCHDOG: ... (ax88179_178a): transmit queue 0 timed out\n3) Stop normal work without any log message.\n   The \"Bulk in\" continue receiving packets normally.\n   The host sends \"Bulk out\" and the device responds with -ECONNRESET.\n   (The netusb.c code tx_complete ignore -ECONNRESET)\nUnder normal conditions these errors take days to happen and in\nintense usage take hours.\n\nA test with ping gives packet loss, showing that something is wrong:\nping -4 -s 462 {destination}\t# 462 = 512 - 42 - 8\nNot all packets fail.\nMy guess is that the device tries to find another packet starting\nat the extra byte and will fail or not depending on the next\nbytes (old buffer content).\n======================================================================\n\nSigned-off-by: Jose Alonso <joalonsof@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "net: usb: ax88179_178a needs FLAG_SEND_ZLP\n\nThe extra byte inserted by usbnet.c when\n (length % dev->maxpacket == 0) is causing problems to device.\n\nThis patch sets FLAG_SEND_ZLP to avoid this.\n\nTested with: 0b95:1790 ASIX Electronics Corp. AX88179 Gigabit Ethernet\n\nProblems observed:\n======================================================================\n1) Using ssh/sshfs. The remote sshd daemon can abort with the message:\n   \"message authentication code incorrect\"\n   This happens because the tcp message sent is corrupted during the\n   USB \"Bulk out\". The device calculate the tcp checksum and send a\n   valid tcp message to the remote sshd. Then the encryption detects\n   the error and aborts.\n2) NETDEV WATCHDOG: ... (ax88179_178a): transmit queue 0 timed out\n3) Stop normal work without any log message.\n   The \"Bulk in\" continue receiving packets normally.\n   The host sends \"Bulk out\" and the device responds with -ECONNRESET.\n   (The netusb.c code tx_complete ignore -ECONNRESET)\nUnder normal conditions these errors take days to happen and in\nintense usage take hours.\n\nA test with ping gives packet loss, showing that something is wrong:\nping -4 -s 462 {destination}\t# 462 = 512 - 42 - 8\nNot all packets fail.\nMy guess is that the device tries to find another packet starting\nat the extra byte and will fail or not depending on the next\nbytes (old buffer content).\n======================================================================\n\nSigned-off-by: Jose Alonso <joalonsof@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Jose Alonso",
  "author_email": "joalonsof@gmail.com",
  "author_date": "Mon Jun 13 15:32:44 2022 -0300",
  "author_date_iso": "2022-06-13T15:32:44-03:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Wed Jun 15 09:32:12 2022 +0100",
  "committer_date_iso": "2022-06-15T09:32:12+01:00",
  "files_changed": [
    "drivers/net/usb/ax88179_178a.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/usb/ax88179_178a.c",
      "insertions": 13,
      "deletions": 13
    }
  ],
  "total_insertions": 13,
  "total_deletions": 13,
  "total_changes": 26,
  "parents": [
    "371de1aa000dd5265a32ed934792a306ec873d6e"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/usb/ax88179_178a.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}