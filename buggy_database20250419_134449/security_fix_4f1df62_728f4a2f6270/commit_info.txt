Commit Hash: 4f1df628d4ec22b04f67e068e6d02538d3dd557b
Subject: KVM: arm64: Advertise ID_AA64PFR0_EL1.CSV3=1 if the CPUs are Meltdown-safe


Security Keywords:
- vulnerability

Full commit message:
KVM: arm64: Advertise ID_AA64PFR0_EL1.CSV3=1 if the CPUs are Meltdown-safe

Cores that predate the introduction of ID_AA64PFR0_EL1.CSV3 to
the ARMv8 architecture have this field set to 0, even of some of
them are not affected by the vulnerability.

The kernel maintains a list of unaffected cores (A53, A55 and a few
others) so that it doesn't impose an expensive mitigation uncessarily.

As we do for CSV2, let's expose the CSV3 property to guests that run
on HW that is effectively not vulnerable. This can be reset to zero
by writing to the ID register from userspace, ensuring that VMs can
be migrated despite the new property being set.

Reported-by: Will Deacon <will@kernel.org>
Signed-off-by: Marc Zyngier <maz@kernel.org>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Thu Nov 26 17:27:13 2020 +0000
Committer: Marc Zyngier <maz@kernel.org>
Commit Date: Mon Nov 30 16:02:53 2020 +0000

Files Changed: 3
Lines Added: 18
Lines Removed: 5
Total Changes: 23
