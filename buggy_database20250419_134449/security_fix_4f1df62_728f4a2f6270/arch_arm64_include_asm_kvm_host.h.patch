commit 4f1df628d4ec22b04f67e068e6d02538d3dd557b
Author: Marc Zyngier <maz@kernel.org>
Date:   Thu Nov 26 17:27:13 2020 +0000

    KVM: arm64: Advertise ID_AA64PFR0_EL1.CSV3=1 if the CPUs are Meltdown-safe
    
    Cores that predate the introduction of ID_AA64PFR0_EL1.CSV3 to
    the ARMv8 architecture have this field set to 0, even of some of
    them are not affected by the vulnerability.
    
    The kernel maintains a list of unaffected cores (A53, A55 and a few
    others) so that it doesn't impose an expensive mitigation uncessarily.
    
    As we do for CSV2, let's expose the CSV3 property to guests that run
    on HW that is effectively not vulnerable. This can be reset to zero
    by writing to the ID register from userspace, ensuring that VMs can
    be migrated despite the new property being set.
    
    Reported-by: Will Deacon <will@kernel.org>
    Signed-off-by: Marc Zyngier <maz@kernel.org>

diff --git a/arch/arm64/include/asm/kvm_host.h b/arch/arm64/include/asm/kvm_host.h
index 0cd9f0f75c13..147347028a20 100644
--- a/arch/arm64/include/asm/kvm_host.h
+++ b/arch/arm64/include/asm/kvm_host.h
@@ -120,6 +120,7 @@ struct kvm_arch {
 	unsigned int pmuver;
 
 	u8 pfr0_csv2;
+	u8 pfr0_csv3;
 };
 
 struct kvm_vcpu_fault_info {