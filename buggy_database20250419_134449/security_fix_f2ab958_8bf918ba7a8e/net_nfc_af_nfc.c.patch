commit f2ab95814103314af3239d322e382c61c69a788d
Author: David S. Miller <davem@davemloft.net>
Date:   Sun Dec 23 16:01:35 2018 -0800

    net: Revert recent Spectre-v1 patches.
    
    This reverts:
    
    50d5258634ae ("net: core: Fix Spectre v1 vulnerability")
    d686026b1e6e ("phonet: af_phonet: Fix Spectre v1 vulnerability")
    a95386f0390a ("nfc: af_nfc: Fix Spectre v1 vulnerability")
    a3ac5817ffe8 ("can: af_can: Fix Spectre v1 vulnerability")
    
    After some discussion with Alexei Starovoitov these all seem to
    be completely unnecessary.
    
    Signed-off-by: David S. Miller <davem@davemloft.net>

diff --git a/net/nfc/af_nfc.c b/net/nfc/af_nfc.c
index 256f3c57059e..d3e594eb36d0 100644
--- a/net/nfc/af_nfc.c
+++ b/net/nfc/af_nfc.c
@@ -21,7 +21,6 @@
 
 #include <linux/nfc.h>
 #include <linux/module.h>
-#include <linux/nospec.h>
 
 #include "nfc.h"
 
@@ -38,7 +37,6 @@ static int nfc_sock_create(struct net *net, struct socket *sock, int proto,
 
 	if (proto < 0 || proto >= NFC_SOCKPROTO_MAX)
 		return -EINVAL;
-	proto = array_index_nospec(proto, NFC_SOCKPROTO_MAX);
 
 	read_lock(&proto_tab_lock);
 	if (proto_tab[proto] &&	try_module_get(proto_tab[proto]->owner)) {