{
  "hash": "94d9864cc86f572f881db9b842a78e9d075493ae",
  "hash_short": "94d9864c",
  "subject": "mac80211: treat some SAE auth steps as final",
  "body": "When we get anti-clogging token required (added by the commit\nmentioned below), or the other status codes added by the later\ncommit 4e56cde15f7d (\"mac80211: Handle special status codes in\nSAE commit\") we currently just pretend (towards the internal\nstate machine of authentication) that we didn't receive anything.\n\nThis has the undesirable consequence of retransmitting the prior\nframe, which is not expected, because the timer is still armed.\n\nIf we just disarm the timer at that point, it would result in\nthe undesirable side effect of being in this state indefinitely\nif userspace crashes, or so.\n\nSo to fix this, reset the timer and set a new auth_data->waiting\nin order to have no more retransmissions, but to have the data\ndestroyed when the timer actually fires, which will only happen\nif userspace didn't continue (i.e. crashed or abandoned it.)\n\nFixes: a4055e74a2ff (\"mac80211: Don't destroy auth data in case of anti-clogging\")\nReported-by: Jouni Malinen <j@w1.fi>\nLink: https://lore.kernel.org/r/20220224103932.75964e1d7932.Ia487f91556f29daae734bf61f8181404642e1eec@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: treat some SAE auth steps as final\n\nWhen we get anti-clogging token required (added by the commit\nmentioned below), or the other status codes added by the later\ncommit 4e56cde15f7d (\"mac80211: Handle special status codes in\nSAE commit\") we currently just pretend (towards the internal\nstate machine of authentication) that we didn't receive anything.\n\nThis has the undesirable consequence of retransmitting the prior\nframe, which is not expected, because the timer is still armed.\n\nIf we just disarm the timer at that point, it would result in\nthe undesirable side effect of being in this state indefinitely\nif userspace crashes, or so.\n\nSo to fix this, reset the timer and set a new auth_data->waiting\nin order to have no more retransmissions, but to have the data\ndestroyed when the timer actually fires, which will only happen\nif userspace didn't continue (i.e. crashed or abandoned it.)\n\nFixes: a4055e74a2ff (\"mac80211: Don't destroy auth data in case of anti-clogging\")\nReported-by: Jouni Malinen <j@w1.fi>\nLink: https://lore.kernel.org/r/20220224103932.75964e1d7932.Ia487f91556f29daae734bf61f8181404642e1eec@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Thu Feb 24 10:39:34 2022 +0100",
  "author_date_iso": "2022-02-24T10:39:34+01:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue Mar 1 11:33:13 2022 +0100",
  "committer_date_iso": "2022-03-01T11:33:13+01:00",
  "files_changed": [
    "net/mac80211/ieee80211_i.h",
    "net/mac80211/mlme.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/mac80211/mlme.c",
      "insertions": 12,
      "deletions": 4
    }
  ],
  "total_insertions": 13,
  "total_deletions": 5,
  "total_changes": 18,
  "parents": [
    "6ad27f522cb3b210476daf63ce6ddb6568c0508b"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "auth"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/mlme.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}