Commit Hash: 99c2dcc8ffc24e210a3aa05c204d92f3ef460b05
Subject: nvme-core: fix memory leak in dhchap_ctrl_secret


Security Keywords:
- authentication

Full commit message:
nvme-core: fix memory leak in dhchap_ctrl_secret

Free dhchap_secret in nvme_ctrl_dhchap_ctrl_secret_store() before we
return when nvme_auth_generate_key() returns error.

Fixes: f50fff73d620 ("nvme: implement In-Band authentication")
Signed-off-by: Chaitanya Kulkarni <kch@nvidia.com>
Reviewed-by: Christoph Hellwig <hch@lst.de>
Reviewed-by: Sagi Grimberg <sagi@grimberg.me>
Signed-off-by: Keith Busch <kbusch@kernel.org>

Metadata:
Author: Chaitanya Kulkarni <kch@nvidia.com>
Author Date: Fri Apr 28 00:31:13 2023 -0700
Committer: Keith Busch <kbusch@kernel.org>
Commit Date: Mon Jun 12 10:33:02 2023 -0700

Files Changed: 1
Lines Added: 5
Lines Removed: 2
Total Changes: 7
