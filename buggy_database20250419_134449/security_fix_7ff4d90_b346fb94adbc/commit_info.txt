Commit Hash: 7ff4d90b4c24a03666f296c3d4878cd39001e81e
Subject: groups: Consolidate the setgroups permission checks


Security Keywords:
- security fix

Full commit message:
groups: Consolidate the setgroups permission checks

Today there are 3 instances of setgroups and due to an oversight their
permission checking has diverged.  Add a common function so that
they may all share the same permission checking code.

This corrects the current oversight in the current permission checks
and adds a helper to avoid this in the future.

A user namespace security fix will update this new helper, shortly.

Cc: stable@vger.kernel.org
Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>

Metadata:
Author: Eric W. Biederman <ebiederm@xmission.com>
Author Date: Fri Dec 5 17:19:27 2014 -0600
Committer: Eric W. Biederman <ebiederm@xmission.com>
Commit Date: Fri Dec 5 17:19:27 2014 -0600

Files Changed: 4
Lines Added: 11
Lines Removed: 3
Total Changes: 14
