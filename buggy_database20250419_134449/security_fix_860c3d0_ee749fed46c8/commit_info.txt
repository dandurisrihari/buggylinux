Commit Hash: 860c3d03bbc3f17aef8600662c488f27fd093142
Subject: scsi: scsi_debug: Fix some bugs in sdebug_error_write()


Security Keywords:
- injection

Full commit message:
scsi: scsi_debug: Fix some bugs in sdebug_error_write()

There are two bug in this code:

 1) If count is zero, then it will lead to a NULL dereference.  The
    kmalloc() will successfully allocate zero bytes and the test for "if
    (buf[0] == '-')" will read beyond the end of the zero size buffer and
    Oops.

 2) The code does not ensure that the user's string is properly NUL
    terminated which could lead to a read overflow.

Fixes: a9996d722b11 ("scsi: scsi_debug: Add interface to manage error injection for a single device")
Signed-off-by: Dan Carpenter <dan.carpenter@linaro.org>
Link: https://lore.kernel.org/r/7733643d-e102-4581-8d29-769472011c97@moroto.mountain
Reviewed-by: Wenchao Hao <haowenchao2@huawei.com>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

Metadata:
Author: Dan Carpenter <dan.carpenter@linaro.org>
Author Date: Mon Nov 6 17:04:33 2023 +0300
Committer: Martin K. Petersen <martin.petersen@oracle.com>
Commit Date: Wed Nov 8 21:42:26 2023 -0500

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
