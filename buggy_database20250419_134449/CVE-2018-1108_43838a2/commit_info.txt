Commit Hash: 43838a23a05fbd13e47d750d3dfd77001536dd33
Subject: random: fix crng_ready() test

CVE Identifiers:
- CVE-2018-1108

Full commit message:
random: fix crng_ready() test

The crng_init variable has three states:

0: The CRNG is not initialized at all
1: The CRNG has a small amount of entropy, hopefully good enough for
   early-boot, non-cryptographical use cases
2: The CRNG is fully initialized and we are sure it is safe for
   cryptographic use cases.

The crng_ready() function should only return true once we are in the
last state.  This addresses CVE-2018-1108.

Reported-by: Jann Horn <jannh@google.com>
Fixes: e192be9d9a30 ("random: replace non-blocking pool...")
Cc: stable@kernel.org # 4.8+
Signed-off-by: Theodore Ts'o <tytso@mit.edu>
Reviewed-by: Jann Horn <jannh@google.com>

Metadata:
Author: Theodore Ts'o <tytso@mit.edu>
Author Date: Wed Apr 11 13:27:52 2018 -0400
Committer: Theodore Ts'o <tytso@mit.edu>
Commit Date: Sat Apr 14 11:58:26 2018 -0400

Files Changed: 1
Lines Added: 5
Lines Removed: 5
Total Changes: 10
