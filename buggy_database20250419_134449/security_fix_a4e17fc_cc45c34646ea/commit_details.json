{
  "hash": "a4e17fc1cf64a6f93e1685dc4a32075dfb426082",
  "hash_short": "a4e17fc1",
  "subject": "hpsa: notice all request_irq errors",
  "body": "In MSI and MSI-X mode, where hpsa asks for more than one interrupt,\nhpsa_request_irqs forgets if the first request_irq call failed\nif later ones succeed.\n\nIt needs to exit the loop on any failure rather than continue,\nfreeing all irqs that were requested until that point.\n\nAlso, it needs to clear out the q numbers up to MAX_REPLY_QUEUES.\nThe same is true for the general hpsa_free_irqs function.\n\nTested with error injection of -ENOSYS on the 4th call:\n[    9.277691]  injecting error in inj_request_irq: 1 4\n[    9.277780] hpsa 0000:02:00.0: failed to get irq 35 for hpsa1\n[   10.711623] scsi host1: Error handler scsi_eh_1 exiting\n[   10.739170] hpsa: probe of 0000:02:00.0 failed with error -38\n\nReviewed-by: Scott Teel <scott.teel@pmcs.com>\nSigned-off-by: Robert Elliott <elliott@hp.com>\nSigned-off-by: Don Brace <don.brace@pmcs.com>\nSigned-off-by: Christoph Hellwig <hch@lst.de>",
  "full_message": "hpsa: notice all request_irq errors\n\nIn MSI and MSI-X mode, where hpsa asks for more than one interrupt,\nhpsa_request_irqs forgets if the first request_irq call failed\nif later ones succeed.\n\nIt needs to exit the loop on any failure rather than continue,\nfreeing all irqs that were requested until that point.\n\nAlso, it needs to clear out the q numbers up to MAX_REPLY_QUEUES.\nThe same is true for the general hpsa_free_irqs function.\n\nTested with error injection of -ENOSYS on the 4th call:\n[    9.277691]  injecting error in inj_request_irq: 1 4\n[    9.277780] hpsa 0000:02:00.0: failed to get irq 35 for hpsa1\n[   10.711623] scsi host1: Error handler scsi_eh_1 exiting\n[   10.739170] hpsa: probe of 0000:02:00.0 failed with error -38\n\nReviewed-by: Scott Teel <scott.teel@pmcs.com>\nSigned-off-by: Robert Elliott <elliott@hp.com>\nSigned-off-by: Don Brace <don.brace@pmcs.com>\nSigned-off-by: Christoph Hellwig <hch@lst.de>",
  "author_name": "Robert Elliott",
  "author_email": "elliott@hp.com",
  "author_date": "Fri Jan 23 16:41:51 2015 -0600",
  "author_date_iso": "2015-01-23T16:41:51-06:00",
  "committer_name": "James Bottomley",
  "committer_email": "JBottomley@Parallels.com",
  "committer_date": "Mon Feb 2 09:57:36 2015 -0800",
  "committer_date_iso": "2015-02-02T09:57:36-08:00",
  "files_changed": [
    "drivers/scsi/hpsa.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/scsi/hpsa.c",
      "insertions": 18,
      "deletions": 1
    }
  ],
  "total_insertions": 18,
  "total_deletions": 1,
  "total_changes": 19,
  "parents": [
    "ec42995263ec91acbef921df8c9bb692365687b6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.0",
    "v4.0-rc1",
    "v4.0-rc2",
    "v4.0-rc3",
    "v4.0-rc4",
    "v4.0-rc5",
    "v4.0-rc6",
    "v4.0-rc7",
    "v4.1",
    "v4.1-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/scsi/hpsa.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}