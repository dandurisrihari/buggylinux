commit 052c40c83b4ca37be226112049b60097cb9961e1
Author: Andrew Vasquez <andrew.vasquez@qlogic.com>
Date:   Fri Jan 20 14:53:19 2006 -0800

    [SCSI] qla2xxx: Correct issue where the rport's upcall was not being made after relogin.
    
    A target can LOGO an initiator at any time (i.e. during I/O,
    due to a controller hicup, or as a simple authentication
    mechanism after an initial CDB command), when this occurs,
    the driver attempts to relogin (PLOGI) to the device via the
    DPC thread.  Add code to make the appropriate upcall to the
    FC transport layer (fc_remote_port_add()) upon successful
    completion of the PLOGI.
    
    Signed-off-by: Andrew Vasquez <andrew.vasquez@qlogic.com>
    Signed-off-by: James Bottomley <James.Bottomley@SteelEye.com>

diff --git a/drivers/scsi/qla2xxx/qla_init.c b/drivers/scsi/qla2xxx/qla_init.c
index 4c7caece4ca7..16c889261d94 100644
--- a/drivers/scsi/qla2xxx/qla_init.c
+++ b/drivers/scsi/qla2xxx/qla_init.c
@@ -32,7 +32,6 @@ static int qla2x00_fw_ready(scsi_qla_host_t *);
 static int qla2x00_configure_hba(scsi_qla_host_t *);
 static int qla2x00_configure_loop(scsi_qla_host_t *);
 static int qla2x00_configure_local_loop(scsi_qla_host_t *);
-static void qla2x00_update_fcport(scsi_qla_host_t *, fc_port_t *);
 static int qla2x00_configure_fabric(scsi_qla_host_t *);
 static int qla2x00_find_all_fabric_devs(scsi_qla_host_t *, struct list_head *);
 static int qla2x00_device_resync(scsi_qla_host_t *);
@@ -2039,7 +2038,7 @@ qla2x00_probe_for_all_luns(scsi_qla_host_t *ha)
  * Context:
  *	Kernel context.
  */
-static void
+void
 qla2x00_update_fcport(scsi_qla_host_t *ha, fc_port_t *fcport)
 {
 	uint16_t	index;