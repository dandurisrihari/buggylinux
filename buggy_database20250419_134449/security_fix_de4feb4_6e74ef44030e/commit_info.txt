Commit Hash: de4feb4e3d61026f81b15ada6f64deaf40125ffc
Subject: NFC: hci: Split memcpy() of struct hcp_message flexible array


Security Keywords:
- hardening

Full commit message:
NFC: hci: Split memcpy() of struct hcp_message flexible array

To work around a misbehavior of the compiler's ability to see into
composite flexible array structs (as detailed in the coming memcpy()
hardening series[1]), split the memcpy() of the header and the payload
so no false positive run-time overflow warning will be generated. This
split already existed for the "firstfrag" case, so just generalize the
logic further.

[1] https://lore.kernel.org/linux-hardening/20220901065914.1417829-2-keescook@chromium.org/

Cc: Eric Dumazet <edumazet@google.com>
Cc: Paolo Abeni <pabeni@redhat.com>
Reported-by: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Signed-off-by: Kees Cook <keescook@chromium.org>
Reviewed-by: Gustavo A. R. Silva <gustavoars@kernel.org>
Reviewed-by: Krzysztof Kozlowski <krzysztof.kozlowski@linaro.org>
Link: https://lore.kernel.org/r/20220924040835.3364912-1-keescook@chromium.org
Signed-off-by: Jakub Kicinski <kuba@kernel.org>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Fri Sep 23 21:08:35 2022 -0700
Committer: Jakub Kicinski <kuba@kernel.org>
Commit Date: Tue Sep 27 07:45:18 2022 -0700

Files Changed: 1
Lines Added: 5
Lines Removed: 7
Total Changes: 12
