Commit Hash: 62411ab2fe5f002dff27417630ddf02cc40ca404
Subject: cifs: Fix signing failure when server mandates signing for NTLMSSP


Security Keywords:
- authentication

Full commit message:
cifs: Fix signing failure when server mandates signing for NTLMSSP

When using NTLMSSP authentication mechanism, if server mandates
signing, keep the flags in type 3 messages of the NTLMSSP exchange
same as in type 1 messages (i.e. keep the indicated capabilities same).

Some of the servers such as Samba, expect the flags such as
Negotiate_Key_Exchange in type 3 message of NTLMSSP exchange as well.
Some servers like Windows do not.

https://bugzilla.samba.org/show_bug.cgi?id=8212

Signed-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail>
Acked-by: Jeff Layton <jlayton@redhat.com>
Signed-off-by: Steve French <sfrench@us.ibm.com>

Metadata:
Author: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Author Date: Sun Jul 10 06:55:32 2011 -0500
Committer: Steve French <sfrench@us.ibm.com>
Commit Date: Tue Jul 12 19:14:23 2011 +0000

Files Changed: 1
Lines Added: 5
Lines Removed: 5
Total Changes: 10
