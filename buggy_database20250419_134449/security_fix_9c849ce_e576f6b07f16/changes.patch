diff --cc fs/Kconfig
index 8d6ac56d6fcd,6d719f2c5828..b11bd4b387e1
--- a/fs/Kconfig
+++ b/fs/Kconfig
@@@ -348,8 -358,14 +348,15 @@@ config NFS_V4_2_SSC_HELPE
  
  source "net/sunrpc/Kconfig"
  source "fs/ceph/Kconfig"
+ 
  source "fs/cifs/Kconfig"
 +source "fs/ksmbd/Kconfig"
+ 
+ config CIFS_COMMON
+ 	tristate
+ 	default y if CIFS=y
+ 	default m if CIFS=m
+ 
  source "fs/coda/Kconfig"
  source "fs/afs/Kconfig"
  source "fs/9p/Kconfig"
diff --cc fs/Makefile
index b7e65c39f98d,77b0e79c8b4f..354e2ba3ee67
--- a/fs/Makefile
+++ b/fs/Makefile
@@@ -96,8 -96,8 +96,9 @@@ obj-$(CONFIG_LOCKD)		+= lockd
  obj-$(CONFIG_NLS)		+= nls/
  obj-$(CONFIG_UNICODE)		+= unicode/
  obj-$(CONFIG_SYSV_FS)		+= sysv/
+ obj-$(CONFIG_CIFS_COMMON)	+= cifs_common/
  obj-$(CONFIG_CIFS)		+= cifs/
 +obj-$(CONFIG_SMB_SERVER)	+= ksmbd/
  obj-$(CONFIG_HPFS_FS)		+= hpfs/
  obj-$(CONFIG_NTFS_FS)		+= ntfs/
  obj-$(CONFIG_UFS_FS)		+= ufs/