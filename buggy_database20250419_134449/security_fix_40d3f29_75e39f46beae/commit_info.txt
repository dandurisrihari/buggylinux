Commit Hash: 40d3f295b5feda409784e569550057b5fbc2a295
Subject: net: mscc: ocelot: use common tag parsing code with DSA


Security Keywords:
- Injection

Full commit message:
net: mscc: ocelot: use common tag parsing code with DSA

The Injection Frame Header and Extraction Frame Header that the switch
prepends to frames over the NPI port is also prepended to frames
delivered over the CPU port module's queues.

Let's unify the handling of the frame headers by making the ocelot
driver call some helpers exported by the DSA tagger. Among other things,
this allows us to get rid of the strange cpu_to_be32 when transmitting
the Injection Frame Header on ocelot, since the packing API uses
network byte order natively (when "quirks" is 0).

The comments above ocelot_gen_ifh talk about setting pop_cnt to 3, and
the cpu extraction queue mask to something, but the code doesn't do it,
so we don't do it either.

Signed-off-by: Vladimir Oltean <vladimir.oltean@nxp.com>
Reviewed-by: Florian Fainelli <f.fainelli@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Vladimir Oltean <vladimir.oltean@nxp.com>
Author Date: Sun Feb 14 00:37:56 2021 +0200
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Sun Feb 14 17:31:44 2021 -0800

Files Changed: 9
Lines Added: 246
Lines Removed: 227
Total Changes: 473
