{
  "hash": "6a137caec23aeb9e036cdfd8a46dd8a366460e5d",
  "hash_short": "6a137cae",
  "subject": "Bluetooth: fix the erroneous flush_work() order",
  "body": "In the cleanup routine for failed initialization of HCI device,\nthe flush_work(&hdev->rx_work) need to be finished before the\nflush_work(&hdev->cmd_work). Otherwise, the hci_rx_work() can\npossibly invoke new cmd_work and cause a bug, like double free,\nin late processings.\n\nThis was assigned CVE-2021-3564.\n\nThis patch reorder the flush_work() to fix this bug.\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nCc: Luiz Augusto von Dentz <luiz.dentz@gmail.com>\nCc: \"David S. Miller\" <davem@davemloft.net>\nCc: Jakub Kicinski <kuba@kernel.org>\nCc: linux-bluetooth@vger.kernel.org\nCc: netdev@vger.kernel.org\nCc: linux-kernel@vger.kernel.org\nSigned-off-by: Lin Ma <linma@zju.edu.cn>\nSigned-off-by: Hao Xiong <mart1n@zju.edu.cn>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "Bluetooth: fix the erroneous flush_work() order\n\nIn the cleanup routine for failed initialization of HCI device,\nthe flush_work(&hdev->rx_work) need to be finished before the\nflush_work(&hdev->cmd_work). Otherwise, the hci_rx_work() can\npossibly invoke new cmd_work and cause a bug, like double free,\nin late processings.\n\nThis was assigned CVE-2021-3564.\n\nThis patch reorder the flush_work() to fix this bug.\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nCc: Luiz Augusto von Dentz <luiz.dentz@gmail.com>\nCc: \"David S. Miller\" <davem@davemloft.net>\nCc: Jakub Kicinski <kuba@kernel.org>\nCc: linux-bluetooth@vger.kernel.org\nCc: netdev@vger.kernel.org\nCc: linux-kernel@vger.kernel.org\nSigned-off-by: Lin Ma <linma@zju.edu.cn>\nSigned-off-by: Hao Xiong <mart1n@zju.edu.cn>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Lin Ma",
  "author_email": "linma@zju.edu.cn",
  "author_date": "Tue May 25 14:39:02 2021 +0200",
  "author_date_iso": "2021-05-25T14:39:02+02:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Thu May 27 18:16:17 2021 +0200",
  "committer_date_iso": "2021-05-27T18:16:17+02:00",
  "files_changed": [
    "net/bluetooth/hci_core.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_core.c",
      "insertions": 6,
      "deletions": 1
    }
  ],
  "total_insertions": 6,
  "total_deletions": 1,
  "total_changes": 7,
  "parents": [
    "62f3415db237b8d2aa9a804ff84ce2efa87df179"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2021-3564"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/bluetooth/hci_core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}