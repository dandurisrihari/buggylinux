Commit Hash: 5c056fdc5b474329037f2aa18401bd73033e0ce0
Subject: libceph: verify authorize reply on connect


Security Keywords:
- authentication

Full commit message:
libceph: verify authorize reply on connect

After sending an authorizer (ceph_x_authorize_a + ceph_x_authorize_b),
the client gets back a ceph_x_authorize_reply, which it is supposed to
verify to ensure the authenticity and protect against replay attacks.
The code for doing this is there (ceph_x_verify_authorizer_reply(),
ceph_auth_verify_authorizer_reply() + plumbing), but it is never
invoked by the the messenger.

AFAICT this goes back to 2009, when ceph authentication protocols
support was added to the kernel client in 4e7a5dcd1bba ("ceph:
negotiate authentication protocol; implement AUTH_NONE protocol").

The second param of ceph_connection_operations::verify_authorizer_reply
is unused all the way down.  Pass 0 to facilitate backporting, and kill
it in the next commit.

Cc: stable@vger.kernel.org
Signed-off-by: Ilya Dryomov <idryomov@gmail.com>
Reviewed-by: Sage Weil <sage@redhat.com>

Metadata:
Author: Ilya Dryomov <idryomov@gmail.com>
Author Date: Fri Dec 2 16:35:09 2016 +0100
Committer: Ilya Dryomov <idryomov@gmail.com>
Commit Date: Mon Dec 12 23:09:21 2016 +0100

Files Changed: 1
Lines Added: 13
Lines Removed: 0
Total Changes: 13
