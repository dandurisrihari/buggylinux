Commit Hash: 773299a570725d1f253d6046cd6475209b0dcd55
Subject: KVM: arm/arm64: vgic: Prevent userspace injection of a mapped interrupt


Security Keywords:
- injection

Full commit message:
KVM: arm/arm64: vgic: Prevent userspace injection of a mapped interrupt

Virtual interrupts mapped to a HW interrupt should only be triggered
from inside the kernel. Otherwise, you could end up confusing the
kernel (and the GIC's) state machine.

Rearrange the injection path so that kvm_vgic_inject_irq is
used for non-mapped interrupts, and kvm_vgic_inject_mapped_irq is
used for mapped interrupts. The latter should only be called from
inside the kernel (timer, irqfd).

Reviewed-by: Christoffer Dall <christoffer.dall@linaro.org>
Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>

Metadata:
Author: Marc Zyngier <marc.zyngier@arm.com>
Author Date: Fri Jul 24 11:30:43 2015 +0100
Committer: Marc Zyngier <marc.zyngier@arm.com>
Commit Date: Wed Aug 12 11:28:26 2015 +0100

Files Changed: 2
Lines Added: 72
Lines Removed: 33
Total Changes: 105
