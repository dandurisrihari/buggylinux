{
  "hash": "0447378a4a793da008451fad50bc0f93e9675ae6",
  "hash_short": "0447378a",
  "subject": "kvm: vmx: Nested VM-entry prereqs for event inj.",
  "body": "This patch extends the checks done prior to a nested VM entry.\nSpecifically, it extends the check_vmentry_prereqs function with checks\nfor fields relevant to the VM-entry event injection information, as\ndescribed in the Intel SDM, volume 3.\n\nThis patch is motivated by a syzkaller bug, where a bad VM-entry\ninterruption information field is generated in the VMCS02, which causes\nthe nested VM launch to fail. Then, KVM fails to resume L1.\n\nWhile KVM should be improved to correctly resume L1 execution after a\nfailed nested launch, this change is justified because the existing code\nto resume L1 is flaky/ad-hoc and the test coverage for resuming L1 is\nsparse.\n\nReported-by: syzbot <syzkaller@googlegroups.com>\nSigned-off-by: Marc Orr <marcorr@google.com>\n[Removed comment whose parts were describing previous revisions and the\n rest was obvious from function/variable naming. - Radim]\nSigned-off-by: Radim Kr\u010dm\u00e1\u0159 <rkrcmar@redhat.com>",
  "full_message": "kvm: vmx: Nested VM-entry prereqs for event inj.\n\nThis patch extends the checks done prior to a nested VM entry.\nSpecifically, it extends the check_vmentry_prereqs function with checks\nfor fields relevant to the VM-entry event injection information, as\ndescribed in the Intel SDM, volume 3.\n\nThis patch is motivated by a syzkaller bug, where a bad VM-entry\ninterruption information field is generated in the VMCS02, which causes\nthe nested VM launch to fail. Then, KVM fails to resume L1.\n\nWhile KVM should be improved to correctly resume L1 execution after a\nfailed nested launch, this change is justified because the existing code\nto resume L1 is flaky/ad-hoc and the test coverage for resuming L1 is\nsparse.\n\nReported-by: syzbot <syzkaller@googlegroups.com>\nSigned-off-by: Marc Orr <marcorr@google.com>\n[Removed comment whose parts were describing previous revisions and the\n rest was obvious from function/variable naming. - Radim]\nSigned-off-by: Radim Kr\u010dm\u00e1\u0159 <rkrcmar@redhat.com>",
  "author_name": "Marc Orr",
  "author_email": "marcorr@google.com",
  "author_date": "Wed Jun 20 17:21:29 2018 -0700",
  "author_date_iso": "2018-06-20T17:21:29-07:00",
  "committer_name": "Radim Kr\u010dm\u00e1\u0159",
  "committer_email": "rkrcmar@redhat.com",
  "committer_date": "Fri Jun 22 16:46:26 2018 +0200",
  "committer_date_iso": "2018-06-22T16:46:26+02:00",
  "files_changed": [
    "arch/x86/include/asm/vmx.h",
    "arch/x86/kvm/vmx.c",
    "arch/x86/kvm/x86.h"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "arch/x86/include/asm/vmx.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/vmx.c",
      "insertions": 67,
      "deletions": 0
    },
    {
      "file": "arch/x86/kvm/x86.h",
      "insertions": 9,
      "deletions": 0
    }
  ],
  "total_insertions": 79,
  "total_deletions": 0,
  "total_changes": 79,
  "parents": [
    "5f9077cbae1de0e46386656cacdda4c472378640"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.18",
    "v4.18-rc2",
    "v4.18-rc3",
    "v4.18-rc4",
    "v4.18-rc5",
    "v4.18-rc6",
    "v4.18-rc7",
    "v4.18-rc8",
    "v4.19",
    "v4.19-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/include/asm/vmx.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/vmx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kvm/x86.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}