{
  "hash": "6abaa83c7352b31450d7e8c173f674324c16b02b",
  "hash_short": "6abaa83c",
  "subject": "Merge tag 'f2fs-for-5.15-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fs",
  "body": "Pull f2fs updates from Jaegeuk Kim:\n \"In this cycle, we've addressed some performance issues such as lock\n  contention, misbehaving compress_cache, allowing extent_cache for\n  compressed files, and new sysfs to adjust ra_size for fadvise.\n\n  In order to diagnose the performance issues quickly, we also added an\n  iostat which shows the IO latencies periodically.\n\n  On the stability side, we've found two memory leakage cases in the\n  error path in compression flow. And, we've also fixed various corner\n  cases in fiemap, quota, checkpoint=disable, zstd, and so on.\n\n  Enhancements:\n   - avoid long checkpoint latency by releasing nat_tree_lock\n   - collect and show iostats periodically\n   - support extent_cache for compressed files\n   - add a sysfs entry to manage ra_size given fadvise(POSIX_FADV_SEQUENTIAL)\n   - report f2fs GC status via sysfs\n   - add discard_unit=%s in mount option to handle zoned device\n\n  Bug fixes:\n   - fix two memory leakages when an error happens in the compressed IO flow\n   - fix commpress_cache to get the right LBA\n   - fix fiemap to deal with compressed case correctly\n   - fix wrong EIO returns due to SBI_NEED_FSCK\n   - fix missing writes when enabling checkpoint back\n   - fix quota deadlock\n   - fix zstd level mount option\n\n  In addition to the above major updates, we've cleaned up several code\n  paths such as dio, unnecessary operations, debugfs/f2fs/status, sanity\n  check, and typos\"\n\n* tag 'f2fs-for-5.15-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fs: (46 commits)\n  f2fs: should put a page beyond EOF when preparing a write\n  f2fs: deallocate compressed pages when error happens\n  f2fs: enable realtime discard iff device supports discard\n  f2fs: guarantee to write dirty data when enabling checkpoint back\n  f2fs: fix to unmap pages from userspace process in punch_hole()\n  f2fs: fix unexpected ENOENT comes from f2fs_map_blocks()\n  f2fs: fix to account missing .skipped_gc_rwsem\n  f2fs: adjust unlock order for cleanup\n  f2fs: Don't create discard thread when device doesn't support realtime discard\n  f2fs: rebuild nat_bits during umount\n  f2fs: introduce periodic iostat io latency traces\n  f2fs: separate out iostat feature\n  f2fs: compress: do sanity check on cluster\n  f2fs: fix description about main_blkaddr node\n  f2fs: convert S_IRUGO to 0444\n  f2fs: fix to keep compatibility of fault injection interface\n  f2fs: support fault injection for f2fs_kmem_cache_alloc()\n  f2fs: compress: allow write compress released file after truncate to zero\n  f2fs: correct comment in segment.h\n  f2fs: improve sbi status info in debugfs/f2fs/status\n  ...",
  "full_message": "Merge tag 'f2fs-for-5.15-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fs\n\nPull f2fs updates from Jaegeuk Kim:\n \"In this cycle, we've addressed some performance issues such as lock\n  contention, misbehaving compress_cache, allowing extent_cache for\n  compressed files, and new sysfs to adjust ra_size for fadvise.\n\n  In order to diagnose the performance issues quickly, we also added an\n  iostat which shows the IO latencies periodically.\n\n  On the stability side, we've found two memory leakage cases in the\n  error path in compression flow. And, we've also fixed various corner\n  cases in fiemap, quota, checkpoint=disable, zstd, and so on.\n\n  Enhancements:\n   - avoid long checkpoint latency by releasing nat_tree_lock\n   - collect and show iostats periodically\n   - support extent_cache for compressed files\n   - add a sysfs entry to manage ra_size given fadvise(POSIX_FADV_SEQUENTIAL)\n   - report f2fs GC status via sysfs\n   - add discard_unit=%s in mount option to handle zoned device\n\n  Bug fixes:\n   - fix two memory leakages when an error happens in the compressed IO flow\n   - fix commpress_cache to get the right LBA\n   - fix fiemap to deal with compressed case correctly\n   - fix wrong EIO returns due to SBI_NEED_FSCK\n   - fix missing writes when enabling checkpoint back\n   - fix quota deadlock\n   - fix zstd level mount option\n\n  In addition to the above major updates, we've cleaned up several code\n  paths such as dio, unnecessary operations, debugfs/f2fs/status, sanity\n  check, and typos\"\n\n* tag 'f2fs-for-5.15-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/jaegeuk/f2fs: (46 commits)\n  f2fs: should put a page beyond EOF when preparing a write\n  f2fs: deallocate compressed pages when error happens\n  f2fs: enable realtime discard iff device supports discard\n  f2fs: guarantee to write dirty data when enabling checkpoint back\n  f2fs: fix to unmap pages from userspace process in punch_hole()\n  f2fs: fix unexpected ENOENT comes from f2fs_map_blocks()\n  f2fs: fix to account missing .skipped_gc_rwsem\n  f2fs: adjust unlock order for cleanup\n  f2fs: Don't create discard thread when device doesn't support realtime discard\n  f2fs: rebuild nat_bits during umount\n  f2fs: introduce periodic iostat io latency traces\n  f2fs: separate out iostat feature\n  f2fs: compress: do sanity check on cluster\n  f2fs: fix description about main_blkaddr node\n  f2fs: convert S_IRUGO to 0444\n  f2fs: fix to keep compatibility of fault injection interface\n  f2fs: support fault injection for f2fs_kmem_cache_alloc()\n  f2fs: compress: allow write compress released file after truncate to zero\n  f2fs: correct comment in segment.h\n  f2fs: improve sbi status info in debugfs/f2fs/status\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Sat Sep 4 10:48:47 2021 -0700",
  "author_date_iso": "2021-09-04T10:48:47-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Sat Sep 4 10:48:47 2021 -0700",
  "committer_date_iso": "2021-09-04T10:48:47-07:00",
  "files_changed": [
    "fs/f2fs/data.c",
    "fs/f2fs/f2fs.h",
    "fs/f2fs/file.c",
    "fs/f2fs/super.c",
    "fs/f2fs/sysfs.c"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "Documentation/ABI/testing/sysfs-fs-f2fs",
      "insertions": 21,
      "deletions": 2
    },
    {
      "file": "Documentation/filesystems/f2fs.rst",
      "insertions": 15,
      "deletions": 2
    },
    {
      "file": "fs/f2fs/Kconfig",
      "insertions": 13,
      "deletions": 6
    },
    {
      "file": "fs/f2fs/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "fs/f2fs/checkpoint.c",
      "insertions": 43,
      "deletions": 14
    },
    {
      "file": "fs/f2fs/compress.c",
      "insertions": 88,
      "deletions": 9
    },
    {
      "file": "fs/f2fs/data.c",
      "insertions": 140,
      "deletions": 62
    },
    {
      "file": "fs/f2fs/debug.c",
      "insertions": 35,
      "deletions": 4
    },
    {
      "file": "fs/f2fs/dir.c",
      "insertions": 11,
      "deletions": 7
    },
    {
      "file": "fs/f2fs/extent_cache.c",
      "insertions": 44,
      "deletions": 2
    },
    {
      "file": "fs/f2fs/f2fs.h",
      "insertions": 85,
      "deletions": 92
    },
    {
      "file": "fs/f2fs/file.c",
      "insertions": 59,
      "deletions": 11
    },
    {
      "file": "fs/f2fs/gc.c",
      "insertions": 10,
      "deletions": 4
    },
    {
      "file": "fs/f2fs/iostat.c",
      "insertions": 287,
      "deletions": 0
    },
    {
      "file": "fs/f2fs/iostat.h",
      "insertions": 84,
      "deletions": 0
    },
    {
      "file": "fs/f2fs/node.c",
      "insertions": 126,
      "deletions": 39
    },
    {
      "file": "fs/f2fs/recovery.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "fs/f2fs/segment.c",
      "insertions": 94,
      "deletions": 43
    },
    {
      "file": "fs/f2fs/segment.h",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "fs/f2fs/super.c",
      "insertions": 182,
      "deletions": 60
    },
    {
      "file": "fs/f2fs/sysfs.c",
      "insertions": 56,
      "deletions": 100
    },
    {
      "file": "fs/f2fs/xattr.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "include/trace/events/f2fs.h",
      "insertions": 97,
      "deletions": 0
    }
  ],
  "total_insertions": 1497,
  "total_deletions": 461,
  "total_changes": 1958,
  "parents": [
    "0961f0c00e69672a8e4a2e591355567dbda44389",
    "9605f75cf36e0bcc0f4ada07b5be712d30107607"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/f2fs/data.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/f2fs/f2fs.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/f2fs/file.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/f2fs/super.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/f2fs/sysfs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}