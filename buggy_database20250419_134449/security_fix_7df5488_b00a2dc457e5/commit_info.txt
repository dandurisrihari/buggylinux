Commit Hash: 7df548840c496b0141fb2404b889c346380c2b22
Subject: x86/bugs: Add "unknown" reporting for MMIO Stale Data


Security Keywords:
- Vulnerability

Full commit message:
x86/bugs: Add "unknown" reporting for MMIO Stale Data

Older Intel CPUs that are not in the affected processor list for MMIO
Stale Data vulnerabilities currently report "Not affected" in sysfs,
which may not be correct. Vulnerability status for these older CPUs is
unknown.

Add known-not-affected CPUs to the whitelist. Report "unknown"
mitigation status for CPUs that are not in blacklist, whitelist and also
don't enumerate MSR ARCH_CAPABILITIES bits that reflect hardware
immunity to MMIO Stale Data vulnerabilities.

Mitigation is not deployed when the status is unknown.

  [ bp: Massage, fixup. ]

Fixes: 8d50cdf8b834 ("x86/speculation/mmio: Add sysfs reporting for Processor MMIO Stale Data")
Suggested-by: Andrew Cooper <andrew.cooper3@citrix.com>
Suggested-by: Tony Luck <tony.luck@intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Borislav Petkov <bp@suse.de>
Cc: stable@vger.kernel.org
Link: https://lore.kernel.org/r/a932c154772f2121794a5f2eded1a11013114711.1657846269.git.pawan.kumar.gupta@linux.intel.com

Metadata:
Author: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Author Date: Wed Aug 3 14:41:32 2022 -0700
Committer: Borislav Petkov <bp@suse.de>
Commit Date: Thu Aug 18 15:35:22 2022 +0200

Files Changed: 4
Lines Added: 56
Lines Removed: 19
Total Changes: 75
