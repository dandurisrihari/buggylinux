Commit Hash: a6f80fb7b5986fda663d94079d3bba0937a6b6ff
Subject: ecryptfs: Bugfix for error related to ecryptfs_hash_buckets

CVE Identifiers:
- CVE-2010-2492

Full commit message:
ecryptfs: Bugfix for error related to ecryptfs_hash_buckets

The function ecryptfs_uid_hash wrongly assumes that the
second parameter to hash_long() is the number of hash
buckets instead of the number of hash bits.
This patch fixes that and renames the variable
ecryptfs_hash_buckets to ecryptfs_hash_bits to make it
clearer.

Fixes: CVE-2010-2492

Signed-off-by: Andre Osterhues <aosterhues@escrypt.com>
Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Andre Osterhues <aosterhues@escrypt.com>
Author Date: Tue Jul 13 15:59:17 2010 -0500
Committer: Linus Torvalds <torvalds@linux-foundation.org>
Commit Date: Wed Jul 28 19:59:24 2010 -0700

Files Changed: 1
Lines Added: 9
Lines Removed: 8
Total Changes: 17
