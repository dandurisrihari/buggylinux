Commit Hash: 5d0d28824c76409f0d1a645bf0ae81318c8ffa42
Subject: NTLM authentication and signing - Calculate auth response per smb session


Security Keywords:
- authentication

Full commit message:
NTLM authentication and signing - Calculate auth response per smb session

Start calculation auth response within a session.  Move/Add pertinet
data structures like session key, server challenge and ntlmv2_hash in
a session structure.  We should do the calculations within a session
before copying session key and response over to server data
structures because a session setup can fail.

Only after a very first smb session succeeds, it copies/makes its
session key, session key of smb connection.  This key stays with
the smb connection throughout its life.

Signed-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Reviewed-by: Jeff Layton <jlayton@redhat.com>
Signed-off-by: Steve French <sfrench@us.ibm.com>

Metadata:
Author: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Author Date: Wed Oct 13 18:15:00 2010 -0500
Committer: Steve French <sfrench@us.ibm.com>
Commit Date: Thu Oct 14 18:05:19 2010 +0000

Files Changed: 5
Lines Added: 36
Lines Removed: 36
Total Changes: 72
