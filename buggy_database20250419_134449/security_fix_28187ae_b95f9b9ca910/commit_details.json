{
  "hash": "28187ae569e8a6c34eb7ac8871f479d94be31e16",
  "hash_short": "28187ae5",
  "subject": "btrfs: Simplify page unlocking in alloc_extent_buffer",
  "body": "Current version of the page unlocking code was added in\n727011e07cbd (\"Btrfs: allow metadata blocks larger than the page size\")\nbut even in this commit that particular flag was never used per-se. In\nfact, btrfs only uses PageChecked for data pages to identify pages\nwhich have been dirtied but don't have ORDERED bit set. For more\ninformation see 247e743cbe6e (\"Btrfs: Use async helpers to deal with\npages that have been improperly dirtied\").\n\nHowever, this doesn't apply to extent buffer pages. The important bit\nhere is that the pages are unlocked AFTER the extent buffer has been\nproperly recorded in the radix tree to avoid races with\nbtree_releasepage. Let's exploit this fact and simplify the page\nunlocking sequence by unlocking the pages in-order and removing the\nredundant PageChecked flag setting/clearing.\n\nSigned-off-by: Nikolay Borisov <nborisov@suse.com>\nReviewed-by: David Sterba <dsterba@suse.com>\nSigned-off-by: David Sterba <dsterba@suse.com>",
  "full_message": "btrfs: Simplify page unlocking in alloc_extent_buffer\n\nCurrent version of the page unlocking code was added in\n727011e07cbd (\"Btrfs: allow metadata blocks larger than the page size\")\nbut even in this commit that particular flag was never used per-se. In\nfact, btrfs only uses PageChecked for data pages to identify pages\nwhich have been dirtied but don't have ORDERED bit set. For more\ninformation see 247e743cbe6e (\"Btrfs: Use async helpers to deal with\npages that have been improperly dirtied\").\n\nHowever, this doesn't apply to extent buffer pages. The important bit\nhere is that the pages are unlocked AFTER the extent buffer has been\nproperly recorded in the radix tree to avoid races with\nbtree_releasepage. Let's exploit this fact and simplify the page\nunlocking sequence by unlocking the pages in-order and removing the\nredundant PageChecked flag setting/clearing.\n\nSigned-off-by: Nikolay Borisov <nborisov@suse.com>\nReviewed-by: David Sterba <dsterba@suse.com>\nSigned-off-by: David Sterba <dsterba@suse.com>",
  "author_name": "Nikolay Borisov",
  "author_email": "nborisov@suse.com",
  "author_date": "Wed Jul 4 10:24:51 2018 +0300",
  "author_date_iso": "2018-07-04T10:24:51+03:00",
  "committer_name": "David Sterba",
  "committer_email": "dsterba@suse.com",
  "committer_date": "Mon Aug 6 13:12:54 2018 +0200",
  "committer_date_iso": "2018-08-06T13:12:54+02:00",
  "files_changed": [
    "fs/btrfs/extent_io.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/btrfs/extent_io.c",
      "insertions": 2,
      "deletions": 7
    }
  ],
  "total_insertions": 2,
  "total_deletions": 7,
  "total_changes": 9,
  "parents": [
    "8b9b6f255485a4354da5474b16e79c447222e9ed"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.19",
    "v4.19-rc1",
    "v4.19-rc2",
    "v4.19-rc3",
    "v4.19-rc4",
    "v4.19-rc5",
    "v4.19-rc6",
    "v4.19-rc7",
    "v4.19-rc8",
    "v4.20"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/btrfs/extent_io.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}