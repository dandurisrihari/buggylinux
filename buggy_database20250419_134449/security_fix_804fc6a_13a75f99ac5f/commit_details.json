{
  "hash": "804fc6a2931e692f50e8e317fcb0c8887331b405",
  "hash_short": "804fc6a2",
  "subject": "mac80211: fix regression where EAPOL frames were sent in plaintext",
  "body": "When sending EAPOL frames via NL80211 they are treated as injected\nframes in mac80211. Due to commit 1df2bdba528b (\"mac80211: never drop\ninjected frames even if normally not allowed\") these injected frames\nwere not assigned a sta context in the function ieee80211_tx_dequeue,\ncausing certain wireless network cards to always send EAPOL frames in\nplaintext. This may cause compatibility issues with some clients or\nAPs, which for instance can cause the group key handshake to fail and\nin turn would cause the station to get disconnected.\n\nThis commit fixes this regression by assigning a sta context in\nieee80211_tx_dequeue to injected frames as well.\n\nNote that sending EAPOL frames in plaintext is not a security issue\nsince they contain their own encryption and authentication protection.\n\nCc: stable@vger.kernel.org\nFixes: 1df2bdba528b (\"mac80211: never drop injected frames even if normally not allowed\")\nReported-by: Thomas Deutschmann <whissi@gentoo.org>\nTested-by: Christian Hesse <list@eworm.de>\nTested-by: Thomas Deutschmann <whissi@gentoo.org>\nSigned-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>\nLink: https://lore.kernel.org/r/20201019160113.350912-1-Mathy.Vanhoef@kuleuven.be\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: fix regression where EAPOL frames were sent in plaintext\n\nWhen sending EAPOL frames via NL80211 they are treated as injected\nframes in mac80211. Due to commit 1df2bdba528b (\"mac80211: never drop\ninjected frames even if normally not allowed\") these injected frames\nwere not assigned a sta context in the function ieee80211_tx_dequeue,\ncausing certain wireless network cards to always send EAPOL frames in\nplaintext. This may cause compatibility issues with some clients or\nAPs, which for instance can cause the group key handshake to fail and\nin turn would cause the station to get disconnected.\n\nThis commit fixes this regression by assigning a sta context in\nieee80211_tx_dequeue to injected frames as well.\n\nNote that sending EAPOL frames in plaintext is not a security issue\nsince they contain their own encryption and authentication protection.\n\nCc: stable@vger.kernel.org\nFixes: 1df2bdba528b (\"mac80211: never drop injected frames even if normally not allowed\")\nReported-by: Thomas Deutschmann <whissi@gentoo.org>\nTested-by: Christian Hesse <list@eworm.de>\nTested-by: Thomas Deutschmann <whissi@gentoo.org>\nSigned-off-by: Mathy Vanhoef <Mathy.Vanhoef@kuleuven.be>\nLink: https://lore.kernel.org/r/20201019160113.350912-1-Mathy.Vanhoef@kuleuven.be\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Mathy Vanhoef",
  "author_email": "Mathy.Vanhoef@kuleuven.be",
  "author_date": "Mon Oct 19 20:01:13 2020 +0400",
  "author_date_iso": "2020-10-19T20:01:13+04:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Fri Oct 30 10:03:24 2020 +0100",
  "committer_date_iso": "2020-10-30T10:03:24+01:00",
  "files_changed": [
    "net/mac80211/tx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/tx.c",
      "insertions": 4,
      "deletions": 3
    }
  ],
  "total_insertions": 4,
  "total_deletions": 3,
  "total_changes": 7,
  "parents": [
    "07e0887302450a62f51dba72df6afb5fabb23d1c"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "security issue",
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/tx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}