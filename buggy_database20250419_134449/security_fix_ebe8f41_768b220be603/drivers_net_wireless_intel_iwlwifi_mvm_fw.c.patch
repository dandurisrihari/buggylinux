commit ebe8f41319fabee020736220942d79c1644bea85
Author: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Date:   Sun Jan 28 08:53:59 2024 +0200

    wifi: iwlwifi: implement GLAI ACPI table loading
    
    All the regulatory tables from BIOS are going to be loaded
    (preferably) from the UEFI instead of the ACPI.
    There is a security issue with the fact that anyone can
    add these UEFI variables.
    The solution for that is to have a lock for all WIFI GUID UEFI
    variables, and only if the UEFI variables are locked then we can
    read it.
    The status of the lock (unlocked, locked, test mode) is indicated
    in a ACPI table: Guid Lock ACPI Indicator.
    Load this table so the driver knows whether to read from UEFI or
    not
    
    Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
    Reviewed-by: Gregory Greenman <gregory.greenman@intel.com>
    Link: https://msgid.link/20240128084842.53994809fbdd.I1bd10aafc387bc04f375e386861ee2bcb82f0a61@changeid
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>

diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/fw.c b/drivers/net/wireless/intel/iwlwifi/mvm/fw.c
index 175024170357..a6db290923cd 100644
--- a/drivers/net/wireless/intel/iwlwifi/mvm/fw.c
+++ b/drivers/net/wireless/intel/iwlwifi/mvm/fw.c
@@ -1402,6 +1402,8 @@ void iwl_mvm_get_acpi_tables(struct iwl_mvm *mvm)
 {
 	int ret;
 
+	iwl_acpi_get_guid_lock_status(&mvm->fwrt);
+
 	/* read PPAG table */
 	ret = iwl_acpi_get_ppag_table(&mvm->fwrt);
 	if (ret < 0) {