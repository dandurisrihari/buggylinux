Commit Hash: 090507157f3bc43dd925fda50f8aca7d03b616b6
Subject: [SCSI] aacraid: prevent copy_from_user() BUG!


Security Keywords:
- hardening

Full commit message:
[SCSI] aacraid: prevent copy_from_user() BUG!

Seen:

	kernel BUG at arch/i386/lib/usercopy.c:872

under a 2.6.18-8.el5 kernel. Traced it to a garbage-in/garbage-out
ioctl condition in the aacraid driver.

Adaptec's special ioctl scb passthrough needs to check the validity of
the individual scatter gather count fields to the maximum the adapter
supports. Doing so will have the side effect of preventing
copy_from_user() from bugging out while populating the dma buffers.
This is a hardening effort, issue was triggered by an errant version
of the management tools and thus the BUG should not be seen in the
field.

[jejb: fixed up compile failure]
Signed-off-by: Mark Salyzyn <aacraid@adaptec.com>
Signed-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>

Metadata:
Author: Mark Salyzyn <Mark_Salyzyn@adaptec.com>
Author Date: Wed May 28 15:32:55 2008 -0400
Committer: James Bottomley <James.Bottomley@HansenPartnership.com>
Commit Date: Sat Jul 12 08:22:24 2008 -0500

Files Changed: 1
Lines Added: 33
Lines Removed: 0
Total Changes: 33
