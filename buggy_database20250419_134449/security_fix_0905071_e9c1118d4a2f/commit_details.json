{
  "hash": "090507157f3bc43dd925fda50f8aca7d03b616b6",
  "hash_short": "09050715",
  "subject": "[SCSI] aacraid: prevent copy_from_user() BUG!",
  "body": "Seen:\n\n\tkernel BUG at arch/i386/lib/usercopy.c:872\n\nunder a 2.6.18-8.el5 kernel. Traced it to a garbage-in/garbage-out\nioctl condition in the aacraid driver.\n\nAdaptec's special ioctl scb passthrough needs to check the validity of\nthe individual scatter gather count fields to the maximum the adapter\nsupports. Doing so will have the side effect of preventing\ncopy_from_user() from bugging out while populating the dma buffers.\nThis is a hardening effort, issue was triggered by an errant version\nof the management tools and thus the BUG should not be seen in the\nfield.\n\n[jejb: fixed up compile failure]\nSigned-off-by: Mark Salyzyn <aacraid@adaptec.com>\nSigned-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>",
  "full_message": "[SCSI] aacraid: prevent copy_from_user() BUG!\n\nSeen:\n\n\tkernel BUG at arch/i386/lib/usercopy.c:872\n\nunder a 2.6.18-8.el5 kernel. Traced it to a garbage-in/garbage-out\nioctl condition in the aacraid driver.\n\nAdaptec's special ioctl scb passthrough needs to check the validity of\nthe individual scatter gather count fields to the maximum the adapter\nsupports. Doing so will have the side effect of preventing\ncopy_from_user() from bugging out while populating the dma buffers.\nThis is a hardening effort, issue was triggered by an errant version\nof the management tools and thus the BUG should not be seen in the\nfield.\n\n[jejb: fixed up compile failure]\nSigned-off-by: Mark Salyzyn <aacraid@adaptec.com>\nSigned-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>",
  "author_name": "Mark Salyzyn",
  "author_email": "Mark_Salyzyn@adaptec.com",
  "author_date": "Wed May 28 15:32:55 2008 -0400",
  "author_date_iso": "2008-05-28T15:32:55-04:00",
  "committer_name": "James Bottomley",
  "committer_email": "James.Bottomley@HansenPartnership.com",
  "committer_date": "Sat Jul 12 08:22:24 2008 -0500",
  "committer_date_iso": "2008-07-12T08:22:24-05:00",
  "files_changed": [
    "drivers/scsi/aacraid/commctrl.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/scsi/aacraid/commctrl.c",
      "insertions": 33,
      "deletions": 0
    }
  ],
  "total_insertions": 33,
  "total_deletions": 0,
  "total_changes": 33,
  "parents": [
    "597136ab70a6dccba5c40ee6eed88e881412429b"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.27",
    "v2.6.27-rc1",
    "v2.6.27-rc2",
    "v2.6.27-rc3",
    "v2.6.27-rc4",
    "v2.6.27-rc5",
    "v2.6.27-rc6",
    "v2.6.27-rc7",
    "v2.6.27-rc8",
    "v2.6.27-rc9"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/scsi/aacraid/commctrl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}