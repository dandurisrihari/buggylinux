commit 6ce2082fd3a25d5a8c756120959237cace0379f1
Author: Jani Nikula <jani.nikula@intel.com>
Date:   Tue Aug 13 15:12:35 2024 +0300

    fault-inject: improve build for CONFIG_FAULT_INJECTION=n
    
    The fault-inject.h users across the kernel need to add a lot of #ifdef
    CONFIG_FAULT_INJECTION to cater for shortcomings in the header.  Make
    fault-inject.h self-contained for CONFIG_FAULT_INJECTION=n, and add stubs
    for DECLARE_FAULT_ATTR(), setup_fault_attr(), should_fail_ex(), and
    should_fail() to allow removal of conditional compilation.
    
    [akpm@linux-foundation.org: repair fallout from no longer including debugfs.h into fault-inject.h]
    [akpm@linux-foundation.org: fix drivers/misc/xilinx_tmr_inject.c]
    [akpm@linux-foundation.org: Add debugfs.h inclusion to more files, per Stephen]
    Link: https://lkml.kernel.org/r/20240813121237.2382534-1-jani.nikula@intel.com
    Fixes: 6ff1cb355e62 ("[PATCH] fault-injection capabilities infrastructure")
    Signed-off-by: Jani Nikula <jani.nikula@intel.com>
    Cc: Akinobu Mita <akinobu.mita@gmail.com>
    Cc: Abhinav Kumar <quic_abhinavk@quicinc.com>
    Cc: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>
    Cc: Himal Prasad Ghimiray <himal.prasad.ghimiray@intel.com>
    Cc: Lucas De Marchi <lucas.demarchi@intel.com>
    Cc: Rob Clark <robdclark@gmail.com>
    Cc: Rodrigo Vivi <rodrigo.vivi@intel.com>
    Cc: Thomas Hellstr√∂m <thomas.hellstrom@linux.intel.com>
    Cc: Stephen Rothwell <sfr@canb.auug.org.au>
    Signed-off-by: Andrew Morton <akpm@linux-foundation.org>

diff --git a/lib/fault-inject.c b/lib/fault-inject.c
index d608f9b48c10..52eb6ba29698 100644
--- a/lib/fault-inject.c
+++ b/lib/fault-inject.c
@@ -2,6 +2,7 @@
 #include <linux/kernel.h>
 #include <linux/init.h>
 #include <linux/random.h>
+#include <linux/debugfs.h>
 #include <linux/sched.h>
 #include <linux/stat.h>
 #include <linux/types.h>