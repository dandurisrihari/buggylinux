{
  "hash": "6ce2082fd3a25d5a8c756120959237cace0379f1",
  "hash_short": "6ce2082f",
  "subject": "fault-inject: improve build for CONFIG_FAULT_INJECTION=n",
  "body": "The fault-inject.h users across the kernel need to add a lot of #ifdef\nCONFIG_FAULT_INJECTION to cater for shortcomings in the header.  Make\nfault-inject.h self-contained for CONFIG_FAULT_INJECTION=n, and add stubs\nfor DECLARE_FAULT_ATTR(), setup_fault_attr(), should_fail_ex(), and\nshould_fail() to allow removal of conditional compilation.\n\n[akpm@linux-foundation.org: repair fallout from no longer including debugfs.h into fault-inject.h]\n[akpm@linux-foundation.org: fix drivers/misc/xilinx_tmr_inject.c]\n[akpm@linux-foundation.org: Add debugfs.h inclusion to more files, per Stephen]\nLink: https://lkml.kernel.org/r/20240813121237.2382534-1-jani.nikula@intel.com\nFixes: 6ff1cb355e62 (\"[PATCH] fault-injection capabilities infrastructure\")\nSigned-off-by: Jani Nikula <jani.nikula@intel.com>\nCc: Akinobu Mita <akinobu.mita@gmail.com>\nCc: Abhinav Kumar <quic_abhinavk@quicinc.com>\nCc: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>\nCc: Himal Prasad Ghimiray <himal.prasad.ghimiray@intel.com>\nCc: Lucas De Marchi <lucas.demarchi@intel.com>\nCc: Rob Clark <robdclark@gmail.com>\nCc: Rodrigo Vivi <rodrigo.vivi@intel.com>\nCc: Thomas Hellstr\u00f6m <thomas.hellstrom@linux.intel.com>\nCc: Stephen Rothwell <sfr@canb.auug.org.au>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>",
  "full_message": "fault-inject: improve build for CONFIG_FAULT_INJECTION=n\n\nThe fault-inject.h users across the kernel need to add a lot of #ifdef\nCONFIG_FAULT_INJECTION to cater for shortcomings in the header.  Make\nfault-inject.h self-contained for CONFIG_FAULT_INJECTION=n, and add stubs\nfor DECLARE_FAULT_ATTR(), setup_fault_attr(), should_fail_ex(), and\nshould_fail() to allow removal of conditional compilation.\n\n[akpm@linux-foundation.org: repair fallout from no longer including debugfs.h into fault-inject.h]\n[akpm@linux-foundation.org: fix drivers/misc/xilinx_tmr_inject.c]\n[akpm@linux-foundation.org: Add debugfs.h inclusion to more files, per Stephen]\nLink: https://lkml.kernel.org/r/20240813121237.2382534-1-jani.nikula@intel.com\nFixes: 6ff1cb355e62 (\"[PATCH] fault-injection capabilities infrastructure\")\nSigned-off-by: Jani Nikula <jani.nikula@intel.com>\nCc: Akinobu Mita <akinobu.mita@gmail.com>\nCc: Abhinav Kumar <quic_abhinavk@quicinc.com>\nCc: Dmitry Baryshkov <dmitry.baryshkov@linaro.org>\nCc: Himal Prasad Ghimiray <himal.prasad.ghimiray@intel.com>\nCc: Lucas De Marchi <lucas.demarchi@intel.com>\nCc: Rob Clark <robdclark@gmail.com>\nCc: Rodrigo Vivi <rodrigo.vivi@intel.com>\nCc: Thomas Hellstr\u00f6m <thomas.hellstrom@linux.intel.com>\nCc: Stephen Rothwell <sfr@canb.auug.org.au>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>",
  "author_name": "Jani Nikula",
  "author_email": "jani.nikula@intel.com",
  "author_date": "Tue Aug 13 15:12:35 2024 +0300",
  "author_date_iso": "2024-08-13T15:12:35+03:00",
  "committer_name": "Andrew Morton",
  "committer_email": "akpm@linux-foundation.org",
  "committer_date": "Sun Sep 1 20:43:33 2024 -0700",
  "committer_date_iso": "2024-09-01T20:43:33-07:00",
  "files_changed": [
    "drivers/gpu/drm/msm/msm_drv.c",
    "drivers/iommu/iommufd/selftest.c",
    "drivers/misc/xilinx_tmr_inject.c",
    "drivers/nvme/host/fault_inject.c",
    "drivers/ufs/core/ufs-fault-injection.c",
    "include/linux/fault-inject.h",
    "include/linux/mmc/host.h",
    "include/ufs/ufshcd.h",
    "kernel/futex/core.c",
    "lib/fault-inject.c",
    "mm/fail_page_alloc.c",
    "mm/failslab.c"
  ],
  "files_changed_count": 12,
  "stats": [
    {
      "file": "drivers/gpu/drm/msm/msm_drv.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/iommu/iommufd/selftest.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/misc/xilinx_tmr_inject.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/nvme/host/fault_inject.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/ufs/core/ufs-fault-injection.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/linux/fault-inject.h",
      "insertions": 29,
      "deletions": 7
    },
    {
      "file": "include/linux/mmc/host.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/ufs/ufshcd.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "kernel/futex/core.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "lib/fault-inject.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "mm/fail_page_alloc.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "mm/failslab.c",
      "insertions": 1,
      "deletions": 0
    }
  ],
  "total_insertions": 40,
  "total_deletions": 7,
  "total_changes": 47,
  "parents": [
    "a15bec6a8f2f177e6c1388f23d02436e27994299"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/ufs/core/ufs-fault-injection.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/fault_inject.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/fault-inject.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/msm/msm_drv.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/misc/xilinx_tmr_inject.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/mmc/host.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/iommu/iommufd/selftest.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/ufs/ufshcd.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/fail_page_alloc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "kernel/futex/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "lib/fault-inject.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/failslab.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}