commit 34bc085c839cef85e3e795b1cee29514f69c3081
Author: Herbert Xu <herbert@gondor.apana.org.au>
Date:   Wed Nov 30 21:14:07 2016 +0800

    crypto: skcipher - Add separate walker for AEAD decryption
    
    The AEAD decrypt interface includes the authentication tag in
    req->cryptlen.  Therefore we need to exlucde that when doing
    a walk over it.
    
    This patch adds separate walker functions for AEAD encryption
    and decryption.
    
    Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
    Reviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>

diff --git a/include/crypto/internal/skcipher.h b/include/crypto/internal/skcipher.h
index d55041f45899..8735979ed341 100644
--- a/include/crypto/internal/skcipher.h
+++ b/include/crypto/internal/skcipher.h
@@ -149,6 +149,10 @@ int skcipher_walk_async(struct skcipher_walk *walk,
 			struct skcipher_request *req);
 int skcipher_walk_aead(struct skcipher_walk *walk, struct aead_request *req,
 		       bool atomic);
+int skcipher_walk_aead_encrypt(struct skcipher_walk *walk,
+			       struct aead_request *req, bool atomic);
+int skcipher_walk_aead_decrypt(struct skcipher_walk *walk,
+			       struct aead_request *req, bool atomic);
 void skcipher_walk_complete(struct skcipher_walk *walk, int err);
 
 static inline void ablkcipher_request_complete(struct ablkcipher_request *req,