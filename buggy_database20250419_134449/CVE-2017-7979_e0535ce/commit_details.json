{
  "hash": "e0535ce58b92d7baf0b33284a6c4f8f0338f943e",
  "hash_short": "e0535ce5",
  "subject": "net sched actions: allocate act cookie early",
  "body": "Policing filters do not use the TCA_ACT_* enum and the tb[]\nnlattr array in tcf_action_init_1() doesn't get filled for\nthem so we should not try to look for a TCA_ACT_COOKIE\nattribute in the then uninitialized array.\nThe error handling in cookie allocation then calls\ntcf_hash_release() leading to invalid memory access later\non.\nAdditionally, if cookie allocation fails after an already\nexisting non-policing filter has successfully been changed,\ntcf_action_release() should not be called, also we would\nhave to roll back the changes in the error handling, so\ninstead we now allocate the cookie early and assign it on\nsuccess at the end.\n\nCVE-2017-7979\nFixes: 1045ba77a596 (\"net sched actions: Add support for user cookies\")\nSigned-off-by: Wolfgang Bumiller <w.bumiller@proxmox.com>\nAcked-by: Jamal Hadi Salim <jhs@mojatatu.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "net sched actions: allocate act cookie early\n\nPolicing filters do not use the TCA_ACT_* enum and the tb[]\nnlattr array in tcf_action_init_1() doesn't get filled for\nthem so we should not try to look for a TCA_ACT_COOKIE\nattribute in the then uninitialized array.\nThe error handling in cookie allocation then calls\ntcf_hash_release() leading to invalid memory access later\non.\nAdditionally, if cookie allocation fails after an already\nexisting non-policing filter has successfully been changed,\ntcf_action_release() should not be called, also we would\nhave to roll back the changes in the error handling, so\ninstead we now allocate the cookie early and assign it on\nsuccess at the end.\n\nCVE-2017-7979\nFixes: 1045ba77a596 (\"net sched actions: Add support for user cookies\")\nSigned-off-by: Wolfgang Bumiller <w.bumiller@proxmox.com>\nAcked-by: Jamal Hadi Salim <jhs@mojatatu.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Wolfgang Bumiller",
  "author_email": "w.bumiller@proxmox.com",
  "author_date": "Thu Apr 20 14:08:26 2017 +0200",
  "author_date_iso": "2017-04-20T14:08:26+02:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Thu Apr 20 16:32:07 2017 -0400",
  "committer_date_iso": "2017-04-20T16:32:07-04:00",
  "files_changed": [
    "net/sched/act_api.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/sched/act_api.c",
      "insertions": 32,
      "deletions": 23
    }
  ],
  "total_insertions": 32,
  "total_deletions": 23,
  "total_changes": 55,
  "parents": [
    "43af390573ad5539b6087831a1197747a0e672ad"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.11",
    "v4.11-rc8",
    "v4.12",
    "v4.12-rc1",
    "v4.12-rc2",
    "v4.12-rc3",
    "v4.12-rc4",
    "v4.12-rc5",
    "v4.12-rc6",
    "v4.12-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2017-7979"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/sched/act_api.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}