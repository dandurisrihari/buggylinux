{
  "hash": "363895767fbfa05891b0b4d9e06ebde7a10c6a07",
  "hash_short": "36389576",
  "subject": "nvme-tcp: sanitize TLS key handling",
  "body": "There is a difference between TLS configured (ie the user has\nprovisioned/requested a key) and TLS enabled (ie the connection\nis encrypted with TLS). This becomes important for secure concatenation,\nwhere the initial authentication is run on an unencrypted connection\n(ie with TLS configured, but not enabled), and then the queue is reset to\nrun over TLS (ie TLS configured _and_ enabled).\nSo to differentiate between those two states store the generated\nkey in opts->tls_key (as we're using the same TLS key for all queues),\nthe key serial of the resulting TLS handshake in ctrl->tls_pskid\n(to signal that TLS on the admin queue is enabled), and a simple\nflag for the queues to indicated that TLS has been enabled.\n\nSigned-off-by: Hannes Reinecke <hare@kernel.org>\nReviewed-by: Christoph Hellwig <hch@lst.de>\nSigned-off-by: Keith Busch <kbusch@kernel.org>",
  "full_message": "nvme-tcp: sanitize TLS key handling\n\nThere is a difference between TLS configured (ie the user has\nprovisioned/requested a key) and TLS enabled (ie the connection\nis encrypted with TLS). This becomes important for secure concatenation,\nwhere the initial authentication is run on an unencrypted connection\n(ie with TLS configured, but not enabled), and then the queue is reset to\nrun over TLS (ie TLS configured _and_ enabled).\nSo to differentiate between those two states store the generated\nkey in opts->tls_key (as we're using the same TLS key for all queues),\nthe key serial of the resulting TLS handshake in ctrl->tls_pskid\n(to signal that TLS on the admin queue is enabled), and a simple\nflag for the queues to indicated that TLS has been enabled.\n\nSigned-off-by: Hannes Reinecke <hare@kernel.org>\nReviewed-by: Christoph Hellwig <hch@lst.de>\nSigned-off-by: Keith Busch <kbusch@kernel.org>",
  "author_name": "Hannes Reinecke",
  "author_email": "hare@kernel.org",
  "author_date": "Mon Jul 22 14:02:19 2024 +0200",
  "author_date_iso": "2024-07-22T14:02:19+02:00",
  "committer_name": "Keith Busch",
  "committer_email": "kbusch@kernel.org",
  "committer_date": "Thu Aug 22 13:22:41 2024 -0700",
  "committer_date_iso": "2024-08-22T13:22:41-07:00",
  "files_changed": [
    "drivers/nvme/host/core.c",
    "drivers/nvme/host/nvme.h",
    "drivers/nvme/host/sysfs.c",
    "drivers/nvme/host/tcp.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "drivers/nvme/host/core.c",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/nvme/host/nvme.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/nvme/host/sysfs.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/nvme/host/tcp.c",
      "insertions": 40,
      "deletions": 13
    }
  ],
  "total_insertions": 43,
  "total_deletions": 17,
  "total_changes": 60,
  "parents": [
    "79559c75332458985ab8a21f11b08bf7c9b833b0"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "sanitize",
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/nvme/host/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/nvme.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/sysfs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/tcp.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}