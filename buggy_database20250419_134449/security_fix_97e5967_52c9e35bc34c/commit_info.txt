Commit Hash: 97e59672a9d2aec0c27f6cd6a6b0edfdd6e5a85c
Subject: x86/ibt: Add paranoid FineIBT mode


Security Keywords:
- hardening

Full commit message:
x86/ibt: Add paranoid FineIBT mode

Due to concerns about circumvention attacks against FineIBT on 'naked'
ENDBR, add an additional caller side hash check to FineIBT. This
should make it impossible to pivot over such a 'naked' ENDBR
instruction at the cost of an additional load.

The specific pivot reported was against the SYSCALL entry site and
FRED will have all those holes fixed up.

  https://lore.kernel.org/linux-hardening/Z60NwR4w%2F28Z7XUa@ubun/

This specific fineibt_paranoid_start[] sequence was concocted by
Scott.

Suggested-by: Scott Constable <scott.d.constable@intel.com>
Reported-by: Jennifer Miller <jmill@asu.edu>
Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org>
Signed-off-by: Ingo Molnar <mingo@kernel.org>
Reviewed-by: Kees Cook <kees@kernel.org>
Link: https://lore.kernel.org/r/20250224124200.598033084@infradead.org

Metadata:
Author: Peter Zijlstra <peterz@infradead.org>
Author Date: Wed Feb 26 12:25:17 2025 +0100
Committer: Ingo Molnar <mingo@kernel.org>
Commit Date: Wed Feb 26 12:27:45 2025 +0100

Files Changed: 1
Lines Added: 138
Lines Removed: 6
Total Changes: 144
