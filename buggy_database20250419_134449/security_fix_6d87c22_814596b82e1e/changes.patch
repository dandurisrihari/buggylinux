diff --cc fs/ceph/inode.c
index e4fff9ff1c27,0901f38547fe..04c89c266cec
--- a/fs/ceph/inode.c
+++ b/fs/ceph/inode.c
@@@ -818,10 -867,9 +867,9 @@@ static int fill_inode(struct inode *ino
  			ci->i_snap_caps |= le32_to_cpu(info->cap.caps);
  			if (cap_fmode >= 0)
  				__ceph_get_fmode(ci, cap_fmode);
- 			spin_unlock(&ci->i_ceph_lock);
  		}
  	} else if (cap_fmode >= 0) {
 -		pr_warning("mds issued no caps on %llx.%llx\n",
 +		pr_warn("mds issued no caps on %llx.%llx\n",
  			   ceph_vinop(inode));
  		__ceph_get_fmode(ci, cap_fmode);
  	}