Commit Hash: e8ed90a6d9a478938ef967a474a5c2a398759f4d
Subject: f2fs: keep isize once block is reserved cross EOF


Security Keywords:
- injection

Full commit message:
f2fs: keep isize once block is reserved cross EOF

Without FADVISE_KEEP_SIZE_BIT, we will try to recover file size
according to last non-hole block, so in fallocate(), we must set
FADVISE_KEEP_SIZE_BIT flag once we have preallocated block cross
EOF, instead of when all preallocation is success. Otherwise, file
size will be incorrect due to lack of this flag.

Simple testcase to reproduce this:

1. echo 2 > /sys/fs/f2fs/<device>/inject_type
2. echo 10 > /sys/fs/f2fs/<device>/inject_rate
3. run tests/generic/392
4. disable fault injection
5. do remount

Signed-off-by: Chao Yu <yuchao0@huawei.com>
Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>

Metadata:
Author: Chao Yu <yuchao0@huawei.com>
Author Date: Sun Nov 5 21:53:30 2017 +0800
Committer: Jaegeuk Kim <jaegeuk@kernel.org>
Commit Date: Mon Nov 6 17:00:09 2017 -0800

Files Changed: 1
Lines Added: 6
Lines Removed: 4
Total Changes: 10
