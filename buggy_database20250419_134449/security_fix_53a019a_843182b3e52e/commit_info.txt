Commit Hash: 53a019a951fae849471e4a620948c5f6886bd1a4
Subject: x86: Fix insn decoder for longer instruction


Security Keywords:
- hardening

Full commit message:
x86: Fix insn decoder for longer instruction

Fix x86 insn decoder for hardening against invalid length
instructions. This adds length checkings for each byte-read
site and if it exceeds MAX_INSN_SIZE, returns immediately.
This can happen when decoding user-space binary.

Caller can check whether it happened by checking insn.*.got
member is set or not.

Signed-off-by: Masami Hiramatsu <masami.hiramatsu.pt@hitachi.com>
Cc: Stephane Eranian <eranian@google.com>
Cc: Andi Kleen <andi@firstfloor.org>
Cc: acme@redhat.com
Cc: ming.m.lin@intel.com
Cc: robert.richter@amd.com
Cc: ravitillo@lbl.gov
Cc: yrl.pp-manager.tt@hitachi.com
Cc: Peter Zijlstra <peterz@infradead.org>
Cc: Srikar Dronamraju <srikar@linux.vnet.ibm.com>
Cc: Peter Zijlstra <peterz@infradead.org>
Link: http://lkml.kernel.org/r/20111007133155.10933.58577.stgit@localhost.localdomain
Signed-off-by: Ingo Molnar <mingo@elte.hu>

Metadata:
Author: Masami Hiramatsu <masami.hiramatsu.pt@hitachi.com>
Author Date: Fri Oct 7 22:31:55 2011 +0900
Committer: Ingo Molnar <mingo@elte.hu>
Commit Date: Mon Oct 10 09:05:51 2011 +0200

Files Changed: 1
Lines Added: 43
Lines Removed: 5
Total Changes: 48
