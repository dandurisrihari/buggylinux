Commit Hash: 699bb2e0c6f3796549dabac329501df7ffd99439
Subject: KVM: arm64: Move vcpu PC/Exception flags to the input flag set


Security Keywords:
- injection

Full commit message:
KVM: arm64: Move vcpu PC/Exception flags to the input flag set

The PC update flags (which also deal with exception injection)
is one of the most complicated use of the flag we have. Make it
more fool prof by:

- moving it over to the new accessors and assign it to the
  input flag set

- turn the combination of generic ELx flags with another flag
  indicating the target EL itself into an explicit set of
  flags for each EL and vector combination

- add a new accessor to pend the exception

This is otherwise a pretty straightformward conversion.

Reviewed-by: Fuad Tabba <tabba@google.com>
Reviewed-by: Reiji Watanabe <reijiw@google.com>
Signed-off-by: Marc Zyngier <maz@kernel.org>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Sat May 28 12:38:18 2022 +0100
Committer: Marc Zyngier <maz@kernel.org>
Commit Date: Fri Jun 10 09:54:34 2022 +0100

Files Changed: 6
Lines Added: 61
Lines Removed: 54
Total Changes: 115
