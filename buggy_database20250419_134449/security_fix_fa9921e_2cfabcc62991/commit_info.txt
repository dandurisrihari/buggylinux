Commit Hash: fa9921e46fd52b78070dc67ce0d27ec301a90410
Subject: ipsec: allow to align IPv4 AH on 32 bits


Security Keywords:
- authentication

Full commit message:
ipsec: allow to align IPv4 AH on 32 bits

The Linux IPv4 AH stack aligns the AH header on a 64 bit boundary
(like in IPv6). This is not RFC compliant (see RFC4302, Section
3.3.3.2.1), it should be aligned on 32 bits.

For most of the authentication algorithms, the ICV size is 96 bits.
The AH header alignment on 32 or 64 bits gives the same results.

However for SHA-256-128 for instance, the wrong 64 bit alignment results
in adding useless padding in IPv4 AH, which is forbidden by the RFC.

To avoid breaking backward compatibility, we use a new flag
(XFRM_STATE_ALIGN4) do change original behavior.

Initial patch from Dang Hongwu <hongwu.dang@6wind.com> and
Christophe Gouault <christophe.gouault@6wind.com>.

Signed-off-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Nicolas Dichtel <nicolas.dichtel@6wind.com>
Author Date: Wed Feb 2 06:29:02 2011 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Tue Feb 8 14:00:40 2011 -0800

Files Changed: 3
Lines Added: 21
Lines Removed: 6
Total Changes: 27
