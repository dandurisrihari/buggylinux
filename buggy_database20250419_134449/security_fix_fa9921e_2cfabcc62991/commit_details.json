{
  "hash": "fa9921e46fd52b78070dc67ce0d27ec301a90410",
  "hash_short": "fa9921e4",
  "subject": "ipsec: allow to align IPv4 AH on 32 bits",
  "body": "The Linux IPv4 AH stack aligns the AH header on a 64 bit boundary\n(like in IPv6). This is not RFC compliant (see RFC4302, Section\n3.3.3.2.1), it should be aligned on 32 bits.\n\nFor most of the authentication algorithms, the ICV size is 96 bits.\nThe AH header alignment on 32 or 64 bits gives the same results.\n\nHowever for SHA-256-128 for instance, the wrong 64 bit alignment results\nin adding useless padding in IPv4 AH, which is forbidden by the RFC.\n\nTo avoid breaking backward compatibility, we use a new flag\n(XFRM_STATE_ALIGN4) do change original behavior.\n\nInitial patch from Dang Hongwu <hongwu.dang@6wind.com> and\nChristophe Gouault <christophe.gouault@6wind.com>.\n\nSigned-off-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "ipsec: allow to align IPv4 AH on 32 bits\n\nThe Linux IPv4 AH stack aligns the AH header on a 64 bit boundary\n(like in IPv6). This is not RFC compliant (see RFC4302, Section\n3.3.3.2.1), it should be aligned on 32 bits.\n\nFor most of the authentication algorithms, the ICV size is 96 bits.\nThe AH header alignment on 32 or 64 bits gives the same results.\n\nHowever for SHA-256-128 for instance, the wrong 64 bit alignment results\nin adding useless padding in IPv4 AH, which is forbidden by the RFC.\n\nTo avoid breaking backward compatibility, we use a new flag\n(XFRM_STATE_ALIGN4) do change original behavior.\n\nInitial patch from Dang Hongwu <hongwu.dang@6wind.com> and\nChristophe Gouault <christophe.gouault@6wind.com>.\n\nSigned-off-by: Nicolas Dichtel <nicolas.dichtel@6wind.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Nicolas Dichtel",
  "author_email": "nicolas.dichtel@6wind.com",
  "author_date": "Wed Feb 2 06:29:02 2011 +0000",
  "author_date_iso": "2011-02-02T06:29:02+00:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Tue Feb 8 14:00:40 2011 -0800",
  "committer_date_iso": "2011-02-08T14:00:40-08:00",
  "files_changed": [
    "include/linux/xfrm.h",
    "include/net/xfrm.h",
    "net/ipv4/ah4.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "include/linux/xfrm.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/net/xfrm.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/ipv4/ah4.c",
      "insertions": 19,
      "deletions": 6
    }
  ],
  "total_insertions": 21,
  "total_deletions": 6,
  "total_changes": 27,
  "parents": [
    "c0c84ef5c130f8871adbdaac2ba824b9195cb6d9"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.39",
    "v2.6.39-rc1",
    "v2.6.39-rc2",
    "v2.6.39-rc3",
    "v2.6.39-rc4",
    "v2.6.39-rc5",
    "v2.6.39-rc6",
    "v2.6.39-rc7",
    "v3.0",
    "v3.0-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/linux/xfrm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/net/xfrm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/ah4.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}