Commit Hash: 554086d85e71f30abe46fc014fea31929a7c6a8a
Subject: x86_32, entry: Do syscall exit work on badsys (CVE-2014-4508)

CVE Identifiers:
- CVE-2014-4508
- CVE-2014-4508
- CVE-2014-4508

Full commit message:
x86_32, entry: Do syscall exit work on badsys (CVE-2014-4508)

The bad syscall nr paths are their own incomprehensible route
through the entry control flow.  Rearrange them to work just like
syscalls that return -ENOSYS.

This fixes an OOPS in the audit code when fast-path auditing is
enabled and sysenter gets a bad syscall nr (CVE-2014-4508).

This has probably been broken since Linux 2.6.27:
af0575bba0 i386 syscall audit fast-path

Cc: stable@vger.kernel.org
Cc: Roland McGrath <roland@redhat.com>
Reported-by: Toralf FÃ¶rster <toralf.foerster@gmx.de>
Signed-off-by: Andy Lutomirski <luto@amacapital.net>
Link: http://lkml.kernel.org/r/e09c499eade6fc321266dd6b54da7beb28d6991c.1403558229.git.luto@amacapital.net
Signed-off-by: H. Peter Anvin <hpa@linux.intel.com>

Metadata:
Author: Andy Lutomirski <luto@amacapital.net>
Author Date: Mon Jun 23 14:22:15 2014 -0700
Committer: H. Peter Anvin <hpa@linux.intel.com>
Commit Date: Mon Jun 23 14:59:26 2014 -0700

Files Changed: 1
Lines Added: 8
Lines Removed: 2
Total Changes: 10
