Commit Hash: e547bc1eccf539b7403138d8ded913ffd2b7fd0d
Subject: tcp: Use correct peer adr when copying MD5 keys


Security Keywords:
- authentication

Full commit message:
tcp: Use correct peer adr when copying MD5 keys

When the TCP connection handshake completes on the passive
side, a variety of state must be set up in the "child" sock,
including the key if MD5 authentication is being used.  Fix TCP
for both address families to label the key with the peer's
destination address, rather than the address from the listening
sock, which is usually the wildcard.

Reported-by:   Stephen Hemminger <shemminger@vyatta.com>
Signed-off-by: John Dykstra <john.dykstra1@gmail.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: John Dykstra <john.dykstra1@gmail.com>
Author Date: Fri Jul 17 09:23:22 2009 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Jul 20 07:49:08 2009 -0700

Files Changed: 2
Lines Added: 2
Lines Removed: 2
Total Changes: 4
