{
  "hash": "913a3aa07d16e5b302f408d497a4b829910de247",
  "hash_short": "913a3aa0",
  "subject": "crypto: arm/aes - add some hardening against cache-timing attacks",
  "body": "Make the ARM scalar AES implementation closer to constant-time by\ndisabling interrupts and prefetching the tables into L1 cache.  This is\nfeasible because due to ARM's \"free\" rotations, the main tables are only\n1024 bytes instead of the usual 4096 used by most AES implementations.\n\nOn ARM Cortex-A7, the speed loss is only about 5%.  The resulting code\nis still over twice as fast as aes_ti.c.  Responsiveness is potentially\na concern, but interrupts are only disabled for a single AES block.\n\nNote that even after these changes, the implementation still isn't\nnecessarily guaranteed to be constant-time; see\nhttps://cr.yp.to/antiforgery/cachetiming-20050414.pdf for a discussion\nof the many difficulties involved in writing truly constant-time AES\nsoftware.  But it's valuable to make such attacks more difficult.\n\nMuch of this patch is based on patches suggested by Ard Biesheuvel.\n\nSuggested-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nReviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "crypto: arm/aes - add some hardening against cache-timing attacks\n\nMake the ARM scalar AES implementation closer to constant-time by\ndisabling interrupts and prefetching the tables into L1 cache.  This is\nfeasible because due to ARM's \"free\" rotations, the main tables are only\n1024 bytes instead of the usual 4096 used by most AES implementations.\n\nOn ARM Cortex-A7, the speed loss is only about 5%.  The resulting code\nis still over twice as fast as aes_ti.c.  Responsiveness is potentially\na concern, but interrupts are only disabled for a single AES block.\n\nNote that even after these changes, the implementation still isn't\nnecessarily guaranteed to be constant-time; see\nhttps://cr.yp.to/antiforgery/cachetiming-20050414.pdf for a discussion\nof the many difficulties involved in writing truly constant-time AES\nsoftware.  But it's valuable to make such attacks more difficult.\n\nMuch of this patch is based on patches suggested by Ard Biesheuvel.\n\nSuggested-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nReviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Eric Biggers",
  "author_email": "ebiggers@google.com",
  "author_date": "Wed Oct 17 21:37:59 2018 -0700",
  "author_date_iso": "2018-10-17T21:37:59-07:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Fri Nov 9 17:36:48 2018 +0800",
  "committer_date_iso": "2018-11-09T17:36:48+08:00",
  "files_changed": [
    "arch/arm/crypto/Kconfig",
    "arch/arm/crypto/aes-cipher-core.S",
    "crypto/aes_generic.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "arch/arm/crypto/Kconfig",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "arch/arm/crypto/aes-cipher-core.S",
      "insertions": 52,
      "deletions": 10
    },
    {
      "file": "crypto/aes_generic.c",
      "insertions": 5,
      "deletions": 4
    }
  ],
  "total_insertions": 66,
  "total_deletions": 14,
  "total_changes": 80,
  "parents": [
    "0a6a40c2a8c184a2fb467efacfb1cd338d719e0b"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.0",
    "v5.0-rc1",
    "v5.0-rc2",
    "v5.0-rc3",
    "v5.0-rc4",
    "v5.0-rc5",
    "v5.0-rc6",
    "v5.0-rc7",
    "v5.0-rc8",
    "v5.1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/arm/crypto/Kconfig",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/arm/crypto/aes-cipher-core.S",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "crypto/aes_generic.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}