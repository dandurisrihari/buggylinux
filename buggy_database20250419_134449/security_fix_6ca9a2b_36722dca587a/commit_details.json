{
  "hash": "6ca9a2beb54a385c8cc5e39a9d2ef49945896c64",
  "hash_short": "6ca9a2be",
  "subject": "drm/i915: Unwind i915_gem_init() failure",
  "body": "Since Michal introduced new user controllable errors other than -EIO\nduring i915_gem_init(), we need to actually unwind on the error path as\nwe have to abort the module load (and we expect to do so cleanly!).\n\nAs we now teardown key state and then mark the driver as wedged (on\nEIO), we have to be careful to not allow ourselves to resume and\nunwedge, thus attempting to use the uninitialised driver.\n\nv2: Try not to free driver state for the suppressed EIO\nv3: Use load-fault-injection to test both error/recovery paths.\n\nReferences: 8620eb1dbbf2 (\"drm/i915/uc: Don't use -EIO to report missing firmware\")\nSigned-off-by: Chris Wilson <chris@chris-wilson.co.uk>\nCc: Michal Wajdeczko <michal.wajdeczko@intel.com>\nCc: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>\nCc: Sagar Arun Kamble <sagar.a.kamble@intel.com>\nReviewed-by: Micha\u0142 Winiarski <michal.winiarski@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/20171213134347.4608-1-chris@chris-wilson.co.uk",
  "full_message": "drm/i915: Unwind i915_gem_init() failure\n\nSince Michal introduced new user controllable errors other than -EIO\nduring i915_gem_init(), we need to actually unwind on the error path as\nwe have to abort the module load (and we expect to do so cleanly!).\n\nAs we now teardown key state and then mark the driver as wedged (on\nEIO), we have to be careful to not allow ourselves to resume and\nunwedge, thus attempting to use the uninitialised driver.\n\nv2: Try not to free driver state for the suppressed EIO\nv3: Use load-fault-injection to test both error/recovery paths.\n\nReferences: 8620eb1dbbf2 (\"drm/i915/uc: Don't use -EIO to report missing firmware\")\nSigned-off-by: Chris Wilson <chris@chris-wilson.co.uk>\nCc: Michal Wajdeczko <michal.wajdeczko@intel.com>\nCc: Joonas Lahtinen <joonas.lahtinen@linux.intel.com>\nCc: Sagar Arun Kamble <sagar.a.kamble@intel.com>\nReviewed-by: Micha\u0142 Winiarski <michal.winiarski@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/20171213134347.4608-1-chris@chris-wilson.co.uk",
  "author_name": "Chris Wilson",
  "author_email": "chris@chris-wilson.co.uk",
  "author_date": "Wed Dec 13 13:43:47 2017 +0000",
  "author_date_iso": "2017-12-13T13:43:47+00:00",
  "committer_name": "Chris Wilson",
  "committer_email": "chris@chris-wilson.co.uk",
  "committer_date": "Wed Dec 13 18:53:35 2017 +0000",
  "committer_date_iso": "2017-12-13T18:53:35+00:00",
  "files_changed": [
    "drivers/gpu/drm/i915/i915_gem.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/i915_gem.c",
      "insertions": 66,
      "deletions": 14
    }
  ],
  "total_insertions": 66,
  "total_deletions": 14,
  "total_changes": 80,
  "parents": [
    "31c70f97bec3107805df0f491485e7eacbc3a3ae"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.16-rc1",
    "v4.16-rc2",
    "v4.16-rc3",
    "v4.16-rc4",
    "v4.16-rc5",
    "v4.16-rc6",
    "v4.16-rc7",
    "v4.17",
    "v4.17-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/gpu/drm/i915/i915_gem.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}