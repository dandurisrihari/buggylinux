Commit Hash: c9c4ff12df110feb1b91951010f673f4b16e49e8
Subject: netfs: Move pinning-for-writeback from fscache to netfs


Security Keywords:
- authentication

Full commit message:
netfs: Move pinning-for-writeback from fscache to netfs

Move the resource pinning-for-writeback from fscache code to netfslib code.
This is used to keep a cache backing object pinned whilst we have dirty
pages on the netfs inode in the pagecache such that VM writeback will be
able to reach it.

Whilst we're at it, switch the parameters of netfs_unpin_writeback() to
match ->write_inode() so that it can be used for that directly.

Note that this mechanism could be more generically useful than that for
network filesystems.  Quite often they have to keep around other resources
(e.g. authentication tokens or network connections) until the writeback is
complete.

Signed-off-by: David Howells <dhowells@redhat.com>
Reviewed-by: Jeff Layton <jlayton@kernel.org>
cc: linux-cachefs@redhat.com
cc: linux-fsdevel@vger.kernel.org
cc: linux-mm@kvack.org

Metadata:
Author: David Howells <dhowells@redhat.com>
Author Date: Mon Nov 27 13:58:07 2023 +0000
Committer: David Howells <dhowells@redhat.com>
Commit Date: Sun Dec 24 15:08:49 2023 +0000

Files Changed: 20
Lines Added: 124
Lines Removed: 187
Total Changes: 311
