{
  "hash": "c9c4ff12df110feb1b91951010f673f4b16e49e8",
  "hash_short": "c9c4ff12",
  "subject": "netfs: Move pinning-for-writeback from fscache to netfs",
  "body": "Move the resource pinning-for-writeback from fscache code to netfslib code.\nThis is used to keep a cache backing object pinned whilst we have dirty\npages on the netfs inode in the pagecache such that VM writeback will be\nable to reach it.\n\nWhilst we're at it, switch the parameters of netfs_unpin_writeback() to\nmatch ->write_inode() so that it can be used for that directly.\n\nNote that this mechanism could be more generically useful than that for\nnetwork filesystems.  Quite often they have to keep around other resources\n(e.g. authentication tokens or network connections) until the writeback is\ncomplete.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\nReviewed-by: Jeff Layton <jlayton@kernel.org>\ncc: linux-cachefs@redhat.com\ncc: linux-fsdevel@vger.kernel.org\ncc: linux-mm@kvack.org",
  "full_message": "netfs: Move pinning-for-writeback from fscache to netfs\n\nMove the resource pinning-for-writeback from fscache code to netfslib code.\nThis is used to keep a cache backing object pinned whilst we have dirty\npages on the netfs inode in the pagecache such that VM writeback will be\nable to reach it.\n\nWhilst we're at it, switch the parameters of netfs_unpin_writeback() to\nmatch ->write_inode() so that it can be used for that directly.\n\nNote that this mechanism could be more generically useful than that for\nnetwork filesystems.  Quite often they have to keep around other resources\n(e.g. authentication tokens or network connections) until the writeback is\ncomplete.\n\nSigned-off-by: David Howells <dhowells@redhat.com>\nReviewed-by: Jeff Layton <jlayton@kernel.org>\ncc: linux-cachefs@redhat.com\ncc: linux-fsdevel@vger.kernel.org\ncc: linux-mm@kvack.org",
  "author_name": "David Howells",
  "author_email": "dhowells@redhat.com",
  "author_date": "Mon Nov 27 13:58:07 2023 +0000",
  "author_date_iso": "2023-11-27T13:58:07+00:00",
  "committer_name": "David Howells",
  "committer_email": "dhowells@redhat.com",
  "committer_date": "Sun Dec 24 15:08:49 2023 +0000",
  "committer_date_iso": "2023-12-24T15:08:49+00:00",
  "files_changed": [
    "fs/9p/vfs_addr.c",
    "fs/9p/vfs_inode.c",
    "fs/9p/vfs_super.c",
    "fs/afs/file.c",
    "fs/afs/inode.c",
    "fs/afs/internal.h",
    "fs/afs/super.c",
    "fs/afs/write.c",
    "fs/ceph/cache.h",
    "fs/ceph/inode.c",
    "fs/fs-writeback.c",
    "fs/netfs/Makefile",
    "fs/netfs/fscache_io.c",
    "fs/netfs/misc.c",
    "fs/smb/client/cifsfs.c",
    "fs/smb/client/file.c",
    "include/linux/fs.h",
    "include/linux/fscache.h",
    "include/linux/netfs.h",
    "include/linux/writeback.h"
  ],
  "files_changed_count": 20,
  "stats": [
    {
      "file": "fs/9p/vfs_addr.c",
      "insertions": 9,
      "deletions": 24
    },
    {
      "file": "fs/9p/vfs_inode.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "fs/9p/vfs_super.c",
      "insertions": 2,
      "deletions": 12
    },
    {
      "file": "fs/afs/file.c",
      "insertions": 1,
      "deletions": 7
    },
    {
      "file": "fs/afs/inode.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/afs/internal.h",
      "insertions": 0,
      "deletions": 6
    },
    {
      "file": "fs/afs/super.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/afs/write.c",
      "insertions": 0,
      "deletions": 9
    },
    {
      "file": "fs/ceph/cache.h",
      "insertions": 7,
      "deletions": 16
    },
    {
      "file": "fs/ceph/inode.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "fs/fs-writeback.c",
      "insertions": 5,
      "deletions": 5
    },
    {
      "file": "fs/netfs/Makefile",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "fs/netfs/fscache_io.c",
      "insertions": 0,
      "deletions": 40
    },
    {
      "file": "fs/netfs/misc.c",
      "insertions": 86,
      "deletions": 0
    },
    {
      "file": "fs/smb/client/cifsfs.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "fs/smb/client/file.c",
      "insertions": 2,
      "deletions": 16
    },
    {
      "file": "include/linux/fs.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/fscache.h",
      "insertions": 0,
      "deletions": 42
    },
    {
      "file": "include/linux/netfs.h",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "include/linux/writeback.h",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 124,
  "total_deletions": 187,
  "total_changes": 311,
  "parents": [
    "7eb5b3e3a0a55f2d166ca949ef47ca6e0c704aab"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/9p/vfs_addr.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/9p/vfs_super.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/file.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/9p/vfs_inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/internal.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/write.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/ceph/cache.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/ceph/inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/afs/super.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/netfs/Makefile",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/netfs/misc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/netfs/fscache_io.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/smb/client/cifsfs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/fs-writeback.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/smb/client/file.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/netfs.h",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/writeback.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/fscache.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/fs.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}