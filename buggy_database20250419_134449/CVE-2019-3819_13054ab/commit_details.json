{
  "hash": "13054abbaa4f1fd4e6f3b4b63439ec033b4c8035",
  "hash_short": "13054abb",
  "subject": "HID: debug: fix the ring buffer implementation",
  "body": "Ring buffer implementation in hid_debug_event() and hid_debug_events_read()\nis strange allowing lost or corrupted data. After commit 717adfdaf147\n(\"HID: debug: check length before copy_to_user()\") it is possible to enter\nan infinite loop in hid_debug_events_read() by providing 0 as count, this\nlocks up a system. Fix this by rewriting the ring buffer implementation\nwith kfifo and simplify the code.\n\nThis fixes CVE-2019-3819.\n\nv2: fix an execution logic and add a comment\nv3: use __set_current_state() instead of set_current_state()\n\nLink: https://bugzilla.redhat.com/show_bug.cgi?id=1669187\nCc: stable@vger.kernel.org # v4.18+\nFixes: cd667ce24796 (\"HID: use debugfs for events/reports dumping\")\nFixes: 717adfdaf147 (\"HID: debug: check length before copy_to_user()\")\nSigned-off-by: Vladis Dronov <vdronov@redhat.com>\nReviewed-by: Oleg Nesterov <oleg@redhat.com>\nSigned-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>",
  "full_message": "HID: debug: fix the ring buffer implementation\n\nRing buffer implementation in hid_debug_event() and hid_debug_events_read()\nis strange allowing lost or corrupted data. After commit 717adfdaf147\n(\"HID: debug: check length before copy_to_user()\") it is possible to enter\nan infinite loop in hid_debug_events_read() by providing 0 as count, this\nlocks up a system. Fix this by rewriting the ring buffer implementation\nwith kfifo and simplify the code.\n\nThis fixes CVE-2019-3819.\n\nv2: fix an execution logic and add a comment\nv3: use __set_current_state() instead of set_current_state()\n\nLink: https://bugzilla.redhat.com/show_bug.cgi?id=1669187\nCc: stable@vger.kernel.org # v4.18+\nFixes: cd667ce24796 (\"HID: use debugfs for events/reports dumping\")\nFixes: 717adfdaf147 (\"HID: debug: check length before copy_to_user()\")\nSigned-off-by: Vladis Dronov <vdronov@redhat.com>\nReviewed-by: Oleg Nesterov <oleg@redhat.com>\nSigned-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com>",
  "author_name": "Vladis Dronov",
  "author_email": "vdronov@redhat.com",
  "author_date": "Tue Jan 29 11:58:35 2019 +0100",
  "author_date_iso": "2019-01-29T11:58:35+01:00",
  "committer_name": "Benjamin Tissoires",
  "committer_email": "benjamin.tissoires@redhat.com",
  "committer_date": "Tue Jan 29 12:09:11 2019 +0100",
  "committer_date_iso": "2019-01-29T12:09:11+01:00",
  "files_changed": [
    "drivers/hid/hid-debug.c",
    "include/linux/hid-debug.h"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "drivers/hid/hid-debug.c",
      "insertions": 47,
      "deletions": 73
    },
    {
      "file": "include/linux/hid-debug.h",
      "insertions": 4,
      "deletions": 5
    }
  ],
  "total_insertions": 51,
  "total_deletions": 78,
  "total_changes": 129,
  "parents": [
    "1950f462916edc9581168ca8d5882a8101e8bbcf"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.0",
    "v5.0-rc6",
    "v5.0-rc7",
    "v5.0-rc8",
    "v5.1",
    "v5.1-rc1",
    "v5.1-rc2",
    "v5.1-rc3",
    "v5.1-rc4",
    "v5.1-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2019-3819"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/hid/hid-debug.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/hid-debug.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}