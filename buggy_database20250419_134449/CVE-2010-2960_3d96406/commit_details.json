{
  "hash": "3d96406c7da1ed5811ea52a3b0905f4f0e295376",
  "hash_short": "3d96406c",
  "subject": "KEYS: Fix bug in keyctl_session_to_parent() if parent has no session keyring",
  "body": "Fix a bug in keyctl_session_to_parent() whereby it tries to check the ownership\nof the parent process's session keyring whether or not the parent has a session\nkeyring [CVE-2010-2960].\n\nThis results in the following oops:\n\n  BUG: unable to handle kernel NULL pointer dereference at 00000000000000a0\n  IP: [<ffffffff811ae4dd>] keyctl_session_to_parent+0x251/0x443\n  ...\n  Call Trace:\n   [<ffffffff811ae2f3>] ? keyctl_session_to_parent+0x67/0x443\n   [<ffffffff8109d286>] ? __do_fault+0x24b/0x3d0\n   [<ffffffff811af98c>] sys_keyctl+0xb4/0xb8\n   [<ffffffff81001eab>] system_call_fastpath+0x16/0x1b\n\nif the parent process has no session keyring.\n\nIf the system is using pam_keyinit then it mostly protected against this as all\nprocesses derived from a login will have inherited the session keyring created\nby pam_keyinit during the log in procedure.\n\nTo test this, pam_keyinit calls need to be commented out in /etc/pam.d/.\n\nReported-by: Tavis Ormandy <taviso@cmpxchg8b.com>\nSigned-off-by: David Howells <dhowells@redhat.com>\nAcked-by: Tavis Ormandy <taviso@cmpxchg8b.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "KEYS: Fix bug in keyctl_session_to_parent() if parent has no session keyring\n\nFix a bug in keyctl_session_to_parent() whereby it tries to check the ownership\nof the parent process's session keyring whether or not the parent has a session\nkeyring [CVE-2010-2960].\n\nThis results in the following oops:\n\n  BUG: unable to handle kernel NULL pointer dereference at 00000000000000a0\n  IP: [<ffffffff811ae4dd>] keyctl_session_to_parent+0x251/0x443\n  ...\n  Call Trace:\n   [<ffffffff811ae2f3>] ? keyctl_session_to_parent+0x67/0x443\n   [<ffffffff8109d286>] ? __do_fault+0x24b/0x3d0\n   [<ffffffff811af98c>] sys_keyctl+0xb4/0xb8\n   [<ffffffff81001eab>] system_call_fastpath+0x16/0x1b\n\nif the parent process has no session keyring.\n\nIf the system is using pam_keyinit then it mostly protected against this as all\nprocesses derived from a login will have inherited the session keyring created\nby pam_keyinit during the log in procedure.\n\nTo test this, pam_keyinit calls need to be commented out in /etc/pam.d/.\n\nReported-by: Tavis Ormandy <taviso@cmpxchg8b.com>\nSigned-off-by: David Howells <dhowells@redhat.com>\nAcked-by: Tavis Ormandy <taviso@cmpxchg8b.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "David Howells",
  "author_email": "dhowells@redhat.com",
  "author_date": "Fri Sep 10 09:59:51 2010 +0100",
  "author_date_iso": "2010-09-10T09:59:51+01:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Fri Sep 10 07:30:00 2010 -0700",
  "committer_date_iso": "2010-09-10T07:30:00-07:00",
  "files_changed": [
    "security/keys/keyctl.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "security/keys/keyctl.c",
      "insertions": 2,
      "deletions": 1
    }
  ],
  "total_insertions": 2,
  "total_deletions": 1,
  "total_changes": 3,
  "parents": [
    "9d1ac65a9698513d00e5608d93fca0c53f536c14"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.36",
    "v2.6.36-rc4",
    "v2.6.36-rc5",
    "v2.6.36-rc6",
    "v2.6.36-rc7",
    "v2.6.36-rc8",
    "v2.6.37",
    "v2.6.37-rc1",
    "v2.6.37-rc2",
    "v2.6.37-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2010-2960"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "security/keys/keyctl.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}