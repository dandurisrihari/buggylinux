{
  "hash": "7b119dc06d871405fc7c3e9a73a6c987409ba639",
  "hash_short": "7b119dc0",
  "subject": "mac80211: fix cfg80211 interaction on auth/assoc request",
  "body": "If authentication (or association with FT) is requested by\nuserspace, mac80211 currently doesn't tell cfg80211 that it\ndisconnected from the AP. That leaves inconsistent state:\ncfg80211 thinks it's connected while mac80211 thinks it's\nnot. Typically this won't last long, as soon as mac80211\nreports the new association to cfg80211 the old one goes\naway. If, however, the new authentication or association\ndoesn't succeed, then cfg80211 will forever think the old\none still exists and will refuse attempts to authenticate\nor associate with the AP it thinks it's connected to.\n\nAnders reported that this leads to it taking a very long\ntime to reconnect to a network, or never even succeeding.\nI tested this with an AP hacked to never respond to auth\nframes, and one that works, and with just those two the\nsystem never recovers because one won't work and cfg80211\nthinks it's connected to the other so refuses connections\nto it.\n\nTo fix this, simply make mac80211 tell cfg80211 when it is\nno longer connected to the old AP, while authenticating or\nassociating to a new one.\n\nCc: stable@vger.kernel.org\nReported-by: Anders Kaseorg <andersk@mit.edu>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: fix cfg80211 interaction on auth/assoc request\n\nIf authentication (or association with FT) is requested by\nuserspace, mac80211 currently doesn't tell cfg80211 that it\ndisconnected from the AP. That leaves inconsistent state:\ncfg80211 thinks it's connected while mac80211 thinks it's\nnot. Typically this won't last long, as soon as mac80211\nreports the new association to cfg80211 the old one goes\naway. If, however, the new authentication or association\ndoesn't succeed, then cfg80211 will forever think the old\none still exists and will refuse attempts to authenticate\nor associate with the AP it thinks it's connected to.\n\nAnders reported that this leads to it taking a very long\ntime to reconnect to a network, or never even succeeding.\nI tested this with an AP hacked to never respond to auth\nframes, and one that works, and with just those two the\nsystem never recovers because one won't work and cfg80211\nthinks it's connected to the other so refuses connections\nto it.\n\nTo fix this, simply make mac80211 tell cfg80211 when it is\nno longer connected to the old AP, while authenticating or\nassociating to a new one.\n\nCc: stable@vger.kernel.org\nReported-by: Anders Kaseorg <andersk@mit.edu>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Wed Apr 10 21:38:36 2013 +0200",
  "author_date_iso": "2013-04-10T21:38:36+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Wed Apr 10 21:38:36 2013 +0200",
  "committer_date_iso": "2013-04-10T21:38:36+02:00",
  "files_changed": [
    "net/mac80211/mlme.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/mlme.c",
      "insertions": 20,
      "deletions": 4
    }
  ],
  "total_insertions": 20,
  "total_deletions": 4,
  "total_changes": 24,
  "parents": [
    "62a40a15554d6924a58b3e9f8756e0d683dc9c0c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "auth"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/mlme.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}