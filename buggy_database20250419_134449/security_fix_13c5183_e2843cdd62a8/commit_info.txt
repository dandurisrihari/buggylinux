Commit Hash: 13c5183a4e643cc2b03a22d0e582c8e17bb7457d
Subject: KVM: x86: Protect MSR-based index computations in pmu.h from Spectre-v1/L1TF attacks


Security Keywords:
- vulnerability

Full commit message:
KVM: x86: Protect MSR-based index computations in pmu.h from Spectre-v1/L1TF attacks

This fixes a Spectre-v1/L1TF vulnerability in the get_gp_pmc() and
get_fixed_pmc() functions.
They both contain index computations based on the (attacker-controlled)
MSR number.

Fixes: 25462f7f5295 ("KVM: x86/vPMU: Define kvm_pmu_ops to support vPMU function dispatch")

Signed-off-by: Nick Finco <nifi@google.com>
Signed-off-by: Marios Pomonis <pomonis@google.com>
Reviewed-by: Andrew Honig <ahonig@google.com>
Cc: stable@vger.kernel.org
Reviewed-by: Jim Mattson <jmattson@google.com>
Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Marios Pomonis <pomonis@google.com>
Author Date: Wed Dec 11 12:47:48 2019 -0800
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Mon Jan 27 19:59:40 2020 +0100

Files Changed: 1
Lines Added: 14
Lines Removed: 4
Total Changes: 18
