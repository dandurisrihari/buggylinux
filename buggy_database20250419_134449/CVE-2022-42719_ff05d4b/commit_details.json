{
  "hash": "ff05d4b45dd89b922578dac497dcabf57cf771c6",
  "hash_short": "ff05d4b4",
  "subject": "wifi: mac80211: fix MBSSID parsing use-after-free",
  "body": "When we parse a multi-BSSID element, we might point some\nelement pointers into the allocated nontransmitted_profile.\nHowever, we free this before returning, causing UAF when the\nrelevant pointers in the parsed elements are accessed.\n\nFix this by not allocating the scratch buffer separately but\nas part of the returned structure instead, that way, there\nare no lifetime issues with it.\n\nThe scratch buffer introduction as part of the returned data\nhere is taken from MLO feature work done by Ilan.\n\nThis fixes CVE-2022-42719.\n\nFixes: 5023b14cf4df (\"mac80211: support profile split between elements\")\nCo-developed-by: Ilan Peer <ilan.peer@intel.com>\nSigned-off-by: Ilan Peer <ilan.peer@intel.com>\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: mac80211: fix MBSSID parsing use-after-free\n\nWhen we parse a multi-BSSID element, we might point some\nelement pointers into the allocated nontransmitted_profile.\nHowever, we free this before returning, causing UAF when the\nrelevant pointers in the parsed elements are accessed.\n\nFix this by not allocating the scratch buffer separately but\nas part of the returned structure instead, that way, there\nare no lifetime issues with it.\n\nThe scratch buffer introduction as part of the returned data\nhere is taken from MLO feature work done by Ilan.\n\nThis fixes CVE-2022-42719.\n\nFixes: 5023b14cf4df (\"mac80211: support profile split between elements\")\nCo-developed-by: Ilan Peer <ilan.peer@intel.com>\nSigned-off-by: Ilan Peer <ilan.peer@intel.com>\nReviewed-by: Kees Cook <keescook@chromium.org>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Wed Sep 28 22:07:15 2022 +0200",
  "author_date_iso": "2022-09-28T22:07:15+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Mon Oct 10 09:50:23 2022 +0200",
  "committer_date_iso": "2022-10-10T09:50:23+02:00",
  "files_changed": [
    "net/mac80211/ieee80211_i.h",
    "net/mac80211/util.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "net/mac80211/util.c",
      "insertions": 15,
      "deletions": 15
    }
  ],
  "total_insertions": 23,
  "total_deletions": 15,
  "total_changes": 38,
  "parents": [
    "8f033d2becc24aa6bfd2a5c104407963560caabc"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2022-42719"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/mac80211/ieee80211_i.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/mac80211/util.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}