Commit Hash: cc255c76c70f7a87d97939621eae04b600d9f4a1
Subject: libceph: implement CEPHX_V2 calculation mode

CVE Identifiers:
- CVE-2018-1129

Full commit message:
libceph: implement CEPHX_V2 calculation mode

Derive the signature from the entire buffer (both AES cipher blocks)
instead of using just the first half of the first block, leaving out
data_crc entirely.

This addresses CVE-2018-1129.

Link: http://tracker.ceph.com/issues/24837
Signed-off-by: Ilya Dryomov <idryomov@gmail.com>
Reviewed-by: Sage Weil <sage@redhat.com>

Metadata:
Author: Ilya Dryomov <idryomov@gmail.com>
Author Date: Fri Jul 27 19:25:32 2018 +0200
Committer: Ilya Dryomov <idryomov@gmail.com>
Commit Date: Thu Aug 2 21:33:25 2018 +0200

Files Changed: 2
Lines Added: 60
Lines Removed: 20
Total Changes: 80
