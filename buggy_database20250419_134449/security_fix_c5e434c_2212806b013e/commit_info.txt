Commit Hash: c5e434c98b49f4877ea1614a629499e082b1a818
Subject: knfsd: rpcgss: RPC_GSS_PROC_ DESTROY request will get a bad rpc


Security Keywords:
- authentication

Full commit message:
knfsd: rpcgss: RPC_GSS_PROC_ DESTROY request will get a bad rpc

If I send a RPC_GSS_PROC_DESTROY message to NFSv4 server, it will reply with a
bad rpc reply which lacks an authentication verifier.  Maybe this patch is
needed.

Send/recv packets as following:

send:

RemoteProcedureCall
    xid
    rpcvers = 2
    prog = 100003
    vers = 4
    proc = 0
    cred = AUTH_GSS
        version = 1
        gss_proc = 3 (RPCSEC_GSS_DESTROY)
        service  = 1 (RPC_GSS_SVC_NONE)
    verf = AUTH_GSS
        checksum

reply:

RemoteProcedureReply
    xid
    msg_type
    reply_stat
    accepted_reply

Signed-off-by: Wei Yongjun <yjwei@cn.fujitsu.com>
Signed-off-by: "J. Bruce Fields" <bfields@citi.umich.edu>
Signed-off-by: Neil Brown <neilb@suse.de>
Signed-off-by: Andrew Morton <akpm@linux-foundation.org>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Wei Yongjun <yjwei@cn.fujitsu.com>
Author Date: Wed May 9 02:34:54 2007 -0700
Committer: Linus Torvalds <torvalds@woody.linux-foundation.org>
Commit Date: Wed May 9 12:30:54 2007 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 0
Total Changes: 2
