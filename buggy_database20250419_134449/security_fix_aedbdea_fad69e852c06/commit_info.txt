Commit Hash: aedbdeab00dcfcc6d751f9fb1b4896b01911d494
Subject: x86/mce: Use untraced rd/wrmsr in the MCE offline/crash check


Security Keywords:
- injection

Full commit message:
x86/mce: Use untraced rd/wrmsr in the MCE offline/crash check

mce_check_crashing_cpu() is called right at the entry of the MCE
handler. It uses mce_rdmsr() and mce_wrmsr() which are wrappers around
rdmsr() and wrmsr() to handle the MCE error injection mechanism, which is
pointless in this context, i.e. when the MCE hits an offline CPU or the
system is already marked crashing.

The MSR access can also be traced, so use the untraceable variants. This
is also safe vs. XEN paravirt as these MSRs are not affected by XEN PV
modifications.

Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Reviewed-by: Alexandre Chartre <alexandre.chartre@oracle.com>
Acked-by: Peter Zijlstra <peterz@infradead.org>
Acked-by: Andy Lutomirski <luto@kernel.org>
Link: https://lkml.kernel.org/r/20200505135314.426347351@linutronix.de

Metadata:
Author: Thomas Gleixner <tglx@linutronix.de>
Author Date: Sat Apr 4 15:39:13 2020 +0200
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Thu Jun 11 15:14:57 2020 +0200

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
