Commit Hash: 7992e00469c485f108a7f0da08be34b0fa441f79
Subject: ubifs: Fix memory leak in __ubifs_node_verify_hmac error path


Security Keywords:
- authentication

Full commit message:
ubifs: Fix memory leak in __ubifs_node_verify_hmac error path

In __ubifs_node_verify_hmac(), 'hmac' is allocated through kmalloc().
However, it is not deallocated in the following execution if
ubifs_node_calc_hmac() fails, leading to a memory leak bug. To fix this
issue, free 'hmac' before returning the error.

Fixes: 49525e5eecca ("ubifs: Add helper functions for authentication support")
Signed-off-by: Wenwen Wang <wenwen@cs.uga.edu>
Signed-off-by: Richard Weinberger <richard@nod.at>

Metadata:
Author: Wenwen Wang <wenwen@cs.uga.edu>
Author Date: Mon Aug 19 22:24:50 2019 -0500
Committer: Richard Weinberger <richard@nod.at>
Commit Date: Sun Sep 15 22:11:58 2019 +0200

Files Changed: 1
Lines Added: 3
Lines Removed: 1
Total Changes: 4
