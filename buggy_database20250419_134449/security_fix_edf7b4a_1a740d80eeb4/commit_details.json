{
  "hash": "edf7b4a2d85e37a1ee77156bddaed4aa6af9c5e1",
  "hash_short": "edf7b4a2",
  "subject": "perf bench inject-buildid: Handle writen() errors",
  "body": "The build on fedora:35 and fedora:rawhide with clang is failing with:\n\n  49    41.00 fedora:35                     : FAIL clang version 13.0.0 (Fedora 13.0.0~rc1-1.fc35)\n    bench/inject-buildid.c:351:6: error: variable 'len' set but not used [-Werror,-Wunused-but-set-variable]\n            u64 len = 0;\n                ^\n    1 error generated.\n    make[3]: *** [/git/perf-5.14.0-rc7/tools/build/Makefile.build:139: bench] Error 2\n  50    41.11 fedora:rawhide                : FAIL clang version 13.0.0 (Fedora 13.0.0~rc1-1.fc35)\n    bench/inject-buildid.c:351:6: error: variable 'len' set but not used [-Werror,-Wunused-but-set-variable]\n            u64 len = 0;\n                ^\n    1 error generated.\n    make[3]: *** [/git/perf-5.14.0-rc7/tools/build/Makefile.build:139: bench] Error 2\n\nThat 'len' variable is not used at all, so just make sure all the\nsynthesize_RECORD() routines return ssize_t to propagate the writen()\nreturn, as it may fail, ditch the 'ret' var and bail out if those\nroutines fail.\n\nFixes: 0bf02a0d80427f26 (\"perf bench: Add build-id injection benchmark\")\nAcked-by: Namhyung Kim <namhyung@kernel.org>\nLink: http://lore.kernel.org/lkml/CAM9d7cgEZNSor+B+7Y2C+QYGme_v5aH0Zn0RLfxoQ+Fy83EHrg@mail.gmail.com\nSigned-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>",
  "full_message": "perf bench inject-buildid: Handle writen() errors\n\nThe build on fedora:35 and fedora:rawhide with clang is failing with:\n\n  49    41.00 fedora:35                     : FAIL clang version 13.0.0 (Fedora 13.0.0~rc1-1.fc35)\n    bench/inject-buildid.c:351:6: error: variable 'len' set but not used [-Werror,-Wunused-but-set-variable]\n            u64 len = 0;\n                ^\n    1 error generated.\n    make[3]: *** [/git/perf-5.14.0-rc7/tools/build/Makefile.build:139: bench] Error 2\n  50    41.11 fedora:rawhide                : FAIL clang version 13.0.0 (Fedora 13.0.0~rc1-1.fc35)\n    bench/inject-buildid.c:351:6: error: variable 'len' set but not used [-Werror,-Wunused-but-set-variable]\n            u64 len = 0;\n                ^\n    1 error generated.\n    make[3]: *** [/git/perf-5.14.0-rc7/tools/build/Makefile.build:139: bench] Error 2\n\nThat 'len' variable is not used at all, so just make sure all the\nsynthesize_RECORD() routines return ssize_t to propagate the writen()\nreturn, as it may fail, ditch the 'ret' var and bail out if those\nroutines fail.\n\nFixes: 0bf02a0d80427f26 (\"perf bench: Add build-id injection benchmark\")\nAcked-by: Namhyung Kim <namhyung@kernel.org>\nLink: http://lore.kernel.org/lkml/CAM9d7cgEZNSor+B+7Y2C+QYGme_v5aH0Zn0RLfxoQ+Fy83EHrg@mail.gmail.com\nSigned-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>",
  "author_name": "Arnaldo Carvalho de Melo",
  "author_email": "acme@redhat.com",
  "author_date": "Wed Aug 25 11:50:37 2021 -0300",
  "author_date_iso": "2021-08-25T11:50:37-03:00",
  "committer_name": "Arnaldo Carvalho de Melo",
  "committer_email": "acme@redhat.com",
  "committer_date": "Mon Aug 30 10:06:37 2021 -0300",
  "committer_date_iso": "2021-08-30T10:06:37-03:00",
  "files_changed": [
    "tools/perf/bench/inject-buildid.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "tools/perf/bench/inject-buildid.c",
      "insertions": 30,
      "deletions": 22
    }
  ],
  "total_insertions": 30,
  "total_deletions": 22,
  "total_changes": 52,
  "parents": [
    "cdf32b44678c382a31dc183d9a767306915cda7b"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "inject"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "tools/perf/bench/inject-buildid.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}