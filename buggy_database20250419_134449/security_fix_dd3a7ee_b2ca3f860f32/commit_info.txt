Commit Hash: dd3a7ee91e0ce0b03d22e974a79e8247cc99959b
Subject: hardening: Adjust dependencies in selection of MODVERSIONS


Security Keywords:
- hardening

Full commit message:
hardening: Adjust dependencies in selection of MODVERSIONS

MODVERSIONS recently grew a dependency on !COMPILE_TEST so that Rust
could be more easily tested. However, this introduces a Kconfig warning
when building allmodconfig with a clang version that supports RANDSTRUCT
natively because RANDSTRUCT_FULL and RANDSTRUCT_PERFORMANCE select
MODVERSIONS when MODULES is enabled, bypassing the !COMPILE_TEST
dependency:

  WARNING: unmet direct dependencies detected for MODVERSIONS
    Depends on [n]: MODULES [=y] && !COMPILE_TEST [=y]
    Selected by [y]:
    - RANDSTRUCT_FULL [=y] && (CC_HAS_RANDSTRUCT [=y] || GCC_PLUGINS [=n]) && MODULES [=y]

Add the !COMPILE_TEST dependency to the selections to clear up the
warning.

Fixes: 1f9c4a996756 ("Kbuild: make MODVERSIONS support depend on not being a compile test build")
Signed-off-by: Nathan Chancellor <nathan@kernel.org>
Link: https://lore.kernel.org/r/20240928-fix-randstruct-modversions-kconfig-warning-v1-1-27d3edc8571e@kernel.org
Signed-off-by: Kees Cook <kees@kernel.org>

Metadata:
Author: Nathan Chancellor <nathan@kernel.org>
Author Date: Sat Sep 28 11:13:13 2024 -0700
Committer: Kees Cook <kees@kernel.org>
Commit Date: Sat Sep 28 13:56:03 2024 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
