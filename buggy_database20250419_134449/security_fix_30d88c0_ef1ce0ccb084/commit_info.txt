Commit Hash: 30d88c0e3ace625a92eead9ca0ad94093a8f59fe
Subject: arm64: entry: Apply BP hardening for suspicious interrupts from EL0


Security Keywords:
- hardening

Full commit message:
arm64: entry: Apply BP hardening for suspicious interrupts from EL0

It is possible to take an IRQ from EL0 following a branch to a kernel
address in such a way that the IRQ is prioritised over the instruction
abort. Whilst an attacker would need to get the stars to align here,
it might be sufficient with enough calibration so perform BP hardening
in the rare case that we see a kernel address in the ELR when handling
an IRQ from EL0.

Reported-by: Dan Hettena <dhettena@nvidia.com>
Reviewed-by: Marc Zyngier <marc.zyngier@arm.com>
Signed-off-by: Will Deacon <will.deacon@arm.com>
Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

Metadata:
Author: Will Deacon <will.deacon@arm.com>
Author Date: Fri Feb 2 17:31:40 2018 +0000
Committer: Catalin Marinas <catalin.marinas@arm.com>
Commit Date: Tue Feb 6 22:53:46 2018 +0000

Files Changed: 2
Lines Added: 11
Lines Removed: 0
Total Changes: 11
