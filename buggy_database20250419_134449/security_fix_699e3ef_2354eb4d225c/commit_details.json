{
  "hash": "699e3efd6c645c741ea4d6d58282c56b6d108cf7",
  "hash_short": "699e3efd",
  "subject": "tpm: Add HMAC session start and end functions",
  "body": "Add session  based HMAC  authentication plus parameter  decryption and\nresponse encryption  using AES. The  basic design is to  segregate all\nthe nasty crypto, hash and hmac code into tpm2-sessions.c and export a\nusable API.  The API first of all starts off by gaining a session with\ntpm2_start_auth_session() which  initiates a session with  the TPM and\nallocates  an  opaque  tpm2_auth   structure  to  handle  the  session\nparameters.  The  design is that  session use will be  single threaded\nfrom start to finish under the ops lock, so the tpm2_auth structure is\nstored in struct tpm2_chip to simpify the externally visible API.\n\nThe session can be ended with tpm2_end_auth_session() which is\ndesigned only to be used in error legs.  Ordinarily the further\nsession API (future patches) will end or continue the session\nappropriately without having to call this.\n\nSigned-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>\nReviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org> # crypto API parts\nReviewed-by: Jarkko Sakkinen <jarkko@kernel.org>\nTested-by: Jarkko Sakkinen <jarkko@kernel.org>\nSigned-off-by: Jarkko Sakkinen <jarkko@kernel.org>",
  "full_message": "tpm: Add HMAC session start and end functions\n\nAdd session  based HMAC  authentication plus parameter  decryption and\nresponse encryption  using AES. The  basic design is to  segregate all\nthe nasty crypto, hash and hmac code into tpm2-sessions.c and export a\nusable API.  The API first of all starts off by gaining a session with\ntpm2_start_auth_session() which  initiates a session with  the TPM and\nallocates  an  opaque  tpm2_auth   structure  to  handle  the  session\nparameters.  The  design is that  session use will be  single threaded\nfrom start to finish under the ops lock, so the tpm2_auth structure is\nstored in struct tpm2_chip to simpify the externally visible API.\n\nThe session can be ended with tpm2_end_auth_session() which is\ndesigned only to be used in error legs.  Ordinarily the further\nsession API (future patches) will end or continue the session\nappropriately without having to call this.\n\nSigned-off-by: James Bottomley <James.Bottomley@HansenPartnership.com>\nReviewed-by: Ard Biesheuvel <ard.biesheuvel@linaro.org> # crypto API parts\nReviewed-by: Jarkko Sakkinen <jarkko@kernel.org>\nTested-by: Jarkko Sakkinen <jarkko@kernel.org>\nSigned-off-by: Jarkko Sakkinen <jarkko@kernel.org>",
  "author_name": "James Bottomley",
  "author_email": "James.Bottomley@HansenPartnership.com",
  "author_date": "Mon Apr 29 16:28:03 2024 -0400",
  "author_date_iso": "2024-04-29T16:28:03-04:00",
  "committer_name": "Jarkko Sakkinen",
  "committer_email": "jarkko@kernel.org",
  "committer_date": "Thu May 9 22:30:51 2024 +0300",
  "committer_date_iso": "2024-05-09T22:30:51+03:00",
  "files_changed": [
    "drivers/char/tpm/Kconfig",
    "drivers/char/tpm/tpm-buf.c",
    "drivers/char/tpm/tpm-chip.c",
    "drivers/char/tpm/tpm2-sessions.c",
    "include/linux/tpm.h"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "drivers/char/tpm/Kconfig",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/char/tpm/tpm-buf.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/char/tpm/tpm-chip.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/char/tpm/tpm2-sessions.c",
      "insertions": 285,
      "deletions": 0
    },
    {
      "file": "include/linux/tpm.h",
      "insertions": 34,
      "deletions": 0
    }
  ],
  "total_insertions": 325,
  "total_deletions": 0,
  "total_changes": 325,
  "parents": [
    "033ee84e5f01c86997cde29947805e9781ddf233"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/char/tpm/Kconfig",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/char/tpm/tpm-buf.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/char/tpm/tpm-chip.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/char/tpm/tpm2-sessions.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/tpm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}