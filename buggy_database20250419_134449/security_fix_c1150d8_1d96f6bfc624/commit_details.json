{
  "hash": "c1150d8cf9e9d2b356fab52d79f2366985e5511b",
  "hash_short": "c1150d8c",
  "subject": "[PATCH] KVM: Improve interrupt response",
  "body": "The current interrupt injection mechanism might delay an interrupt under\nthe following circumstances:\n\n - if injection fails because the guest is not interruptible (rflags.IF clear,\n   or after a 'mov ss' or 'sti' instruction).  Userspace can check rflags,\n   but the other cases or not testable under the current API.\n - if injection fails because of a fault during delivery.  This probably\n   never happens under normal guests.\n - if injection fails due to a physical interrupt causing a vmexit so that\n   it can be handled by the host.\n\nIn all cases the guest proceeds without processing the interrupt, reducing\nthe interactive feel and interrupt throughput of the guest.\n\nThis patch fixes the situation by allowing userspace to request an exit\nwhen the 'interrupt window' opens, so that it can re-inject the interrupt\nat the right time.  Guest interactivity is very visibly improved.\n\nSigned-off-by: Dor Laor <dor.laor@qumranet.com>\nSigned-off-by: Avi Kivity <avi@qumranet.com>\nAcked-by: Ingo Molnar <mingo@elte.hu>\nSigned-off-by: Andrew Morton <akpm@osdl.org>\nSigned-off-by: Linus Torvalds <torvalds@osdl.org>",
  "full_message": "[PATCH] KVM: Improve interrupt response\n\nThe current interrupt injection mechanism might delay an interrupt under\nthe following circumstances:\n\n - if injection fails because the guest is not interruptible (rflags.IF clear,\n   or after a 'mov ss' or 'sti' instruction).  Userspace can check rflags,\n   but the other cases or not testable under the current API.\n - if injection fails because of a fault during delivery.  This probably\n   never happens under normal guests.\n - if injection fails due to a physical interrupt causing a vmexit so that\n   it can be handled by the host.\n\nIn all cases the guest proceeds without processing the interrupt, reducing\nthe interactive feel and interrupt throughput of the guest.\n\nThis patch fixes the situation by allowing userspace to request an exit\nwhen the 'interrupt window' opens, so that it can re-inject the interrupt\nat the right time.  Guest interactivity is very visibly improved.\n\nSigned-off-by: Dor Laor <dor.laor@qumranet.com>\nSigned-off-by: Avi Kivity <avi@qumranet.com>\nAcked-by: Ingo Molnar <mingo@elte.hu>\nSigned-off-by: Andrew Morton <akpm@osdl.org>\nSigned-off-by: Linus Torvalds <torvalds@osdl.org>",
  "author_name": "Dor Laor",
  "author_email": "dor.laor@qumranet.com",
  "author_date": "Fri Jan 5 16:36:24 2007 -0800",
  "author_date_iso": "2007-01-05T16:36:24-08:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@woody.osdl.org",
  "committer_date": "Fri Jan 5 23:55:22 2007 -0800",
  "committer_date_iso": "2007-01-05T23:55:22-08:00",
  "files_changed": [
    "drivers/kvm/kvm.h",
    "drivers/kvm/kvm_main.c",
    "drivers/kvm/svm.c",
    "drivers/kvm/vmx.c",
    "include/linux/kvm.h"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "drivers/kvm/kvm.h",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "drivers/kvm/kvm_main.c",
      "insertions": 7,
      "deletions": 4
    },
    {
      "file": "drivers/kvm/svm.c",
      "insertions": 87,
      "deletions": 7
    },
    {
      "file": "drivers/kvm/vmx.c",
      "insertions": 72,
      "deletions": 16
    },
    {
      "file": "include/linux/kvm.h",
      "insertions": 10,
      "deletions": 1
    }
  ],
  "total_insertions": 180,
  "total_deletions": 28,
  "total_changes": 208,
  "parents": [
    "e097f35ce58eb8d687f3a300247cf1a978fcea39"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.20",
    "v2.6.20-rc4",
    "v2.6.20-rc5",
    "v2.6.20-rc6",
    "v2.6.20-rc7",
    "v2.6.21",
    "v2.6.21-rc1",
    "v2.6.21-rc2",
    "v2.6.21-rc3",
    "v2.6.21-rc4"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/kvm/kvm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/kvm/kvm_main.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/kvm/svm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/kvm/vmx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/kvm.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}