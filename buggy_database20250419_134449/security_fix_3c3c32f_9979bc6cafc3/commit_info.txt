Commit Hash: 3c3c32f85b6cc05e5db78693457deff03ac0f434
Subject: ubifs: fix wrong use of crypto_shash_descsize()


Security Keywords:
- authentication

Full commit message:
ubifs: fix wrong use of crypto_shash_descsize()

crypto_shash_descsize() returns the size of the shash_desc context
needed to compute the hash, not the size of the hash itself.

crypto_shash_digestsize() would be correct, or alternatively using
c->hash_len and c->hmac_desc_len which already store the correct values.
But actually it's simpler to just use stack arrays, so do that instead.

Fixes: 49525e5eecca ("ubifs: Add helper functions for authentication support")
Fixes: da8ef65f9573 ("ubifs: Authenticate replayed journal")
Cc: <stable@vger.kernel.org> # v4.20+
Cc: Sascha Hauer <s.hauer@pengutronix.de>
Signed-off-by: Eric Biggers <ebiggers@google.com>
Acked-by: Sascha Hauer <s.hauer@pengutronix.de>
Signed-off-by: Richard Weinberger <richard@nod.at>

Metadata:
Author: Eric Biggers <ebiggers@google.com>
Author Date: Fri May 1 22:59:45 2020 -0700
Committer: Richard Weinberger <richard@nod.at>
Commit Date: Sun May 17 23:38:21 2020 +0200

Files Changed: 2
Lines Added: 6
Lines Removed: 24
Total Changes: 30
