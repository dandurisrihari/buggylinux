Commit Hash: 6719331c2f736fba881f2ce85c8b0e37fe054c46
Subject: mptcp: trigger msk processing even for OoO data


Security Keywords:
- injection

Full commit message:
mptcp: trigger msk processing even for OoO data

This is a prerequisite to allow receiving data from multiple
subflows without re-injection.

Instead of dropping the OoO - "future" data in
subflow_check_data_avail(), call into __mptcp_move_skbs()
and let the msk drop that.

To avoid code duplication factor out the mptcp_subflow_discard_data()
helper.

Note that __mptcp_move_skbs() can now find multiple subflows
with data avail (comprising to-be-discarded data), so must
update the byte counter incrementally.

v1 -> v2:
 - fix checkpatch issues (unsigned -> unsigned int)

Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Reviewed-by: Mat Martineau <mathew.j.martineau@linux.intel.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Paolo Abeni <pabeni@redhat.com>
Author Date: Mon Sep 14 10:01:09 2020 +0200
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Sep 14 13:28:02 2020 -0700

Files Changed: 3
Lines Added: 78
Lines Removed: 42
Total Changes: 120
