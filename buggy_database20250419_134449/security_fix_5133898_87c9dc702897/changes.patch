diff --cc block/genhd.c
index 988ba52fd331,d6a21803a57e..514395361d7c
--- a/block/genhd.c
+++ b/block/genhd.c
@@@ -625,9 -626,7 +625,9 @@@ void del_gendisk(struct gendisk *disk
  	pm_runtime_set_memalloc_noio(disk_to_dev(disk), false);
  	device_del(disk_to_dev(disk));
  
 +	blk_mq_freeze_queue_wait(q);
 +
- 	blk_throtl_cancel_bios(disk->queue);
+ 	blk_throtl_cancel_bios(disk);
  
  	blk_sync_queue(q);
  	blk_flush_integrity();