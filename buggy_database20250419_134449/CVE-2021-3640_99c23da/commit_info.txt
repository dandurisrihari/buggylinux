Commit Hash: 99c23da0eed4fd20cae8243f2b51e10e66aa0951
Subject: Bluetooth: sco: Fix lock_sock() blockage by memcpy_from_msg()

CVE Identifiers:
- CVE-2021-3640

Full commit message:
Bluetooth: sco: Fix lock_sock() blockage by memcpy_from_msg()

The sco_send_frame() also takes lock_sock() during memcpy_from_msg()
call that may be endlessly blocked by a task with userfaultd
technique, and this will result in a hung task watchdog trigger.

Just like the similar fix for hci_sock_sendmsg() in commit
92c685dc5de0 ("Bluetooth: reorganize functions..."), this patch moves
the  memcpy_from_msg() out of lock_sock() for addressing the hang.

This should be the last piece for fixing CVE-2021-3640 after a few
already queued fixes.

Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Marcel Holtmann <marcel@holtmann.org>

Metadata:
Author: Takashi Iwai <tiwai@suse.de>
Author Date: Sat Aug 28 18:18:18 2021 +0200
Committer: Marcel Holtmann <marcel@holtmann.org>
Commit Date: Mon Aug 30 16:47:31 2021 +0200

Files Changed: 1
Lines Added: 16
Lines Removed: 8
Total Changes: 24
