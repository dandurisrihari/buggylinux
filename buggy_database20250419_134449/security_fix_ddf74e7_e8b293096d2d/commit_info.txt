Commit Hash: ddf74e79a54070f277ae520722d3bab7f7a6c67a
Subject: drm/amdgpu/pm: Fix potential Spectre v1


Security Keywords:
- vulnerability
- sanitizing

Full commit message:
drm/amdgpu/pm: Fix potential Spectre v1

idx can be indirectly controlled by user-space, hence leading to a
potential exploitation of the Spectre variant 1 vulnerability.

This issue was detected with the help of Smatch:

drivers/gpu/drm/amd/amdgpu/amdgpu_pm.c:408 amdgpu_set_pp_force_state()
warn: potential spectre issue 'data.states'

Fix this by sanitizing idx before using it to index data.states

Notice that given that speculation windows are large, the policy is
to kill the speculation on the first load and not worry if it can be
completed with a dependent load/store [1].

[1] https://marc.info/?l=linux-kernel&m=152449131114778&w=2

Cc: stable@vger.kernel.org
Signed-off-by: Gustavo A. R. Silva <gustavo@embeddedor.com>
Signed-off-by: Alex Deucher <alexander.deucher@amd.com>

Metadata:
Author: Gustavo A. R. Silva <gustavo@embeddedor.com>
Author Date: Mon Jul 23 11:32:32 2018 -0500
Committer: Alex Deucher <alexander.deucher@amd.com>
Commit Date: Tue Jul 31 16:58:23 2018 -0500

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
