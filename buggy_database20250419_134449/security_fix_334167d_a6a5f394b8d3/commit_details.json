{
  "hash": "334167decf98f01a66c91ea84180c278bc4ad290",
  "hash_short": "334167de",
  "subject": "iwlwifi: mvm: set the correct tid when we flush the MCAST sta",
  "body": "The tid being used for the queue (cab_queue) for the MCAST\nstation has been changed recently to be 0 (for BE).\nThe flush path still flushed only the special tid (15)\nwhich means that the firmware wasn't flushing the right\nqueue and we could get a firmware crash upon remove\nstation if we had an MCAST packet on the ring.\n\nThe current code that flushes queues for a station only\ndifferentiates between internal stations (stations that\naren't instantiated in mac80211, like the MCAST station)\nand the non-internal ones.\nInternal stations can be either: BCAST (beacons), MCAST\n(for cab_queue), GENERAL_PURPOSE (p2p dev, and sniffer\ninjection). The internal stations can use different tids.\n\nTo make the code simpler, just flush all the tids always\nand add the special internal tid (15) for internal\nstations. The firmware will know how to handle this even\nif we hadn't any queue mapped that that tid.\n\nFixes: e340c1a6ef4b (\"iwlwifi: mvm: Correctly set the tid for mcast queue\")\nSigned-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>\nSigned-off-by: Luca Coelho <luciano.coelho@intel.com>",
  "full_message": "iwlwifi: mvm: set the correct tid when we flush the MCAST sta\n\nThe tid being used for the queue (cab_queue) for the MCAST\nstation has been changed recently to be 0 (for BE).\nThe flush path still flushed only the special tid (15)\nwhich means that the firmware wasn't flushing the right\nqueue and we could get a firmware crash upon remove\nstation if we had an MCAST packet on the ring.\n\nThe current code that flushes queues for a station only\ndifferentiates between internal stations (stations that\naren't instantiated in mac80211, like the MCAST station)\nand the non-internal ones.\nInternal stations can be either: BCAST (beacons), MCAST\n(for cab_queue), GENERAL_PURPOSE (p2p dev, and sniffer\ninjection). The internal stations can use different tids.\n\nTo make the code simpler, just flush all the tids always\nand add the special internal tid (15) for internal\nstations. The firmware will know how to handle this even\nif we hadn't any queue mapped that that tid.\n\nFixes: e340c1a6ef4b (\"iwlwifi: mvm: Correctly set the tid for mcast queue\")\nSigned-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>\nSigned-off-by: Luca Coelho <luciano.coelho@intel.com>",
  "author_name": "Emmanuel Grumbach",
  "author_email": "emmanuel.grumbach@intel.com",
  "author_date": "Thu Feb 15 15:48:09 2018 +0200",
  "author_date_iso": "2018-02-15T15:48:09+02:00",
  "committer_name": "Luca Coelho",
  "committer_email": "luciano.coelho@intel.com",
  "committer_date": "Fri Mar 16 12:34:52 2018 +0200",
  "committer_date_iso": "2018-03-16T12:34:52+02:00",
  "files_changed": [
    "drivers/net/wireless/intel/iwlwifi/mvm/tx.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/wireless/intel/iwlwifi/mvm/tx.c",
      "insertions": 4,
      "deletions": 6
    }
  ],
  "total_insertions": 4,
  "total_deletions": 6,
  "total_changes": 10,
  "parents": [
    "87de1201ddaa39d4f3fafa9f35ac143e582517e6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.16",
    "v4.17",
    "v4.17-rc1",
    "v4.17-rc2",
    "v4.17-rc3",
    "v4.17-rc4",
    "v4.17-rc5",
    "v4.17-rc6",
    "v4.17-rc7",
    "v4.18"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/intel/iwlwifi/mvm/tx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}