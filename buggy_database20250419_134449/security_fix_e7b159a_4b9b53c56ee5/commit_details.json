{
  "hash": "e7b159a48ba6f7c243881c7ef3afa6e8785c0826",
  "hash_short": "e7b159a4",
  "subject": "net/tls: remove the record tail optimization",
  "body": "For TLS device offload the tag/message authentication code are\nfilled in by the device. The kernel merely reserves space for\nthem. Because device overwrites it, the contents of the tag make\ndo no matter. Current code tries to save space by reusing the\nheader as the tag. This, however, leads to an additional frag\nbeing created and defeats buffer coalescing (which trickles\nall the way down to the drivers).\n\nRemove this optimization, and try to allocate the space for\nthe tag in the usual way, leave the memory uninitialized.\nIf memory allocation fails rewind the record pointer so that\nwe use the already copied user data as tag.\n\nNote that the optimization was actually buggy, as the tag\nfor TLS 1.2 is 16 bytes, but header is just 13, so the reuse\nmay had looked past the end of the page..\n\nSigned-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>\nReviewed-by: Dirk van der Merwe <dirk.vandermerwe@netronome.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "net/tls: remove the record tail optimization\n\nFor TLS device offload the tag/message authentication code are\nfilled in by the device. The kernel merely reserves space for\nthem. Because device overwrites it, the contents of the tag make\ndo no matter. Current code tries to save space by reusing the\nheader as the tag. This, however, leads to an additional frag\nbeing created and defeats buffer coalescing (which trickles\nall the way down to the drivers).\n\nRemove this optimization, and try to allocate the space for\nthe tag in the usual way, leave the memory uninitialized.\nIf memory allocation fails rewind the record pointer so that\nwe use the already copied user data as tag.\n\nNote that the optimization was actually buggy, as the tag\nfor TLS 1.2 is 16 bytes, but header is just 13, so the reuse\nmay had looked past the end of the page..\n\nSigned-off-by: Jakub Kicinski <jakub.kicinski@netronome.com>\nReviewed-by: Dirk van der Merwe <dirk.vandermerwe@netronome.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Jakub Kicinski",
  "author_email": "jakub.kicinski@netronome.com",
  "author_date": "Fri Sep 6 22:29:59 2019 -0700",
  "author_date_iso": "2019-09-06T22:29:59-07:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Sat Sep 7 18:10:34 2019 +0200",
  "committer_date_iso": "2019-09-07T18:10:34+02:00",
  "files_changed": [
    "net/tls/tls_device.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/tls/tls_device.c",
      "insertions": 47,
      "deletions": 20
    }
  ],
  "total_insertions": 47,
  "total_deletions": 20,
  "total_changes": 67,
  "parents": [
    "d4774ac0d49ae92c5176c9848db555e89a5a4e45"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.4",
    "v5.4-rc1",
    "v5.4-rc2",
    "v5.4-rc3",
    "v5.4-rc4",
    "v5.4-rc5",
    "v5.4-rc6",
    "v5.4-rc7",
    "v5.4-rc8",
    "v5.5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/tls/tls_device.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}