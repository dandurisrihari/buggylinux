diff --cc arch/arm64/kvm/hyp/include/hyp/switch.h
index 4fe217efa218,dc584b0f4f12..f35d5abedf9c
--- a/arch/arm64/kvm/hyp/include/hyp/switch.h
+++ b/arch/arm64/kvm/hyp/include/hyp/switch.h
@@@ -112,22 -148,11 +154,16 @@@ static inline void __deactivate_traps_c
  	write_sysreg(vcpu->arch.mdcr_el2_host, mdcr_el2);
  
  	write_sysreg(0, hstr_el2);
 -	if (kvm_arm_support_pmu_v3())
 -		write_sysreg(0, pmuserenr_el0);
 +	if (kvm_arm_support_pmu_v3()) {
 +		struct kvm_cpu_context *hctxt;
 +
 +		hctxt = &this_cpu_ptr(&kvm_host_data)->host_ctxt;
 +		write_sysreg(ctxt_sys_reg(hctxt, PMUSERENR_EL0), pmuserenr_el0);
 +		vcpu_clear_flag(vcpu, PMUSERENR_ON_CPU);
 +	}
  
- 	if (cpus_have_final_cap(ARM64_SME)) {
- 		sysreg_clear_set_s(SYS_HFGRTR_EL2, 0,
- 				   HFGxTR_EL2_nSMPRI_EL1_MASK |
- 				   HFGxTR_EL2_nTPIDR2_EL0_MASK);
- 		sysreg_clear_set_s(SYS_HFGWTR_EL2, 0,
- 				   HFGxTR_EL2_nSMPRI_EL1_MASK |
- 				   HFGxTR_EL2_nTPIDR2_EL0_MASK);
- 	}
+ 	if (__hfgxtr_traps_required())
+ 		__deactivate_traps_hfgxtr();
  }
  
  static inline void ___activate_traps(struct kvm_vcpu *vcpu)
diff --cc include/linux/arm_ffa.h
index 583fe3b49a49,b9f81035eb41..cc060da51bec
--- a/include/linux/arm_ffa.h
+++ b/include/linux/arm_ffa.h
@@@ -94,9 -94,16 +94,17 @@@
   */
  #define FFA_PAGE_SIZE		SZ_4K
  
+ /*
+  * Minimum buffer size/alignment encodings returned by an FFA_FEATURES
+  * query for FFA_RXTX_MAP.
+  */
+ #define FFA_FEAT_RXTX_MIN_SZ_4K		0
+ #define FFA_FEAT_RXTX_MIN_SZ_64K	1
+ #define FFA_FEAT_RXTX_MIN_SZ_16K	2
+ 
  /* FFA Bus/Device/Driver related */
  struct ffa_device {
 +	u32 id;
  	int vm_id;
  	bool mode_32bit;
  	uuid_t uuid;