{
  "hash": "a4172af3040cdc207f1b60efffcdd219156093c9",
  "hash_short": "a4172af3",
  "subject": "Merge tag 'drm-xe-next-2024-07-30' of https://gitlab.freedesktop.org/drm/xe/kernel into drm-next",
  "body": "drm-xe-next for 6.12\n\nUAPI Changes:\n- Rename xe perf layer as xe observation layer, but was\n  also made available via fixes to previous verison (Ashutosh)\n- Use write-back caching mode for system memory on DGFX,\n  but was also mad available via fixes to previous version (Thomas)\n- Expose SIMD16 EU mask in topology query for userspace to know\n  the type of EU, as available in PVC, Lunar Lake and Battlemage\n  (Lucas)\n- Return ENOBUFS instead of ENOMEM in vm_bind if failure is tied\n  to an array of binds (Matthew Brost)\n\nDriver Changes:\n- Log cleanup moving messages to debug priority (Michal Wajdeczko)\n- Add timeout to fences to adhere to dma_buf rules (Matthew Brost)\n- Rename old engine nomenclature to exec_queue (Matthew Brost)\n- Convert multiple bind ops to 1 job (Matthew Brost)\n- Add error injection for vm bind to help testing error path\n  (Matthew Brost)\n- Fix error handling in page table to propagate correctly\n  to userspace (Matthew Brost)\n- Re-organize and cleanup SR-IOV related registers (Michal Wajdeczko)\n- Make the device write barrier compatible with VF (Michal Wajdeczko)\n- New display workarounds for Battlemage (Matthew  Auld)\n- New media workarounds for Lunar Lake and Battlemage (Ngai-Mint Kwan)\n- New graphics workarounds for Lunar Lake (Bommu Krishnaiah)\n- Tracepoint updates (Matthew Brost, Nirmoy Das)\n- Cleanup the header generation for OOB workarounds (Lucas De Marchi)\n- Fix leaking HDCP-related object (Nirmoy Das)\n- Serialize L2 flushes to avoid races (Tejas Upadhyay)\n- Log pid and comm on job timeout (Jos\u00e9 Roberto de Souza)\n- Simplify boilerplate code for live kunit (Michal Wajdeczko)\n- Improve kunit skips for live kunit (Michal Wajdeczko)\n- Fix xe_sync cleanup when handling xe_exec ioctl (Ashutosh Dixit)\n- Limit fair VF LMEM provisioning (Michal Wajdeczko)\n- New workaround to fence mmio writes in Lunar Lake (Tejas Upadhyay)\n- Warn on writes inaccessible register in VF (Michal Wajdeczko)\n- Fix register lookup in VF (Michal Wajdeczko)\n- Add GSC support for Battlemage (Alexander Usyskin)\n- Fix wedging only the GT in which timeout occurred (Matthew Brost)\n- Block device suspend when wedging (Matthew Brost)\n- Handle compression and migration changes for Battlemage\n  (Akshata Jahagirdar)\n- Limit access of stolen memory for Lunar Lake (Uma Shankar)\n- Fail invalid addresses during user fence creation (Matthew Brost)\n- Refcount xe_file to safely and accurately store fdinfo stats\n  (Umesh Nerlige Ramappa)\n- Cleanup and fix PM reference for TLB invalidation code\n  (Matthew Brost)\n- Fix PM reference handling when communicating with GuC (Matthew Brost)\n- Add new BO flag for 2 MiB alignement and use in VF (Michal Wajdeczko)\n- Simplify MMIO setup for multi-tile platforms (Lucas De Marchi)\n- Add check for uninitialized access to OOB workarounds\n  (Lucas De Marchi)\n- New GSC and HuC firmware blobs for Lunar Lake and Battlemage\n  (Daniele Ceraolo Spurio)\n- Unify mmio wait logic (Gustavo Sousa)\n- Fix off-by-one when processing RTP rules (Lucas De Marchi)\n- Future-proof migrate logic with compressed PAT flag (Matt Roper)\n- Add WA kunit tests for Battlemage (Lucas De Marchi)\n- Test active tracking for workaorunds with kunit (Lucas De Marchi)\n- Add kunit tests for RTP with no actions (Lucas De Marchi)\n- Unify parse of OR rules in RTP (Lucas De Marchi)\n- Add performance tuning for Battlemage (Sai Teja Pottumuttu)\n- Make bit masks unsigned (Geert Uytterhoeven)\n\nSigned-off-by: Dave Airlie <airlied@redhat.com>\n\nFrom: Lucas De Marchi <lucas.demarchi@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/k7xuktfav4zmtxxjr77glu2hszypvzgmzghoumh757nqfnk7kn@ccfi4ts3ytbk",
  "full_message": "Merge tag 'drm-xe-next-2024-07-30' of https://gitlab.freedesktop.org/drm/xe/kernel into drm-next\n\ndrm-xe-next for 6.12\n\nUAPI Changes:\n- Rename xe perf layer as xe observation layer, but was\n  also made available via fixes to previous verison (Ashutosh)\n- Use write-back caching mode for system memory on DGFX,\n  but was also mad available via fixes to previous version (Thomas)\n- Expose SIMD16 EU mask in topology query for userspace to know\n  the type of EU, as available in PVC, Lunar Lake and Battlemage\n  (Lucas)\n- Return ENOBUFS instead of ENOMEM in vm_bind if failure is tied\n  to an array of binds (Matthew Brost)\n\nDriver Changes:\n- Log cleanup moving messages to debug priority (Michal Wajdeczko)\n- Add timeout to fences to adhere to dma_buf rules (Matthew Brost)\n- Rename old engine nomenclature to exec_queue (Matthew Brost)\n- Convert multiple bind ops to 1 job (Matthew Brost)\n- Add error injection for vm bind to help testing error path\n  (Matthew Brost)\n- Fix error handling in page table to propagate correctly\n  to userspace (Matthew Brost)\n- Re-organize and cleanup SR-IOV related registers (Michal Wajdeczko)\n- Make the device write barrier compatible with VF (Michal Wajdeczko)\n- New display workarounds for Battlemage (Matthew  Auld)\n- New media workarounds for Lunar Lake and Battlemage (Ngai-Mint Kwan)\n- New graphics workarounds for Lunar Lake (Bommu Krishnaiah)\n- Tracepoint updates (Matthew Brost, Nirmoy Das)\n- Cleanup the header generation for OOB workarounds (Lucas De Marchi)\n- Fix leaking HDCP-related object (Nirmoy Das)\n- Serialize L2 flushes to avoid races (Tejas Upadhyay)\n- Log pid and comm on job timeout (Jos\u00e9 Roberto de Souza)\n- Simplify boilerplate code for live kunit (Michal Wajdeczko)\n- Improve kunit skips for live kunit (Michal Wajdeczko)\n- Fix xe_sync cleanup when handling xe_exec ioctl (Ashutosh Dixit)\n- Limit fair VF LMEM provisioning (Michal Wajdeczko)\n- New workaround to fence mmio writes in Lunar Lake (Tejas Upadhyay)\n- Warn on writes inaccessible register in VF (Michal Wajdeczko)\n- Fix register lookup in VF (Michal Wajdeczko)\n- Add GSC support for Battlemage (Alexander Usyskin)\n- Fix wedging only the GT in which timeout occurred (Matthew Brost)\n- Block device suspend when wedging (Matthew Brost)\n- Handle compression and migration changes for Battlemage\n  (Akshata Jahagirdar)\n- Limit access of stolen memory for Lunar Lake (Uma Shankar)\n- Fail invalid addresses during user fence creation (Matthew Brost)\n- Refcount xe_file to safely and accurately store fdinfo stats\n  (Umesh Nerlige Ramappa)\n- Cleanup and fix PM reference for TLB invalidation code\n  (Matthew Brost)\n- Fix PM reference handling when communicating with GuC (Matthew Brost)\n- Add new BO flag for 2 MiB alignement and use in VF (Michal Wajdeczko)\n- Simplify MMIO setup for multi-tile platforms (Lucas De Marchi)\n- Add check for uninitialized access to OOB workarounds\n  (Lucas De Marchi)\n- New GSC and HuC firmware blobs for Lunar Lake and Battlemage\n  (Daniele Ceraolo Spurio)\n- Unify mmio wait logic (Gustavo Sousa)\n- Fix off-by-one when processing RTP rules (Lucas De Marchi)\n- Future-proof migrate logic with compressed PAT flag (Matt Roper)\n- Add WA kunit tests for Battlemage (Lucas De Marchi)\n- Test active tracking for workaorunds with kunit (Lucas De Marchi)\n- Add kunit tests for RTP with no actions (Lucas De Marchi)\n- Unify parse of OR rules in RTP (Lucas De Marchi)\n- Add performance tuning for Battlemage (Sai Teja Pottumuttu)\n- Make bit masks unsigned (Geert Uytterhoeven)\n\nSigned-off-by: Dave Airlie <airlied@redhat.com>\n\nFrom: Lucas De Marchi <lucas.demarchi@intel.com>\nLink: https://patchwork.freedesktop.org/patch/msgid/k7xuktfav4zmtxxjr77glu2hszypvzgmzghoumh757nqfnk7kn@ccfi4ts3ytbk",
  "author_name": "Dave Airlie",
  "author_email": "airlied@redhat.com",
  "author_date": "Mon Aug 5 18:47:30 2024 +1000",
  "author_date_iso": "2024-08-05T18:47:30+10:00",
  "committer_name": "Dave Airlie",
  "committer_email": "airlied@redhat.com",
  "committer_date": "Mon Aug 5 18:47:43 2024 +1000",
  "committer_date_iso": "2024-08-05T18:47:43+10:00",
  "files_changed": [
    "drivers/gpu/drm/xe/display/xe_fb_pin.c",
    "drivers/gpu/drm/xe/display/xe_plane_initial.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "drivers/gpu/drm/i915/display/intel_display_wa.h",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/i915/display/intel_fbc.c",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/Makefile",
      "insertions": 5,
      "deletions": 18
    },
    {
      "file": "drivers/gpu/drm/xe/display/intel_fbdev_fb.c",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/display/xe_display_wa.c",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/display/xe_dsb_buffer.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/display/xe_fb_pin.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/display/xe_plane_initial.c",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/regs/xe_gt_regs.h",
      "insertions": 15,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/regs/xe_regs.h",
      "insertions": 8,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/xe/regs/xe_sriov_regs.h",
      "insertions": 0,
      "deletions": 23
    },
    {
      "file": "drivers/gpu/drm/xe/tests/Makefile",
      "insertions": 1,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_bo.c",
      "insertions": 33,
      "deletions": 12
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_bo_test.c",
      "insertions": 0,
      "deletions": 21
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_bo_test.h",
      "insertions": 0,
      "deletions": 14
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_dma_buf.c",
      "insertions": 20,
      "deletions": 6
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_dma_buf_test.c",
      "insertions": 0,
      "deletions": 20
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_dma_buf_test.h",
      "insertions": 0,
      "deletions": 13
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_kunit_helpers.c",
      "insertions": 39,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_kunit_helpers.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_live_test_mod.c",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_migrate.c",
      "insertions": 419,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_migrate_test.c",
      "insertions": 0,
      "deletions": 20
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_migrate_test.h",
      "insertions": 0,
      "deletions": 13
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_mocs.c",
      "insertions": 33,
      "deletions": 11
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_mocs_test.c",
      "insertions": 0,
      "deletions": 21
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_mocs_test.h",
      "insertions": 0,
      "deletions": 14
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_pci.c",
      "insertions": 30,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_pci_test.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_pci_test.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_rtp_test.c",
      "insertions": 197,
      "deletions": 22
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_test.h",
      "insertions": 3,
      "deletions": 7
    },
    {
      "file": "drivers/gpu/drm/xe/tests/xe_wa_test.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_bo.c",
      "insertions": 6,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/xe/xe_bo.h",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/xe_bo_types.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_devcoredump.c",
      "insertions": 2,
      "deletions": 8
    },
    {
      "file": "drivers/gpu/drm/xe/xe_device.c",
      "insertions": 101,
      "deletions": 10
    },
    {
      "file": "drivers/gpu/drm/xe/xe_device.h",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_device_types.h",
      "insertions": 30,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_drm_client.c",
      "insertions": 1,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/xe/xe_exec_queue.c",
      "insertions": 32,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_exec_queue.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_exec_queue_types.h",
      "insertions": 7,
      "deletions": 6
    },
    {
      "file": "drivers/gpu/drm/xe/xe_execlist.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gen_wa_oob.c",
      "insertions": 12,
      "deletions": 4
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt.c",
      "insertions": 54,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_sriov_pf.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_sriov_pf_config.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_sriov_vf.c",
      "insertions": 27,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_sriov_vf.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_tlb_invalidation.c",
      "insertions": 111,
      "deletions": 94
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_tlb_invalidation.h",
      "insertions": 11,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_tlb_invalidation_types.h",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_topology.c",
      "insertions": 22,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/xe/xe_gt_types.h",
      "insertions": 24,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_guc_ct.c",
      "insertions": 10,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_guc_id_mgr.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/xe_guc_submit.c",
      "insertions": 48,
      "deletions": 8
    },
    {
      "file": "drivers/gpu/drm/xe/xe_heci_gsc.c",
      "insertions": 25,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/xe/xe_heci_gsc.h",
      "insertions": 8,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/xe_irq.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_lmtt.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/xe_migrate.c",
      "insertions": 290,
      "deletions": 238
    },
    {
      "file": "drivers/gpu/drm/xe/xe_migrate.h",
      "insertions": 21,
      "deletions": 13
    },
    {
      "file": "drivers/gpu/drm/xe/xe_mmio.c",
      "insertions": 144,
      "deletions": 87
    },
    {
      "file": "drivers/gpu/drm/xe/xe_mmio.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_oa.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_pat.c",
      "insertions": 10,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_pci.c",
      "insertions": 5,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/xe_pm.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_preempt_fence.c",
      "insertions": 9,
      "deletions": 3
    },
    {
      "file": "drivers/gpu/drm/xe/xe_pt.c",
      "insertions": 848,
      "deletions": 462
    },
    {
      "file": "drivers/gpu/drm/xe/xe_pt.h",
      "insertions": 6,
      "deletions": 8
    },
    {
      "file": "drivers/gpu/drm/xe/xe_pt_types.h",
      "insertions": 48,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_query.c",
      "insertions": 3,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_rtp.c",
      "insertions": 12,
      "deletions": 30
    },
    {
      "file": "drivers/gpu/drm/xe/xe_rtp.h",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "drivers/gpu/drm/xe/xe_rtp_helpers.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_sa.c",
      "insertions": 7,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_sriov.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_sync.c",
      "insertions": 8,
      "deletions": 12
    },
    {
      "file": "drivers/gpu/drm/xe/xe_sync.h",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_trace.h",
      "insertions": 52,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_trace_bo.h",
      "insertions": 5,
      "deletions": 5
    },
    {
      "file": "drivers/gpu/drm/xe/xe_tuning.c",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_uc_fw.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_vm.c",
      "insertions": 273,
      "deletions": 426
    },
    {
      "file": "drivers/gpu/drm/xe/xe_vm.h",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_vm_types.h",
      "insertions": 30,
      "deletions": 25
    },
    {
      "file": "drivers/gpu/drm/xe/xe_wa.c",
      "insertions": 15,
      "deletions": 0
    },
    {
      "file": "drivers/gpu/drm/xe/xe_wa.h",
      "insertions": 6,
      "deletions": 1
    },
    {
      "file": "drivers/gpu/drm/xe/xe_wa_oob.rules",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "include/uapi/drm/xe_drm.h",
      "insertions": 13,
      "deletions": 5
    }
  ],
  "total_insertions": 3273,
  "total_deletions": 1739,
  "total_changes": 5012,
  "parents": [
    "de9c2c66ad8e787abec7c9d7eff4f8c3cdd28aed",
    "f2881dfdaaa9ec873dbd383ef5512fc31e576cbb"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/gpu/drm/xe/display/xe_fb_pin.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/gpu/drm/xe/display/xe_plane_initial.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}