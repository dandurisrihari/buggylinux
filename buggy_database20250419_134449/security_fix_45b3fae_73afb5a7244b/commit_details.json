{
  "hash": "45b3fae4675dc1d4ee2d7aefa19d85ee4f891377",
  "hash_short": "45b3fae4",
  "subject": "neighbour: Fix __randomize_layout crash in struct neighbour",
  "body": "Previously, one-element and zero-length arrays were treated as true\nflexible arrays, even though they are actually \"fake\" flex arrays.\nThe __randomize_layout would leave them untouched at the end of the\nstruct, similarly to proper C99 flex-array members.\n\nHowever, this approach changed with commit 1ee60356c2dc (\"gcc-plugins:\nrandstruct: Only warn about true flexible arrays\"). Now, only C99\nflexible-array members will remain untouched at the end of the struct,\nwhile one-element and zero-length arrays will be subject to randomization.\n\nFix a `__randomize_layout` crash in `struct neighbour` by transforming\nzero-length array `primary_key` into a proper C99 flexible-array member.\n\nFixes: 1ee60356c2dc (\"gcc-plugins: randstruct: Only warn about true flexible arrays\")\nCloses: https://lore.kernel.org/linux-hardening/20231124102458.GB1503258@e124191.cambridge.arm.com/\nSigned-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>\nReviewed-by: Kees Cook <keescook@chromium.org>\nTested-by: Joey Gouly <joey.gouly@arm.com>\nLink: https://lore.kernel.org/r/ZWJoRsJGnCPdJ3+2@work\nSigned-off-by: Paolo Abeni <pabeni@redhat.com>",
  "full_message": "neighbour: Fix __randomize_layout crash in struct neighbour\n\nPreviously, one-element and zero-length arrays were treated as true\nflexible arrays, even though they are actually \"fake\" flex arrays.\nThe __randomize_layout would leave them untouched at the end of the\nstruct, similarly to proper C99 flex-array members.\n\nHowever, this approach changed with commit 1ee60356c2dc (\"gcc-plugins:\nrandstruct: Only warn about true flexible arrays\"). Now, only C99\nflexible-array members will remain untouched at the end of the struct,\nwhile one-element and zero-length arrays will be subject to randomization.\n\nFix a `__randomize_layout` crash in `struct neighbour` by transforming\nzero-length array `primary_key` into a proper C99 flexible-array member.\n\nFixes: 1ee60356c2dc (\"gcc-plugins: randstruct: Only warn about true flexible arrays\")\nCloses: https://lore.kernel.org/linux-hardening/20231124102458.GB1503258@e124191.cambridge.arm.com/\nSigned-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>\nReviewed-by: Kees Cook <keescook@chromium.org>\nTested-by: Joey Gouly <joey.gouly@arm.com>\nLink: https://lore.kernel.org/r/ZWJoRsJGnCPdJ3+2@work\nSigned-off-by: Paolo Abeni <pabeni@redhat.com>",
  "author_name": "Gustavo A. R. Silva",
  "author_email": "gustavoars@kernel.org",
  "author_date": "Sat Nov 25 15:33:58 2023 -0600",
  "author_date_iso": "2023-11-25T15:33:58-06:00",
  "committer_name": "Paolo Abeni",
  "committer_email": "pabeni@redhat.com",
  "committer_date": "Tue Nov 28 12:18:29 2023 +0100",
  "committer_date_iso": "2023-11-28T12:18:29+01:00",
  "files_changed": [
    "include/net/neighbour.h"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "include/net/neighbour.h",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "fd7f98b2e12a3d96a92bde6640657ec7116f4372"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/neighbour.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}