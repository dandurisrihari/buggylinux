Commit Hash: 8b0db9db19858b08c46a84540acfd35f6e6487b8
Subject: proc: make check_mem_permission() return an mm_struct on success


Security Keywords:
- security issue
- vulnerability

Full commit message:
proc: make check_mem_permission() return an mm_struct on success

This change allows us to take advantage of access_remote_vm(), which in turn
eliminates a security issue with the mem_write() implementation.

The previous implementation of mem_write() was insecure since the target task
could exec a setuid-root binary between the permission check and the actual
write.  Holding a reference to the target mm_struct eliminates this
vulnerability.

Signed-off-by: Stephen Wilson <wilsons@start.ca>
Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>

Metadata:
Author: Stephen Wilson <wilsons@start.ca>
Author Date: Sun Mar 13 15:49:23 2011 -0400
Committer: Al Viro <viro@zeniv.linux.org.uk>
Commit Date: Wed Mar 23 16:36:59 2011 -0400

Files Changed: 1
Lines Added: 34
Lines Removed: 24
Total Changes: 58
