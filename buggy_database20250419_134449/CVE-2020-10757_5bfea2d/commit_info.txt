Commit Hash: 5bfea2d9b17f1034a68147a8b03b9789af5700f9
Subject: mm: Fix mremap not considering huge pmd devmap

CVE Identifiers:
- CVE-2020-10757

Full commit message:
mm: Fix mremap not considering huge pmd devmap

The original code in mm/mremap.c checks huge pmd by:

		if (is_swap_pmd(*old_pmd) || pmd_trans_huge(*old_pmd)) {

However, a DAX mapped nvdimm is mapped as huge page (by default) but it
is not transparent huge page (_PAGE_PSE | PAGE_DEVMAP).  This commit
changes the condition to include the case.

This addresses CVE-2020-10757.

Fixes: 5c7fb56e5e3f ("mm, dax: dax-pmd vs thp-pmd vs hugetlbfs-pmd")
Cc: <stable@vger.kernel.org>
Reported-by: Fan Yang <Fan_Yang@sjtu.edu.cn>
Signed-off-by: Fan Yang <Fan_Yang@sjtu.edu.cn>
Tested-by: Fan Yang <Fan_Yang@sjtu.edu.cn>
Tested-by: Dan Williams <dan.j.williams@intel.com>
Reviewed-by: Dan Williams <dan.j.williams@intel.com>
Acked-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com>
Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>

Metadata:
Author: Fan Yang <Fan_Yang@sjtu.edu.cn>
Author Date: Thu Jun 4 18:22:07 2020 +0800
Committer: Linus Torvalds <torvalds@linux-foundation.org>
Commit Date: Thu Jun 4 19:05:24 2020 -0700

Files Changed: 2
Lines Added: 2
Lines Removed: 1
Total Changes: 3
