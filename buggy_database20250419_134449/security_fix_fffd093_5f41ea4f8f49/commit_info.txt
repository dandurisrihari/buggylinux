Commit Hash: fffd0934b9390f34bec45762192b7edd3b12b4b5
Subject: cfg80211: rework key operation


Security Keywords:
- authentication

Full commit message:
cfg80211: rework key operation

This reworks the key operation in cfg80211, and now only
allows, from userspace, configuring keys (via nl80211)
after the connection has been established (in managed
mode), the IBSS been joined (in IBSS mode), at any time
(in AP[_VLAN] modes) or never for all the other modes.

In order to do shared key authentication correctly, it
is now possible to give a WEP key to the AUTH command.
To configure static WEP keys, these are given to the
CONNECT or IBSS_JOIN command directly, for a userspace
SME it is assumed it will configure it properly after
the connection has been established.

Since mac80211 used to check the default key in IBSS
mode to see whether or not the network is protected,
it needs an update in that area, as well as an update
to make use of the WEP key passed to auth() for shared
key authentication.

Signed-off-by: Johannes Berg <johannes@sipsolutions.net>
Signed-off-by: John W. Linville <linville@tuxdriver.com>

Metadata:
Author: Johannes Berg <johannes@sipsolutions.net>
Author Date: Wed Jul 8 14:22:54 2009 +0200
Committer: John W. Linville <linville@tuxdriver.com>
Commit Date: Fri Jul 24 15:05:09 2009 -0400

Files Changed: 17
Lines Added: 554
Lines Removed: 161
Total Changes: 715
