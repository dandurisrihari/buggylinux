{
  "hash": "6311071a056272e1e761de8d0305e87cc566f734",
  "hash_short": "6311071a",
  "subject": "wifi: nl80211: fix integer overflow in nl80211_parse_mbssid_elems()",
  "body": "nl80211_parse_mbssid_elems() uses a u8 variable num_elems to count the\nnumber of MBSSID elements in the nested netlink attribute attrs, which can\nlead to an integer overflow if a user of the nl80211 interface specifies\n256 or more elements in the corresponding attribute in userspace. The\ninteger overflow can lead to a heap buffer overflow as num_elems determines\nthe size of the trailing array in elems, and this array is thereafter\nwritten to for each element in attrs.\n\nNote that this vulnerability only affects devices with the\nwiphy->mbssid_max_interfaces member set for the wireless physical device\nstruct in the device driver, and can only be triggered by a process with\nCAP_NET_ADMIN capabilities.\n\nFix this by checking for a maximum of 255 elements in attrs.\n\nCc: stable@vger.kernel.org\nFixes: dc1e3cb8da8b (\"nl80211: MBSSID and EMA support in AP mode\")\nSigned-off-by: Keith Yeo <keithyjy@gmail.com>\nLink: https://lore.kernel.org/r/20230731034719.77206-1-keithyjy@gmail.com\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: nl80211: fix integer overflow in nl80211_parse_mbssid_elems()\n\nnl80211_parse_mbssid_elems() uses a u8 variable num_elems to count the\nnumber of MBSSID elements in the nested netlink attribute attrs, which can\nlead to an integer overflow if a user of the nl80211 interface specifies\n256 or more elements in the corresponding attribute in userspace. The\ninteger overflow can lead to a heap buffer overflow as num_elems determines\nthe size of the trailing array in elems, and this array is thereafter\nwritten to for each element in attrs.\n\nNote that this vulnerability only affects devices with the\nwiphy->mbssid_max_interfaces member set for the wireless physical device\nstruct in the device driver, and can only be triggered by a process with\nCAP_NET_ADMIN capabilities.\n\nFix this by checking for a maximum of 255 elements in attrs.\n\nCc: stable@vger.kernel.org\nFixes: dc1e3cb8da8b (\"nl80211: MBSSID and EMA support in AP mode\")\nSigned-off-by: Keith Yeo <keithyjy@gmail.com>\nLink: https://lore.kernel.org/r/20230731034719.77206-1-keithyjy@gmail.com\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Keith Yeo",
  "author_email": "keithyjy@gmail.com",
  "author_date": "Mon Jul 31 11:47:20 2023 +0800",
  "author_date_iso": "2023-07-31T11:47:20+08:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Wed Aug 9 14:43:35 2023 +0200",
  "committer_date_iso": "2023-08-09T14:43:35+02:00",
  "files_changed": [
    "net/wireless/nl80211.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/wireless/nl80211.c",
      "insertions": 4,
      "deletions": 1
    }
  ],
  "total_insertions": 4,
  "total_deletions": 1,
  "total_changes": 5,
  "parents": [
    "5fb9a9fb71a33be61d7d8e8ba4597bfb18d604d0"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/wireless/nl80211.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}