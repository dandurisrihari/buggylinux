{
  "hash": "9c7d83ae6ba67d6c6199cce24573983db3b56332",
  "hash_short": "9c7d83ae",
  "subject": "pstore: Fix warning in pstore_kill_sb()",
  "body": "syzbot is hitting WARN_ON(pstore_sb != sb) at pstore_kill_sb() [1], for the\nassumption that pstore_sb != NULL is wrong because pstore_fill_super() will\nnot assign pstore_sb = sb when new_inode() for d_make_root() returned NULL\n(due to memory allocation fault injection).\n\nSince mount_single() calls pstore_kill_sb() when pstore_fill_super()\nfailed, pstore_kill_sb() needs to be aware of such failure path.\n\n[1] https://syzkaller.appspot.com/bug?id=6abacb8da5137cb47a416f2bef95719ed60508a0\n\nReported-by: syzbot <syzbot+d0cf0ad6513e9a1da5df@syzkaller.appspotmail.com>\nSigned-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nLink: https://lore.kernel.org/r/20210214031307.57903-1-penguin-kernel@I-love.SAKURA.ne.jp",
  "full_message": "pstore: Fix warning in pstore_kill_sb()\n\nsyzbot is hitting WARN_ON(pstore_sb != sb) at pstore_kill_sb() [1], for the\nassumption that pstore_sb != NULL is wrong because pstore_fill_super() will\nnot assign pstore_sb = sb when new_inode() for d_make_root() returned NULL\n(due to memory allocation fault injection).\n\nSince mount_single() calls pstore_kill_sb() when pstore_fill_super()\nfailed, pstore_kill_sb() needs to be aware of such failure path.\n\n[1] https://syzkaller.appspot.com/bug?id=6abacb8da5137cb47a416f2bef95719ed60508a0\n\nReported-by: syzbot <syzbot+d0cf0ad6513e9a1da5df@syzkaller.appspotmail.com>\nSigned-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp>\nSigned-off-by: Kees Cook <keescook@chromium.org>\nLink: https://lore.kernel.org/r/20210214031307.57903-1-penguin-kernel@I-love.SAKURA.ne.jp",
  "author_name": "Tetsuo Handa",
  "author_email": "penguin-kernel@I-love.SAKURA.ne.jp",
  "author_date": "Sun Feb 14 12:13:07 2021 +0900",
  "author_date_iso": "2021-02-14T12:13:07+09:00",
  "committer_name": "Kees Cook",
  "committer_email": "keescook@chromium.org",
  "committer_date": "Tue Feb 23 09:27:20 2021 -0800",
  "committer_date_iso": "2021-02-23T09:27:20-08:00",
  "files_changed": [
    "fs/pstore/inode.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/pstore/inode.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "19d8e9149c27b689c6224f5c84b96a159342195a"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/pstore/inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}