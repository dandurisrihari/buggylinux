commit f6047040217babeb9655b855c83d61cb1c375ac9
Author: Harald Freudenberger <freude@linux.ibm.com>
Date:   Tue Sep 20 15:12:01 2022 +0200

    s390/ap: exploit new B bit from QCI config info
    
    This patch introduces an update to the ap_config_info
    struct which is filled with the QCI subfunction. There
    is a new bit apsb (short 'B') showing if the AP secure
    bind facility is available. The patch also includes a
    simple function ap_sb_available() wrapping this bit test.
    
    Signed-off-by: Harald Freudenberger <freude@linux.ibm.com>
    Reviewed-by: Tony Krowiak <akrowiak@linux.ibm.com>
    Reviewed-by: Holger Dengler <dengler@linux.ibm.com>
    Signed-off-by: Heiko Carstens <hca@linux.ibm.com>

diff --git a/drivers/s390/crypto/vfio_ap_ops.c b/drivers/s390/crypto/vfio_ap_ops.c
index 72e10abb103a..bfe995116a6a 100644
--- a/drivers/s390/crypto/vfio_ap_ops.c
+++ b/drivers/s390/crypto/vfio_ap_ops.c
@@ -599,9 +599,9 @@ static int handle_pqap(struct kvm_vcpu *vcpu)
 static void vfio_ap_matrix_init(struct ap_config_info *info,
 				struct ap_matrix *matrix)
 {
-	matrix->apm_max = info->apxa ? info->Na : 63;
-	matrix->aqm_max = info->apxa ? info->Nd : 15;
-	matrix->adm_max = info->apxa ? info->Nd : 15;
+	matrix->apm_max = info->apxa ? info->na : 63;
+	matrix->aqm_max = info->apxa ? info->nd : 15;
+	matrix->adm_max = info->apxa ? info->nd : 15;
 }
 
 static void vfio_ap_mdev_update_guest_apcb(struct ap_matrix_mdev *matrix_mdev)