Commit Hash: 6e601a53566d84e1ffd25e7b6fe0b6894ffd79c0
Subject: sock_diag: Fix out-of-bounds access to sock_diag_handlers[]


Security Keywords:
- privilege escalation

Full commit message:
sock_diag: Fix out-of-bounds access to sock_diag_handlers[]

Userland can send a netlink message requesting SOCK_DIAG_BY_FAMILY
with a family greater or equal then AF_MAX -- the array size of
sock_diag_handlers[]. The current code does not test for this
condition therefore is vulnerable to an out-of-bound access opening
doors for a privilege escalation.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Acked-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Mathias Krause <minipli@googlemail.com>
Author Date: Sat Feb 23 01:13:47 2013 +0000
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Sat Feb 23 13:51:54 2013 -0500

Files Changed: 1
Lines Added: 3
Lines Removed: 0
Total Changes: 3
