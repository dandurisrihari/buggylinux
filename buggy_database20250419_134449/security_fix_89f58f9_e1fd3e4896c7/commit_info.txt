Commit Hash: 89f58f96d1e2357601c092d85b40a2109cf25ef3
Subject: nvmet-auth: fix nvmet_auth hash error handling


Security Keywords:
- auth

Full commit message:
nvmet-auth: fix nvmet_auth hash error handling

If we fail to call nvme_auth_augmented_challenge, or fail to kmalloc
for shash, we should free the memory allocation for challenge, so add
err path out_free_challenge to fix the memory leak.

Fixes: 7a277c37d352 ("nvmet-auth: Diffie-Hellman key exchange support")
Signed-off-by: Gaosheng Cui <cuigaosheng1@huawei.com>
Reviewed-by: Hannes Reinecke <hare@suse.de>
Reviewed-by: Christoph Hellwig <hch@lst.de>
Signed-off-by: Keith Busch <kbusch@kernel.org>

Metadata:
Author: Gaosheng Cui <cuigaosheng1@huawei.com>
Author Date: Sat Jul 6 14:46:25 2024 +0800
Committer: Keith Busch <kbusch@kernel.org>
Commit Date: Mon Jul 8 10:28:16 2024 -0700

Files Changed: 1
Lines Added: 8
Lines Removed: 6
Total Changes: 14
