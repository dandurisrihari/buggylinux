Commit Hash: d692873cbe861a870cdc9cbfb120eefd113c3dfd
Subject: gve: Use size_add() in call to struct_size()


Security Keywords:
- hardening

Full commit message:
gve: Use size_add() in call to struct_size()

If, for any reason, `tx_stats_num + rx_stats_num` wraps around, the
protection that struct_size() adds against potential integer overflows
is defeated. Fix this by hardening call to struct_size() with size_add().

Fixes: 691f4077d560 ("gve: Replace zero-length array with flexible-array member")
Signed-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>
Reviewed-by: Kees Cook <keescook@chromium.org>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Gustavo A. R. Silva <gustavoars@kernel.org>
Author Date: Fri Sep 15 12:17:49 2023 -0600
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Sun Sep 17 18:50:33 2023 +0100

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
