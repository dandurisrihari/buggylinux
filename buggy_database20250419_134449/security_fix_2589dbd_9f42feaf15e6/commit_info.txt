Commit Hash: 2589dbd72797a4163dd998b05c4663ff98bd0771
Subject: KVM: arm64: Consolidate allowed and restricted VM feature checks


Security Keywords:
- authentication

Full commit message:
KVM: arm64: Consolidate allowed and restricted VM feature checks

The definitions for features allowed and allowed with
restrictions for protected guests, which are based on feature
registers, were defined and checked for separately, even though
they are handled in the same way. This could result in missing
checks for certain features, e.g., pointer authentication,
causing traps for allowed features.

Consolidate the definitions into one. Use that new definition to
construct the guest view of the feature registers for
consistency.

Signed-off-by: Fuad Tabba <tabba@google.com>
Link: https://lore.kernel.org/r/20241216105057.579031-2-tabba@google.com
Signed-off-by: Marc Zyngier <maz@kernel.org>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Fri Dec 20 11:33:05 2024 +0000
Committer: Marc Zyngier <maz@kernel.org>
Commit Date: Fri Dec 20 13:39:10 2024 +0000

Files Changed: 3
Lines Added: 26
Lines Removed: 43
Total Changes: 69
