{
  "hash": "7aa5783d95646f924b99d245338d5b7aa7a2b3c0",
  "hash_short": "7aa5783d",
  "subject": "ima: Allow imasig requirement to be satisfied by EVM portable signatures",
  "body": "System administrators can require that all accessed files have a signature\nby specifying appraise_type=imasig in a policy rule.\n\nCurrently, IMA signatures satisfy this requirement. Appended signatures may\nalso satisfy this requirement, but are not applicable as IMA signatures.\nIMA/appended signatures ensure data source authentication for file content\nand prevent any change. EVM signatures instead ensure data source\nauthentication for file metadata. Given that the digest or signature of the\nfile content must be included in the metadata, EVM signatures provide the\nsame file data guarantees of IMA signatures, as well as providing file\nmetadata guarantees.\n\nThis patch lets systems protected with EVM signatures pass appraisal\nverification if the appraise_type=imasig requirement is specified in the\npolicy. This facilitates deployment in the scenarios where only EVM\nsignatures are available.\n\nThe patch makes the following changes:\n\nfile xattr types:\nsecurity.ima: IMA_XATTR_DIGEST/IMA_XATTR_DIGEST_NG\nsecurity.evm: EVM_XATTR_PORTABLE_DIGSIG\n\nexecve(), mmap(), open() behavior (with appraise_type=imasig):\nbefore: denied (file without IMA signature, imasig requirement not met)\nafter: allowed (file with EVM portable signature, imasig requirement met)\n\nopen(O_WRONLY) behavior (without appraise_type=imasig):\nbefore: allowed (file without IMA signature, not immutable)\nafter: denied (file with EVM portable signature, immutable)\n\nIn addition, similarly to IMA signatures, this patch temporarily allows\nnew files without or with incomplete metadata to be opened so that content\ncan be written.\n\nSigned-off-by: Roberto Sassu <roberto.sassu@huawei.com>\nSigned-off-by: Mimi Zohar <zohar@linux.ibm.com>",
  "full_message": "ima: Allow imasig requirement to be satisfied by EVM portable signatures\n\nSystem administrators can require that all accessed files have a signature\nby specifying appraise_type=imasig in a policy rule.\n\nCurrently, IMA signatures satisfy this requirement. Appended signatures may\nalso satisfy this requirement, but are not applicable as IMA signatures.\nIMA/appended signatures ensure data source authentication for file content\nand prevent any change. EVM signatures instead ensure data source\nauthentication for file metadata. Given that the digest or signature of the\nfile content must be included in the metadata, EVM signatures provide the\nsame file data guarantees of IMA signatures, as well as providing file\nmetadata guarantees.\n\nThis patch lets systems protected with EVM signatures pass appraisal\nverification if the appraise_type=imasig requirement is specified in the\npolicy. This facilitates deployment in the scenarios where only EVM\nsignatures are available.\n\nThe patch makes the following changes:\n\nfile xattr types:\nsecurity.ima: IMA_XATTR_DIGEST/IMA_XATTR_DIGEST_NG\nsecurity.evm: EVM_XATTR_PORTABLE_DIGSIG\n\nexecve(), mmap(), open() behavior (with appraise_type=imasig):\nbefore: denied (file without IMA signature, imasig requirement not met)\nafter: allowed (file with EVM portable signature, imasig requirement met)\n\nopen(O_WRONLY) behavior (without appraise_type=imasig):\nbefore: allowed (file without IMA signature, not immutable)\nafter: denied (file with EVM portable signature, immutable)\n\nIn addition, similarly to IMA signatures, this patch temporarily allows\nnew files without or with incomplete metadata to be opened so that content\ncan be written.\n\nSigned-off-by: Roberto Sassu <roberto.sassu@huawei.com>\nSigned-off-by: Mimi Zohar <zohar@linux.ibm.com>",
  "author_name": "Roberto Sassu",
  "author_email": "roberto.sassu@huawei.com",
  "author_date": "Fri May 14 17:27:51 2021 +0200",
  "author_date_iso": "2021-05-14T17:27:51+02:00",
  "committer_name": "Mimi Zohar",
  "committer_email": "zohar@linux.ibm.com",
  "committer_date": "Tue Jun 1 12:30:51 2021 -0400",
  "committer_date_iso": "2021-06-01T12:30:51-04:00",
  "files_changed": [
    "security/integrity/ima/ima_appraise.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "security/integrity/ima/ima_appraise.c",
      "insertions": 17,
      "deletions": 7
    }
  ],
  "total_insertions": 17,
  "total_deletions": 7,
  "total_changes": 24,
  "parents": [
    "1434c6a1d32a3a1a77f58a03197b802b1724c740"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "security/integrity/ima/ima_appraise.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}