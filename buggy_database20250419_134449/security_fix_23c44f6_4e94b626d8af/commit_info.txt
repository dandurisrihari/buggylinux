Commit Hash: 23c44f6c83257923b179461694edcf62749bedd5
Subject: perf tools: Fix build-id event recording


Security Keywords:
- inject

Full commit message:
perf tools: Fix build-id event recording

The build-id events written at the end of the record session are broken
due to unexpected data.  The write_buildid() writes the fixed length
event first and then variable length filename.

But a recent change made it write more data in the padding area
accidentally.  So readers of the event see zero-filled data for the
next entry and treat it incorrectly.  This resulted in wrong kernel
symbols because the kernel DSO loaded a random vmlinux image in the
path as it didn't have a valid build-id.

Fixes: ae39ba16554e ("perf inject: Fix build ID injection")
Reported-by: Linus Torvalds <torvalds@linux-foundation.org>
Tested-by: Arnaldo Carvalho de Melo <acme@redhat.com>
Reviewed-by: Ian Rogers <irogers@google.com>
Link: https://lore.kernel.org/r/Z0aRFFW9xMh3mqKB@google.com
Signed-off-by: Namhyung Kim <namhyung@kernel.org>

Metadata:
Author: Namhyung Kim <namhyung@kernel.org>
Author Date: Tue Nov 26 19:13:31 2024 -0800
Committer: Namhyung Kim <namhyung@kernel.org>
Commit Date: Mon Dec 2 12:36:20 2024 -0800

Files Changed: 1
Lines Added: 2
Lines Removed: 2
Total Changes: 4
