Commit Hash: 210d12c8197a551caa2979be421aa42381156aec
Subject: soc: qcom: mdt_loader: Enhance split binary detection


Security Keywords:
- authentication

Full commit message:
soc: qcom: mdt_loader: Enhance split binary detection

It may be that the offset of the first program header lies inside the mdt's
filesize, in this case the loader would incorrectly assume that the bins
were not split and in this scenario the firmware authentication fails.
This change updates the logic used by the mdt loader to understand whether
the firmware images are split or not. It figures this out by checking if
each programs header's segment lies within the file or not.

Co-developed-by: Melody Olvera <quic_molvera@quicinc.com>
Signed-off-by: Melody Olvera <quic_molvera@quicinc.com>
Signed-off-by: Gokul krishna Krishnakumar <quic_gokukris@quicinc.com>
Signed-off-by: Bjorn Andersson <andersson@kernel.org>
Link: https://lore.kernel.org/r/20230509001821.24010-1-quic_gokukris@quicinc.com

Metadata:
Author: Gokul krishna Krishnakumar <quic_gokukris@quicinc.com>
Author Date: Mon May 8 17:18:21 2023 -0700
Committer: Bjorn Andersson <andersson@kernel.org>
Commit Date: Wed May 24 19:28:57 2023 -0700

Files Changed: 1
Lines Added: 23
Lines Removed: 2
Total Changes: 25
