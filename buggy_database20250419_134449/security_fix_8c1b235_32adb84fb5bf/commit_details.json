{
  "hash": "8c1b235594fbab9a13240a1dac12ea9fd99b6440",
  "hash_short": "8c1b2355",
  "subject": "Bluetooth: Add enhanced security model for Simple Pairing",
  "body": "The current security model is based around the flags AUTH, ENCRYPT and\nSECURE. Starting with support for the Bluetooth 2.1 specification this is\nno longer sufficient. The different security levels are now defined as\nSDP, LOW, MEDIUM and SECURE.\n\nPreviously it was possible to set each security independently, but this\nactually doesn't make a lot of sense. For Bluetooth the encryption depends\non a previous successful authentication. Also you can only update your\nexisting link key if you successfully created at least one before. And of\ncourse the update of link keys without having proper encryption in place\nis a security issue.\n\nThe new security levels from the Bluetooth 2.1 specification are now\nused internally. All old settings are mapped to the new values and this\nway it ensures that old applications still work. The only limitation\nis that it is no longer possible to set authentication without also\nenabling encryption. No application should have done this anyway since\nthis is actually a security issue. Without encryption the integrity of\nthe authentication can't be guaranteed.\n\nAs default for a new L2CAP or RFCOMM connection, the LOW security level\nis used. The only exception here are the service discovery sessions on\nPSM 1 where SDP level is used. To have similar security strength as with\na Bluetooth 2.0 and before combination key, the MEDIUM level should be\nused. This is according to the Bluetooth specification. The MEDIUM level\nwill not require any kind of man-in-the-middle (MITM) protection. Only\nthe HIGH security level will require this.\n\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "full_message": "Bluetooth: Add enhanced security model for Simple Pairing\n\nThe current security model is based around the flags AUTH, ENCRYPT and\nSECURE. Starting with support for the Bluetooth 2.1 specification this is\nno longer sufficient. The different security levels are now defined as\nSDP, LOW, MEDIUM and SECURE.\n\nPreviously it was possible to set each security independently, but this\nactually doesn't make a lot of sense. For Bluetooth the encryption depends\non a previous successful authentication. Also you can only update your\nexisting link key if you successfully created at least one before. And of\ncourse the update of link keys without having proper encryption in place\nis a security issue.\n\nThe new security levels from the Bluetooth 2.1 specification are now\nused internally. All old settings are mapped to the new values and this\nway it ensures that old applications still work. The only limitation\nis that it is no longer possible to set authentication without also\nenabling encryption. No application should have done this anyway since\nthis is actually a security issue. Without encryption the integrity of\nthe authentication can't be guaranteed.\n\nAs default for a new L2CAP or RFCOMM connection, the LOW security level\nis used. The only exception here are the service discovery sessions on\nPSM 1 where SDP level is used. To have similar security strength as with\na Bluetooth 2.0 and before combination key, the MEDIUM level should be\nused. This is according to the Bluetooth specification. The MEDIUM level\nwill not require any kind of man-in-the-middle (MITM) protection. Only\nthe HIGH security level will require this.\n\nSigned-off-by: Marcel Holtmann <marcel@holtmann.org>",
  "author_name": "Marcel Holtmann",
  "author_email": "marcel@holtmann.org",
  "author_date": "Thu Jan 15 21:58:04 2009 +0100",
  "author_date_iso": "2009-01-15T21:58:04+01:00",
  "committer_name": "Marcel Holtmann",
  "committer_email": "marcel@holtmann.org",
  "committer_date": "Fri Feb 27 06:14:25 2009 +0100",
  "committer_date_iso": "2009-02-27T06:14:25+01:00",
  "files_changed": [
    "include/net/bluetooth/bluetooth.h",
    "include/net/bluetooth/hci_core.h",
    "net/bluetooth/hci_conn.c",
    "net/bluetooth/hci_event.c",
    "net/bluetooth/l2cap.c",
    "net/bluetooth/rfcomm/core.c",
    "net/bluetooth/sco.c"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "include/net/bluetooth/bluetooth.h",
      "insertions": 9,
      "deletions": 0
    },
    {
      "file": "include/net/bluetooth/hci_core.h",
      "insertions": 33,
      "deletions": 23
    },
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 30,
      "deletions": 15
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "net/bluetooth/l2cap.c",
      "insertions": 40,
      "deletions": 94
    },
    {
      "file": "net/bluetooth/rfcomm/core.c",
      "insertions": 24,
      "deletions": 57
    },
    {
      "file": "net/bluetooth/sco.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 139,
  "total_deletions": 191,
  "total_changes": 330,
  "parents": [
    "c89b6e6bda4c8021195778f47567d0cc9dbfe7ec"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.30",
    "v2.6.30-rc1",
    "v2.6.30-rc2",
    "v2.6.30-rc3",
    "v2.6.30-rc4",
    "v2.6.30-rc5",
    "v2.6.30-rc6",
    "v2.6.30-rc7",
    "v2.6.30-rc8",
    "v2.6.31"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "AUTH",
      "security issue"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/bluetooth/bluetooth.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/net/bluetooth/hci_core.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/sco.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/l2cap.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/rfcomm/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}