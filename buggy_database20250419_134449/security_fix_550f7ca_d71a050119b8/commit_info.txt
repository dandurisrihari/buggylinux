Commit Hash: 550f7ca98ee028a606aa75705a7e77b1bd11720f
Subject: ceph: give up on paths longer than PATH_MAX


Security Keywords:
- vulnerability

Full commit message:
ceph: give up on paths longer than PATH_MAX

If the full path to be built by ceph_mdsc_build_path() happens to be
longer than PATH_MAX, then this function will enter an endless (retry)
loop, effectively blocking the whole task.  Most of the machine
becomes unusable, making this a very simple and effective DoS
vulnerability.

I cannot imagine why this retry was ever implemented, but it seems
rather useless and harmful to me.  Let's remove it and fail with
ENAMETOOLONG instead.

Cc: stable@vger.kernel.org
Reported-by: Dario Wei√üer <dario@cure53.de>
Signed-off-by: Max Kellermann <max.kellermann@ionos.com>
Reviewed-by: Alex Markuze <amarkuze@redhat.com>
Signed-off-by: Ilya Dryomov <idryomov@gmail.com>

Metadata:
Author: Max Kellermann <max.kellermann@ionos.com>
Author Date: Mon Nov 18 23:28:28 2024 +0100
Committer: Ilya Dryomov <idryomov@gmail.com>
Commit Date: Mon Dec 16 23:25:43 2024 +0100

Files Changed: 1
Lines Added: 4
Lines Removed: 5
Total Changes: 9
