{
  "hash": "a31080899d5fdafcccf7f39dd214a814a2c82626",
  "hash_short": "a3108089",
  "subject": "cifs: sanitize multiple delimiters in prepath",
  "body": "mount.cifs can pass a device with multiple delimiters in it. This will\ncause rename(2) to fail with ENOENT.\n\nV2:\n  - Make sanitize_path more readable.\n  - Fix multiple delimiters between UNC and prepath.\n  - Avoid a memory leak if a bad user starts putting a lot of delimiters\n    in the path on purpose.\n\nBugLink: https://bugzilla.redhat.com/show_bug.cgi?id=2031200\nFixes: 24e0a1eff9e2 (\"cifs: switch to new mount api\")\nCc: stable@vger.kernel.org # 5.11+\nAcked-by: Ronnie Sahlberg <lsahlber@redhat.com>\nSigned-off-by: Thiago Rafael Becker <trbecker@gmail.com>\nSigned-off-by: Steve French <stfrench@microsoft.com>",
  "full_message": "cifs: sanitize multiple delimiters in prepath\n\nmount.cifs can pass a device with multiple delimiters in it. This will\ncause rename(2) to fail with ENOENT.\n\nV2:\n  - Make sanitize_path more readable.\n  - Fix multiple delimiters between UNC and prepath.\n  - Avoid a memory leak if a bad user starts putting a lot of delimiters\n    in the path on purpose.\n\nBugLink: https://bugzilla.redhat.com/show_bug.cgi?id=2031200\nFixes: 24e0a1eff9e2 (\"cifs: switch to new mount api\")\nCc: stable@vger.kernel.org # 5.11+\nAcked-by: Ronnie Sahlberg <lsahlber@redhat.com>\nSigned-off-by: Thiago Rafael Becker <trbecker@gmail.com>\nSigned-off-by: Steve French <stfrench@microsoft.com>",
  "author_name": "Thiago Rafael Becker",
  "author_email": "trbecker@gmail.com",
  "author_date": "Fri Dec 17 15:20:22 2021 -0300",
  "author_date_iso": "2021-12-17T15:20:22-03:00",
  "committer_name": "Steve French",
  "committer_email": "stfrench@microsoft.com",
  "committer_date": "Fri Dec 17 19:16:49 2021 -0600",
  "committer_date_iso": "2021-12-17T19:16:49-06:00",
  "files_changed": [
    "fs/cifs/fs_context.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/cifs/fs_context.c",
      "insertions": 37,
      "deletions": 1
    }
  ],
  "total_insertions": 37,
  "total_deletions": 1,
  "total_changes": 38,
  "parents": [
    "b774302e885697dde027825f8de9beb985d037bd"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "sanitize"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/cifs/fs_context.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}