Commit Hash: a31080899d5fdafcccf7f39dd214a814a2c82626
Subject: cifs: sanitize multiple delimiters in prepath


Security Keywords:
- sanitize

Full commit message:
cifs: sanitize multiple delimiters in prepath

mount.cifs can pass a device with multiple delimiters in it. This will
cause rename(2) to fail with ENOENT.

V2:
  - Make sanitize_path more readable.
  - Fix multiple delimiters between UNC and prepath.
  - Avoid a memory leak if a bad user starts putting a lot of delimiters
    in the path on purpose.

BugLink: https://bugzilla.redhat.com/show_bug.cgi?id=2031200
Fixes: 24e0a1eff9e2 ("cifs: switch to new mount api")
Cc: stable@vger.kernel.org # 5.11+
Acked-by: Ronnie Sahlberg <lsahlber@redhat.com>
Signed-off-by: Thiago Rafael Becker <trbecker@gmail.com>
Signed-off-by: Steve French <stfrench@microsoft.com>

Metadata:
Author: Thiago Rafael Becker <trbecker@gmail.com>
Author Date: Fri Dec 17 15:20:22 2021 -0300
Committer: Steve French <stfrench@microsoft.com>
Commit Date: Fri Dec 17 19:16:49 2021 -0600

Files Changed: 1
Lines Added: 37
Lines Removed: 1
Total Changes: 38
