{
  "hash": "117166efb1ee8f13c38f9e96b258f16d4923f888",
  "hash_short": "117166ef",
  "subject": "ext4: do not allow external inodes for inline data",
  "body": "The inline data feature was implemented before we added support for\nexternal inodes for xattrs.  It makes no sense to support that\ncombination, but the problem is that there are a number of extended\nattribute checks that are skipped if e_value_inum is non-zero.\n\nUnfortunately, the inline data code is completely e_value_inum\nunaware, and attempts to interpret the xattr fields as if it were an\ninline xattr --- at which point, Hilarty Ensues.\n\nThis addresses CVE-2018-11412.\n\nhttps://bugzilla.kernel.org/show_bug.cgi?id=199803\n\nReported-by: Jann Horn <jannh@google.com>\nReviewed-by: Andreas Dilger <adilger@dilger.ca>\nSigned-off-by: Theodore Ts'o <tytso@mit.edu>\nFixes: e50e5129f384 (\"ext4: xattr-in-inode support\")\nCc: stable@kernel.org",
  "full_message": "ext4: do not allow external inodes for inline data\n\nThe inline data feature was implemented before we added support for\nexternal inodes for xattrs.  It makes no sense to support that\ncombination, but the problem is that there are a number of extended\nattribute checks that are skipped if e_value_inum is non-zero.\n\nUnfortunately, the inline data code is completely e_value_inum\nunaware, and attempts to interpret the xattr fields as if it were an\ninline xattr --- at which point, Hilarty Ensues.\n\nThis addresses CVE-2018-11412.\n\nhttps://bugzilla.kernel.org/show_bug.cgi?id=199803\n\nReported-by: Jann Horn <jannh@google.com>\nReviewed-by: Andreas Dilger <adilger@dilger.ca>\nSigned-off-by: Theodore Ts'o <tytso@mit.edu>\nFixes: e50e5129f384 (\"ext4: xattr-in-inode support\")\nCc: stable@kernel.org",
  "author_name": "Theodore Ts'o",
  "author_email": "tytso@mit.edu",
  "author_date": "Tue May 22 16:15:24 2018 -0400",
  "author_date_iso": "2018-05-22T16:15:24-04:00",
  "committer_name": "Theodore Ts'o",
  "committer_email": "tytso@mit.edu",
  "committer_date": "Tue May 22 16:15:24 2018 -0400",
  "committer_date_iso": "2018-05-22T16:15:24-04:00",
  "files_changed": [
    "fs/ext4/inline.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/ext4/inline.c",
      "insertions": 6,
      "deletions": 0
    }
  ],
  "total_insertions": 6,
  "total_deletions": 0,
  "total_changes": 6,
  "parents": [
    "f06925c7394236d769c788940c9a7b85dbe4c40c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.18",
    "v4.18-rc1",
    "v4.18-rc2",
    "v4.18-rc3",
    "v4.18-rc4",
    "v4.18-rc5",
    "v4.18-rc6",
    "v4.18-rc7",
    "v4.18-rc8",
    "v4.19"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2018-11412"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "fs/ext4/inline.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}