Commit Hash: df8fbc241aa3c451248b1f19fff3a3f604b107f9
Subject: cifs: Support NTLM2 session security during NTLMSSP authentication [try #5]


Security Keywords:
- authentication

Full commit message:
cifs: Support NTLM2 session security during NTLMSSP authentication [try #5]

Indicate to the server a capability of NTLM2 session security (NTLM2 Key)
during ntlmssp protocol exchange in one of the bits of the flags field.
If server supports this capability, send NTLM2 key even if signing is not
required on the server.

If the server requires signing, the session keys exchanged for NTLMv2
and NTLM2 session security in auth packet of the nlmssp exchange are same.

Send the same flags in authenticate message (type 3) that client sent in
negotiate message (type 1).

Remove function setup_ntlmssp_neg_req

Make sure ntlmssp negotiate and authenticate messages are zero'ed
before they are built.

Reported-and-Tested-by: Robbert Kouprie <robbert@exx.nl>
Signed-off-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Acked-by: Jeff Layton <jlayton@redhat.com>
Signed-off-by: Steve French <sfrench@us.ibm.com>

Metadata:
Author: Shirish Pargaonkar <shirishpargaonkar@gmail.com>
Author Date: Sat Dec 11 14:19:22 2010 -0600
Committer: Steve French <sfrench@us.ibm.com>
Commit Date: Thu Jan 6 19:07:52 2011 +0000

Files Changed: 1
Lines Added: 14
Lines Removed: 19
Total Changes: 33
