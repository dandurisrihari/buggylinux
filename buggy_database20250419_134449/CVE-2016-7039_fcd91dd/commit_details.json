{
  "hash": "fcd91dd449867c6bfe56a81cabba76b829fd05cd",
  "hash_short": "fcd91dd4",
  "subject": "net: add recursion limit to GRO",
  "body": "Currently, GRO can do unlimited recursion through the gro_receive\nhandlers.  This was fixed for tunneling protocols by limiting tunnel GRO\nto one level with encap_mark, but both VLAN and TEB still have this\nproblem.  Thus, the kernel is vulnerable to a stack overflow, if we\nreceive a packet composed entirely of VLAN headers.\n\nThis patch adds a recursion counter to the GRO layer to prevent stack\noverflow.  When a gro_receive function hits the recursion limit, GRO is\naborted for this skb and it is processed normally.  This recursion\ncounter is put in the GRO CB, but could be turned into a percpu counter\nif we run out of space in the CB.\n\nThanks to Vladim\u00edr Bene\u0161 <vbenes@redhat.com> for the initial bug report.\n\nFixes: CVE-2016-7039\nFixes: 9b174d88c257 (\"net: Add Transparent Ethernet Bridging GRO support.\")\nFixes: 66e5133f19e9 (\"vlan: Add GRO support for non hardware accelerated vlan\")\nSigned-off-by: Sabrina Dubroca <sd@queasysnail.net>\nReviewed-by: Jiri Benc <jbenc@redhat.com>\nAcked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nAcked-by: Tom Herbert <tom@herbertland.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "net: add recursion limit to GRO\n\nCurrently, GRO can do unlimited recursion through the gro_receive\nhandlers.  This was fixed for tunneling protocols by limiting tunnel GRO\nto one level with encap_mark, but both VLAN and TEB still have this\nproblem.  Thus, the kernel is vulnerable to a stack overflow, if we\nreceive a packet composed entirely of VLAN headers.\n\nThis patch adds a recursion counter to the GRO layer to prevent stack\noverflow.  When a gro_receive function hits the recursion limit, GRO is\naborted for this skb and it is processed normally.  This recursion\ncounter is put in the GRO CB, but could be turned into a percpu counter\nif we run out of space in the CB.\n\nThanks to Vladim\u00edr Bene\u0161 <vbenes@redhat.com> for the initial bug report.\n\nFixes: CVE-2016-7039\nFixes: 9b174d88c257 (\"net: Add Transparent Ethernet Bridging GRO support.\")\nFixes: 66e5133f19e9 (\"vlan: Add GRO support for non hardware accelerated vlan\")\nSigned-off-by: Sabrina Dubroca <sd@queasysnail.net>\nReviewed-by: Jiri Benc <jbenc@redhat.com>\nAcked-by: Hannes Frederic Sowa <hannes@stressinduktion.org>\nAcked-by: Tom Herbert <tom@herbertland.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Sabrina Dubroca",
  "author_email": "sd@queasysnail.net",
  "author_date": "Thu Oct 20 15:58:02 2016 +0200",
  "author_date_iso": "2016-10-20T15:58:02+02:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Thu Oct 20 14:32:22 2016 -0400",
  "committer_date_iso": "2016-10-20T14:32:22-04:00",
  "files_changed": [
    "drivers/net/geneve.c",
    "drivers/net/vxlan.c",
    "include/linux/netdevice.h",
    "net/8021q/vlan.c",
    "net/core/dev.c",
    "net/ethernet/eth.c",
    "net/ipv4/af_inet.c",
    "net/ipv4/fou.c",
    "net/ipv4/gre_offload.c",
    "net/ipv4/udp_offload.c",
    "net/ipv6/ip6_offload.c"
  ],
  "files_changed_count": 11,
  "stats": [
    {
      "file": "drivers/net/geneve.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/net/vxlan.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/netdevice.h",
      "insertions": 38,
      "deletions": 1
    },
    {
      "file": "net/8021q/vlan.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/core/dev.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/ethernet/eth.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/ipv4/af_inet.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/ipv4/fou.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "net/ipv4/gre_offload.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/ipv4/udp_offload.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/ipv6/ip6_offload.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 49,
  "total_deletions": 11,
  "total_changes": 60,
  "parents": [
    "7aa8e63f0d0f2e0ae353632bca1ce75a258696c6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc1",
    "v4.10-rc2",
    "v4.10-rc3",
    "v4.10-rc4",
    "v4.10-rc5",
    "v4.10-rc6",
    "v4.10-rc7",
    "v4.10-rc8",
    "v4.11"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2016-7039"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/geneve.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/vxlan.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/linux/netdevice.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ethernet/eth.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/af_inet.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/gre_offload.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/core/dev.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/fou.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv4/udp_offload.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/8021q/vlan.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/ipv6/ip6_offload.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}