Files changed: 19
Insertions: 2532
Deletions: 385
Total changes: 2917

File-specific changes:
arch/arm64/include/asm/kvm_asm.h: +1 -0
arch/arm64/include/asm/kvm_emulate.h: +1 -1
arch/arm64/include/asm/kvm_host.h: +19 -27
arch/arm64/include/asm/kvm_hyp.h: +0 -1
arch/arm64/include/asm/kvm_mmu.h: +2 -0
arch/arm64/include/asm/kvm_pgtable.h: +25 -5
arch/arm64/include/asm/kvm_pkvm.h: +71 -0
arch/arm64/include/asm/mmu.h: +1 -0
arch/arm64/include/asm/sysreg.h: +1 -0
arch/arm64/kernel/asm-offsets.c: +0 -1
arch/arm64/kernel/fpsimd.c: +5 -1
arch/arm64/kvm/.gitignore: +2 -0
arch/arm64/kvm/Makefile: +17 -1
arch/arm64/kvm/arm.c: +37 -27
arch/arm64/kvm/fpsimd.c: +41 -38
arch/arm64/kvm/hyp/Makefile: +1 -1
arch/arm64/kvm/hyp/fpsimd.S: +0 -6
arch/arm64/kvm/hyp/hyp-constants.c: +10 -0
arch/arm64/kvm/hyp/include/hyp/switch.h: +4 -26
arch/arm64/kvm/hyp/include/nvhe/mem_protect.h: +6 -0
arch/arm64/kvm/hyp/include/nvhe/mm.h: +0 -59
arch/arm64/kvm/hyp/nvhe/early_alloc.c: +5 -0
arch/arm64/kvm/hyp/nvhe/hyp-main.c: +8 -0
arch/arm64/kvm/hyp/nvhe/mem_protect.c: +428 -77
arch/arm64/kvm/hyp/nvhe/mm.c: +3 -1
arch/arm64/kvm/hyp/nvhe/page_alloc.c: +1 -1
arch/arm64/kvm/hyp/nvhe/setup.c: +19 -6
arch/arm64/kvm/hyp/nvhe/switch.c: +0 -1
arch/arm64/kvm/hyp/pgtable.c: +85 -23
arch/arm64/kvm/hyp/vhe/switch.c: +0 -1
arch/arm64/kvm/mmu.c: +137 -13
arch/arm64/kvm/{hyp/reserved_mem.c => pkvm.c}: +4 -4
arch/arm64/kvm/pmu-emul.c: +1 -0
arch/arm64/kvm/psci.c: +1 -1
arch/arm64/kvm/reset.c: +21 -7
arch/arm64/kvm/vgic/vgic-init.c: +1 -1
arch/arm64/kvm/vgic/vgic-mmio-v3.c: +5 -3
arch/arm64/kvm/vgic/vgic-mmio.c: +1 -1
arch/arm64/kvm/vgic/vgic-mmio.h: +1 -1
arch/arm64/kvm/vgic/vgic-v2.c: +7 -2
arch/arm64/kvm/vgic/vgic-v3.c: +3 -3
include/kvm/arm_vgic.h: +3 -1
include/linux/kvm_host.h: +0 -1
tools/testing/selftests/kvm/.gitignore: +1 -0
tools/testing/selftests/kvm/Makefile: +1 -0
tools/testing/selftests/kvm/aarch64/arch_timer.c: +1 -1
tools/testing/selftests/kvm/aarch64/get-reg-list.c: +50 -0
tools/testing/selftests/kvm/aarch64/vgic_irq.c: +853 -0
tools/testing/selftests/kvm/include/aarch64/gic.h: +26 -0
tools/testing/selftests/kvm/{lib => include}/aarch64/gic_v3.h: +12 -0
tools/testing/selftests/kvm/include/aarch64/processor.h: +3 -0
tools/testing/selftests/kvm/include/aarch64/vgic.h: +16 -2
tools/testing/selftests/kvm/include/kvm_util.h: +19 -1
tools/testing/selftests/kvm/lib/aarch64/gic.c: +66 -0
tools/testing/selftests/kvm/lib/aarch64/gic_private.h: +11 -0
tools/testing/selftests/kvm/lib/aarch64/gic_v3.c: +181 -25
tools/testing/selftests/kvm/lib/aarch64/processor.c: +75 -7
tools/testing/selftests/kvm/lib/aarch64/vgic.c: +102 -1
tools/testing/selftests/kvm/lib/guest_modes.c: +43 -6
tools/testing/selftests/kvm/lib/kvm_util.c: +94 -0
