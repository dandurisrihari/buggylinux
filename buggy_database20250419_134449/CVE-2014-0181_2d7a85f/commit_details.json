{
  "hash": "2d7a85f4b06e9c27ff629f07a524c48074f07f81",
  "hash_short": "2d7a85f4",
  "subject": "netlink: Only check file credentials for implicit destinations",
  "body": "It was possible to get a setuid root or setcap executable to write to\nit's stdout or stderr (which has been set made a netlink socket) and\ninadvertently reconfigure the networking stack.\n\nTo prevent this we check that both the creator of the socket and\nthe currentl applications has permission to reconfigure the network\nstack.\n\nUnfortunately this breaks Zebra which always uses sendto/sendmsg\nand creates it's socket without any privileges.\n\nTo keep Zebra working don't bother checking if the creator of the\nsocket has privilege when a destination address is specified.  Instead\nrely exclusively on the privileges of the sender of the socket.\n\nNote from Andy: This is exactly Eric's code except for some comment\nclarifications and formatting fixes.  Neither I nor, I think, anyone\nelse is thrilled with this approach, but I'm hesitant to wait on a\nbetter fix since 3.15 is almost here.\n\nNote to stable maintainers: This is a mess.  An earlier series of\npatches in 3.15 fix a rather serious security issue (CVE-2014-0181),\nbut they did so in a way that breaks Zebra.  The offending series\nincludes:\n\n    commit aa4cf9452f469f16cea8c96283b641b4576d4a7b\n    Author: Eric W. Biederman <ebiederm@xmission.com>\n    Date:   Wed Apr 23 14:28:03 2014 -0700\n\n        net: Add variants of capable for use on netlink messages\n\nIf a given kernel version is missing that series of fixes, it's\nprobably worth backporting it and this patch.  if that series is\npresent, then this fix is critical if you care about Zebra.\n\nCc: stable@vger.kernel.org\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "netlink: Only check file credentials for implicit destinations\n\nIt was possible to get a setuid root or setcap executable to write to\nit's stdout or stderr (which has been set made a netlink socket) and\ninadvertently reconfigure the networking stack.\n\nTo prevent this we check that both the creator of the socket and\nthe currentl applications has permission to reconfigure the network\nstack.\n\nUnfortunately this breaks Zebra which always uses sendto/sendmsg\nand creates it's socket without any privileges.\n\nTo keep Zebra working don't bother checking if the creator of the\nsocket has privilege when a destination address is specified.  Instead\nrely exclusively on the privileges of the sender of the socket.\n\nNote from Andy: This is exactly Eric's code except for some comment\nclarifications and formatting fixes.  Neither I nor, I think, anyone\nelse is thrilled with this approach, but I'm hesitant to wait on a\nbetter fix since 3.15 is almost here.\n\nNote to stable maintainers: This is a mess.  An earlier series of\npatches in 3.15 fix a rather serious security issue (CVE-2014-0181),\nbut they did so in a way that breaks Zebra.  The offending series\nincludes:\n\n    commit aa4cf9452f469f16cea8c96283b641b4576d4a7b\n    Author: Eric W. Biederman <ebiederm@xmission.com>\n    Date:   Wed Apr 23 14:28:03 2014 -0700\n\n        net: Add variants of capable for use on netlink messages\n\nIf a given kernel version is missing that series of fixes, it's\nprobably worth backporting it and this patch.  if that series is\npresent, then this fix is critical if you care about Zebra.\n\nCc: stable@vger.kernel.org\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>\nSigned-off-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Eric W. Biederman",
  "author_email": "ebiederm@xmission.com",
  "author_date": "Fri May 30 11:04:00 2014 -0700",
  "author_date_iso": "2014-05-30T11:04:00-07:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Mon Jun 2 16:34:09 2014 -0700",
  "committer_date_iso": "2014-06-02T16:34:09-07:00",
  "files_changed": [
    "include/linux/netlink.h",
    "net/netlink/af_netlink.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "include/linux/netlink.h",
      "insertions": 4,
      "deletions": 3
    },
    {
      "file": "net/netlink/af_netlink.c",
      "insertions": 6,
      "deletions": 1
    }
  ],
  "total_insertions": 10,
  "total_deletions": 4,
  "total_changes": 14,
  "parents": [
    "22fd2a52f715550930938fc79140defc098287d6"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.15",
    "v3.16",
    "v3.16-rc1",
    "v3.16-rc2",
    "v3.16-rc3",
    "v3.16-rc4",
    "v3.16-rc5",
    "v3.16-rc6",
    "v3.16-rc7",
    "v3.17"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2014-0181"
    ],
    "security_keywords": [
      "security issue"
    ]
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "include/linux/netlink.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/netlink/af_netlink.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}