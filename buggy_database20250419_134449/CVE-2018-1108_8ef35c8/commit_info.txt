Commit Hash: 8ef35c866f8862df074a49a93b0309725812dea8
Subject: random: set up the NUMA crng instances after the CRNG is fully initialized

CVE Identifiers:
- CVE-2018-1108

Full commit message:
random: set up the NUMA crng instances after the CRNG is fully initialized

Until the primary_crng is fully initialized, don't initialize the NUMA
crng nodes.  Otherwise users of /dev/urandom on NUMA systems before
the CRNG is fully initialized can get very bad quality randomness.  Of
course everyone should move to getrandom(2) where this won't be an
issue, but there's a lot of legacy code out there.  This related to
CVE-2018-1108.

Reported-by: Jann Horn <jannh@google.com>
Fixes: 1e7f583af67b ("random: make /dev/urandom scalable for silly...")
Cc: stable@kernel.org # 4.8+
Signed-off-by: Theodore Ts'o <tytso@mit.edu>

Metadata:
Author: Theodore Ts'o <tytso@mit.edu>
Author Date: Wed Apr 11 15:23:56 2018 -0400
Committer: Theodore Ts'o <tytso@mit.edu>
Commit Date: Sat Apr 14 11:59:19 2018 -0400

Files Changed: 1
Lines Added: 27
Lines Removed: 19
Total Changes: 46
