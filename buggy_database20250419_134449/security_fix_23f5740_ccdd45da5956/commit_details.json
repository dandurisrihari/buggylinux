{
  "hash": "23f57406b82de51809d5812afd96f210f8b627f3",
  "hash_short": "23f57406",
  "subject": "ipv4: avoid using shared IP generator for connected sockets",
  "body": "ip_select_ident_segs() has been very conservative about using\nthe connected socket private generator only for packets with IP_DF\nset, claiming it was needed for some VJ compression implementations.\n\nAs mentioned in this referenced document, this can be abused.\n(Ref: Off-Path TCP Exploits of the Mixed IPID Assignment)\n\nBefore switching to pure random IPID generation and possibly hurt\nsome workloads, lets use the private inet socket generator.\n\nNot only this will remove one vulnerability, this will also\nimprove performance of TCP flows using pmtudisc==IP_PMTUDISC_DONT\n\nFixes: 73f156a6e8c1 (\"inetpeer: get rid of ip_id_count\")\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReviewed-by: David Ahern <dsahern@kernel.org>\nReported-by: Ray Che <xijiache@gmail.com>\nCc: Willy Tarreau <w@1wt.eu>\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "ipv4: avoid using shared IP generator for connected sockets\n\nip_select_ident_segs() has been very conservative about using\nthe connected socket private generator only for packets with IP_DF\nset, claiming it was needed for some VJ compression implementations.\n\nAs mentioned in this referenced document, this can be abused.\n(Ref: Off-Path TCP Exploits of the Mixed IPID Assignment)\n\nBefore switching to pure random IPID generation and possibly hurt\nsome workloads, lets use the private inet socket generator.\n\nNot only this will remove one vulnerability, this will also\nimprove performance of TCP flows using pmtudisc==IP_PMTUDISC_DONT\n\nFixes: 73f156a6e8c1 (\"inetpeer: get rid of ip_id_count\")\nSigned-off-by: Eric Dumazet <edumazet@google.com>\nReviewed-by: David Ahern <dsahern@kernel.org>\nReported-by: Ray Che <xijiache@gmail.com>\nCc: Willy Tarreau <w@1wt.eu>\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Eric Dumazet",
  "author_email": "edumazet@google.com",
  "author_date": "Wed Jan 26 17:10:22 2022 -0800",
  "author_date_iso": "2022-01-26T17:10:22-08:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Thu Jan 27 08:37:02 2022 -0800",
  "committer_date_iso": "2022-01-27T08:37:02-08:00",
  "files_changed": [
    "include/net/ip.h"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "include/net/ip.h",
      "insertions": 10,
      "deletions": 11
    }
  ],
  "total_insertions": 10,
  "total_deletions": 11,
  "total_changes": 21,
  "parents": [
    "970a5a3ea86da637471d3cd04d513a0755aba4bf"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/ip.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}