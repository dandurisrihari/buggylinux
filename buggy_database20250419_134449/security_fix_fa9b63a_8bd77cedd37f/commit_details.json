{
  "hash": "fa9b63adabcfa9b724120ef3352cf6fb82b4b9a5",
  "hash_short": "fa9b63ad",
  "subject": "apparmor: add user namespace creation mediation",
  "body": "Unprivileged user namespace creation is often used as a first step\nin privilege escalation attacks. Instead of disabling it at the\nsysrq level, which blocks its legitimate use as for setting up a sandbox,\nallow control on a per domain basis.\n\nThis allows an admin to quickly lock down a system while also still\nallowing legitimate use.\n\nReviewed-by: Georgia Garcia <georgia.garcia@canonical.com>\nSigned-off-by: John Johansen <john.johansen@canonical.com>",
  "full_message": "apparmor: add user namespace creation mediation\n\nUnprivileged user namespace creation is often used as a first step\nin privilege escalation attacks. Instead of disabling it at the\nsysrq level, which blocks its legitimate use as for setting up a sandbox,\nallow control on a per domain basis.\n\nThis allows an admin to quickly lock down a system while also still\nallowing legitimate use.\n\nReviewed-by: Georgia Garcia <georgia.garcia@canonical.com>\nSigned-off-by: John Johansen <john.johansen@canonical.com>",
  "author_name": "John Johansen",
  "author_email": "john.johansen@canonical.com",
  "author_date": "Fri Sep 9 16:00:09 2022 -0700",
  "author_date_iso": "2022-09-09T16:00:09-07:00",
  "committer_name": "John Johansen",
  "committer_email": "john.johansen@canonical.com",
  "committer_date": "Wed Oct 18 15:49:02 2023 -0700",
  "committer_date_iso": "2023-10-18T15:49:02-07:00",
  "files_changed": [
    "security/apparmor/apparmorfs.c",
    "security/apparmor/audit.c",
    "security/apparmor/include/apparmor.h",
    "security/apparmor/include/audit.h",
    "security/apparmor/include/task.h",
    "security/apparmor/lsm.c",
    "security/apparmor/task.c"
  ],
  "files_changed_count": 7,
  "stats": [
    {
      "file": "security/apparmor/apparmorfs.c",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "security/apparmor/audit.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "security/apparmor/include/apparmor.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "security/apparmor/include/audit.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "security/apparmor/include/task.h",
      "insertions": 6,
      "deletions": 0
    },
    {
      "file": "security/apparmor/lsm.c",
      "insertions": 24,
      "deletions": 1
    },
    {
      "file": "security/apparmor/task.c",
      "insertions": 41,
      "deletions": 0
    }
  ],
  "total_insertions": 75,
  "total_deletions": 2,
  "total_changes": 77,
  "parents": [
    "2d9da9b188b8cd3b579d7ef5ba5d334be9dd38fc"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "privilege escalation"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "security/apparmor/audit.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/apparmor/include/audit.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/apparmor/apparmorfs.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/apparmor/include/task.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/apparmor/lsm.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/apparmor/include/apparmor.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/apparmor/task.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}