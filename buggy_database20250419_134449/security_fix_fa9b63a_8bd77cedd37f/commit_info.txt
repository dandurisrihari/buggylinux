Commit Hash: fa9b63adabcfa9b724120ef3352cf6fb82b4b9a5
Subject: apparmor: add user namespace creation mediation


Security Keywords:
- privilege escalation

Full commit message:
apparmor: add user namespace creation mediation

Unprivileged user namespace creation is often used as a first step
in privilege escalation attacks. Instead of disabling it at the
sysrq level, which blocks its legitimate use as for setting up a sandbox,
allow control on a per domain basis.

This allows an admin to quickly lock down a system while also still
allowing legitimate use.

Reviewed-by: Georgia Garcia <georgia.garcia@canonical.com>
Signed-off-by: John Johansen <john.johansen@canonical.com>

Metadata:
Author: John Johansen <john.johansen@canonical.com>
Author Date: Fri Sep 9 16:00:09 2022 -0700
Committer: John Johansen <john.johansen@canonical.com>
Commit Date: Wed Oct 18 15:49:02 2023 -0700

Files Changed: 7
Lines Added: 75
Lines Removed: 2
Total Changes: 77
