commit be82ecd3a5c859dc2886cd70564634647787a9b6
Author: Avraham Stern <avraham.stern@intel.com>
Date:   Fri Sep 11 20:44:39 2020 +0300

    iwlwifi: mvm: add an option to add PASN station
    
    A FTM responder may do PASN authentication with unassociated stations
    to allow secure ranging. In this case, the driver will add an internal
    station and install the TK so the FW will accept protected FTM
    request frames from this station and will send a protected FTM
    response frame.
    
    In addition, the driver needs to configure the HLTK to the FW so
    the FW can derive the secure LTF bits. This is left for a later
    patch since it is not yet supported by the FW.
    
    Signed-off-by: Avraham Stern <avraham.stern@intel.com>
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>
    Link: https://lore.kernel.org/r/iwlwifi.20200911204056.c915b44ad7dd.I72ef7f9753964555561c27ec503241105eddb14e@changeid
    Signed-off-by: Luca Coelho <luciano.coelho@intel.com>

diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c b/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c
index f9b261e36f2d..12f217f2d7b3 100644
--- a/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c
+++ b/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c
@@ -2633,6 +2633,8 @@ static void iwl_mvm_stop_ap_ibss(struct ieee80211_hw *hw,
 
 	iwl_mvm_update_quotas(mvm, false, NULL);
 
+	iwl_mvm_ftm_responder_clear(mvm, vif);
+
 	/*
 	 * This is not very nice, but the simplest:
 	 * For older FWs removing the mcast sta before the bcast station may