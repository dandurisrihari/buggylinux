Commit Hash: f5a5a406b4b8bb6c1fc7a1e92a872bd86061a53f
Subject: KVM: arm64: Propagate and handle Fine-Grained UNDEF bits


Security Keywords:
- injection

Full commit message:
KVM: arm64: Propagate and handle Fine-Grained UNDEF bits

In order to correctly honor our FGU bits, they must be converted
into a set of FGT bits. They get merged as part of the existing
FGT setting.

Similarly, the UNDEF injection phase takes place when handling
the trap.

This results in a bit of rework in the FGT macros in order to
help with the code generation, as burying per-CPU accesses in
macros results in a lot of expansion, not to mention the vcpu->kvm
access on nvhe (kern_hyp_va() is not optimisation-friendly).

Reviewed-by: Joey Gouly <joey.gouly@arm.com>
Signed-off-by: Marc Zyngier <maz@kernel.org>
Link: https://lore.kernel.org/r/20240214131827.2856277-19-maz@kernel.org
Signed-off-by: Oliver Upton <oliver.upton@linux.dev>

Metadata:
Author: Marc Zyngier <maz@kernel.org>
Author Date: Wed Feb 14 13:18:19 2024 +0000
Committer: Oliver Upton <oliver.upton@linux.dev>
Commit Date: Mon Feb 19 17:13:01 2024 +0000

Files Changed: 2
Lines Added: 72
Lines Removed: 20
Total Changes: 92
