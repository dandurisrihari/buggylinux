Commit Hash: 2a5eb9995528441447d33838727f6ec1caf08139
Subject: binfmt_elf: Leave a gap between .bss and brk


Security Keywords:
- hardening

Full commit message:
binfmt_elf: Leave a gap between .bss and brk

Currently the brk starts its randomization immediately after .bss,
which means there is a chance that when the random offset is 0, linear
overflows from .bss can reach into the brk area. Leave at least a single
page gap between .bss and brk (when it has not already been explicitly
relocated into the mmap range).

Reported-by:  <y0un9n132@gmail.com>
Closes: https://lore.kernel.org/linux-hardening/CA+2EKTVLvc8hDZc+2Yhwmus=dzOUG5E4gV7ayCbu0MPJTZzWkw@mail.gmail.com/
Link: https://lore.kernel.org/r/20240217062545.1631668-2-keescook@chromium.org
Signed-off-by: Kees Cook <keescook@chromium.org>

Metadata:
Author: Kees Cook <keescook@chromium.org>
Author Date: Fri Feb 16 22:25:44 2024 -0800
Committer: Kees Cook <keescook@chromium.org>
Commit Date: Wed Apr 24 12:20:35 2024 -0700

Files Changed: 1
Lines Added: 3
Lines Removed: 0
Total Changes: 3
