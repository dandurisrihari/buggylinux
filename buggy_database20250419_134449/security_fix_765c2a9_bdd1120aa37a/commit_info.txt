Commit Hash: 765c2a964b49bd06b61a52991519281c85d82b67
Subject: Bluetooth: Fix race condition with conn->sec_level


Security Keywords:
- authentication

Full commit message:
Bluetooth: Fix race condition with conn->sec_level

The conn->sec_level value is supposed to represent the current level of
security that the connection has. However, by assigning to it before
requesting authentication it will have the wrong value during the
authentication procedure. To fix this a pending_sec_level variable is
added which is used to track the desired security level while making
sure that sec_level always represents the current level of security.

Signed-off-by: Johan Hedberg <johan.hedberg@nokia.com>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>

Metadata:
Author: Johan Hedberg <johan.hedberg@nokia.com>
Author Date: Wed Jan 19 12:06:52 2011 +0530
Committer: Gustavo F. Padovan <padovan@profusion.mobi>
Commit Date: Wed Jan 19 14:43:11 2011 -0200

Files Changed: 3
Lines Added: 12
Lines Removed: 6
Total Changes: 18
