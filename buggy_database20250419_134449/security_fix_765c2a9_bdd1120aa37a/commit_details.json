{
  "hash": "765c2a964b49bd06b61a52991519281c85d82b67",
  "hash_short": "765c2a96",
  "subject": "Bluetooth: Fix race condition with conn->sec_level",
  "body": "The conn->sec_level value is supposed to represent the current level of\nsecurity that the connection has. However, by assigning to it before\nrequesting authentication it will have the wrong value during the\nauthentication procedure. To fix this a pending_sec_level variable is\nadded which is used to track the desired security level while making\nsure that sec_level always represents the current level of security.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@nokia.com>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>",
  "full_message": "Bluetooth: Fix race condition with conn->sec_level\n\nThe conn->sec_level value is supposed to represent the current level of\nsecurity that the connection has. However, by assigning to it before\nrequesting authentication it will have the wrong value during the\nauthentication procedure. To fix this a pending_sec_level variable is\nadded which is used to track the desired security level while making\nsure that sec_level always represents the current level of security.\n\nSigned-off-by: Johan Hedberg <johan.hedberg@nokia.com>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>",
  "author_name": "Johan Hedberg",
  "author_email": "johan.hedberg@nokia.com",
  "author_date": "Wed Jan 19 12:06:52 2011 +0530",
  "author_date_iso": "2011-01-19T12:06:52+05:30",
  "committer_name": "Gustavo F. Padovan",
  "committer_email": "padovan@profusion.mobi",
  "committer_date": "Wed Jan 19 14:43:11 2011 -0200",
  "committer_date_iso": "2011-01-19T14:43:11-02:00",
  "files_changed": [
    "include/net/bluetooth/hci_core.h",
    "net/bluetooth/hci_conn.c",
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "include/net/bluetooth/hci_core.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/bluetooth/hci_conn.c",
      "insertions": 6,
      "deletions": 2
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 5,
      "deletions": 4
    }
  ],
  "total_insertions": 12,
  "total_deletions": 6,
  "total_changes": 18,
  "parents": [
    "d00ef24fc2923b65fdd440dc6445903e965841ac"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.38",
    "v2.6.38-rc3",
    "v2.6.38-rc4",
    "v2.6.38-rc5",
    "v2.6.38-rc6",
    "v2.6.38-rc7",
    "v2.6.38-rc8",
    "v2.6.39",
    "v2.6.39-rc1",
    "v2.6.39-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "include/net/bluetooth/hci_core.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_conn.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}