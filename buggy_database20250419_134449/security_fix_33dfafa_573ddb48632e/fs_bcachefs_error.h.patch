commit 33dfafa90285c0873a24d633877d505ab8e3fc20
Author: Kent Overstreet <kent.overstreet@linux.dev>
Date:   Wed Jun 19 09:55:48 2024 -0400

    bcachefs: Fix safe errors by default
    
    i.e. the start of automatic self healing:
    
    If errors=continue or fix_safe, we now automatically fix simple errors
    without user intervention.
    
    New error action option: fix_safe
    
    This replaces the existing errors=ro option, which gets a new slot, i.e.
    existing errors=ro users now get errors=fix_safe.
    
    This is currently only enabled for a limited set of errors - initially
    just disk accounting; errors we would never not want to fix, and we
    don't want to require user intervention (i.e. to make sure a bug report
    gets filed).
    
    Errors will still be counted in the superblock, so we (developers) will
    still know they've been occuring if a bug report gets filed (as bug
    reports typically include the errors superblock section).
    
    Eventually we'll be enabling this for a much wider set of errors, after
    we've done thorough error injection testing.
    
    Signed-off-by: Kent Overstreet <kent.overstreet@linux.dev>

diff --git a/fs/bcachefs/error.h b/fs/bcachefs/error.h
index 36caedf72d89..777711504c35 100644
--- a/fs/bcachefs/error.h
+++ b/fs/bcachefs/error.h
@@ -108,13 +108,6 @@ struct fsck_err_state {
 	char			*last_msg;
 };
 
-enum bch_fsck_flags {
-	FSCK_CAN_FIX		= 1 << 0,
-	FSCK_CAN_IGNORE		= 1 << 1,
-	FSCK_NEED_FSCK		= 1 << 2,
-	FSCK_NO_RATELIMIT	= 1 << 3,
-};
-
 #define fsck_err_count(_c, _err)	bch2_sb_err_count(_c, BCH_FSCK_ERR_##_err)
 
 __printf(4, 5) __cold