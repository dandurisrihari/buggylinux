Commit Hash: 04ad99a0b160450ae615e41b839e444eccb5c99b
Subject: arm64: unwind: strip PAC from kernel addresses


Security Keywords:
- authentication

Full commit message:
arm64: unwind: strip PAC from kernel addresses

When we enable pointer authentication in the kernel, LR values saved to
the stack will have a PAC which we must strip in order to retrieve the
real return address.

Strip PACs when unwinding the stack in order to account for this.

When function graph tracer is used with patchable-function-entry then
return_to_handler will also have pac bits so strip it too.

Reviewed-by: Kees Cook <keescook@chromium.org>
Acked-by: Catalin Marinas <catalin.marinas@arm.com>
Reviewed-by: James Morse <james.morse@arm.com>
Signed-off-by: Mark Rutland <mark.rutland@arm.com>
Signed-off-by: Kristina Martsenko <kristina.martsenko@arm.com>
[Amit: Re-position ptrauth_strip_insn_pac, comment]
Signed-off-by: Amit Daniel Kachhap <amit.kachhap@arm.com>
Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>

Metadata:
Author: Mark Rutland <mark.rutland@arm.com>
Author Date: Fri Mar 13 14:34:59 2020 +0530
Committer: Catalin Marinas <catalin.marinas@arm.com>
Commit Date: Wed Mar 18 09:50:20 2020 +0000

Files Changed: 1
Lines Added: 4
Lines Removed: 1
Total Changes: 5
