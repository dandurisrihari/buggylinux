Commit Hash: 31a2fbb390fee4231281b939e1979e810f945415
Subject: x86/ptrace: Fix possible spectre-v1 in ptrace_get_debugreg()


Security Keywords:
- vulnerability
- sanitizing

Full commit message:
x86/ptrace: Fix possible spectre-v1 in ptrace_get_debugreg()

The index to access the threads ptrace_bps is controlled by userspace via
syscall: sys_ptrace(), hence leading to a potential exploitation of the
Spectre variant 1 vulnerability.

The index can be controlled from:
    ptrace -> arch_ptrace -> ptrace_get_debugreg.

Fix this by sanitizing the user supplied index before using it access
thread->ptrace_bps.

Signed-off-by: Dianzhang Chen <dianzhangchen0@gmail.com>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Cc: bp@alien8.de
Cc: hpa@zytor.com
Cc: stable@vger.kernel.org
Link: https://lkml.kernel.org/r/1561476617-3759-1-git-send-email-dianzhangchen0@gmail.com

Metadata:
Author: Dianzhang Chen <dianzhangchen0@gmail.com>
Author Date: Tue Jun 25 23:30:17 2019 +0800
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Thu Jun 27 23:48:04 2019 +0200

Files Changed: 1
Lines Added: 4
Lines Removed: 1
Total Changes: 5
