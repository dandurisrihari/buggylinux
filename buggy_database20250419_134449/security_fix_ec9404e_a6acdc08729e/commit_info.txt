Commit Hash: ec9404e40e8f36421a2b66ecb76dc2209fe7f3ef
Subject: x86/bhi: Add BHI mitigation knob


Security Keywords:
- hardening
- Injection

Full commit message:
x86/bhi: Add BHI mitigation knob

Branch history clearing software sequences and hardware control
BHI_DIS_S were defined to mitigate Branch History Injection (BHI).

Add cmdline spectre_bhi={on|off|auto} to control BHI mitigation:

 auto - Deploy the hardware mitigation BHI_DIS_S, if available.
 on   - Deploy the hardware mitigation BHI_DIS_S, if available,
        otherwise deploy the software sequence at syscall entry and
	VMexit.
 off  - Turn off BHI mitigation.

The default is auto mode which does not deploy the software sequence
mitigation.  This is because of the hardening done in the syscall
dispatch path, which is the likely target of BHI.

Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Daniel Sneddon <daniel.sneddon@linux.intel.com>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Reviewed-by: Alexandre Chartre <alexandre.chartre@oracle.com>
Reviewed-by: Josh Poimboeuf <jpoimboe@kernel.org>

Metadata:
Author: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Author Date: Mon Mar 11 08:57:05 2024 -0700
Committer: Thomas Gleixner <tglx@linutronix.de>
Commit Date: Mon Apr 8 19:27:05 2024 +0200

Files Changed: 5
Lines Added: 165
Lines Removed: 7
Total Changes: 172
