{
  "hash": "95a762e2c8c942780948091f8f2a4f32fce1ac6f",
  "hash_short": "95a762e2",
  "subject": "bpf: fix incorrect sign extension in check_alu_op()",
  "body": "Distinguish between\nBPF_ALU64|BPF_MOV|BPF_K (load 32-bit immediate, sign-extended to 64-bit)\nand BPF_ALU|BPF_MOV|BPF_K (load 32-bit immediate, zero-padded to 64-bit);\nonly perform sign extension in the first case.\n\nStarting with v4.14, this is exploitable by unprivileged users as long as\nthe unprivileged_bpf_disabled sysctl isn't set.\n\nDebian assigned CVE-2017-16995 for this issue.\n\nv3:\n - add CVE number (Ben Hutchings)\n\nFixes: 484611357c19 (\"bpf: allow access into map value arrays\")\nSigned-off-by: Jann Horn <jannh@google.com>\nAcked-by: Edward Cree <ecree@solarflare.com>\nSigned-off-by: Alexei Starovoitov <ast@kernel.org>\nSigned-off-by: Daniel Borkmann <daniel@iogearbox.net>",
  "full_message": "bpf: fix incorrect sign extension in check_alu_op()\n\nDistinguish between\nBPF_ALU64|BPF_MOV|BPF_K (load 32-bit immediate, sign-extended to 64-bit)\nand BPF_ALU|BPF_MOV|BPF_K (load 32-bit immediate, zero-padded to 64-bit);\nonly perform sign extension in the first case.\n\nStarting with v4.14, this is exploitable by unprivileged users as long as\nthe unprivileged_bpf_disabled sysctl isn't set.\n\nDebian assigned CVE-2017-16995 for this issue.\n\nv3:\n - add CVE number (Ben Hutchings)\n\nFixes: 484611357c19 (\"bpf: allow access into map value arrays\")\nSigned-off-by: Jann Horn <jannh@google.com>\nAcked-by: Edward Cree <ecree@solarflare.com>\nSigned-off-by: Alexei Starovoitov <ast@kernel.org>\nSigned-off-by: Daniel Borkmann <daniel@iogearbox.net>",
  "author_name": "Jann Horn",
  "author_email": "jannh@google.com",
  "author_date": "Mon Dec 18 20:11:54 2017 -0800",
  "author_date_iso": "2017-12-18T20:11:54-08:00",
  "committer_name": "Daniel Borkmann",
  "committer_email": "daniel@iogearbox.net",
  "committer_date": "Thu Dec 21 02:15:41 2017 +0100",
  "committer_date_iso": "2017-12-21T02:15:41+01:00",
  "files_changed": [
    "kernel/bpf/verifier.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "kernel/bpf/verifier.c",
      "insertions": 7,
      "deletions": 1
    }
  ],
  "total_insertions": 7,
  "total_deletions": 1,
  "total_changes": 8,
  "parents": [
    "4374f256ce8182019353c0c639bb8d0695b4c941"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.15",
    "v4.15-rc5",
    "v4.15-rc6",
    "v4.15-rc7",
    "v4.15-rc8",
    "v4.15-rc9",
    "v4.16",
    "v4.16-rc1",
    "v4.16-rc2",
    "v4.16-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2017-16995"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "kernel/bpf/verifier.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}