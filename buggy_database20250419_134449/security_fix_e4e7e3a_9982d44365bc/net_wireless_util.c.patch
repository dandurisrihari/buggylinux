commit e4e7e3af73694380f0d9a742d13b80598a3393e9
Author: Vinayak Yadawad <vinayak.yadawad@broadcom.com>
Date:   Tue Sep 26 16:02:22 2023 +0530

    wifi: cfg80211: Allow AP/P2PGO to indicate port authorization to peer STA/P2PClient
    
    In 4way handshake offload, cfg80211_port_authorized enables driver
    to indicate successful 4way handshake to cfg80211 layer. Currently
    this path of port authorization is restricted to interface type
    NL80211_IFTYPE_STATION and NL80211_IFTYPE_P2P_CLIENT. This patch
    extends the support for NL80211_IFTYPE_AP and NL80211_IFTYPE_P2P_GO
    interfaces to authorize peer STA/P2P_CLIENT, whenever authentication
    is offloaded on the AP/P2P_GO interface.
    
    Signed-off-by: Vinayak Yadawad <vinayak.yadawad@broadcom.com>
    Link: https://lore.kernel.org/r/dee3b0a2b4f617e932c90bff4504a89389273632.1695721435.git.vinayak.yadawad@broadcom.com
    Signed-off-by: Johannes Berg <johannes.berg@intel.com>

diff --git a/net/wireless/util.c b/net/wireless/util.c
index 0893b7f57832..626b858b4b35 100644
--- a/net/wireless/util.c
+++ b/net/wireless/util.c
@@ -1062,7 +1062,7 @@ void cfg80211_process_wdev_events(struct wireless_dev *wdev)
 			cfg80211_leave(wiphy_to_rdev(wdev->wiphy), wdev);
 			break;
 		case EVENT_PORT_AUTHORIZED:
-			__cfg80211_port_authorized(wdev, ev->pa.bssid,
+			__cfg80211_port_authorized(wdev, ev->pa.peer_addr,
 						   ev->pa.td_bitmap,
 						   ev->pa.td_bitmap_len);
 			break;