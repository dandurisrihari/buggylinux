{
  "hash": "ed1062772531b6e1029fa4ca62dc8d61f6d53d1c",
  "hash_short": "ed106277",
  "subject": "sctp: refactor sctp_packet_append_chunk and clenup some memory leaks",
  "body": "While doing some recent work on sctp sack bundling I noted that\nsctp_packet_append_chunk was pretty inefficient.  Specifially, it was called\nrecursively while trying to bundle auth and sack chunks.  Because of that we\ncall sctp_packet_bundle_sack and sctp_packet_bundle_auth a total of 4 times for\nevery call to sctp_packet_append_chunk, knowing that at least 3 of those calls\nwill do nothing.\n\nSo lets refactor sctp_packet_bundle_auth to have an outer part that does the\nattempted bundling, and an inner part that just does the chunk appends.  This\nsaves us several calls per iteration that we just don't need.\n\nAlso, noticed that the auth and sack bundling fail to free the chunks they\nallocate if the append fails, so make sure we add that in\n\nSigned-off-by: Neil Horman <nhorman@tuxdriver.com>\nCC: Vlad Yasevich <vyasevich@gmail.com>\nCC: \"David S. Miller\" <davem@davemloft.net>\nCC: linux-sctp@vger.kernel.org\nAcked-by: Vlad Yasevich <vyasevich@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "sctp: refactor sctp_packet_append_chunk and clenup some memory leaks\n\nWhile doing some recent work on sctp sack bundling I noted that\nsctp_packet_append_chunk was pretty inefficient.  Specifially, it was called\nrecursively while trying to bundle auth and sack chunks.  Because of that we\ncall sctp_packet_bundle_sack and sctp_packet_bundle_auth a total of 4 times for\nevery call to sctp_packet_append_chunk, knowing that at least 3 of those calls\nwill do nothing.\n\nSo lets refactor sctp_packet_bundle_auth to have an outer part that does the\nattempted bundling, and an inner part that just does the chunk appends.  This\nsaves us several calls per iteration that we just don't need.\n\nAlso, noticed that the auth and sack bundling fail to free the chunks they\nallocate if the append fails, so make sure we add that in\n\nSigned-off-by: Neil Horman <nhorman@tuxdriver.com>\nCC: Vlad Yasevich <vyasevich@gmail.com>\nCC: \"David S. Miller\" <davem@davemloft.net>\nCC: linux-sctp@vger.kernel.org\nAcked-by: Vlad Yasevich <vyasevich@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Neil Horman",
  "author_email": "nhorman@tuxdriver.com",
  "author_date": "Mon Jul 2 09:59:24 2012 +0000",
  "author_date_iso": "2012-07-02T09:59:24+00:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Sun Jul 8 23:56:16 2012 -0700",
  "committer_date_iso": "2012-07-08T23:56:16-07:00",
  "files_changed": [
    "net/sctp/output.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/sctp/output.c",
      "insertions": 52,
      "deletions": 27
    }
  ],
  "total_insertions": 52,
  "total_deletions": 27,
  "total_changes": 79,
  "parents": [
    "12aba9e7974c5aabf0f4b8e90a5943bfa17fadf4"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "auth"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/sctp/output.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}