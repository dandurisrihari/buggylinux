{
  "hash": "35f56c554eb1b56b77b3cf197a6b00922d49033d",
  "hash_short": "35f56c55",
  "subject": "netfilter: ipset: add missing range check in bitmap_ip_uadt",
  "body": "When tb[IPSET_ATTR_IP_TO] is not present but tb[IPSET_ATTR_CIDR] exists,\nthe values of ip and ip_to are slightly swapped. Therefore, the range check\nfor ip should be done later, but this part is missing and it seems that the\nvulnerability occurs.\n\nSo we should add missing range checks and remove unnecessary range checks.\n\nCc: <stable@vger.kernel.org>\nReported-by: syzbot+58c872f7790a4d2ac951@syzkaller.appspotmail.com\nFixes: 72205fc68bd1 (\"netfilter: ipset: bitmap:ip set type support\")\nSigned-off-by: Jeongjun Park <aha310510@gmail.com>\nAcked-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu>\nSigned-off-by: Pablo Neira Ayuso <pablo@netfilter.org>",
  "full_message": "netfilter: ipset: add missing range check in bitmap_ip_uadt\n\nWhen tb[IPSET_ATTR_IP_TO] is not present but tb[IPSET_ATTR_CIDR] exists,\nthe values of ip and ip_to are slightly swapped. Therefore, the range check\nfor ip should be done later, but this part is missing and it seems that the\nvulnerability occurs.\n\nSo we should add missing range checks and remove unnecessary range checks.\n\nCc: <stable@vger.kernel.org>\nReported-by: syzbot+58c872f7790a4d2ac951@syzkaller.appspotmail.com\nFixes: 72205fc68bd1 (\"netfilter: ipset: bitmap:ip set type support\")\nSigned-off-by: Jeongjun Park <aha310510@gmail.com>\nAcked-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu>\nSigned-off-by: Pablo Neira Ayuso <pablo@netfilter.org>",
  "author_name": "Jeongjun Park",
  "author_email": "aha310510@gmail.com",
  "author_date": "Wed Nov 13 22:02:09 2024 +0900",
  "author_date_iso": "2024-11-13T22:02:09+09:00",
  "committer_name": "Pablo Neira Ayuso",
  "committer_email": "pablo@netfilter.org",
  "committer_date": "Thu Nov 14 13:47:26 2024 +0100",
  "committer_date_iso": "2024-11-14T13:47:26+01:00",
  "files_changed": [
    "net/netfilter/ipset/ip_set_bitmap_ip.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/netfilter/ipset/ip_set_bitmap_ip.c",
      "insertions": 2,
      "deletions": 5
    }
  ],
  "total_insertions": 2,
  "total_deletions": 5,
  "total_changes": 7,
  "parents": [
    "041bd1e4f2d82859690cd8b41c35f0f9404c3770"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/netfilter/ipset/ip_set_bitmap_ip.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}