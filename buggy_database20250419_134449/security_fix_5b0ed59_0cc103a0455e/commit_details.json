{
  "hash": "5b0ed5964928b0aaf0d644c17c886c7f5ea4bb3f",
  "hash_short": "5b0ed596",
  "subject": "Merge tag 'for-6.3/block-2023-02-16' of git://git.kernel.dk/linux",
  "body": "Pull block updates from Jens Axboe:\n\n - NVMe updates via Christoph:\n      - Small improvements to the logging functionality (Amit Engel)\n      - Authentication cleanups (Hannes Reinecke)\n      - Cleanup and optimize the DMA mapping cod in the PCIe driver\n        (Keith Busch)\n      - Work around the command effects for Format NVM (Keith Busch)\n      - Misc cleanups (Keith Busch, Christoph Hellwig)\n      - Fix and cleanup freeing single sgl (Keith Busch)\n\n - MD updates via Song:\n      - Fix a rare crash during the takeover process\n      - Don't update recovery_cp when curr_resync is ACTIVE\n      - Free writes_pending in md_stop\n      - Change active_io to percpu\n\n - Updates to drbd, inching us closer to unifying the out-of-tree driver\n   with the in-tree one (Andreas, Christoph, Lars, Robert)\n\n - BFQ update adding support for multi-actuator drives (Paolo, Federico,\n   Davide)\n\n - Make brd compliant with REQ_NOWAIT (me)\n\n - Fix for IOPOLL and queue entering, fixing stalled IO waiting on\n   timeouts (me)\n\n - Fix for REQ_NOWAIT with multiple bios (me)\n\n - Fix memory leak in blktrace cleanup (Greg)\n\n - Clean up sbitmap and fix a potential hang (Kemeng)\n\n - Clean up some bits in BFQ, and fix a bug in the request injection\n   (Kemeng)\n\n - Clean up the request allocation and issue code, and fix some bugs\n   related to that (Kemeng)\n\n - ublk updates and fixes:\n      - Add support for unprivileged ublk (Ming)\n      - Improve device deletion handling (Ming)\n      - Misc (Liu, Ziyang)\n\n - s390 dasd fixes (Alexander, Qiheng)\n\n - Improve utility of request caching and fixes (Anuj, Xiao)\n\n - zoned cleanups (Pankaj)\n\n - More constification for kobjs (Thomas)\n\n - blk-iocost cleanups (Yu)\n\n - Remove bio splitting from drivers that don't need it (Christoph)\n\n - Switch blk-cgroups to use struct gendisk. Some of this is now\n   incomplete as select late reverts were done. (Christoph)\n\n - Add bvec initialization helpers, and convert callers to use that\n   rather than open-coding it (Christoph)\n\n - Misc fixes and cleanups (Jinke, Keith, Arnd, Bart, Li, Martin,\n   Matthew, Ulf, Zhong)\n\n* tag 'for-6.3/block-2023-02-16' of git://git.kernel.dk/linux: (169 commits)\n  brd: use radix_tree_maybe_preload instead of radix_tree_preload\n  block: use proper return value from bio_failfast()\n  block: bio-integrity: Copy flags when bio_integrity_payload is cloned\n  block: Fix io statistics for cgroup in throttle path\n  brd: mark as nowait compatible\n  brd: check for REQ_NOWAIT and set correct page allocation mask\n  brd: return 0/-error from brd_insert_page()\n  block: sync mixed merged request's failfast with 1st bio's\n  Revert \"blk-cgroup: pin the gendisk in struct blkcg_gq\"\n  Revert \"blk-cgroup: pass a gendisk to blkg_lookup\"\n  Revert \"blk-cgroup: delay blk-cgroup initialization until add_disk\"\n  Revert \"blk-cgroup: delay calling blkcg_exit_disk until disk_release\"\n  Revert \"blk-cgroup: move the cgroup information to struct gendisk\"\n  nvme-pci: remove iod use_sgls\n  nvme-pci: fix freeing single sgl\n  block: ublk: check IO buffer based on flag need_get_data\n  s390/dasd: Fix potential memleak in dasd_eckd_init()\n  s390/dasd: sort out physical vs virtual pointers usage\n  block: Remove the ALLOC_CACHE_SLACK constant\n  block: make kobj_type structures constant\n  ...",
  "full_message": "Merge tag 'for-6.3/block-2023-02-16' of git://git.kernel.dk/linux\n\nPull block updates from Jens Axboe:\n\n - NVMe updates via Christoph:\n      - Small improvements to the logging functionality (Amit Engel)\n      - Authentication cleanups (Hannes Reinecke)\n      - Cleanup and optimize the DMA mapping cod in the PCIe driver\n        (Keith Busch)\n      - Work around the command effects for Format NVM (Keith Busch)\n      - Misc cleanups (Keith Busch, Christoph Hellwig)\n      - Fix and cleanup freeing single sgl (Keith Busch)\n\n - MD updates via Song:\n      - Fix a rare crash during the takeover process\n      - Don't update recovery_cp when curr_resync is ACTIVE\n      - Free writes_pending in md_stop\n      - Change active_io to percpu\n\n - Updates to drbd, inching us closer to unifying the out-of-tree driver\n   with the in-tree one (Andreas, Christoph, Lars, Robert)\n\n - BFQ update adding support for multi-actuator drives (Paolo, Federico,\n   Davide)\n\n - Make brd compliant with REQ_NOWAIT (me)\n\n - Fix for IOPOLL and queue entering, fixing stalled IO waiting on\n   timeouts (me)\n\n - Fix for REQ_NOWAIT with multiple bios (me)\n\n - Fix memory leak in blktrace cleanup (Greg)\n\n - Clean up sbitmap and fix a potential hang (Kemeng)\n\n - Clean up some bits in BFQ, and fix a bug in the request injection\n   (Kemeng)\n\n - Clean up the request allocation and issue code, and fix some bugs\n   related to that (Kemeng)\n\n - ublk updates and fixes:\n      - Add support for unprivileged ublk (Ming)\n      - Improve device deletion handling (Ming)\n      - Misc (Liu, Ziyang)\n\n - s390 dasd fixes (Alexander, Qiheng)\n\n - Improve utility of request caching and fixes (Anuj, Xiao)\n\n - zoned cleanups (Pankaj)\n\n - More constification for kobjs (Thomas)\n\n - blk-iocost cleanups (Yu)\n\n - Remove bio splitting from drivers that don't need it (Christoph)\n\n - Switch blk-cgroups to use struct gendisk. Some of this is now\n   incomplete as select late reverts were done. (Christoph)\n\n - Add bvec initialization helpers, and convert callers to use that\n   rather than open-coding it (Christoph)\n\n - Misc fixes and cleanups (Jinke, Keith, Arnd, Bart, Li, Martin,\n   Matthew, Ulf, Zhong)\n\n* tag 'for-6.3/block-2023-02-16' of git://git.kernel.dk/linux: (169 commits)\n  brd: use radix_tree_maybe_preload instead of radix_tree_preload\n  block: use proper return value from bio_failfast()\n  block: bio-integrity: Copy flags when bio_integrity_payload is cloned\n  block: Fix io statistics for cgroup in throttle path\n  brd: mark as nowait compatible\n  brd: check for REQ_NOWAIT and set correct page allocation mask\n  brd: return 0/-error from brd_insert_page()\n  block: sync mixed merged request's failfast with 1st bio's\n  Revert \"blk-cgroup: pin the gendisk in struct blkcg_gq\"\n  Revert \"blk-cgroup: pass a gendisk to blkg_lookup\"\n  Revert \"blk-cgroup: delay blk-cgroup initialization until add_disk\"\n  Revert \"blk-cgroup: delay calling blkcg_exit_disk until disk_release\"\n  Revert \"blk-cgroup: move the cgroup information to struct gendisk\"\n  nvme-pci: remove iod use_sgls\n  nvme-pci: fix freeing single sgl\n  block: ublk: check IO buffer based on flag need_get_data\n  s390/dasd: Fix potential memleak in dasd_eckd_init()\n  s390/dasd: sort out physical vs virtual pointers usage\n  block: Remove the ALLOC_CACHE_SLACK constant\n  block: make kobj_type structures constant\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Mon Feb 20 14:27:21 2023 -0800",
  "author_date_iso": "2023-02-20T14:27:21-08:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Mon Feb 20 14:27:21 2023 -0800",
  "committer_date_iso": "2023-02-20T14:27:21-08:00",
  "files_changed": [
    "MAINTAINERS",
    "block/bfq-cgroup.c",
    "block/bfq-iosched.c",
    "block/blk-cgroup.c",
    "block/blk-map.c",
    "block/blk-merge.c",
    "block/blk-mq.c",
    "drivers/block/ublk_drv.c",
    "drivers/nvme/host/auth.c",
    "drivers/nvme/host/core.c",
    "drivers/nvme/host/pci.c",
    "fs/ceph/file.c",
    "fs/coredump.c",
    "fs/orangefs/inode.c",
    "mm/swapfile.c"
  ],
  "files_changed_count": 15,
  "stats": [
    {
      "file": "Documentation/ABI/stable/sysfs-block",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "Documentation/block/capability.rst",
      "insertions": 0,
      "deletions": 10
    },
    {
      "file": "Documentation/block/index.rst",
      "insertions": 0,
      "deletions": 1
    },
    {
      "file": "Documentation/block/ublk.rst",
      "insertions": 46,
      "deletions": 9
    },
    {
      "file": "MAINTAINERS",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "block/Kconfig.iosched",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "block/bfq-cgroup.c",
      "insertions": 55,
      "deletions": 50
    },
    {
      "file": "block/bfq-iosched.c",
      "insertions": 417,
      "deletions": 212
    },
    {
      "file": "block/bfq-iosched.h",
      "insertions": 113,
      "deletions": 33
    },
    {
      "file": "block/bfq-wf2q.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "block/bio-integrity.c",
      "insertions": 2,
      "deletions": 6
    },
    {
      "file": "block/bio.c",
      "insertions": 4,
      "deletions": 11
    },
    {
      "file": "block/blk-cgroup.c",
      "insertions": 91,
      "deletions": 59
    },
    {
      "file": "block/blk-cgroup.h",
      "insertions": 7,
      "deletions": 7
    },
    {
      "file": "block/blk-core.c",
      "insertions": 23,
      "deletions": 13
    },
    {
      "file": "block/blk-crypto-sysfs.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "block/blk-ia-ranges.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "block/blk-integrity.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "block/blk-iocost.c",
      "insertions": 47,
      "deletions": 31
    },
    {
      "file": "block/blk-iolatency.c",
      "insertions": 15,
      "deletions": 22
    },
    {
      "file": "block/blk-ioprio.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "block/blk-map.c",
      "insertions": 2,
      "deletions": 4
    },
    {
      "file": "block/blk-merge.c",
      "insertions": 33,
      "deletions": 2
    },
    {
      "file": "block/blk-mq-debugfs.c",
      "insertions": 4,
      "deletions": 6
    },
    {
      "file": "block/blk-mq-sched.c",
      "insertions": 3,
      "deletions": 4
    },
    {
      "file": "block/blk-mq-sysfs.c",
      "insertions": 3,
      "deletions": 27
    },
    {
      "file": "block/blk-mq.c",
      "insertions": 69,
      "deletions": 83
    },
    {
      "file": "block/blk-rq-qos.c",
      "insertions": 67,
      "deletions": 0
    },
    {
      "file": "block/blk-rq-qos.h",
      "insertions": 5,
      "deletions": 61
    },
    {
      "file": "block/blk-settings.c",
      "insertions": 8,
      "deletions": 2
    },
    {
      "file": "block/blk-stat.c",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "block/blk-sysfs.c",
      "insertions": 19,
      "deletions": 9
    },
    {
      "file": "block/blk-throttle.c",
      "insertions": 5,
      "deletions": 6
    },
    {
      "file": "block/blk-wbt.c",
      "insertions": 95,
      "deletions": 21
    },
    {
      "file": "block/blk-wbt.h",
      "insertions": 6,
      "deletions": 92
    },
    {
      "file": "block/blk-zoned.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "block/elevator.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "block/fops.c",
      "insertions": 18,
      "deletions": 3
    },
    {
      "file": "block/genhd.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "drivers/block/brd.c",
      "insertions": 37,
      "deletions": 30
    },
    {
      "file": "drivers/block/drbd/Makefile",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/block/drbd/drbd_buildtag.c",
      "insertions": 22,
      "deletions": 0
    },
    {
      "file": "drivers/block/drbd/drbd_debugfs.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/block/drbd/drbd_int.h",
      "insertions": 2,
      "deletions": 11
    },
    {
      "file": "drivers/block/drbd/drbd_interval.c",
      "insertions": 5,
      "deletions": 1
    },
    {
      "file": "drivers/block/drbd/drbd_main.c",
      "insertions": 1,
      "deletions": 19
    },
    {
      "file": "drivers/block/drbd/drbd_proc.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/block/drbd/drbd_vli.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/block/loop.c",
      "insertions": 10,
      "deletions": 4
    },
    {
      "file": "drivers/block/null_blk/main.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/block/ps3vram.c",
      "insertions": 0,
      "deletions": 7
    },
    {
      "file": "drivers/block/rbd.c",
      "insertions": 3,
      "deletions": 4
    },
    {
      "file": "drivers/block/ublk_drv.c",
      "insertions": 302,
      "deletions": 103
    },
    {
      "file": "drivers/block/virtio_blk.c",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "drivers/block/zram/zram_drv.c",
      "insertions": 4,
      "deletions": 11
    },
    {
      "file": "drivers/md/md.c",
      "insertions": 42,
      "deletions": 23
    },
    {
      "file": "drivers/md/md.h",
      "insertions": 5,
      "deletions": 4
    },
    {
      "file": "drivers/nvme/host/auth.c",
      "insertions": 15,
      "deletions": 15
    },
    {
      "file": "drivers/nvme/host/constants.c",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "drivers/nvme/host/core.c",
      "insertions": 67,
      "deletions": 56
    },
    {
      "file": "drivers/nvme/host/fabrics.c",
      "insertions": 17,
      "deletions": 2
    },
    {
      "file": "drivers/nvme/host/ioctl.c",
      "insertions": 5,
      "deletions": 4
    },
    {
      "file": "drivers/nvme/host/nvme.h",
      "insertions": 15,
      "deletions": 1
    },
    {
      "file": "drivers/nvme/host/pci.c",
      "insertions": 26,
      "deletions": 78
    },
    {
      "file": "drivers/nvme/host/tcp.c",
      "insertions": 5,
      "deletions": 2
    },
    {
      "file": "drivers/nvme/target/admin-cmd.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/nvme/target/io-cmd-file.c",
      "insertions": 2,
      "deletions": 8
    },
    {
      "file": "drivers/nvme/target/passthru.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/nvme/target/tcp.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "drivers/nvme/target/zns.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/s390/block/dasd.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "drivers/s390/block/dasd_3990_erp.c",
      "insertions": 5,
      "deletions": 5
    },
    {
      "file": "drivers/s390/block/dasd_alias.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "drivers/s390/block/dasd_eckd.c",
      "insertions": 52,
      "deletions": 52
    },
    {
      "file": "drivers/s390/block/dasd_eer.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/s390/block/dasd_fba.c",
      "insertions": 7,
      "deletions": 7
    },
    {
      "file": "drivers/s390/block/dcssblk.c",
      "insertions": 0,
      "deletions": 4
    },
    {
      "file": "drivers/scsi/sd.c",
      "insertions": 17,
      "deletions": 19
    },
    {
      "file": "drivers/target/target_core_file.c",
      "insertions": 6,
      "deletions": 12
    },
    {
      "file": "drivers/vhost/vringh.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "fs/afs/write.c",
      "insertions": 3,
      "deletions": 5
    },
    {
      "file": "fs/ceph/file.c",
      "insertions": 4,
      "deletions": 8
    },
    {
      "file": "fs/cifs/connect.c",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "fs/cifs/fscache.c",
      "insertions": 6,
      "deletions": 10
    },
    {
      "file": "fs/cifs/misc.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "fs/cifs/smb2ops.c",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "fs/coredump.c",
      "insertions": 2,
      "deletions": 5
    },
    {
      "file": "fs/nfs/fscache.c",
      "insertions": 6,
      "deletions": 10
    },
    {
      "file": "fs/orangefs/inode.c",
      "insertions": 7,
      "deletions": 15
    },
    {
      "file": "fs/splice.c",
      "insertions": 2,
      "deletions": 3
    },
    {
      "file": "include/linux/blkdev.h",
      "insertions": 21,
      "deletions": 6
    },
    {
      "file": "include/linux/bvec.h",
      "insertions": 40,
      "deletions": 1
    },
    {
      "file": "include/linux/drbd.h",
      "insertions": 0,
      "deletions": 7
    },
    {
      "file": "include/linux/drbd_config.h",
      "insertions": 16,
      "deletions": 0
    },
    {
      "file": "include/linux/drbd_genl_api.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/linux/drbd_limits.h",
      "insertions": 102,
      "deletions": 102
    },
    {
      "file": "include/linux/sched.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/uapi/linux/ublk_cmd.h",
      "insertions": 47,
      "deletions": 2
    },
    {
      "file": "io_uring/rsrc.c",
      "insertions": 1,
      "deletions": 3
    },
    {
      "file": "kernel/fork.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "kernel/trace/blktrace.c",
      "insertions": 2,
      "deletions": 2
    },
    {
      "file": "lib/sbitmap.c",
      "insertions": 45,
      "deletions": 57
    },
    {
      "file": "mm/page_io.c",
      "insertions": 2,
      "deletions": 6
    },
    {
      "file": "mm/swapfile.c",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "net/ceph/messenger_v1.c",
      "insertions": 2,
      "deletions": 5
    },
    {
      "file": "net/ceph/messenger_v2.c",
      "insertions": 11,
      "deletions": 17
    },
    {
      "file": "net/rxrpc/rxperf.c",
      "insertions": 3,
      "deletions": 5
    },
    {
      "file": "net/sunrpc/svcsock.c",
      "insertions": 2,
      "deletions": 5
    },
    {
      "file": "net/sunrpc/xdr.c",
      "insertions": 2,
      "deletions": 3
    }
  ],
  "total_insertions": 2224,
  "total_deletions": 1599,
  "total_changes": 3823,
  "parents": [
    "553637f73c314c742243b8dc5ef072e9dadbe581",
    "0aa2988e4fd23c0c8b33999d7b47dfbc5e6bf24b"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "Authentication",
      "injection"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "block/bfq-cgroup.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "block/blk-map.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "block/blk-cgroup.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "block/blk-merge.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/block/ublk_drv.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "block/blk-mq.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "block/bfq-iosched.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/auth.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/ceph/file.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "MAINTAINERS",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/pci.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/coredump.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "fs/orangefs/inode.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/nvme/host/core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "mm/swapfile.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}