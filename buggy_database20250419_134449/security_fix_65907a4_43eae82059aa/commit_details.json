{
  "hash": "65907a433ac0ca450c4408080f24c6e4743386b2",
  "hash_short": "65907a43",
  "subject": "dccp ccid-2: Bug-Fix - Ack Vectors need to be ignored on request sockets",
  "body": "This fixes an oversight from an earlier patch, ensuring that Ack Vectors\nare not processed on request sockets.\n\nThe issue is that Ack Vectors must not be parsed on request sockets, since\nthe Ack Vector feature depends on the selection of the (TX) CCID. During the\ninitial handshake the CCIDs are undefined, and so RFC 4340, 10.3 applies:\n\n \"Using CCID-specific options and feature options during a negotiation\n  for the corresponding CCID feature is NOT RECOMMENDED [...]\"\n\nAnd it is not even possible: when the server receives the Request from the \nclient, the CCID and Ack vector features are undefined; when the Ack finalising\nthe 3-way hanshake arrives, the request socket has not been cloned yet into a\nfull socket. (This order is necessary, since otherwise the newly created socket\nwould have to be destroyed whenever an option error occurred - a malicious\nhacker could simply send garbage options and exploit this.)\n\nSigned-off-by: Gerrit Renker <gerrit@erg.abdn.ac.uk>",
  "full_message": "dccp ccid-2: Bug-Fix - Ack Vectors need to be ignored on request sockets\n\nThis fixes an oversight from an earlier patch, ensuring that Ack Vectors\nare not processed on request sockets.\n\nThe issue is that Ack Vectors must not be parsed on request sockets, since\nthe Ack Vector feature depends on the selection of the (TX) CCID. During the\ninitial handshake the CCIDs are undefined, and so RFC 4340, 10.3 applies:\n\n \"Using CCID-specific options and feature options during a negotiation\n  for the corresponding CCID feature is NOT RECOMMENDED [...]\"\n\nAnd it is not even possible: when the server receives the Request from the \nclient, the CCID and Ack vector features are undefined; when the Ack finalising\nthe 3-way hanshake arrives, the request socket has not been cloned yet into a\nfull socket. (This order is necessary, since otherwise the newly created socket\nwould have to be destroyed whenever an option error occurred - a malicious\nhacker could simply send garbage options and exploit this.)\n\nSigned-off-by: Gerrit Renker <gerrit@erg.abdn.ac.uk>",
  "author_name": "Gerrit Renker",
  "author_email": "gerrit@erg.abdn.ac.uk",
  "author_date": "Wed Jun 11 11:19:09 2008 +0100",
  "author_date_iso": "2008-06-11T11:19:09+01:00",
  "committer_name": "Gerrit Renker",
  "committer_email": "gerrit@erg.abdn.ac.uk",
  "committer_date": "Wed Jun 11 11:19:09 2008 +0100",
  "committer_date_iso": "2008-06-11T11:19:09+01:00",
  "files_changed": [
    "net/dccp/options.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/dccp/options.c",
      "insertions": 3,
      "deletions": 1
    }
  ],
  "total_insertions": 3,
  "total_deletions": 1,
  "total_changes": 4,
  "parents": [
    "1e2f0e5e8376f2a0ada8760fc9d3104e1a81382b"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.26",
    "v2.6.26-rc7",
    "v2.6.26-rc8",
    "v2.6.26-rc9",
    "v2.6.27",
    "v2.6.27-rc1",
    "v2.6.27-rc2",
    "v2.6.27-rc3",
    "v2.6.27-rc4",
    "v2.6.27-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/dccp/options.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}