Commit Hash: 71ba994c94a81c37185ef2fb5190844286ba9aca
Subject: KVM: x86: clean/fix memory barriers in irqchip_in_kernel


Security Keywords:
- injection

Full commit message:
KVM: x86: clean/fix memory barriers in irqchip_in_kernel

The memory barriers are trying to protect against concurrent RCU-based
interrupt injection, but the IRQ routing table is not valid at the time
kvm->arch.vpic is written.  Fix this by writing kvm->arch.vpic last.
kvm_destroy_pic then need not set kvm->arch.vpic to NULL; modify it
to take a struct kvm_pic* and reuse it if the IOAPIC creation fails.

Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>

Metadata:
Author: Paolo Bonzini <pbonzini@redhat.com>
Author Date: Wed Jul 29 12:31:15 2015 +0200
Committer: Paolo Bonzini <pbonzini@redhat.com>
Commit Date: Thu Jul 30 16:02:56 2015 +0200

Files Changed: 3
Lines Added: 15
Lines Removed: 25
Total Changes: 40
