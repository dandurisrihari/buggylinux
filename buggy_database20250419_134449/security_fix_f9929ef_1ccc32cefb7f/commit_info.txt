Commit Hash: f9929ef6a2a55f03aac61248c6a3a987b8546f2a
Subject: ksmbd: add support for key exchange


Security Keywords:
- authentication

Full commit message:
ksmbd: add support for key exchange

When mounting cifs client, can see the following warning message.

CIFS: decode_ntlmssp_challenge: authentication has been weakened as server
does not support key exchange

To remove this warning message, Add support for key exchange feature to
ksmbd. This patch decrypts 16-byte ciphertext value sent by the client
using RC4 with session key. The decrypted value is the recovered secondary
key that will use instead of the session key for signing and sealing.

Signed-off-by: Namjae Jeon <linkinjeon@kernel.org>
Signed-off-by: Steve French <stfrench@microsoft.com>

Metadata:
Author: Namjae Jeon <linkinjeon@kernel.org>
Author Date: Tue Feb 1 18:20:34 2022 +0900
Committer: Steve French <stfrench@microsoft.com>
Commit Date: Fri Feb 4 00:12:22 2022 -0600

Files Changed: 2
Lines Added: 29
Lines Removed: 2
Total Changes: 31
