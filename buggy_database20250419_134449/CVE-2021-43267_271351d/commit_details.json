{
  "hash": "271351d255b09e39c7f6437738cba595f9b235be",
  "hash_short": "271351d2",
  "subject": "tipc: only accept encrypted MSG_CRYPTO msgs",
  "body": "The MSG_CRYPTO msgs are always encrypted and sent to other nodes\nfor keys' deployment. But when receiving in peers, if those nodes\ndo not validate it and make sure it's encrypted, one could craft\na malicious MSG_CRYPTO msg to deploy its key with no need to know\nother nodes' keys.\n\nThis patch is to do that by checking TIPC_SKB_CB(skb)->decrypted\nand discard it if this packet never got decrypted.\n\nNote that this is also a supplementary fix to CVE-2021-43267 that\ncan be triggered by an unencrypted malicious MSG_CRYPTO msg.\n\nFixes: 1ef6f7c9390f (\"tipc: add automatic session key exchange\")\nAcked-by: Ying Xue <ying.xue@windriver.com>\nAcked-by: Jon Maloy <jmaloy@redhat.com>\nSigned-off-by: Xin Long <lucien.xin@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "tipc: only accept encrypted MSG_CRYPTO msgs\n\nThe MSG_CRYPTO msgs are always encrypted and sent to other nodes\nfor keys' deployment. But when receiving in peers, if those nodes\ndo not validate it and make sure it's encrypted, one could craft\na malicious MSG_CRYPTO msg to deploy its key with no need to know\nother nodes' keys.\n\nThis patch is to do that by checking TIPC_SKB_CB(skb)->decrypted\nand discard it if this packet never got decrypted.\n\nNote that this is also a supplementary fix to CVE-2021-43267 that\ncan be triggered by an unencrypted malicious MSG_CRYPTO msg.\n\nFixes: 1ef6f7c9390f (\"tipc: add automatic session key exchange\")\nAcked-by: Ying Xue <ying.xue@windriver.com>\nAcked-by: Jon Maloy <jmaloy@redhat.com>\nSigned-off-by: Xin Long <lucien.xin@gmail.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Xin Long",
  "author_email": "lucien.xin@gmail.com",
  "author_date": "Mon Nov 15 07:45:24 2021 -0500",
  "author_date_iso": "2021-11-15T07:45:24-05:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Mon Nov 15 14:25:22 2021 +0000",
  "committer_date_iso": "2021-11-15T14:25:22+00:00",
  "files_changed": [
    "net/tipc/link.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/tipc/link.c",
      "insertions": 5,
      "deletions": 2
    }
  ],
  "total_insertions": 5,
  "total_deletions": 2,
  "total_changes": 7,
  "parents": [
    "6def480181f15f6d9ec812bca8cbc62451ba314c"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2021-43267"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/tipc/link.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}