{
  "hash": "c12e56ef6951f4fce1afe9ef6aab9243ea9a9b04",
  "hash_short": "c12e56ef",
  "subject": "RDMA/nes: Don't allow userspace QPs to use STag zero",
  "body": "STag zero is a special STag that allows consumers to access any bus\naddress without registering memory.  The nes driver unfortunately\nallows STag zero to be used even with QPs created by unprivileged\nuserspace consumers, which means that any process with direct verbs\naccess to the nes device can read and write any memory accessible to\nthe underlying PCI device (usually any memory in the system).  Such\naccess is usually given for cluster software such as MPI to use, so\nthis is a local privilege escalation bug on most systems running this\ndriver.\n\nThe driver was using STag zero to receive the last streaming mode\ndata; to allow STag zero to be disabled for unprivileged QPs, the\ndriver now registers a special MR for this data.\n\nCc: <stable@kernel.org>\nSigned-off-by: Faisal Latif <faisal.latif@intel.com>\nSigned-off-by: Roland Dreier <rolandd@cisco.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "full_message": "RDMA/nes: Don't allow userspace QPs to use STag zero\n\nSTag zero is a special STag that allows consumers to access any bus\naddress without registering memory.  The nes driver unfortunately\nallows STag zero to be used even with QPs created by unprivileged\nuserspace consumers, which means that any process with direct verbs\naccess to the nes device can read and write any memory accessible to\nthe underlying PCI device (usually any memory in the system).  Such\naccess is usually given for cluster software such as MPI to use, so\nthis is a local privilege escalation bug on most systems running this\ndriver.\n\nThe driver was using STag zero to receive the last streaming mode\ndata; to allow STag zero to be disabled for unprivileged QPs, the\ndriver now registers a special MR for this data.\n\nCc: <stable@kernel.org>\nSigned-off-by: Faisal Latif <faisal.latif@intel.com>\nSigned-off-by: Roland Dreier <rolandd@cisco.com>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
  "author_name": "Faisal Latif",
  "author_email": "faisal.latif@intel.com",
  "author_date": "Thu Mar 12 14:34:59 2009 -0700",
  "author_date_iso": "2009-03-12T14:34:59-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Thu Mar 12 16:21:41 2009 -0700",
  "committer_date_iso": "2009-03-12T16:21:41-07:00",
  "files_changed": [
    "drivers/infiniband/hw/nes/nes_cm.c",
    "drivers/infiniband/hw/nes/nes_verbs.c",
    "drivers/infiniband/hw/nes/nes_verbs.h"
  ],
  "files_changed_count": 3,
  "stats": [
    {
      "file": "drivers/infiniband/hw/nes/nes_cm.c",
      "insertions": 34,
      "deletions": 5
    },
    {
      "file": "drivers/infiniband/hw/nes/nes_verbs.c",
      "insertions": 2,
      "deletions": 0
    },
    {
      "file": "drivers/infiniband/hw/nes/nes_verbs.h",
      "insertions": 1,
      "deletions": 0
    }
  ],
  "total_insertions": 37,
  "total_deletions": 5,
  "total_changes": 42,
  "parents": [
    "7ef0d7377cb287e08f3ae94cebc919448e1f5dff"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.29",
    "v2.6.29-rc8",
    "v2.6.30",
    "v2.6.30-rc1",
    "v2.6.30-rc2",
    "v2.6.30-rc3",
    "v2.6.30-rc4",
    "v2.6.30-rc5",
    "v2.6.30-rc6",
    "v2.6.30-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "privilege escalation"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/infiniband/hw/nes/nes_cm.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/nes/nes_verbs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/hw/nes/nes_verbs.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}