{
  "hash": "06e7e776ca4d36547e503279aeff996cbb292c16",
  "hash_short": "06e7e776",
  "subject": "Bluetooth: Prevent stack info leak from the EFS element.",
  "body": "In the function l2cap_parse_conf_rsp and in the function\nl2cap_parse_conf_req the following variable is declared without\ninitialization:\n\nstruct l2cap_conf_efs efs;\n\nIn addition, when parsing input configuration parameters in both of\nthese functions, the switch case for handling EFS elements may skip the\nmemcpy call that will write to the efs variable:\n\n...\ncase L2CAP_CONF_EFS:\nif (olen == sizeof(efs))\nmemcpy(&efs, (void *)val, olen);\n...\n\nThe olen in the above if is attacker controlled, and regardless of that\nif, in both of these functions the efs variable would eventually be\nadded to the outgoing configuration request that is being built:\n\nl2cap_add_conf_opt(&ptr, L2CAP_CONF_EFS, sizeof(efs), (unsigned long) &efs);\n\nSo by sending a configuration request, or response, that contains an\nL2CAP_CONF_EFS element, but with an element length that is not\nsizeof(efs) - the memcpy to the uninitialized efs variable can be\navoided, and the uninitialized variable would be returned to the\nattacker (16 bytes).\n\nThis issue has been assigned CVE-2017-1000410\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Ben Seri <ben@armis.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
  "full_message": "Bluetooth: Prevent stack info leak from the EFS element.\n\nIn the function l2cap_parse_conf_rsp and in the function\nl2cap_parse_conf_req the following variable is declared without\ninitialization:\n\nstruct l2cap_conf_efs efs;\n\nIn addition, when parsing input configuration parameters in both of\nthese functions, the switch case for handling EFS elements may skip the\nmemcpy call that will write to the efs variable:\n\n...\ncase L2CAP_CONF_EFS:\nif (olen == sizeof(efs))\nmemcpy(&efs, (void *)val, olen);\n...\n\nThe olen in the above if is attacker controlled, and regardless of that\nif, in both of these functions the efs variable would eventually be\nadded to the outgoing configuration request that is being built:\n\nl2cap_add_conf_opt(&ptr, L2CAP_CONF_EFS, sizeof(efs), (unsigned long) &efs);\n\nSo by sending a configuration request, or response, that contains an\nL2CAP_CONF_EFS element, but with an element length that is not\nsizeof(efs) - the memcpy to the uninitialized efs variable can be\navoided, and the uninitialized variable would be returned to the\nattacker (16 bytes).\n\nThis issue has been assigned CVE-2017-1000410\n\nCc: Marcel Holtmann <marcel@holtmann.org>\nCc: Gustavo Padovan <gustavo@padovan.org>\nCc: Johan Hedberg <johan.hedberg@gmail.com>\nCc: stable <stable@vger.kernel.org>\nSigned-off-by: Ben Seri <ben@armis.com>\nSigned-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>",
  "author_name": "Ben Seri",
  "author_email": "ben@armis.com",
  "author_date": "Fri Dec 8 15:14:47 2017 +0100",
  "author_date_iso": "2017-12-08T15:14:47+01:00",
  "committer_name": "Greg Kroah-Hartman",
  "committer_email": "gregkh@linuxfoundation.org",
  "committer_date": "Thu Jan 4 17:01:01 2018 +0100",
  "committer_date_iso": "2018-01-04T17:01:01+01:00",
  "files_changed": [
    "net/bluetooth/l2cap_core.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/l2cap_core.c",
      "insertions": 11,
      "deletions": 9
    }
  ],
  "total_insertions": 11,
  "total_deletions": 9,
  "total_changes": 20,
  "parents": [
    "30a7acd573899fd8b8ac39236eff6468b195ac7d"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.15",
    "v4.15-rc8",
    "v4.15-rc9",
    "v4.16",
    "v4.16-rc1",
    "v4.16-rc2",
    "v4.16-rc3",
    "v4.16-rc4",
    "v4.16-rc5",
    "v4.16-rc6"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2017-1000410"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "net/bluetooth/l2cap_core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}