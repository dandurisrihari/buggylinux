Commit Hash: e479ab651f071dbd1518ce8fb121c7f42f2bb97d
Subject: mac80211: Fix FILS AEAD protection in Association Request frame


Security Keywords:
- authentication

Full commit message:
mac80211: Fix FILS AEAD protection in Association Request frame

Incorrect num_elem parameter value (1 vs. 5) was used in the
aes_siv_encrypt() call. This resulted in only the first one of the five
AAD vectors to SIV getting included in calculation. This does not
protect all the contents correctly and would not interoperate with a
standard compliant implementation.

Fix this by using the correct number. A matching fix is needed in the AP
side (hostapd) to get FILS authentication working properly.

Fixes: 39404feee691 ("mac80211: FILS AEAD protection for station mode association frames")
Reported-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>
Signed-off-by: Jouni Malinen <jouni@qca.qualcomm.com>
Signed-off-by: Johannes Berg <johannes.berg@intel.com>

Metadata:
Author: Jouni Malinen <jouni@qca.qualcomm.com>
Author Date: Sat Feb 4 13:59:22 2017 +0200
Committer: Johannes Berg <johannes.berg@intel.com>
Commit Date: Mon Feb 6 07:42:39 2017 +0100

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
