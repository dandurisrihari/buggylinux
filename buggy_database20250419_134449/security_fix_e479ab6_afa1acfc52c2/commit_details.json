{
  "hash": "e479ab651f071dbd1518ce8fb121c7f42f2bb97d",
  "hash_short": "e479ab65",
  "subject": "mac80211: Fix FILS AEAD protection in Association Request frame",
  "body": "Incorrect num_elem parameter value (1 vs. 5) was used in the\naes_siv_encrypt() call. This resulted in only the first one of the five\nAAD vectors to SIV getting included in calculation. This does not\nprotect all the contents correctly and would not interoperate with a\nstandard compliant implementation.\n\nFix this by using the correct number. A matching fix is needed in the AP\nside (hostapd) to get FILS authentication working properly.\n\nFixes: 39404feee691 (\"mac80211: FILS AEAD protection for station mode association frames\")\nReported-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Jouni Malinen <jouni@qca.qualcomm.com>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "mac80211: Fix FILS AEAD protection in Association Request frame\n\nIncorrect num_elem parameter value (1 vs. 5) was used in the\naes_siv_encrypt() call. This resulted in only the first one of the five\nAAD vectors to SIV getting included in calculation. This does not\nprotect all the contents correctly and would not interoperate with a\nstandard compliant implementation.\n\nFix this by using the correct number. A matching fix is needed in the AP\nside (hostapd) to get FILS authentication working properly.\n\nFixes: 39404feee691 (\"mac80211: FILS AEAD protection for station mode association frames\")\nReported-by: Ard Biesheuvel <ard.biesheuvel@linaro.org>\nSigned-off-by: Jouni Malinen <jouni@qca.qualcomm.com>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Jouni Malinen",
  "author_email": "jouni@qca.qualcomm.com",
  "author_date": "Sat Feb 4 13:59:22 2017 +0200",
  "author_date_iso": "2017-02-04T13:59:22+02:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Mon Feb 6 07:42:39 2017 +0100",
  "committer_date_iso": "2017-02-06T07:42:39+01:00",
  "files_changed": [
    "net/mac80211/fils_aead.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/mac80211/fils_aead.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "7892032cfe67f4bde6fc2ee967e45a8fbaf33756"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.10",
    "v4.10-rc8",
    "v4.11",
    "v4.11-rc1",
    "v4.11-rc2",
    "v4.11-rc3",
    "v4.11-rc4",
    "v4.11-rc5",
    "v4.11-rc6",
    "v4.11-rc7"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/mac80211/fils_aead.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}