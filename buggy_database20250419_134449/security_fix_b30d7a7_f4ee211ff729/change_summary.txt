Files changed: 4
Insertions: 20334
Deletions: 11817
Total changes: 32151

File-specific changes:
tools/lib/api/fs/cgroup.c: +11 -6
tools/lib/api/fs/fs.c: +99 -127
tools/lib/api/fs/tracing_path.c: +6 -11
tools/lib/api/io.h: +27 -1
tools/lib/perf/cpumap.c: +101 -24
tools/lib/perf/evlist.c: +20 -5
tools/lib/perf/include/internal/evsel.h: +12 -3
tools/lib/perf/include/perf/cpumap.h: +19 -0
tools/lib/perf/include/perf/event.h: +2 -1
tools/lib/subcmd/exec-cmd.c: +20 -15
tools/lib/subcmd/help.c: +8 -2
tools/perf/Documentation/Makefile: +11 -4
tools/perf/Documentation/perf-script.txt: +1 -1
tools/perf/Documentation/perf-stat.txt: +31 -0
tools/perf/Makefile.config: +5 -0
tools/perf/Makefile.perf: +4 -0
tools/perf/arch/arm/tests/dwarf-unwind.c: +1 -1
tools/perf/arch/arm/util/auxtrace.c: +4 -3
tools/perf/arch/arm/util/cs-etm.c: +2 -2
tools/perf/arch/arm64/entry/syscalls/mksyscalltbl: +9 -8
tools/perf/arch/arm64/tests/dwarf-unwind.c: +1 -1
tools/perf/arch/arm64/util/pmu.c: +2 -4
tools/perf/arch/common.c: +18 -0
tools/perf/arch/loongarch/annotate/instructions.c: +103 -13
tools/perf/arch/loongarch/entry/syscalls/mksyscalltbl: +12 -28
tools/perf/arch/mips/entry/syscalls/mksyscalltbl: +1 -1
tools/perf/arch/powerpc/entry/syscalls/mksyscalltbl: +1 -1
tools/perf/arch/powerpc/tests/dwarf-unwind.c: +1 -1
tools/perf/arch/powerpc/util/kvm-stat.c: +2 -2
tools/perf/arch/s390/annotate/instructions.c: +0 -3
tools/perf/arch/s390/entry/syscalls/mksyscalltbl: +1 -1
tools/perf/arch/x86/annotate/instructions.c: +11 -39
tools/perf/arch/x86/entry/syscalls/syscalltbl.sh: +1 -1
tools/perf/arch/x86/include/arch-tests.h: +3 -0
tools/perf/arch/x86/tests/Build: +5 -1
tools/perf/arch/x86/tests/amd-ibs-via-core-pmu.c: +1 -4
tools/perf/arch/x86/tests/arch-tests.c: +14 -0
tools/perf/arch/x86/tests/dwarf-unwind.c: +1 -1
tools/perf/arch/x86/tests/hybrid.c: +288 -0
tools/perf/arch/x86/tests/insn-x86.c: +5 -5
tools/perf/arch/x86/tests/intel-pt-test.c: +7 -7
tools/perf/arch/x86/util/Build: +1 -0
tools/perf/arch/x86/util/auxtrace.c: +3 -2
tools/perf/arch/x86/util/env.c: +19 -0
tools/perf/arch/x86/util/env.h: +7 -0
tools/perf/arch/x86/util/evlist.c: +18 -11
tools/perf/arch/x86/util/evsel.c: +6 -37
tools/perf/arch/x86/util/intel-bts.c: +2 -2
tools/perf/arch/x86/util/intel-pt.c: +2 -2
tools/perf/arch/x86/util/mem-events.c: +11 -25
tools/perf/arch/x86/util/perf_regs.c: +10 -5
tools/perf/arch/x86/util/pmu.c: +12 -0
tools/perf/arch/x86/util/topdown.c: +3 -2
tools/perf/bench/epoll-ctl.c: +5 -0
tools/perf/bench/epoll-wait.c: +5 -0
tools/perf/bench/futex-lock-pi.c: +6 -6
tools/perf/bench/futex-requeue.c: +6 -6
tools/perf/bench/futex-wake-parallel.c: +11 -8
tools/perf/bench/futex-wake.c: +6 -6
tools/perf/bench/pmu-scan.c: +33 -27
tools/perf/bench/sched-messaging.c: +17 -1
tools/perf/builtin-annotate.c: +22 -10
tools/perf/builtin-bench.c: +2 -0
tools/perf/builtin-c2c.c: +17 -14
tools/perf/builtin-config.c: +3 -1
tools/perf/builtin-daemon.c: +28 -16
tools/perf/builtin-diff.c: +13 -11
tools/perf/builtin-ftrace.c: +2 -0
tools/perf/builtin-help.c: +3 -1
tools/perf/builtin-inject.c: +28 -7
tools/perf/builtin-kmem.c: +18 -8
tools/perf/builtin-kwork.c: +21 -6
tools/perf/builtin-list.c: +34 -14
tools/perf/builtin-lock.c: +21 -6
tools/perf/builtin-mem.c: +6 -7
tools/perf/builtin-probe.c: +71 -62
tools/perf/builtin-record.c: +19 -23
tools/perf/builtin-report.c: +12 -9
tools/perf/builtin-sched.c: +67 -53
tools/perf/builtin-script.c: +117 -101
tools/perf/builtin-stat.c: +305 -38
tools/perf/builtin-timechart.c: +46 -13
tools/perf/builtin-top.c: +32 -16
tools/perf/builtin-trace.c: +60 -36
tools/perf/check-headers.sh: +128 -104
tools/perf/pmu-events/arch/arm64/ampere/ampereone/branch.json: +17 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/bus.json: +32 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/cache.json: +104 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/core-imp-def.json: +698 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/exception.json: +44 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/instruction.json: +89 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/intrinsic.json: +14 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/memory.json: +44 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/pipeline.json: +23 -0
tools/perf/pmu-events/arch/arm64/ampere/ampereone/spe.json: +14 -0
tools/perf/pmu-events/arch/arm64/hisilicon/hip08/metrics.json: +8 -4
tools/perf/pmu-events/arch/arm64/mapfile.csv: +1 -0
tools/perf/pmu-events/arch/arm64/sbsa.json: +8 -4
tools/perf/pmu-events/arch/x86/alderlake/adl-metrics.json: +711 -717
tools/perf/pmu-events/arch/x86/alderlake/cache.json: +9 -0
tools/perf/pmu-events/arch/x86/alderlake/memory.json: +4 -2
tools/perf/pmu-events/arch/x86/alderlake/metricgroups.json: +122 -0
tools/perf/pmu-events/arch/x86/alderlaken/adln-metrics.json: +140 -161
tools/perf/pmu-events/arch/x86/alderlaken/metricgroups.json: +26 -0
tools/perf/pmu-events/arch/x86/broadwell/bdw-metrics.json: +290 -290
tools/perf/pmu-events/arch/x86/broadwell/floating-point.json: +15 -0
tools/perf/pmu-events/arch/x86/broadwell/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/broadwellde/bdwde-metrics.json: +278 -278
tools/perf/pmu-events/arch/x86/broadwellde/floating-point.json: +15 -0
tools/perf/pmu-events/arch/x86/broadwellde/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/broadwellx/bdx-metrics.json: +502 -294
tools/perf/pmu-events/arch/x86/broadwellx/floating-point.json: +15 -0
tools/perf/pmu-events/arch/x86/broadwellx/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/cascadelakex/clx-metrics.json: +741 -490
tools/perf/pmu-events/arch/x86/cascadelakex/floating-point.json: +31 -0
tools/perf/pmu-events/arch/x86/cascadelakex/metricgroups.json: +114 -0
tools/perf/pmu-events/arch/x86/cascadelakex/pipeline.json: +21 -2
tools/perf/pmu-events/arch/x86/elkhartlake/cache.json: +7 -0
tools/perf/pmu-events/arch/x86/elkhartlake/memory.json: +2 -0
tools/perf/pmu-events/arch/x86/elkhartlake/other.json: +10 -0
tools/perf/pmu-events/arch/x86/elkhartlake/pipeline.json: +3 -0
tools/perf/pmu-events/arch/x86/haswell/hsw-metrics.json: +242 -242
tools/perf/pmu-events/arch/x86/haswell/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/haswellx/hsx-metrics.json: +454 -246
tools/perf/pmu-events/arch/x86/haswellx/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/icelake/cache.json: +18 -0
tools/perf/pmu-events/arch/x86/icelake/icl-metrics.json: +492 -477
tools/perf/pmu-events/arch/x86/icelake/metricgroups.json: +113 -0
tools/perf/pmu-events/arch/x86/icelakex/icx-metrics.json: +797 -524
tools/perf/pmu-events/arch/x86/icelakex/metricgroups.json: +114 -0
tools/perf/pmu-events/arch/x86/ivybridge/ivb-metrics.json: +263 -263
tools/perf/pmu-events/arch/x86/ivybridge/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/ivytown/ivt-metrics.json: +267 -267
tools/perf/pmu-events/arch/x86/ivytown/metricgroups.json: +107 -0
tools/perf/pmu-events/arch/x86/jaketown/jkt-metrics.json: +112 -112
tools/perf/pmu-events/arch/x86/jaketown/metricgroups.json: +100 -0
tools/perf/pmu-events/arch/x86/mapfile.csv: +13 -13
tools/perf/pmu-events/arch/x86/sandybridge/metricgroups.json: +100 -0
tools/perf/pmu-events/arch/x86/sandybridge/snb-metrics.json: +111 -111
tools/perf/pmu-events/arch/x86/sapphirerapids/memory.json: +4 -2
tools/perf/pmu-events/arch/x86/sapphirerapids/metricgroups.json: +118 -0
tools/perf/pmu-events/arch/x86/sapphirerapids/spr-metrics.json: +853 -561
tools/perf/pmu-events/arch/x86/sapphirerapids/uncore-interconnect.json: +1 -1
tools/perf/pmu-events/arch/x86/sapphirerapids/uncore-memory.json: +4 -4
tools/perf/pmu-events/arch/x86/skylake/floating-point.json: +8 -0
tools/perf/pmu-events/arch/x86/skylake/metricgroups.json: +113 -0
tools/perf/pmu-events/arch/x86/skylake/pipeline.json: +12 -3
tools/perf/pmu-events/arch/x86/skylake/skl-metrics.json: +437 -438
tools/perf/pmu-events/arch/x86/skylakex/floating-point.json: +31 -0
tools/perf/pmu-events/arch/x86/skylakex/metricgroups.json: +114 -0
tools/perf/pmu-events/arch/x86/skylakex/pipeline.json: +21 -2
tools/perf/pmu-events/arch/x86/skylakex/skx-metrics.json: +708 -475
tools/perf/pmu-events/arch/x86/snowridgex/cache.json: +7 -0
tools/perf/pmu-events/arch/x86/snowridgex/memory.json: +2 -0
tools/perf/pmu-events/arch/x86/snowridgex/other.json: +10 -0
tools/perf/pmu-events/arch/x86/snowridgex/pipeline.json: +3 -0
tools/perf/pmu-events/arch/x86/snowridgex/uncore-interconnect.json: +7 -7
tools/perf/pmu-events/arch/x86/snowridgex/uncore-io.json: +0 -8
tools/perf/pmu-events/arch/x86/snowridgex/uncore-memory.json: +3 -4
tools/perf/pmu-events/arch/x86/snowridgex/uncore-power.json: +3 -3
tools/perf/pmu-events/arch/x86/tigerlake/cache.json: +18 -0
tools/perf/pmu-events/arch/x86/tigerlake/metricgroups.json: +113 -0
tools/perf/pmu-events/arch/x86/tigerlake/pipeline.json: +1 -0
tools/perf/pmu-events/arch/x86/tigerlake/tgl-metrics.json: +501 -486
tools/perf/pmu-events/empty-pmu-events.c: +5 -0
tools/perf/pmu-events/jevents.py: +53 -7
tools/perf/pmu-events/metric.py: +17 -11
tools/perf/pmu-events/metric_test.py: +3 -3
tools/perf/pmu-events/pmu-events.h: +4 -0
tools/perf/scripts/python/Perf-Trace-Util/Context.c: +2 -2
tools/perf/scripts/python/arm-cs-trace-disasm.py: +0 -1
tools/perf/tests/attr.c: +9 -2
tools/perf/tests/builtin-test.c: +1 -3
tools/perf/tests/code-reading.c: +3 -3
tools/perf/tests/cpumap.c: +89 -3
tools/perf/tests/dwarf-unwind.c: +0 -1
tools/perf/tests/event_groups.c: +2 -5
tools/perf/tests/evsel-roundtrip-name.c: +49 -70
tools/perf/tests/expr.c: +40 -0
tools/perf/tests/hists_common.c: +1 -1
tools/perf/tests/hists_cumulate.c: +11 -7
tools/perf/tests/hists_filter.c: +7 -4
tools/perf/tests/hists_link.c: +12 -8
tools/perf/tests/hists_output.c: +8 -4
tools/perf/tests/make: +1 -0
tools/perf/tests/maps.c: +1 -1
tools/perf/tests/mmap-thread-lookup.c: +3 -2
tools/perf/tests/parse-events.c: +1199 -959
tools/perf/tests/parse-metric.c: +3 -6
tools/perf/tests/perf-targz-src-pkg: +3 -2
tools/perf/tests/pmu-events.c: +4 -14
tools/perf/tests/pmu.c: +9 -8
tools/perf/tests/python-use.c: +1 -1
tools/perf/tests/shell/buildid.sh: +6 -6
tools/perf/tests/shell/daemon.sh: +75 -38
tools/perf/tests/shell/lib/perf_json_output_lint.py: +9 -4
tools/perf/tests/shell/lib/perf_metric_validation.py: +574 -0
tools/perf/tests/shell/lib/perf_metric_validation_rules.json: +398 -0
tools/perf/tests/shell/lib/stat_output.sh: +169 -0
tools/perf/tests/shell/lock_contention.sh: +35 -35
tools/perf/tests/shell/record+probe_libc_inet_pton.sh: +5 -5
tools/perf/tests/shell/record+script_probe_vfs_getname.sh: +2 -2
tools/perf/tests/shell/stat+csv_output.sh: +17 -161
tools/perf/tests/shell/stat+json_output.sh: +14 -1
tools/perf/tests/shell/stat+shadow_stat.sh: +2 -2
tools/perf/tests/shell/stat+std_output.sh: +108 -0
tools/perf/tests/shell/stat.sh: +44 -0
tools/perf/tests/shell/stat_all_metrics.sh: +3 -3
tools/perf/tests/shell/stat_all_pfm.sh: +51 -0
tools/perf/tests/shell/stat_metrics_values.sh: +30 -0
tools/perf/tests/shell/test_arm_callgraph_fp.sh: +6 -5
tools/perf/tests/shell/test_arm_coresight.sh: +3 -3
tools/perf/tests/shell/test_arm_spe.sh: +1 -1
tools/perf/tests/shell/test_brstack.sh: +6 -6
tools/perf/tests/shell/test_perf_data_converter_json.sh: +72 -0
tools/perf/tests/shell/test_task_analyzer.sh: +64 -40
tools/perf/tests/switch-tracking.c: +2 -12
tools/perf/tests/symbols.c: +0 -1
tools/perf/tests/tests.h: +1 -3
tools/perf/tests/thread-maps-share.c: +7 -6
tools/perf/tests/topology.c: +3 -13
tools/perf/trace/beauty/beauty.h: +1 -1
tools/perf/trace/beauty/pid.c: +2 -2
tools/perf/trace/beauty/tracepoints/x86_msr.sh: +3 -3
tools/perf/ui/browsers/annotate.c: +8 -6
tools/perf/ui/browsers/hists.c: +10 -9
tools/perf/ui/hist.c: +4 -1
tools/perf/ui/stdio/hist.c: +1 -1
tools/perf/util/Build: +2 -3
tools/perf/util/addr_location.c: +44 -0
tools/perf/util/addr_location.h: +31 -0
tools/perf/util/annotate.c: +106 -15
tools/perf/util/annotate.h: +8 -3
tools/perf/util/arm-spe.c: +2 -2
tools/perf/util/block-info.c: +4 -4
tools/perf/util/build-id.c: +2 -0
tools/perf/util/cache.h: +1 -1
tools/perf/util/callchain.c: +65 -8
tools/perf/util/callchain.h: +5 -3
tools/perf/util/config.c: +7 -3
tools/perf/util/cpumap.c: +12 -2
tools/perf/util/cpumap.h: +9 -2
tools/perf/util/cputopo.c: +6 -6
tools/perf/util/cs-etm-decoder/cs-etm-decoder.c: +11 -22
tools/perf/util/cs-etm-decoder/cs-etm-decoder.h: +3 -1
tools/perf/util/cs-etm.c: +171 -129
tools/perf/util/cs-etm.h: +10 -3
tools/perf/util/data-convert-json.c: +11 -5
tools/perf/util/db-export.c: +17 -13
tools/perf/util/dlfilter.c: +12 -5
tools/perf/util/dso.c: +33 -0
tools/perf/util/dso.h: +5 -3
tools/perf/util/dwarf-aux.c: +6 -4
tools/perf/util/env.c: +3 -2
tools/perf/util/event.c: +20 -24
tools/perf/util/evlist-hybrid.c: +0 -162
tools/perf/util/evlist-hybrid.h: +0 -15
tools/perf/util/evlist.c: +50 -16
tools/perf/util/evlist.h: +2 -8
tools/perf/util/evsel.c: +20 -72
tools/perf/util/evsel.h: +32 -15
tools/perf/util/evsel_fprintf.c: +15 -13
tools/perf/util/evsel_fprintf.h: +1 -0
tools/perf/util/expr.y: +69 -17
tools/perf/util/genelf_debug.c: +5 -1
tools/perf/util/header.c: +87 -53
tools/perf/util/header.h: +4 -0
tools/perf/util/help-unknown-cmd.c: +3 -0
tools/perf/util/hist.c: +48 -28
tools/perf/util/intel-bts.c: +1 -1
tools/perf/util/intel-pt.c: +53 -35
tools/perf/util/jitdump.c: +8 -4
tools/perf/util/machine.c: +157 -138
tools/perf/util/map.c: +33 -5
tools/perf/util/map.h: +1 -0
tools/perf/util/maps.c: +3 -2
tools/perf/util/maps.h: +8 -1
tools/perf/util/mem-events.c: +14 -16
tools/perf/util/metricgroup.c: +110 -32
tools/perf/util/metricgroup.h: +5 -1
tools/perf/util/parse-events-hybrid.c: +0 -214
tools/perf/util/parse-events-hybrid.h: +0 -25
tools/perf/util/parse-events.c: +392 -446
tools/perf/util/parse-events.h: +33 -36
tools/perf/util/parse-events.l: +55 -76
tools/perf/util/parse-events.y: +135 -130
tools/perf/util/path.c: +5 -30
tools/perf/util/pfm.c: +52 -11
tools/perf/util/pmu-hybrid.c: +0 -72
tools/perf/util/pmu-hybrid.h: +0 -33
tools/perf/util/pmu.c: +87 -468
tools/perf/util/pmu.h: +34 -15
tools/perf/util/pmus.c: +568 -2
tools/perf/util/pmus.h: +18 -2
tools/perf/util/print-events.c: +82 -48
tools/perf/util/print-events.h: +2 -0
tools/perf/util/python-ext-sources: +0 -1
tools/perf/util/python.c: +18 -0
tools/perf/util/scripting-engines/trace-event-perl.c: +9 -6
tools/perf/util/scripting-engines/trace-event-python.c: +31 -18
tools/perf/util/session.c: +1 -7
tools/perf/util/setup.py: +4 -0
tools/perf/util/sharded_mutex.c: +33 -0
tools/perf/util/sharded_mutex.h: +29 -0
tools/perf/util/sort.c: +8 -6
tools/perf/util/srcline.c: +130 -40
tools/perf/util/srcline.h: +4 -2
tools/perf/util/stat-display.c: +132 -12
tools/perf/util/stat-shadow.c: +119 -12
tools/perf/util/stat.c: +22 -0
tools/perf/util/stat.h: +18 -0
tools/perf/util/symbol-elf.c: +10 -2
tools/perf/util/symbol.c: +6 -4
tools/perf/util/symbol.h: +1 -16
tools/perf/util/synthetic-events.c: +1 -0
tools/perf/util/syscalltbl.c: +7 -7
tools/perf/util/target.h: +0 -1
tools/perf/util/thread-stack.c: +13 -12
tools/perf/util/thread.c: +106 -116
tools/perf/util/thread.h: +193 -17
tools/perf/util/unwind-libdw.c: +20 -7
tools/perf/util/unwind-libunwind-local.c: +25 -11
tools/perf/util/unwind-libunwind.c: +1 -1
tools/perf/util/vdso.c: +1 -1
