Commit Hash: 72e637fec558c7842d6f1508f480fd77c20afe3a
Subject: media: rc: validate that "rc_proto" is reasonable


Security Keywords:
- hardening

Full commit message:
media: rc: validate that "rc_proto" is reasonable

Smatch complains that "rc_proto" comes from the user and it can result
in shift wrapping in ir_raw_encode_scancode()

    drivers/media/rc/rc-ir-raw.c:526 ir_raw_encode_scancode()
    error: undefined (user controlled) shift '1 << protocol'

This is true, but I reviewed the surrounding code and it appears
harmless. Anyway, let's verify that "rc_proto" is valid as a kernel
hardening measure.

Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com>
Signed-off-by: Sean Young <sean@mess.org>
Signed-off-by: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>

Metadata:
Author: Dan Carpenter <dan.carpenter@oracle.com>
Author Date: Fri Oct 30 12:52:30 2020 +0100
Committer: Mauro Carvalho Chehab <mchehab+huawei@kernel.org>
Commit Date: Tue Nov 17 06:57:10 2020 +0100

Files Changed: 2
Lines Added: 3
Lines Removed: 1
Total Changes: 4
