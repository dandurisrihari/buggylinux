{
  "hash": "cb77c3ec075a50e9f956f62dc2e4c0394df1d578",
  "hash_short": "cb77c3ec",
  "subject": "Bluetooth: Send mgmt_connected only if state is BT_CONFIG",
  "body": "If a remote name request is initiated while acl connection is going on,\nand if it fails then mgmt_connected will be sent. Evetually after acl\nconnection, authentication will not be initiated and userspace will\nnever get pairing reply.\n\n< HCI Command: Create Connection (0x01|0x0005) plen 13\n    bdaddr AA:BB:CC:DD:EE:FF ptype 0xcc18 rswitch 0x01 clkoffset 0x2306 (valid)\n    Packet type: DM1 DM3 DM5 DH1 DH3 DH5\n> HCI Event: Command Status (0x0f) plen 4\n    Create Connection (0x01|0x0005) status 0x00 ncmd 1\n> HCI Event: Inquiry Complete (0x01) plen 1\n    status 0x00\n< HCI Command: Remote Name Request (0x01|0x0019) plen 10\n    bdaddr AA:BB:CC:DD:EE:FF mode 1 clkoffset 0x2306\n> HCI Event: Command Status (0x0f) plen 4\n    Remote Name Request (0x01|0x0019) status 0x0c ncmd 1\n    Error: Command Disallowed\n> HCI Event: Connect Complete (0x03) plen 11\n    status 0x00 handle 50 bdaddr 00:0D:FD:47:53:B2 type ACL encrypt 0x00\n< HCI Command: Read Remote Supported Features (0x01|0x001b) plen 2\n    handle 50\n> HCI Event: Command Status (0x0f) plen 4\n    Read Remote Supported Features (0x01|0x001b) status 0x00 ncmd 1\n> HCI Event: Max Slots Change (0x1b) plen 3\n    handle 50 slots 5\n> HCI Event: Read Remote Supported Features (0x0b) plen 11\n    status 0x00 handle 50\n    Features: 0xff 0xff 0x8f 0xfe 0x9b 0xff 0x59 0x83\n< HCI Command: Read Remote Extended Features (0x01|0x001c) plen 3\n    handle 50 page 1\n> HCI Event: Command Status (0x0f) plen 4\n    Read Remote Extended Features (0x01|0x001c) status 0x00 ncmd 1\n> HCI Event: Read Remote Extended Features (0x23) plen 13\n    status 0x00 handle 50 page 1 max 1\n    Features: 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n\nThis patch sends mgmt_connected in remote name command status only if\nconn->state is BT_CONFIG\n\nSigned-off-by: Jaganath Kanakkassery <jaganath.k@samsung.com>\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>",
  "full_message": "Bluetooth: Send mgmt_connected only if state is BT_CONFIG\n\nIf a remote name request is initiated while acl connection is going on,\nand if it fails then mgmt_connected will be sent. Evetually after acl\nconnection, authentication will not be initiated and userspace will\nnever get pairing reply.\n\n< HCI Command: Create Connection (0x01|0x0005) plen 13\n    bdaddr AA:BB:CC:DD:EE:FF ptype 0xcc18 rswitch 0x01 clkoffset 0x2306 (valid)\n    Packet type: DM1 DM3 DM5 DH1 DH3 DH5\n> HCI Event: Command Status (0x0f) plen 4\n    Create Connection (0x01|0x0005) status 0x00 ncmd 1\n> HCI Event: Inquiry Complete (0x01) plen 1\n    status 0x00\n< HCI Command: Remote Name Request (0x01|0x0019) plen 10\n    bdaddr AA:BB:CC:DD:EE:FF mode 1 clkoffset 0x2306\n> HCI Event: Command Status (0x0f) plen 4\n    Remote Name Request (0x01|0x0019) status 0x0c ncmd 1\n    Error: Command Disallowed\n> HCI Event: Connect Complete (0x03) plen 11\n    status 0x00 handle 50 bdaddr 00:0D:FD:47:53:B2 type ACL encrypt 0x00\n< HCI Command: Read Remote Supported Features (0x01|0x001b) plen 2\n    handle 50\n> HCI Event: Command Status (0x0f) plen 4\n    Read Remote Supported Features (0x01|0x001b) status 0x00 ncmd 1\n> HCI Event: Max Slots Change (0x1b) plen 3\n    handle 50 slots 5\n> HCI Event: Read Remote Supported Features (0x0b) plen 11\n    status 0x00 handle 50\n    Features: 0xff 0xff 0x8f 0xfe 0x9b 0xff 0x59 0x83\n< HCI Command: Read Remote Extended Features (0x01|0x001c) plen 3\n    handle 50 page 1\n> HCI Event: Command Status (0x0f) plen 4\n    Read Remote Extended Features (0x01|0x001c) status 0x00 ncmd 1\n> HCI Event: Read Remote Extended Features (0x23) plen 13\n    status 0x00 handle 50 page 1 max 1\n    Features: 0x01 0x00 0x00 0x00 0x00 0x00 0x00 0x00\n\nThis patch sends mgmt_connected in remote name command status only if\nconn->state is BT_CONFIG\n\nSigned-off-by: Jaganath Kanakkassery <jaganath.k@samsung.com>\nSigned-off-by: Johan Hedberg <johan.hedberg@intel.com>",
  "author_name": "Jaganath Kanakkassery",
  "author_email": "jaganath.k@samsung.com",
  "author_date": "Fri Nov 7 16:39:09 2014 +0530",
  "author_date_iso": "2014-11-07T16:39:09+05:30",
  "committer_name": "Johan Hedberg",
  "committer_email": "johan.hedberg@intel.com",
  "committer_date": "Fri Nov 7 15:43:51 2014 +0200",
  "committer_date_iso": "2014-11-07T15:43:51+02:00",
  "files_changed": [
    "net/bluetooth/hci_event.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "net/bluetooth/hci_event.c",
      "insertions": 2,
      "deletions": 1
    }
  ],
  "total_insertions": 2,
  "total_deletions": 1,
  "total_changes": 3,
  "parents": [
    "56b2c3eea398c772dd895dc62c18cbdd1ba127b1"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.19",
    "v3.19-rc1",
    "v3.19-rc2",
    "v3.19-rc3",
    "v3.19-rc4",
    "v3.19-rc5",
    "v3.19-rc6",
    "v3.19-rc7",
    "v4.0",
    "v4.0-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/bluetooth/hci_event.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}