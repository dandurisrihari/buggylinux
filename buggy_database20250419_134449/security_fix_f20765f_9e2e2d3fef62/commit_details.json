{
  "hash": "f20765fdfdc2c8f47b41cb08489fdad3194a8465",
  "hash_short": "f20765fd",
  "subject": "integrity: Always reference the blacklist keyring with appraisal",
  "body": "Commit 273df864cf746 (\"ima: Check against blacklisted hashes for files with\nmodsig\") introduced an appraise_flag option for referencing the blacklist\nkeyring.  Any matching binary found on this keyring fails signature\nvalidation. This flag only works with module appended signatures.\n\nAn important part of a PKI infrastructure is to have the ability to do\nrevocation at a later time should a vulnerability be found.  Expand the\nrevocation flag usage to all appraisal functions. The flag is now\nenabled by default. Setting the flag with an IMA policy has been\ndeprecated. Without a revocation capability like this in place, only\nauthenticity can be maintained. With this change, integrity can now be\nachieved with digital signature based IMA appraisal.\n\nSigned-off-by: Eric Snowberg <eric.snowberg@oracle.com>\nReviewed-by: Nayna Jain <nayna@linux.ibm.com>\nSigned-off-by: Mimi Zohar <zohar@linux.ibm.com>",
  "full_message": "integrity: Always reference the blacklist keyring with appraisal\n\nCommit 273df864cf746 (\"ima: Check against blacklisted hashes for files with\nmodsig\") introduced an appraise_flag option for referencing the blacklist\nkeyring.  Any matching binary found on this keyring fails signature\nvalidation. This flag only works with module appended signatures.\n\nAn important part of a PKI infrastructure is to have the ability to do\nrevocation at a later time should a vulnerability be found.  Expand the\nrevocation flag usage to all appraisal functions. The flag is now\nenabled by default. Setting the flag with an IMA policy has been\ndeprecated. Without a revocation capability like this in place, only\nauthenticity can be maintained. With this change, integrity can now be\nachieved with digital signature based IMA appraisal.\n\nSigned-off-by: Eric Snowberg <eric.snowberg@oracle.com>\nReviewed-by: Nayna Jain <nayna@linux.ibm.com>\nSigned-off-by: Mimi Zohar <zohar@linux.ibm.com>",
  "author_name": "Eric Snowberg",
  "author_email": "eric.snowberg@oracle.com",
  "author_date": "Wed Jul 26 17:17:25 2023 -0400",
  "author_date_iso": "2023-07-26T17:17:25-04:00",
  "committer_name": "Mimi Zohar",
  "committer_email": "zohar@linux.ibm.com",
  "committer_date": "Tue Aug 1 08:17:25 2023 -0400",
  "committer_date_iso": "2023-08-01T08:17:25-04:00",
  "files_changed": [
    "Documentation/ABI/testing/ima_policy",
    "arch/powerpc/kernel/ima_arch.c",
    "security/integrity/ima/ima_appraise.c",
    "security/integrity/ima/ima_policy.c"
  ],
  "files_changed_count": 4,
  "stats": [
    {
      "file": "Documentation/ABI/testing/ima_policy",
      "insertions": 3,
      "deletions": 3
    },
    {
      "file": "arch/powerpc/kernel/ima_arch.c",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "security/integrity/ima/ima_appraise.c",
      "insertions": 7,
      "deletions": 5
    },
    {
      "file": "security/integrity/ima/ima_policy.c",
      "insertions": 5,
      "deletions": 12
    }
  ],
  "total_insertions": 19,
  "total_deletions": 24,
  "total_changes": 43,
  "parents": [
    "5087fd9e80e539d2163accd045b73da64de7de95"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "Documentation/ABI/testing/ima_policy",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/powerpc/kernel/ima_arch.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/integrity/ima/ima_appraise.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "security/integrity/ima/ima_policy.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}