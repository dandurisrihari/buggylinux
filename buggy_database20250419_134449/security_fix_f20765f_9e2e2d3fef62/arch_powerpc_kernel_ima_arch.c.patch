commit f20765fdfdc2c8f47b41cb08489fdad3194a8465
Author: Eric Snowberg <eric.snowberg@oracle.com>
Date:   Wed Jul 26 17:17:25 2023 -0400

    integrity: Always reference the blacklist keyring with appraisal
    
    Commit 273df864cf746 ("ima: Check against blacklisted hashes for files with
    modsig") introduced an appraise_flag option for referencing the blacklist
    keyring.  Any matching binary found on this keyring fails signature
    validation. This flag only works with module appended signatures.
    
    An important part of a PKI infrastructure is to have the ability to do
    revocation at a later time should a vulnerability be found.  Expand the
    revocation flag usage to all appraisal functions. The flag is now
    enabled by default. Setting the flag with an IMA policy has been
    deprecated. Without a revocation capability like this in place, only
    authenticity can be maintained. With this change, integrity can now be
    achieved with digital signature based IMA appraisal.
    
    Signed-off-by: Eric Snowberg <eric.snowberg@oracle.com>
    Reviewed-by: Nayna Jain <nayna@linux.ibm.com>
    Signed-off-by: Mimi Zohar <zohar@linux.ibm.com>

diff --git a/arch/powerpc/kernel/ima_arch.c b/arch/powerpc/kernel/ima_arch.c
index 957abd592075..b7029beed847 100644
--- a/arch/powerpc/kernel/ima_arch.c
+++ b/arch/powerpc/kernel/ima_arch.c
@@ -23,9 +23,9 @@ bool arch_ima_get_secureboot(void)
  * is not enabled.
  */
 static const char *const secure_rules[] = {
-	"appraise func=KEXEC_KERNEL_CHECK appraise_flag=check_blacklist appraise_type=imasig|modsig",
+	"appraise func=KEXEC_KERNEL_CHECK appraise_type=imasig|modsig",
 #ifndef CONFIG_MODULE_SIG
-	"appraise func=MODULE_CHECK appraise_flag=check_blacklist appraise_type=imasig|modsig",
+	"appraise func=MODULE_CHECK appraise_type=imasig|modsig",
 #endif
 	NULL
 };
@@ -49,9 +49,9 @@ static const char *const trusted_rules[] = {
 static const char *const secure_and_trusted_rules[] = {
 	"measure func=KEXEC_KERNEL_CHECK template=ima-modsig",
 	"measure func=MODULE_CHECK template=ima-modsig",
-	"appraise func=KEXEC_KERNEL_CHECK appraise_flag=check_blacklist appraise_type=imasig|modsig",
+	"appraise func=KEXEC_KERNEL_CHECK appraise_type=imasig|modsig",
 #ifndef CONFIG_MODULE_SIG
-	"appraise func=MODULE_CHECK appraise_flag=check_blacklist appraise_type=imasig|modsig",
+	"appraise func=MODULE_CHECK appraise_type=imasig|modsig",
 #endif
 	NULL
 };