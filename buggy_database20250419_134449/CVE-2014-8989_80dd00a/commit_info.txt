Commit Hash: 80dd00a23784b384ccea049bfb3f259d3f973b9d
Subject: userns: Check euid no fsuid when establishing an unprivileged uid mapping

CVE Identifiers:
- CVE-2014-8989

Full commit message:
userns: Check euid no fsuid when establishing an unprivileged uid mapping

setresuid allows the euid to be set to any of uid, euid, suid, and
fsuid.  Therefor it is safe to allow an unprivileged user to map
their euid and use CAP_SETUID privileged with exactly that uid,
as no new credentials can be obtained.

I can not find a combination of existing system calls that allows setting
uid, euid, suid, and fsuid from the fsuid making the previous use
of fsuid for allowing unprivileged mappings a bug.

This is part of a fix for CVE-2014-8989.

Cc: stable@vger.kernel.org
Reviewed-by: Andy Lutomirski <luto@amacapital.net>
Signed-off-by: "Eric W. Biederman" <ebiederm@xmission.com>

Metadata:
Author: Eric W. Biederman <ebiederm@xmission.com>
Author Date: Fri Dec 5 18:26:30 2014 -0600
Committer: Eric W. Biederman <ebiederm@xmission.com>
Commit Date: Tue Dec 9 17:08:32 2014 -0600

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
