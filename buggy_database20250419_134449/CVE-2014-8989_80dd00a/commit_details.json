{
  "hash": "80dd00a23784b384ccea049bfb3f259d3f973b9d",
  "hash_short": "80dd00a2",
  "subject": "userns: Check euid no fsuid when establishing an unprivileged uid mapping",
  "body": "setresuid allows the euid to be set to any of uid, euid, suid, and\nfsuid.  Therefor it is safe to allow an unprivileged user to map\ntheir euid and use CAP_SETUID privileged with exactly that uid,\nas no new credentials can be obtained.\n\nI can not find a combination of existing system calls that allows setting\nuid, euid, suid, and fsuid from the fsuid making the previous use\nof fsuid for allowing unprivileged mappings a bug.\n\nThis is part of a fix for CVE-2014-8989.\n\nCc: stable@vger.kernel.org\nReviewed-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>",
  "full_message": "userns: Check euid no fsuid when establishing an unprivileged uid mapping\n\nsetresuid allows the euid to be set to any of uid, euid, suid, and\nfsuid.  Therefor it is safe to allow an unprivileged user to map\ntheir euid and use CAP_SETUID privileged with exactly that uid,\nas no new credentials can be obtained.\n\nI can not find a combination of existing system calls that allows setting\nuid, euid, suid, and fsuid from the fsuid making the previous use\nof fsuid for allowing unprivileged mappings a bug.\n\nThis is part of a fix for CVE-2014-8989.\n\nCc: stable@vger.kernel.org\nReviewed-by: Andy Lutomirski <luto@amacapital.net>\nSigned-off-by: \"Eric W. Biederman\" <ebiederm@xmission.com>",
  "author_name": "Eric W. Biederman",
  "author_email": "ebiederm@xmission.com",
  "author_date": "Fri Dec 5 18:26:30 2014 -0600",
  "author_date_iso": "2014-12-05T18:26:30-06:00",
  "committer_name": "Eric W. Biederman",
  "committer_email": "ebiederm@xmission.com",
  "committer_date": "Tue Dec 9 17:08:32 2014 -0600",
  "committer_date_iso": "2014-12-09T17:08:32-06:00",
  "files_changed": [
    "kernel/user_namespace.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "kernel/user_namespace.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 1,
  "total_deletions": 1,
  "total_changes": 2,
  "parents": [
    "be7c6dba2332cef0677fbabb606e279ae76652c3"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.19",
    "v3.19-rc1",
    "v3.19-rc2",
    "v3.19-rc3",
    "v3.19-rc4",
    "v3.19-rc5",
    "v3.19-rc6",
    "v3.19-rc7",
    "v4.0",
    "v4.0-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2014-8989"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "kernel/user_namespace.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    }
  ]
}