{
  "hash": "91f0abfda1709131edbd62ad3515da2b8e6c0261",
  "hash_short": "91f0abfd",
  "subject": "iscsi-target: Reject zero-length payloads during SecurityNegotiation",
  "body": "This patch changes iscsi_target_handle_csg_zero() to explicitly\nreject login requests in SecurityNegotiation with a zero-length\npayload, following the language in RFC-3720 Section 8.2:\n\n  Whenever an iSCSI target gets a response whose keys, or their\n  values, are not according to the step definition, it MUST answer\n  with a Login reject with the \"Initiator Error\" or \"Missing Parameter\"\n  status.\n\nPreviously when a zero-length login request in CSG=0 was received,\nthe target would send a login response with CSG=0 + T_BIT=0 asking\nthe initiator to complete authentication, and not fail the login\nuntil MAX_LOGIN_PDUS was reached.  This change will now immediately\nfail the login attempt with ISCSI_STATUS_CLS_INITIATOR_ERR status.\n\nReported-by: Tejas Vaykole <tejas.vaykole@calsoftinc.com>\nSigned-off-by: Nicholas Bellinger <nab@linux-iscsi.org>",
  "full_message": "iscsi-target: Reject zero-length payloads during SecurityNegotiation\n\nThis patch changes iscsi_target_handle_csg_zero() to explicitly\nreject login requests in SecurityNegotiation with a zero-length\npayload, following the language in RFC-3720 Section 8.2:\n\n  Whenever an iSCSI target gets a response whose keys, or their\n  values, are not according to the step definition, it MUST answer\n  with a Login reject with the \"Initiator Error\" or \"Missing Parameter\"\n  status.\n\nPreviously when a zero-length login request in CSG=0 was received,\nthe target would send a login response with CSG=0 + T_BIT=0 asking\nthe initiator to complete authentication, and not fail the login\nuntil MAX_LOGIN_PDUS was reached.  This change will now immediately\nfail the login attempt with ISCSI_STATUS_CLS_INITIATOR_ERR status.\n\nReported-by: Tejas Vaykole <tejas.vaykole@calsoftinc.com>\nSigned-off-by: Nicholas Bellinger <nab@linux-iscsi.org>",
  "author_name": "Nicholas Bellinger",
  "author_email": "nab@linux-iscsi.org",
  "author_date": "Wed May 28 12:07:40 2014 -0700",
  "author_date_iso": "2014-05-28T12:07:40-07:00",
  "committer_name": "Nicholas Bellinger",
  "committer_email": "nab@linux-iscsi.org",
  "committer_date": "Tue Jun 3 19:18:43 2014 -0700",
  "committer_date_iso": "2014-06-03T19:18:43-07:00",
  "files_changed": [
    "drivers/target/iscsi/iscsi_target_nego.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/target/iscsi/iscsi_target_nego.c",
      "insertions": 6,
      "deletions": 0
    }
  ],
  "total_insertions": 6,
  "total_deletions": 0,
  "total_changes": 6,
  "parents": [
    "51a07f84649d2be206c4c2ad9a612956db0c2f8c"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.16",
    "v3.16-rc1",
    "v3.16-rc2",
    "v3.16-rc3",
    "v3.16-rc4",
    "v3.16-rc5",
    "v3.16-rc6",
    "v3.16-rc7",
    "v3.17",
    "v3.17-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/target/iscsi/iscsi_target_nego.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}