{
  "hash": "59d8d4434f429b4fa8a346fd889058bda427a837",
  "hash_short": "59d8d443",
  "subject": "sctp: delay the authentication for the duplicated cookie-echo chunk",
  "body": "Now sctp only delays the authentication for the normal cookie-echo\nchunk by setting chunk->auth_chunk in sctp_endpoint_bh_rcv(). But\nfor the duplicated one with auth, in sctp_assoc_bh_rcv(), it does\nauthentication first based on the old asoc, which will definitely\nfail due to the different auth info in the old asoc.\n\nThe duplicated cookie-echo chunk will create a new asoc with the\nauth info from this chunk, and the authentication should also be\ndone with the new asoc's auth info for all of the collision 'A',\n'B' and 'D'. Otherwise, the duplicated cookie-echo chunk with auth\nwill never pass the authentication and create the new connection.\n\nThis issue exists since very beginning, and this fix is to make\nsctp_assoc_bh_rcv() follow the way sctp_endpoint_bh_rcv() does\nfor the normal cookie-echo chunk to delay the authentication.\n\nWhile at it, remove the unused params from sctp_sf_authenticate()\nand define sctp_auth_chunk_verify() used for all the places that\ndo the delayed authentication.\n\nv1->v2:\n  fix the typo in changelog as Marcelo noticed.\n\nAcked-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>\nSigned-off-by: Xin Long <lucien.xin@gmail.com>\nAcked-by: Neil Horman <nhorman@tuxdriver.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "sctp: delay the authentication for the duplicated cookie-echo chunk\n\nNow sctp only delays the authentication for the normal cookie-echo\nchunk by setting chunk->auth_chunk in sctp_endpoint_bh_rcv(). But\nfor the duplicated one with auth, in sctp_assoc_bh_rcv(), it does\nauthentication first based on the old asoc, which will definitely\nfail due to the different auth info in the old asoc.\n\nThe duplicated cookie-echo chunk will create a new asoc with the\nauth info from this chunk, and the authentication should also be\ndone with the new asoc's auth info for all of the collision 'A',\n'B' and 'D'. Otherwise, the duplicated cookie-echo chunk with auth\nwill never pass the authentication and create the new connection.\n\nThis issue exists since very beginning, and this fix is to make\nsctp_assoc_bh_rcv() follow the way sctp_endpoint_bh_rcv() does\nfor the normal cookie-echo chunk to delay the authentication.\n\nWhile at it, remove the unused params from sctp_sf_authenticate()\nand define sctp_auth_chunk_verify() used for all the places that\ndo the delayed authentication.\n\nv1->v2:\n  fix the typo in changelog as Marcelo noticed.\n\nAcked-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com>\nSigned-off-by: Xin Long <lucien.xin@gmail.com>\nAcked-by: Neil Horman <nhorman@tuxdriver.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Xin Long",
  "author_email": "lucien.xin@gmail.com",
  "author_date": "Sat May 5 14:59:47 2018 +0800",
  "author_date_iso": "2018-05-05T14:59:47+08:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Mon May 7 23:39:10 2018 -0400",
  "committer_date_iso": "2018-05-07T23:39:10-04:00",
  "files_changed": [
    "net/sctp/associola.c",
    "net/sctp/sm_statefuns.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "net/sctp/associola.c",
      "insertions": 29,
      "deletions": 1
    },
    {
      "file": "net/sctp/sm_statefuns.c",
      "insertions": 46,
      "deletions": 40
    }
  ],
  "total_insertions": 75,
  "total_deletions": 41,
  "total_changes": 116,
  "parents": [
    "a86b74d363708d0b04305f356fd3429c7b560a64"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.17",
    "v4.17-rc5",
    "v4.17-rc6",
    "v4.17-rc7",
    "v4.18",
    "v4.18-rc1",
    "v4.18-rc2",
    "v4.18-rc3",
    "v4.18-rc4",
    "v4.18-rc5"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "net/sctp/associola.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/sctp/sm_statefuns.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}