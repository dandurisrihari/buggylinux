Commit Hash: b7fa76e03b0d83a035b20e0ef1a3d65a4557f76c
Subject: usb: atm: Use size_add() in call to struct_size()


Security Keywords:
- hardening

Full commit message:
usb: atm: Use size_add() in call to struct_size()

If, for any reason, the open-coded arithmetic causes a wraparound,
the protection that `struct_size()` adds against potential integer
overflows is defeated. Fix this by hardening call to `struct_size()`
with `size_add()`.

Fixes: b626871a7cda ("usb: atm: Use struct_size() helper")
Signed-off-by: "Gustavo A. R. Silva" <gustavoars@kernel.org>
Reviewed-by: Kees Cook <keescook@chromium.org>
Link: https://lore.kernel.org/r/ZQSuboEIhvATAdxN@work
Signed-off-by: Kees Cook <keescook@chromium.org>

Metadata:
Author: Gustavo A. R. Silva <gustavoars@kernel.org>
Author Date: Fri Sep 15 13:20:14 2023 -0600
Committer: Kees Cook <keescook@chromium.org>
Commit Date: Mon Oct 2 09:48:51 2023 -0700

Files Changed: 1
Lines Added: 2
Lines Removed: 1
Total Changes: 3
