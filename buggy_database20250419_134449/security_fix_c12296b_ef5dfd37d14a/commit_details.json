{
  "hash": "c12296bbecc488623b7d1932080e394d08f3226b",
  "hash_short": "c12296bb",
  "subject": "team: Fix use-after-free when an option instance allocation fails",
  "body": "In __team_options_register, team_options are allocated and appended to\nthe team's option_list.\nIf one option instance allocation fails, the \"inst_rollback\" cleanup\npath frees the previously allocated options but doesn't remove them from\nthe team's option_list.\nThis leaves dangling pointers that can be dereferenced later by other\nparts of the team driver that iterate over options.\n\nThis patch fixes the cleanup path to remove the dangling pointers from\nthe list.\n\nAs far as I can tell, this uaf doesn't have much security implications\nsince it would be fairly hard to exploit (an attacker would need to make\nthe allocation of that specific small object fail) but it's still nice\nto fix.\n\nCc: stable@vger.kernel.org\nFixes: 80f7c6683fe0 (\"team: add support for per-port options\")\nSigned-off-by: Florent Revest <revest@chromium.org>\nReviewed-by: Jiri Pirko <jiri@nvidia.com>\nReviewed-by: Hangbin Liu <liuhangbin@gmail.com>\nLink: https://lore.kernel.org/r/20231206123719.1963153-1-revest@chromium.org\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "full_message": "team: Fix use-after-free when an option instance allocation fails\n\nIn __team_options_register, team_options are allocated and appended to\nthe team's option_list.\nIf one option instance allocation fails, the \"inst_rollback\" cleanup\npath frees the previously allocated options but doesn't remove them from\nthe team's option_list.\nThis leaves dangling pointers that can be dereferenced later by other\nparts of the team driver that iterate over options.\n\nThis patch fixes the cleanup path to remove the dangling pointers from\nthe list.\n\nAs far as I can tell, this uaf doesn't have much security implications\nsince it would be fairly hard to exploit (an attacker would need to make\nthe allocation of that specific small object fail) but it's still nice\nto fix.\n\nCc: stable@vger.kernel.org\nFixes: 80f7c6683fe0 (\"team: add support for per-port options\")\nSigned-off-by: Florent Revest <revest@chromium.org>\nReviewed-by: Jiri Pirko <jiri@nvidia.com>\nReviewed-by: Hangbin Liu <liuhangbin@gmail.com>\nLink: https://lore.kernel.org/r/20231206123719.1963153-1-revest@chromium.org\nSigned-off-by: Jakub Kicinski <kuba@kernel.org>",
  "author_name": "Florent Revest",
  "author_email": "revest@chromium.org",
  "author_date": "Wed Dec 6 13:37:18 2023 +0100",
  "author_date_iso": "2023-12-06T13:37:18+01:00",
  "committer_name": "Jakub Kicinski",
  "committer_email": "kuba@kernel.org",
  "committer_date": "Fri Dec 8 10:45:49 2023 -0800",
  "committer_date_iso": "2023-12-08T10:45:49-08:00",
  "files_changed": [
    "drivers/net/team/team.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/team/team.c",
      "insertions": 3,
      "deletions": 1
    }
  ],
  "total_insertions": 3,
  "total_deletions": 1,
  "total_changes": 4,
  "parents": [
    "bd4a816752bab609dd6d65ae021387beb9e2ddbd"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "exploit"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/team/team.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}