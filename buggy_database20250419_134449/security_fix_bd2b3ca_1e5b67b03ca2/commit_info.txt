Commit Hash: bd2b3ca7686d9470b1b58df631daa03179486182
Subject: KVM: VMX: Fix interrupt loss during race with NMI


Security Keywords:
- injection

Full commit message:
KVM: VMX: Fix interrupt loss during race with NMI

If an interrupt cannot be injected for some reason (say, page fault
when fetching the IDT descriptor), the interrupt is marked for
reinjection.  However, if an NMI is queued at this time, the NMI
will be injected instead and the NMI will be lost.

Fix by deferring the NMI injection until the interrupt has been
injected successfully.

Analyzed by Jan Kiszka.

Signed-off-by: Avi Kivity <avi@redhat.com>

Metadata:
Author: Avi Kivity <avi@redhat.com>
Author Date: Thu Nov 20 11:47:18 2008 +0200
Committer: Avi Kivity <avi@redhat.com>
Commit Date: Sun Nov 23 14:52:29 2008 +0200

Files Changed: 1
Lines Added: 3
Lines Removed: 1
Total Changes: 4
