{
  "hash": "b8730b403aee94db4631bfefb546a6ce8c287dc2",
  "hash_short": "b8730b40",
  "subject": "iwlwifi: dvm: fix the passive-no-RX workaround",
  "body": "Alex Romosan reported that since the mac80211 changes in\n\"mac80211: start auth/assoc timeout on frame status\" and\nthe subsequent fixes in \"mac80211: fix auth/assoc timeout\nhandling\" (commits 1672c0e31917 and 89afe614c0c) there's\nsometimes an issue connecting to a 5 GHz network with the\niwlwifi DVM driver.\n\nThe reason appears to be that since these commits any bad\nTX status makes mac80211 immediately try again, causing\nall of the authentication attempts to be quickly rejected\nby the firmware as it hasn't heard a beacon yet. Before,\nit would wait for the timeout regardless of status.\n\nTo fix this, invoke the passive-no-RX workaround when not\nassociated yet as well. This will cause the first frame\nto get lost, but then the driver will stop the queues and\nthe second attempt will only be transmitted after hearing\na beacon, thus delaying it appropriately to not make the\nfirmware reject it again.\n\nReported-by: Alex Romosan <romosan@sycorax.lbl.gov>\nTested-by: Alex Romosan <romosan@sycorax.lbl.gov>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "iwlwifi: dvm: fix the passive-no-RX workaround\n\nAlex Romosan reported that since the mac80211 changes in\n\"mac80211: start auth/assoc timeout on frame status\" and\nthe subsequent fixes in \"mac80211: fix auth/assoc timeout\nhandling\" (commits 1672c0e31917 and 89afe614c0c) there's\nsometimes an issue connecting to a 5 GHz network with the\niwlwifi DVM driver.\n\nThe reason appears to be that since these commits any bad\nTX status makes mac80211 immediately try again, causing\nall of the authentication attempts to be quickly rejected\nby the firmware as it hasn't heard a beacon yet. Before,\nit would wait for the timeout regardless of status.\n\nTo fix this, invoke the passive-no-RX workaround when not\nassociated yet as well. This will cause the first frame\nto get lost, but then the driver will stop the queues and\nthe second attempt will only be transmitted after hearing\na beacon, thus delaying it appropriately to not make the\nfirmware reject it again.\n\nReported-by: Alex Romosan <romosan@sycorax.lbl.gov>\nTested-by: Alex Romosan <romosan@sycorax.lbl.gov>\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Wed Mar 27 20:49:58 2013 +0100",
  "author_date_iso": "2013-03-27T20:49:58+01:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Thu Mar 28 16:31:26 2013 +0100",
  "committer_date_iso": "2013-03-28T16:31:26+01:00",
  "files_changed": [
    "drivers/net/wireless/iwlwifi/dvm/rxon.c",
    "drivers/net/wireless/iwlwifi/dvm/tx.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "drivers/net/wireless/iwlwifi/dvm/rxon.c",
      "insertions": 8,
      "deletions": 10
    },
    {
      "file": "drivers/net/wireless/iwlwifi/dvm/tx.c",
      "insertions": 1,
      "deletions": 1
    }
  ],
  "total_insertions": 9,
  "total_deletions": 11,
  "total_changes": 20,
  "parents": [
    "2d5d50ee596361566f7f84300117cba7d7672bc5"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.10",
    "v3.10-rc1",
    "v3.10-rc2",
    "v3.10-rc3",
    "v3.10-rc4",
    "v3.10-rc5",
    "v3.10-rc6",
    "v3.10-rc7",
    "v3.11",
    "v3.11-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "auth"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/iwlwifi/dvm/rxon.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/net/wireless/iwlwifi/dvm/tx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}