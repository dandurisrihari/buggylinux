Commit Hash: 045da3077bc57e587d0ab4cfc8945b76af03d72d
Subject: scsi: ufs: core: Make fault injection dynamically configurable per HBA


Security Keywords:
- injection

Full commit message:
scsi: ufs: core: Make fault injection dynamically configurable per HBA

The UFS driver has two driver-specific fault injection mechanisms
(trigger_eh and timeout). Each fault injection configuration can only be
specified by a module parameter and cannot be reconfigured without
reloading the driver. Also, each configuration is common to all HBAs.

This change adds the following subdirectories for each UFS HBA when
debugfs is enabled:

  /sys/kernel/debug/ufshcd/<HBA>/timeout_inject
  /sys/kernel/debug/ufshcd/<HBA>/trigger_eh_inject

Each fault injection attribute can be dynamically set per HBA by a
corresponding file in these directories.

This is tested with QEMU UFS devices.

Signed-off-by: Akinobu Mita <akinobu.mita@gmail.com>
Link: https://lore.kernel.org/r/20231118124443.1007116-1-akinobu.mita@gmail.com
Reviewed-by: Bart Van Assche <bvanassche@acm.org>
Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>

Metadata:
Author: Akinobu Mita <akinobu.mita@gmail.com>
Author Date: Sat Nov 18 21:44:43 2023 +0900
Committer: Martin K. Petersen <martin.petersen@oracle.com>
Commit Date: Fri Nov 24 19:23:35 2023 -0500

Files Changed: 4
Lines Added: 32
Lines Removed: 10
Total Changes: 42
