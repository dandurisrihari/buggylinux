{
  "hash": "6d2fa9e141ea56a571ec842fd4f3a86bea44a203",
  "hash_short": "6d2fa9e1",
  "subject": "Merge branch 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/nab/target-pending",
  "body": "Pull SCSI target updates from Nicholas Bellinger:\n \"Lots of activity this round on performance improvements in target-core\n  while benchmarking the prototype scsi-mq initiator code with\n  vhost-scsi fabric ports, along with a number of iscsi/iser-target\n  improvements and hardening fixes for exception path cases post v3.10\n  merge.\n\n  The highlights include:\n\n   - Make persistent reservations APTPL buffer allocated on-demand, and\n     drop per t10_reservation buffer.  (grover)\n   - Make virtual LUN=0 a NULLIO device, and skip allocation of NULLIO\n     device pages (grover)\n   - Add transport_cmd_check_stop write_pending bit to avoid extra\n     access of ->t_state_lock is WRITE I/O submission fast-path.  (nab)\n   - Drop unnecessary CMD_T_DEV_ACTIVE check from\n     transport_lun_remove_cmd to avoid extra access of ->t_state_lock in\n     release fast-path.  (nab)\n   - Avoid extra t_state_lock access in __target_execute_cmd fast-path\n     (nab)\n   - Drop unnecessary vhost-scsi wait_for_tasks=true usage +\n     ->t_state_lock access in release fast-path.  (nab)\n   - Convert vhost-scsi to use modern se_cmd->cmd_kref\n     TARGET_SCF_ACK_KREF usage (nab)\n   - Add tracepoints for SCSI commands being processed (roland)\n   - Refactoring of iscsi-target handling of ISCSI_OP_NOOP +\n     ISCSI_OP_TEXT to be transport independent (nab)\n   - Add iscsi-target SendTargets=$IQN support for in-band discovery\n     (nab)\n   - Add iser-target support for in-band discovery (nab + Or)\n   - Add iscsi-target demo-mode TPG authentication context support (nab)\n   - Fix isert_put_reject payload buffer post (nab)\n   - Fix iscsit_add_reject* usage for iser (nab)\n   - Fix iscsit_sequence_cmd reject handling for iser (nab)\n   - Fix ISCSI_OP_SCSI_TMFUNC handling for iser (nab)\n   - Fix session reset bug with RDMA_CM_EVENT_DISCONNECTED (nab)\n\n  The last five iscsi/iser-target items are CC'ed to stable, as they do\n  address issues present in v3.10 code.  They are certainly larger than\n  I'd like for stable patch set, but are important to ensure proper\n  REJECT exception handling in iser-target for 3.10.y\"\n\n* 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/nab/target-pending: (51 commits)\n  iser-target: Ignore non TEXT + LOGOUT opcodes for discovery\n  target: make queue_tm_rsp() return void\n  target: remove unused codes from enum tcm_tmrsp_table\n  iscsi-target: kstrtou* configfs attribute parameter cleanups\n  iscsi-target: Fix tfc_tpg_auth_cit configfs length overflow\n  iscsi-target: Fix tfc_tpg_nacl_auth_cit configfs length overflow\n  iser-target: Add support for ISCSI_OP_TEXT opcode + payload handling\n  iser-target: Rename sense_buf_[dma,len] to pdu_[dma,len]\n  iser-target: Add vendor_err debug output\n  target: Add (obsolete) checking for PMI/LBA fields in READ CAPACITY(10)\n  target: Return correct sense data for IO past the end of a device\n  target: Add tracepoints for SCSI commands being processed\n  iser-target: Fix session reset bug with RDMA_CM_EVENT_DISCONNECTED\n  iscsi-target: Fix ISCSI_OP_SCSI_TMFUNC handling for iser\n  iscsi-target: Fix iscsit_sequence_cmd reject handling for iser\n  iscsi-target: Fix iscsit_add_reject* usage for iser\n  iser-target: Fix isert_put_reject payload buffer post\n  iscsi-target: missing kfree() on error path\n  iscsi-target: Drop left-over iscsi_conn->bad_hdr\n  target: Make core_scsi3_update_and_write_aptpl return sense_reason_t\n  ...",
  "full_message": "Merge branch 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/nab/target-pending\n\nPull SCSI target updates from Nicholas Bellinger:\n \"Lots of activity this round on performance improvements in target-core\n  while benchmarking the prototype scsi-mq initiator code with\n  vhost-scsi fabric ports, along with a number of iscsi/iser-target\n  improvements and hardening fixes for exception path cases post v3.10\n  merge.\n\n  The highlights include:\n\n   - Make persistent reservations APTPL buffer allocated on-demand, and\n     drop per t10_reservation buffer.  (grover)\n   - Make virtual LUN=0 a NULLIO device, and skip allocation of NULLIO\n     device pages (grover)\n   - Add transport_cmd_check_stop write_pending bit to avoid extra\n     access of ->t_state_lock is WRITE I/O submission fast-path.  (nab)\n   - Drop unnecessary CMD_T_DEV_ACTIVE check from\n     transport_lun_remove_cmd to avoid extra access of ->t_state_lock in\n     release fast-path.  (nab)\n   - Avoid extra t_state_lock access in __target_execute_cmd fast-path\n     (nab)\n   - Drop unnecessary vhost-scsi wait_for_tasks=true usage +\n     ->t_state_lock access in release fast-path.  (nab)\n   - Convert vhost-scsi to use modern se_cmd->cmd_kref\n     TARGET_SCF_ACK_KREF usage (nab)\n   - Add tracepoints for SCSI commands being processed (roland)\n   - Refactoring of iscsi-target handling of ISCSI_OP_NOOP +\n     ISCSI_OP_TEXT to be transport independent (nab)\n   - Add iscsi-target SendTargets=$IQN support for in-band discovery\n     (nab)\n   - Add iser-target support for in-band discovery (nab + Or)\n   - Add iscsi-target demo-mode TPG authentication context support (nab)\n   - Fix isert_put_reject payload buffer post (nab)\n   - Fix iscsit_add_reject* usage for iser (nab)\n   - Fix iscsit_sequence_cmd reject handling for iser (nab)\n   - Fix ISCSI_OP_SCSI_TMFUNC handling for iser (nab)\n   - Fix session reset bug with RDMA_CM_EVENT_DISCONNECTED (nab)\n\n  The last five iscsi/iser-target items are CC'ed to stable, as they do\n  address issues present in v3.10 code.  They are certainly larger than\n  I'd like for stable patch set, but are important to ensure proper\n  REJECT exception handling in iser-target for 3.10.y\"\n\n* 'for-next' of git://git.kernel.org/pub/scm/linux/kernel/git/nab/target-pending: (51 commits)\n  iser-target: Ignore non TEXT + LOGOUT opcodes for discovery\n  target: make queue_tm_rsp() return void\n  target: remove unused codes from enum tcm_tmrsp_table\n  iscsi-target: kstrtou* configfs attribute parameter cleanups\n  iscsi-target: Fix tfc_tpg_auth_cit configfs length overflow\n  iscsi-target: Fix tfc_tpg_nacl_auth_cit configfs length overflow\n  iser-target: Add support for ISCSI_OP_TEXT opcode + payload handling\n  iser-target: Rename sense_buf_[dma,len] to pdu_[dma,len]\n  iser-target: Add vendor_err debug output\n  target: Add (obsolete) checking for PMI/LBA fields in READ CAPACITY(10)\n  target: Return correct sense data for IO past the end of a device\n  target: Add tracepoints for SCSI commands being processed\n  iser-target: Fix session reset bug with RDMA_CM_EVENT_DISCONNECTED\n  iscsi-target: Fix ISCSI_OP_SCSI_TMFUNC handling for iser\n  iscsi-target: Fix iscsit_sequence_cmd reject handling for iser\n  iscsi-target: Fix iscsit_add_reject* usage for iser\n  iser-target: Fix isert_put_reject payload buffer post\n  iscsi-target: missing kfree() on error path\n  iscsi-target: Drop left-over iscsi_conn->bad_hdr\n  target: Make core_scsi3_update_and_write_aptpl return sense_reason_t\n  ...",
  "author_name": "Linus Torvalds",
  "author_email": "torvalds@linux-foundation.org",
  "author_date": "Thu Jul 11 12:57:19 2013 -0700",
  "author_date_iso": "2013-07-11T12:57:19-07:00",
  "committer_name": "Linus Torvalds",
  "committer_email": "torvalds@linux-foundation.org",
  "committer_date": "Thu Jul 11 12:57:19 2013 -0700",
  "committer_date_iso": "2013-07-11T12:57:19-07:00",
  "files_changed": [
    "drivers/infiniband/ulp/isert/ib_isert.c",
    "drivers/scsi/qla2xxx/tcm_qla2xxx.c",
    "drivers/target/iscsi/iscsi_target_configfs.c",
    "drivers/target/iscsi/iscsi_target_erl0.c",
    "drivers/target/iscsi/iscsi_target_nego.c",
    "drivers/vhost/scsi.c"
  ],
  "files_changed_count": 6,
  "stats": [
    {
      "file": "drivers/infiniband/ulp/isert/ib_isert.c",
      "insertions": 225,
      "deletions": 43
    },
    {
      "file": "drivers/infiniband/ulp/isert/ib_isert.h",
      "insertions": 3,
      "deletions": 2
    },
    {
      "file": "drivers/infiniband/ulp/srpt/ib_srpt.c",
      "insertions": 17,
      "deletions": 10
    },
    {
      "file": "drivers/scsi/qla2xxx/qla_target.c",
      "insertions": 13,
      "deletions": 138
    },
    {
      "file": "drivers/scsi/qla2xxx/tcm_qla2xxx.c",
      "insertions": 5,
      "deletions": 5
    },
    {
      "file": "drivers/target/iscsi/iscsi_target.c",
      "insertions": 400,
      "deletions": 368
    },
    {
      "file": "drivers/target/iscsi/iscsi_target.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_configfs.c",
      "insertions": 160,
      "deletions": 24
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_core.h",
      "insertions": 7,
      "deletions": 4
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_erl0.c",
      "insertions": 4,
      "deletions": 4
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_erl1.c",
      "insertions": 12,
      "deletions": 14
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_nego.c",
      "insertions": 12,
      "deletions": 1
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_parameters.c",
      "insertions": 0,
      "deletions": 3
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_util.c",
      "insertions": 21,
      "deletions": 7
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_util.h",
      "insertions": 2,
      "deletions": 1
    },
    {
      "file": "drivers/target/loopback/tcm_loop.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/target/sbp/sbp_target.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/target/target_core_configfs.c",
      "insertions": 5,
      "deletions": 8
    },
    {
      "file": "drivers/target/target_core_device.c",
      "insertions": 1,
      "deletions": 4
    },
    {
      "file": "drivers/target/target_core_fabric_configfs.c",
      "insertions": 19,
      "deletions": 2
    },
    {
      "file": "drivers/target/target_core_pr.c",
      "insertions": 169,
      "deletions": 330
    },
    {
      "file": "drivers/target/target_core_pr.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/target/target_core_rd.c",
      "insertions": 5,
      "deletions": 0
    },
    {
      "file": "drivers/target/target_core_sbc.c",
      "insertions": 17,
      "deletions": 1
    },
    {
      "file": "drivers/target/target_core_tmr.c",
      "insertions": 2,
      "deletions": 10
    },
    {
      "file": "drivers/target/target_core_transport.c",
      "insertions": 34,
      "deletions": 53
    },
    {
      "file": "drivers/target/tcm_fc/tcm_fc.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "drivers/target/tcm_fc/tfc_cmd.c",
      "insertions": 2,
      "deletions": 6
    },
    {
      "file": "drivers/usb/gadget/tcm_usb_gadget.c",
      "insertions": 1,
      "deletions": 2
    },
    {
      "file": "drivers/vhost/scsi.c",
      "insertions": 22,
      "deletions": 15
    },
    {
      "file": "include/target/iscsi/iscsi_transport.h",
      "insertions": 16,
      "deletions": 5
    },
    {
      "file": "include/target/target_core_base.h",
      "insertions": 7,
      "deletions": 16
    },
    {
      "file": "include/target/target_core_configfs.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "include/target/target_core_fabric.h",
      "insertions": 1,
      "deletions": 1
    },
    {
      "file": "include/target/target_core_fabric_configfs.h",
      "insertions": 11,
      "deletions": 0
    },
    {
      "file": "include/trace/events/target.h",
      "insertions": 214,
      "deletions": 0
    }
  ],
  "total_insertions": 1413,
  "total_deletions": 1084,
  "total_changes": 2497,
  "parents": [
    "0fb3767b0a5601dd0d528bc8dbefc0567a34b7ec",
    "ca40d24eb8fc3c194b4439493ecf6b2d703812b8"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v3.11",
    "v3.11-rc1",
    "v3.11-rc2",
    "v3.11-rc3",
    "v3.11-rc4",
    "v3.11-rc5",
    "v3.11-rc6",
    "v3.11-rc7",
    "v3.12",
    "v3.12-rc1"
  ],
  "is_merge": true,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening",
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/target/iscsi/iscsi_target_configfs.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_erl0.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/target/iscsi/iscsi_target_nego.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/vhost/scsi.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/scsi/qla2xxx/tcm_qla2xxx.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "drivers/infiniband/ulp/isert/ib_isert.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}