{
  "hash": "5f8cf712582617d523120df67d392059eaf2fc4b",
  "hash_short": "5f8cf712",
  "subject": "ALSA: usb-audio: Fix UAF decrement if card has no live interfaces in card.c",
  "body": "If a USB sound card reports 0 interfaces, an error condition is triggered\nand the function usb_audio_probe errors out. In the error path, there was a\nuse-after-free vulnerability where the memory object of the card was first\nfreed, followed by a decrement of the number of active chips. Moving the\ndecrement above the atomic_dec fixes the UAF.\n\n[ The original problem was introduced in 3.1 kernel, while it was\n  developed in a different form.  The Fixes tag below indicates the\n  original commit but it doesn't mean that the patch is applicable\n  cleanly. -- tiwai ]\n\nFixes: 362e4e49abe5 (\"ALSA: usb-audio - clear chip->probing on error exit\")\nReported-by: Hui Peng <benquike@gmail.com>\nReported-by: Mathias Payer <mathias.payer@nebelwelt.net>\nSigned-off-by: Hui Peng <benquike@gmail.com>\nSigned-off-by: Mathias Payer <mathias.payer@nebelwelt.net>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
  "full_message": "ALSA: usb-audio: Fix UAF decrement if card has no live interfaces in card.c\n\nIf a USB sound card reports 0 interfaces, an error condition is triggered\nand the function usb_audio_probe errors out. In the error path, there was a\nuse-after-free vulnerability where the memory object of the card was first\nfreed, followed by a decrement of the number of active chips. Moving the\ndecrement above the atomic_dec fixes the UAF.\n\n[ The original problem was introduced in 3.1 kernel, while it was\n  developed in a different form.  The Fixes tag below indicates the\n  original commit but it doesn't mean that the patch is applicable\n  cleanly. -- tiwai ]\n\nFixes: 362e4e49abe5 (\"ALSA: usb-audio - clear chip->probing on error exit\")\nReported-by: Hui Peng <benquike@gmail.com>\nReported-by: Mathias Payer <mathias.payer@nebelwelt.net>\nSigned-off-by: Hui Peng <benquike@gmail.com>\nSigned-off-by: Mathias Payer <mathias.payer@nebelwelt.net>\nCc: <stable@vger.kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
  "author_name": "Hui Peng",
  "author_email": "benquike@gmail.com",
  "author_date": "Mon Dec 3 16:09:34 2018 +0100",
  "author_date_iso": "2018-12-03T16:09:34+01:00",
  "committer_name": "Takashi Iwai",
  "committer_email": "tiwai@suse.de",
  "committer_date": "Mon Dec 3 16:09:38 2018 +0100",
  "committer_date_iso": "2018-12-03T16:09:38+01:00",
  "files_changed": [
    "sound/usb/card.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "sound/usb/card.c",
      "insertions": 4,
      "deletions": 1
    }
  ],
  "total_insertions": 4,
  "total_deletions": 1,
  "total_changes": 5,
  "parents": [
    "54947cd64c1b8290f64bb2958e343c07270e3a58"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.20",
    "v4.20-rc6",
    "v4.20-rc7",
    "v5.0",
    "v5.0-rc1",
    "v5.0-rc2",
    "v5.0-rc3",
    "v5.0-rc4",
    "v5.0-rc5",
    "v5.0-rc6"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "sound/usb/card.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}