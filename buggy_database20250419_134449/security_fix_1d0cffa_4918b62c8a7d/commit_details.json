{
  "hash": "1d0cffa674cfa7d185a302c8c6850fc50b893bed",
  "hash_short": "1d0cffa6",
  "subject": "cifs: do not allow creating sockets except with SMB1 posix exensions",
  "body": "RHBZ: 1453123\n\nSince at least the 3.10 kernel and likely a lot earlier we have\nnot been able to create unix domain sockets in a cifs share\nwhen mounted using the SFU mount option (except when mounted\nwith the cifs unix extensions to Samba e.g.)\nTrying to create a socket, for example using the af_unix command from\nxfstests will cause :\nBUG: unable to handle kernel NULL pointer dereference at 00000000\n00000040\n\nSince no one uses or depends on being able to create unix domains sockets\non a cifs share the easiest fix to stop this vulnerability is to simply\nnot allow creation of any other special files than char or block devices\nwhen sfu is used.\n\nAdded update to Ronnie's patch to handle a tcon link leak, and\nto address a buf leak noticed by Gustavo and Colin.\n\nAcked-by: Gustavo A. R. Silva <gustavo@embeddedor.com>\nCC:  Colin Ian King <colin.king@canonical.com>\nReviewed-by: Pavel Shilovsky <pshilov@microsoft.com>\nReported-by: Eryu Guan <eguan@redhat.com>\nSigned-off-by: Ronnie Sahlberg <lsahlber@redhat.com>\nSigned-off-by: Steve French <smfrench@gmail.com>\nCc: stable@vger.kernel.org",
  "full_message": "cifs: do not allow creating sockets except with SMB1 posix exensions\n\nRHBZ: 1453123\n\nSince at least the 3.10 kernel and likely a lot earlier we have\nnot been able to create unix domain sockets in a cifs share\nwhen mounted using the SFU mount option (except when mounted\nwith the cifs unix extensions to Samba e.g.)\nTrying to create a socket, for example using the af_unix command from\nxfstests will cause :\nBUG: unable to handle kernel NULL pointer dereference at 00000000\n00000040\n\nSince no one uses or depends on being able to create unix domains sockets\non a cifs share the easiest fix to stop this vulnerability is to simply\nnot allow creation of any other special files than char or block devices\nwhen sfu is used.\n\nAdded update to Ronnie's patch to handle a tcon link leak, and\nto address a buf leak noticed by Gustavo and Colin.\n\nAcked-by: Gustavo A. R. Silva <gustavo@embeddedor.com>\nCC:  Colin Ian King <colin.king@canonical.com>\nReviewed-by: Pavel Shilovsky <pshilov@microsoft.com>\nReported-by: Eryu Guan <eguan@redhat.com>\nSigned-off-by: Ronnie Sahlberg <lsahlber@redhat.com>\nSigned-off-by: Steve French <smfrench@gmail.com>\nCc: stable@vger.kernel.org",
  "author_name": "Steve French",
  "author_email": "smfrench@gmail.com",
  "author_date": "Fri Apr 20 12:19:07 2018 -0500",
  "author_date_iso": "2018-04-20T12:19:07-05:00",
  "committer_name": "Steve French",
  "committer_email": "smfrench@gmail.com",
  "committer_date": "Fri Apr 20 13:31:32 2018 -0500",
  "committer_date_iso": "2018-04-20T13:31:32-05:00",
  "files_changed": [
    "fs/cifs/dir.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "fs/cifs/dir.c",
      "insertions": 5,
      "deletions": 4
    }
  ],
  "total_insertions": 5,
  "total_deletions": 4,
  "total_changes": 9,
  "parents": [
    "ff30b89e0ab71115cbad6ae10a58bd83fe18b41f"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.17",
    "v4.17-rc2",
    "v4.17-rc3",
    "v4.17-rc4",
    "v4.17-rc5",
    "v4.17-rc6",
    "v4.17-rc7",
    "v4.18",
    "v4.18-rc1",
    "v4.18-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "fs/cifs/dir.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}