Commit Hash: e22c6ea025013ae447fe269269753ffec763dde5
Subject: mlxsw: Use size_mul() in call to struct_size()


Security Keywords:
- hardening

Full commit message:
mlxsw: Use size_mul() in call to struct_size()

If, for any reason, the open-coded arithmetic causes a wraparound, the
protection that `struct_size()` adds against potential integer overflows
is defeated. Fix this by hardening call to `struct_size()` with `size_mul()`.

Fixes: 2285ec872d9d ("mlxsw: spectrum_acl_bloom_filter: use struct_size() in kzalloc()")
Signed-off-by: Gustavo A. R. Silva <gustavoars@kernel.org>
Reviewed-by: Kees Cook <keescook@chromium.org>
Reviewed-by: Ido Schimmel <idosch@nvidia.com>
Signed-off-by: David S. Miller <davem@davemloft.net>

Metadata:
Author: Gustavo A. R. Silva <gustavoars@kernel.org>
Author Date: Fri Sep 15 13:01:23 2023 -0600
Committer: David S. Miller <davem@davemloft.net>
Commit Date: Mon Sep 18 09:36:20 2023 +0100

Files Changed: 1
Lines Added: 1
Lines Removed: 1
Total Changes: 2
