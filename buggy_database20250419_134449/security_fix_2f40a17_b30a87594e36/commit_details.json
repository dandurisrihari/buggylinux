{
  "hash": "2f40a178e70030c4712fe63807c883f34c3645eb",
  "hash_short": "2f40a178",
  "subject": "[CRYPTO] xcbc: Fix crash with IPsec",
  "body": "When using aes-xcbc-mac for authentication in IPsec, \nthe kernel crashes. It seems this algorithm doesn't \naccount for the space IPsec may make in scatterlist for authtag.\nThus when crypto_xcbc_digest_update2() gets called,\nnbytes may be less than sg[i].length. \nSince nbytes is an unsigned number, it wraps\nat the end of the loop allowing us to go back \ninto loop and causing crash in memcpy.\n\nI used update function in digest.c to model this fix.\nPlease let me know if it looks ok.\n\nSigned-off-by: Joy Latten <latten@austin.ibm.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "full_message": "[CRYPTO] xcbc: Fix crash with IPsec\n\nWhen using aes-xcbc-mac for authentication in IPsec, \nthe kernel crashes. It seems this algorithm doesn't \naccount for the space IPsec may make in scatterlist for authtag.\nThus when crypto_xcbc_digest_update2() gets called,\nnbytes may be less than sg[i].length. \nSince nbytes is an unsigned number, it wraps\nat the end of the loop allowing us to go back \ninto loop and causing crash in memcpy.\n\nI used update function in digest.c to model this fix.\nPlease let me know if it looks ok.\n\nSigned-off-by: Joy Latten <latten@austin.ibm.com>\nSigned-off-by: Herbert Xu <herbert@gondor.apana.org.au>",
  "author_name": "Joy Latten",
  "author_email": "latten@austin.ibm.com",
  "author_date": "Thu Mar 6 19:28:44 2008 +0800",
  "author_date_iso": "2008-03-06T19:28:44+08:00",
  "committer_name": "Herbert Xu",
  "committer_email": "herbert@gondor.apana.org.au",
  "committer_date": "Thu Mar 6 19:28:44 2008 +0800",
  "committer_date_iso": "2008-03-06T19:28:44+08:00",
  "files_changed": [
    "crypto/xcbc.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "crypto/xcbc.c",
      "insertions": 5,
      "deletions": 1
    }
  ],
  "total_insertions": 5,
  "total_deletions": 1,
  "total_changes": 6,
  "parents": [
    "6212f2c7f70c591efb0d9f3d50ad29112392fee2"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v2.6.25",
    "v2.6.25-rc5",
    "v2.6.25-rc6",
    "v2.6.25-rc7",
    "v2.6.25-rc8",
    "v2.6.25-rc9",
    "v2.6.26",
    "v2.6.26-rc1",
    "v2.6.26-rc2",
    "v2.6.26-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "crypto/xcbc.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}