Commit Hash: 2f40a178e70030c4712fe63807c883f34c3645eb
Subject: [CRYPTO] xcbc: Fix crash with IPsec


Security Keywords:
- authentication

Full commit message:
[CRYPTO] xcbc: Fix crash with IPsec

When using aes-xcbc-mac for authentication in IPsec, 
the kernel crashes. It seems this algorithm doesn't 
account for the space IPsec may make in scatterlist for authtag.
Thus when crypto_xcbc_digest_update2() gets called,
nbytes may be less than sg[i].length. 
Since nbytes is an unsigned number, it wraps
at the end of the loop allowing us to go back 
into loop and causing crash in memcpy.

I used update function in digest.c to model this fix.
Please let me know if it looks ok.

Signed-off-by: Joy Latten <latten@austin.ibm.com>
Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>

Metadata:
Author: Joy Latten <latten@austin.ibm.com>
Author Date: Thu Mar 6 19:28:44 2008 +0800
Committer: Herbert Xu <herbert@gondor.apana.org.au>
Commit Date: Thu Mar 6 19:28:44 2008 +0800

Files Changed: 1
Lines Added: 5
Lines Removed: 1
Total Changes: 6
