{
  "hash": "e63e5d5c15c6b1dba26f7cbd1b1089a1d6155db5",
  "hash_short": "e63e5d5c",
  "subject": "x86/fpu: Introduce validate_xstate_header()",
  "body": "Move validation of user-supplied xstate_header into a helper function,\nin preparation of calling it from both the ptrace and sigreturn syscall\npaths.\n\nThe new function also considers it to be an error if *any* reserved bits\nare set, whereas before we were just clearing most of them silently.\n\nThis should reduce the chance of bugs that fail to correctly validate\nuser-supplied XSAVE areas.  It also will expose any broken userspace\nprograms that set the other reserved bits; this is desirable because\nsuch programs will lose compatibility with future CPUs and kernels if\nthose bits are ever used for anything.  (There shouldn't be any such\nprograms, and in fact in the case where the compacted format is in use\nwe were already validating xfeatures.  But you never know...)\n\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Andy Lutomirski <luto@amacapital.net>\nCc: Andy Lutomirski <luto@kernel.org>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Dave Hansen <dave.hansen@linux.intel.com>\nCc: Dmitry Vyukov <dvyukov@google.com>\nCc: Eric Biggers <ebiggers3@gmail.com>\nCc: Fenghua Yu <fenghua.yu@intel.com>\nCc: Kees Cook <keescook@chromium.org>\nCc: Kevin Hao <haokexin@gmail.com>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Michael Halcrow <mhalcrow@google.com>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Rik van Riel <riel@redhat.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: Wanpeng Li <wanpeng.li@hotmail.com>\nCc: Yu-cheng Yu <yu-cheng.yu@intel.com>\nCc: kernel-hardening@lists.openwall.com\nLink: http://lkml.kernel.org/r/20170924105913.9157-2-mingo@kernel.org\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
  "full_message": "x86/fpu: Introduce validate_xstate_header()\n\nMove validation of user-supplied xstate_header into a helper function,\nin preparation of calling it from both the ptrace and sigreturn syscall\npaths.\n\nThe new function also considers it to be an error if *any* reserved bits\nare set, whereas before we were just clearing most of them silently.\n\nThis should reduce the chance of bugs that fail to correctly validate\nuser-supplied XSAVE areas.  It also will expose any broken userspace\nprograms that set the other reserved bits; this is desirable because\nsuch programs will lose compatibility with future CPUs and kernels if\nthose bits are ever used for anything.  (There shouldn't be any such\nprograms, and in fact in the case where the compacted format is in use\nwe were already validating xfeatures.  But you never know...)\n\nSigned-off-by: Eric Biggers <ebiggers@google.com>\nCc: Andrew Morton <akpm@linux-foundation.org>\nCc: Andy Lutomirski <luto@amacapital.net>\nCc: Andy Lutomirski <luto@kernel.org>\nCc: Borislav Petkov <bp@alien8.de>\nCc: Dave Hansen <dave.hansen@linux.intel.com>\nCc: Dmitry Vyukov <dvyukov@google.com>\nCc: Eric Biggers <ebiggers3@gmail.com>\nCc: Fenghua Yu <fenghua.yu@intel.com>\nCc: Kees Cook <keescook@chromium.org>\nCc: Kevin Hao <haokexin@gmail.com>\nCc: Linus Torvalds <torvalds@linux-foundation.org>\nCc: Michael Halcrow <mhalcrow@google.com>\nCc: Oleg Nesterov <oleg@redhat.com>\nCc: Peter Zijlstra <peterz@infradead.org>\nCc: Rik van Riel <riel@redhat.com>\nCc: Thomas Gleixner <tglx@linutronix.de>\nCc: Wanpeng Li <wanpeng.li@hotmail.com>\nCc: Yu-cheng Yu <yu-cheng.yu@intel.com>\nCc: kernel-hardening@lists.openwall.com\nLink: http://lkml.kernel.org/r/20170924105913.9157-2-mingo@kernel.org\nSigned-off-by: Ingo Molnar <mingo@kernel.org>",
  "author_name": "Eric Biggers",
  "author_email": "ebiggers@google.com",
  "author_date": "Sun Sep 24 12:59:04 2017 +0200",
  "author_date_iso": "2017-09-24T12:59:04+02:00",
  "committer_name": "Ingo Molnar",
  "committer_email": "mingo@kernel.org",
  "committer_date": "Tue Sep 26 09:43:45 2017 +0200",
  "committer_date_iso": "2017-09-26T09:43:45+02:00",
  "files_changed": [
    "arch/x86/include/asm/fpu/xstate.h",
    "arch/x86/kernel/fpu/xstate.c"
  ],
  "files_changed_count": 2,
  "stats": [
    {
      "file": "arch/x86/include/asm/fpu/xstate.h",
      "insertions": 4,
      "deletions": 0
    },
    {
      "file": "arch/x86/kernel/fpu/xstate.c",
      "insertions": 24,
      "deletions": 0
    }
  ],
  "total_insertions": 28,
  "total_deletions": 0,
  "total_changes": 28,
  "parents": [
    "369a036de206710ff27a66f9bffe78ef657648c3"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.14",
    "v4.14-rc3",
    "v4.14-rc4",
    "v4.14-rc5",
    "v4.14-rc6",
    "v4.14-rc7",
    "v4.14-rc8",
    "v4.15",
    "v4.15-rc1",
    "v4.15-rc2"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "hardening"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "arch/x86/include/asm/fpu/xstate.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "arch/x86/kernel/fpu/xstate.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}