Commit Hash: 919dc320956ea353a7fb2d84265195ad5ef525ac
Subject: fsverity: skip PKCS#7 parser when keyring is empty


Security Keywords:
- hardening

Full commit message:
fsverity: skip PKCS#7 parser when keyring is empty

If an fsverity builtin signature is given for a file but the
".fs-verity" keyring is empty, there's no real reason to run the PKCS#7
parser.  Skip this to avoid the PKCS#7 attack surface when builtin
signature support is configured into the kernel but is not being used.

This is a hardening improvement, not a fix per se, but I've added
Fixes and Cc stable to get it out to more users.

Fixes: 432434c9f8e1 ("fs-verity: support builtin file signatures")
Cc: stable@vger.kernel.org
Reviewed-by: Jarkko Sakkinen <jarkko@kernel.org>
Link: https://lore.kernel.org/r/20230820173237.2579-1-ebiggers@kernel.org
Signed-off-by: Eric Biggers <ebiggers@google.com>

Metadata:
Author: Eric Biggers <ebiggers@google.com>
Author Date: Tue Aug 1 21:03:53 2023 -0700
Committer: Eric Biggers <ebiggers@google.com>
Commit Date: Sun Aug 20 10:33:43 2023 -0700

Files Changed: 1
Lines Added: 16
Lines Removed: 0
Total Changes: 16
