Commit Hash: 0e1fc5ef470cc1d157005c437a434868d59fead4
Subject: eCryptfs: verify authentication tokens before their use


Security Keywords:
- authentication

Full commit message:
eCryptfs: verify authentication tokens before their use

Authentication tokens content may change if another requestor calls the
update() method of the corresponding key. The new function
ecryptfs_verify_auth_tok_from_key() retrieves the authentication token from
the provided key and verifies if it is still valid before being used to
encrypt or decrypt an eCryptfs file.

Signed-off-by: Roberto Sassu <roberto.sassu@polito.it>
[tyhicks: Minor formatting changes]
Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>

Metadata:
Author: Roberto Sassu <roberto.sassu@polito.it>
Author Date: Mon Mar 21 16:00:53 2011 +0100
Committer: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
Commit Date: Mon Mar 28 01:49:41 2011 -0500

Files Changed: 3
Lines Added: 135
Lines Removed: 81
Total Changes: 216
