{
  "hash": "3d94a4a8373bf5f45cf5f939e88b8354dbf2311b",
  "hash_short": "3d94a4a8",
  "subject": "mwifiex: fix possible heap overflow in mwifiex_process_country_ie()",
  "body": "mwifiex_process_country_ie() function parse elements of bss\ndescriptor in beacon packet. When processing WLAN_EID_COUNTRY\nelement, there is no upper limit check for country_ie_len before\ncalling memcpy. The destination buffer domain_info->triplet is an\narray of length MWIFIEX_MAX_TRIPLET_802_11D(83). The remote\nattacker can build a fake AP with the same ssid as real AP, and\nsend malicous beacon packet with long WLAN_EID_COUNTRY elemen\n(country_ie_len > 83). Attacker can  force STA connect to fake AP\non a different channel. When the victim STA connects to fake AP,\nwill trigger the heap buffer overflow. Fix this by checking for\nlength and if found invalid, don not connect to the AP.\n\nThis fix addresses CVE-2019-14895.\n\nReported-by: huangwen <huangwenabc@gmail.com>\nSigned-off-by: Ganapathi Bhat <gbhat@marvell.com>\nSigned-off-by: Kalle Valo <kvalo@codeaurora.org>",
  "full_message": "mwifiex: fix possible heap overflow in mwifiex_process_country_ie()\n\nmwifiex_process_country_ie() function parse elements of bss\ndescriptor in beacon packet. When processing WLAN_EID_COUNTRY\nelement, there is no upper limit check for country_ie_len before\ncalling memcpy. The destination buffer domain_info->triplet is an\narray of length MWIFIEX_MAX_TRIPLET_802_11D(83). The remote\nattacker can build a fake AP with the same ssid as real AP, and\nsend malicous beacon packet with long WLAN_EID_COUNTRY elemen\n(country_ie_len > 83). Attacker can  force STA connect to fake AP\non a different channel. When the victim STA connects to fake AP,\nwill trigger the heap buffer overflow. Fix this by checking for\nlength and if found invalid, don not connect to the AP.\n\nThis fix addresses CVE-2019-14895.\n\nReported-by: huangwen <huangwenabc@gmail.com>\nSigned-off-by: Ganapathi Bhat <gbhat@marvell.com>\nSigned-off-by: Kalle Valo <kvalo@codeaurora.org>",
  "author_name": "Ganapathi Bhat",
  "author_email": "gbhat@marvell.com",
  "author_date": "Thu Nov 21 21:34:38 2019 +0530",
  "author_date_iso": "2019-11-21T21:34:38+05:30",
  "committer_name": "Kalle Valo",
  "committer_email": "kvalo@codeaurora.org",
  "committer_date": "Thu Nov 28 10:18:25 2019 +0200",
  "committer_date_iso": "2019-11-28T10:18:25+02:00",
  "files_changed": [
    "drivers/net/wireless/marvell/mwifiex/sta_ioctl.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/wireless/marvell/mwifiex/sta_ioctl.c",
      "insertions": 11,
      "deletions": 2
    }
  ],
  "total_insertions": 11,
  "total_deletions": 2,
  "total_changes": 13,
  "parents": [
    "6f3aeb1ba05d41320e6cf9a60f698d9c4e44348e"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v5.5",
    "v5.5-rc3",
    "v5.5-rc4",
    "v5.5-rc5",
    "v5.5-rc6",
    "v5.5-rc7",
    "v5.6",
    "v5.6-rc1",
    "v5.6-rc2",
    "v5.6-rc3"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [
      "CVE-2019-14895"
    ],
    "security_keywords": []
  },
  "fix_type": "cve",
  "file_results": [
    {
      "file": "drivers/net/wireless/marvell/mwifiex/sta_ioctl.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}