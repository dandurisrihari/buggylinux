Commit Hash: aa6d148e6d6270274e3d5a529b71c54cd329d17f
Subject: ubifs: Fix build errors as symbol undefined


Security Keywords:
- authentication

Full commit message:
ubifs: Fix build errors as symbol undefined

With CONFIG_UBIFS_FS_AUTHENTICATION not set, the compiler can assume that
ubifs_node_check_hash() is never true and drops the call to ubifs_bad_hash().
Is CONFIG_CC_OPTIMIZE_FOR_SIZE enabled this optimization does not happen anymore.

So When CONFIG_UBIFS_FS and CONFIG_CC_OPTIMIZE_FOR_SIZE is enabled but
CONFIG_UBIFS_FS_AUTHENTICATION is not set, the build errors is as followd:
    ERROR: modpost: "ubifs_bad_hash" [fs/ubifs/ubifs.ko] undefined!

Fix it by add no-op ubifs_bad_hash() for the CONFIG_UBIFS_FS_AUTHENTICATION=n case.

Fixes: 16a26b20d2af ("ubifs: authentication: Add hashes to index nodes")
Signed-off-by: Li Hua <hucool.lihua@huawei.com>
Reviewed-by: Sascha Hauer <s.hauer@pengutronix.de>
Signed-off-by: Richard Weinberger <richard@nod.at>

Metadata:
Author: Li Hua <hucool.lihua@huawei.com>
Author Date: Mon Nov 21 19:18:47 2022 +0800
Committer: Richard Weinberger <richard@nod.at>
Commit Date: Thu Feb 2 21:13:34 2023 +0100

Files Changed: 1
Lines Added: 5
Lines Removed: 0
Total Changes: 5
