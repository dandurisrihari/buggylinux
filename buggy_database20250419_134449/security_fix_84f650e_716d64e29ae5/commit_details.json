{
  "hash": "84f650e6323cfdb44aaa94adbab7480435427cf6",
  "hash_short": "84f650e6",
  "subject": "wifi: iwlwifi: mvm: remove per-STA MFP setting",
  "body": "When we first add the STA before sending an authentication\nframe this is false. However, in some cases such as FT or\ncertainly in MLO link switch scenarios, it will be true.\n\nIf it happens to be true, it causes a firmware assert (in\nLMAC, 0x2528), because the same bit is used by the firmware\nfor tracking this setting as well as for tracking if the\nmanagement key has been installed, and then we get this\nassert from the firmware when installing the MFP key as it\nthinks it has already been installed.\n\nRemove the setting for now, until the firmware disentangles\nthe two. We should be able to set it, in fact we should be\nsetting it speculatively before authentication/association,\nto avoid processing management frames that should have been\nprotected/encrypted before the key is set.\n\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\nSigned-off-by: Gregory Greenman <gregory.greenman@intel.com>\nLink: https://lore.kernel.org/r/20230417113648.adbeb0e0bfed.I400d0ee3721dc4f294313be992d277ba4d9c88d9@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "full_message": "wifi: iwlwifi: mvm: remove per-STA MFP setting\n\nWhen we first add the STA before sending an authentication\nframe this is false. However, in some cases such as FT or\ncertainly in MLO link switch scenarios, it will be true.\n\nIf it happens to be true, it causes a firmware assert (in\nLMAC, 0x2528), because the same bit is used by the firmware\nfor tracking this setting as well as for tracking if the\nmanagement key has been installed, and then we get this\nassert from the firmware when installing the MFP key as it\nthinks it has already been installed.\n\nRemove the setting for now, until the firmware disentangles\nthe two. We should be able to set it, in fact we should be\nsetting it speculatively before authentication/association,\nto avoid processing management frames that should have been\nprotected/encrypted before the key is set.\n\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>\nSigned-off-by: Gregory Greenman <gregory.greenman@intel.com>\nLink: https://lore.kernel.org/r/20230417113648.adbeb0e0bfed.I400d0ee3721dc4f294313be992d277ba4d9c88d9@changeid\nSigned-off-by: Johannes Berg <johannes.berg@intel.com>",
  "author_name": "Johannes Berg",
  "author_email": "johannes.berg@intel.com",
  "author_date": "Mon Apr 17 11:41:24 2023 +0300",
  "author_date_iso": "2023-04-17T11:41:24+03:00",
  "committer_name": "Johannes Berg",
  "committer_email": "johannes.berg@intel.com",
  "committer_date": "Tue Apr 18 14:47:54 2023 +0200",
  "committer_date_iso": "2023-04-18T14:47:54+02:00",
  "files_changed": [
    "drivers/net/wireless/intel/iwlwifi/mvm/mld-sta.c"
  ],
  "files_changed_count": 1,
  "stats": [
    {
      "file": "drivers/net/wireless/intel/iwlwifi/mvm/mld-sta.c",
      "insertions": 0,
      "deletions": 1
    }
  ],
  "total_insertions": 0,
  "total_deletions": 1,
  "total_changes": 1,
  "parents": [
    "d16b96b5fd88b75db6fbbe88a8d5981557329581"
  ],
  "branches": [
    "* development",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "authentication"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "drivers/net/wireless/intel/iwlwifi/mvm/mld-sta.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}