{
  "hash": "b245be1f4db1a0394e4b6eb66059814b46670ac3",
  "hash_short": "b245be1f",
  "subject": "net-timestamp: no-payload only sysctl",
  "body": "Tx timestamps are looped onto the error queue on top of an skb. This\nmechanism leaks packet headers to processes unless the no-payload\noptions SOF_TIMESTAMPING_OPT_TSONLY is set.\n\nAdd a sysctl that optionally drops looped timestamp with data. This\nonly affects processes without CAP_NET_RAW.\n\nThe policy is checked when timestamps are generated in the stack.\nIt is possible for timestamps with data to be reported after the\nsysctl is set, if these were queued internally earlier.\n\nNo vulnerability is immediately known that exploits knowledge\ngleaned from packet headers, but it may still be preferable to allow\nadministrators to lock down this path at the cost of possible\nbreakage of legacy applications.\n\nSigned-off-by: Willem de Bruijn <willemb@google.com>\n\n----\n\nChanges\n  (v1 -> v2)\n  - test socket CAP_NET_RAW instead of capable(CAP_NET_RAW)\n  (rfc -> v1)\n  - document the sysctl in Documentation/sysctl/net.txt\n  - fix access control race: read .._OPT_TSONLY only once,\n        use same value for permission check and skb generation.\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "full_message": "net-timestamp: no-payload only sysctl\n\nTx timestamps are looped onto the error queue on top of an skb. This\nmechanism leaks packet headers to processes unless the no-payload\noptions SOF_TIMESTAMPING_OPT_TSONLY is set.\n\nAdd a sysctl that optionally drops looped timestamp with data. This\nonly affects processes without CAP_NET_RAW.\n\nThe policy is checked when timestamps are generated in the stack.\nIt is possible for timestamps with data to be reported after the\nsysctl is set, if these were queued internally earlier.\n\nNo vulnerability is immediately known that exploits knowledge\ngleaned from packet headers, but it may still be preferable to allow\nadministrators to lock down this path at the cost of possible\nbreakage of legacy applications.\n\nSigned-off-by: Willem de Bruijn <willemb@google.com>\n\n----\n\nChanges\n  (v1 -> v2)\n  - test socket CAP_NET_RAW instead of capable(CAP_NET_RAW)\n  (rfc -> v1)\n  - document the sysctl in Documentation/sysctl/net.txt\n  - fix access control race: read .._OPT_TSONLY only once,\n        use same value for permission check and skb generation.\nSigned-off-by: David S. Miller <davem@davemloft.net>",
  "author_name": "Willem de Bruijn",
  "author_email": "willemb@google.com",
  "author_date": "Fri Jan 30 13:29:32 2015 -0500",
  "author_date_iso": "2015-01-30T13:29:32-05:00",
  "committer_name": "David S. Miller",
  "committer_email": "davem@davemloft.net",
  "committer_date": "Mon Feb 2 18:46:51 2015 -0800",
  "committer_date_iso": "2015-02-02T18:46:51-08:00",
  "files_changed": [
    "Documentation/sysctl/net.txt",
    "include/net/sock.h",
    "net/core/skbuff.c",
    "net/core/sock.c",
    "net/core/sysctl_net_core.c"
  ],
  "files_changed_count": 5,
  "stats": [
    {
      "file": "Documentation/sysctl/net.txt",
      "insertions": 8,
      "deletions": 0
    },
    {
      "file": "include/net/sock.h",
      "insertions": 1,
      "deletions": 0
    },
    {
      "file": "net/core/skbuff.c",
      "insertions": 20,
      "deletions": 1
    },
    {
      "file": "net/core/sock.c",
      "insertions": 3,
      "deletions": 0
    },
    {
      "file": "net/core/sysctl_net_core.c",
      "insertions": 9,
      "deletions": 0
    }
  ],
  "total_insertions": 41,
  "total_deletions": 1,
  "total_changes": 42,
  "parents": [
    "49ca0d8bfaf3bc46d5eef60ce67b00eb195bd392"
  ],
  "branches": [
    "* development",
    "master",
    "remotes/origin/HEAD -> origin/master",
    "remotes/origin/master"
  ],
  "tags": [
    "v4.0",
    "v4.0-rc1",
    "v4.0-rc2",
    "v4.0-rc3",
    "v4.0-rc4",
    "v4.0-rc5",
    "v4.0-rc6",
    "v4.0-rc7",
    "v4.1",
    "v4.1-rc1"
  ],
  "is_merge": false,
  "security_info": {
    "cve_ids": [],
    "security_keywords": [
      "vulnerability"
    ]
  },
  "fix_type": "security",
  "file_results": [
    {
      "file": "Documentation/sysctl/net.txt",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "include/net/sock.h",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/core/skbuff.c",
      "pre_version": true,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/core/sock.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    },
    {
      "file": "net/core/sysctl_net_core.c",
      "pre_version": false,
      "post_version": true,
      "patch": true
    }
  ]
}